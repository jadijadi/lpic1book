<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Jadi" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="Linux Installation and Package Management, LPIC1, LPIC1-101-500, LPIC1, " />

<meta property="og:title" content="102.1 Design hard disk layout "/>
<meta property="og:url" content="./1021-design-hard-disk-layout.html" />
<meta property="og:description" content="Description: Candidates should be able to design a disk partitioning scheme for a Linux system." />
<meta property="og:site_name" content="lpic1book" />
<meta property="og:article:author" content="Jadi" />
<meta property="og:article:published_time" content="2010-12-03T10:20:00+01:00" />
<meta name="twitter:title" content="102.1 Design hard disk layout ">
<meta name="twitter:description" content="Description: Candidates should be able to design a disk partitioning scheme for a Linux system.">

        <title>102.1 Design hard disk layout  · lpic1book
</title>



        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4CZV14VZXW"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-4CZV14VZXW');
        </script>
        
    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>lpic1book</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                </li>
                                <li ><a href="./">LPIC1 Book</a></li>
                                <li ><a href="./">Home</a></li>
                                <li ><a href="./support">Support/Donate</a></li>
                                <li ><a href="./archives.html">Chapters</a></li>
                                <li ><a href="./tags.html">Tags</a></li>
                                <li><form action="https://www.google.com/search" method="get" target="_blank" class="navbar-search"> <input type="hidden" name="sitesearch" value="https://linux1st.com/"/><input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./1021-design-hard-disk-layout.html">
                102.1 Design hard disk layout
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p><em>Weight: 2</em></p>
<p>Description: Candidates should be able to design a disk partitioning scheme for a Linux system.</p>
<h2>Key Knowledge Areas</h2>
<ul>
<li>Allocate filesystems and swap space to separate partitions or disks</li>
<li>Tailor the design to the intended use of the system</li>
<li>Ensure the <code>/boot</code> partition conforms to the hardware architecture requirements for booting</li>
<li>Knowledge of basic features of LVM</li>
</ul>
<p>The following is a partial list of the used files, terms, and utilities:</p>
<ul>
<li><code>/</code> (root) filesystem</li>
<li><code>/var</code> filesystem</li>
<li><code>/home</code> filesystem</li>
<li><code>/boot</code> filesystem</li>
<li>EFI System Partition (ESP)</li>
<li>Swap space</li>
<li>Mount points</li>
<li>Partitions</li>
</ul>
<h2>Basics</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/AGu0ulELDzE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Like any contemporary OS, Linux uses <em>files</em> and <em>directories</em> to operate. But unlike <em>Windows</em>, it does not use A:, C:, D:, etc. In Linux, everything is in <em>*one big tree</em>, starting with <code>/</code> (called root). Any partition, disk, CD, USB, network drive, ... will be placed somewhere in this huge tree.</p>
<blockquote>
<p>Note: Most of external devices (USB, CD, ...) are mounted at <code>/media/</code> or <code>/mnt/</code> .</p>
</blockquote>
<h2>Unix directories</h2>
<p>This might be your enlightening moment in your Linux journey. Understanding <strong>Filesystem Hierarchy Standard (FHS)</strong> can help you find your programs, configs, logs and more without having prior knowledge about them. The table below has been the standard the latest revision since 2015.</p>
<table>
<thead>
<tr>
<th align="left">Directory</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bin</td>
<td align="left">Essential command binaries</td>
</tr>
<tr>
<td align="left">boot</td>
<td align="left">Static files of the boot loader</td>
</tr>
<tr>
<td align="left">dev</td>
<td align="left">Device files</td>
</tr>
<tr>
<td align="left">etc</td>
<td align="left">Host-specific system configuration</td>
</tr>
<tr>
<td align="left">home</td>
<td align="left">Home directory of the users</td>
</tr>
<tr>
<td align="left">lib</td>
<td align="left">Essential shared libraries and kernel modules</td>
</tr>
<tr>
<td align="left">media</td>
<td align="left">Mount point for removable media</td>
</tr>
<tr>
<td align="left">mnt</td>
<td align="left">Mount point for mounting a filesystem temporarily</td>
</tr>
<tr>
<td align="left">opt</td>
<td align="left">Add-on application software packages</td>
</tr>
<tr>
<td align="left">root</td>
<td align="left">Home directory of the root user</td>
</tr>
<tr>
<td align="left">sbin</td>
<td align="left">Essential system binaries</td>
</tr>
<tr>
<td align="left">srv</td>
<td align="left">Data for services provided by this system</td>
</tr>
<tr>
<td align="left">tmp</td>
<td align="left">Temporary files, sometimes purged on each boot</td>
</tr>
<tr>
<td align="left">usr</td>
<td align="left">Secondary hierarchy</td>
</tr>
<tr>
<td align="left">var</td>
<td align="left">Variable data (logs, ...)</td>
</tr>
</tbody>
</table>
<h2>Partitions</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/WHsjpzCYXo8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>In the Linux world, devices are defined at <code>/dev/</code> and for different types of disks, there are different naming conventions:
- PATA (Obsolete): <code>/dev/hdc</code>
- SATA (Serial ATA) &amp; SCSI disks: <code>/dev/sda</code>
- SD/emmc &amp; bare NAND/NOR devices: <code>/dev/mmcblk0</code> &amp; their partitions are available as: <code>/dev/mmcblk0p0</code>
- NVME drives: <code>/dev/nvme0</code> &amp; their partitions are available as: <code>/dev/nvme0n1</code></p>
<p>You have to <em>PARTITION</em> the disks, that is to create smaller parts on a big disk. These are self-contained sections on the main drive. OS sees these as standalone disks.  We recognize them as:
- /dev/sd<strong>a</strong>1 (first partition of the first SCSI disk) 
- /dev/hd<strong>b</strong>3 (3rd partition on the second disk)</p>
<p>BIOS systems were using MBR and could have up to 4 partitions on each disk, although instead of creating 4 Primary partitions, you could create an Extended partition and define more Logical partitions inside it.  </p>
<blockquote>
<p>Note: an Extended partition is just an empty box for creating Logical partitions inside it.</p>
</blockquote>
<p>So:</p>
<ul>
<li><code>/dev/sda3</code> is the 3rd primary partition on the first disk</li>
<li><code>/dev/sdb5</code> is the first logical partition on the second disk</li>
<li><code>/dev/sda7</code> is the 3rd logical partition of the first physical disk</li>
</ul>
<p>UEFI systems use GUID Partition Table (GPT) which supports 128 partitions on each device.</p>
<blockquote>
<p>If you define an extended partition on a BIOS system, that will be <code>/dev/sdx5</code> (1-4 for primary, and the first extended will be 5). </p>
</blockquote>
<p>Linux systems can <strong>mount</strong> these partitions on different paths. Say you can have a separated disk with one huge partition for your <code>/home</code> and another one for your <code>/var/logs/</code>.</p>
<div class="highlight"><pre><span></span><code># fdisk /dev/sda
Welcome to fdisk (util-linux 2.25.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.


Command (m for help): p
Disk /dev/sda: 298.1 GiB, 320072933376 bytes, 625142448 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x000beca1

Device     Boot     Start       End   Sectors   Size Id Type
/dev/sda1  *         2048  43094015  43091968  20.6G 83 Linux
/dev/sda2        43094016  92078390  48984375  23.4G 83 Linux
/dev/sda3        92080126 625141759 533061634 254.2G  5 Extended
/dev/sda5        92080128 107702271  15622144   7.5G 82 Linux swap / Solaris
/dev/sda6       107704320 625141759 517437440 246.8G 83 Linux
</code></pre></div>

<p>The newer <strong>GUID Partition Table (or GPT)</strong> solves these problems. If you format your disk with GPT you can have 128 primary partitions (no need for extended and logical).</p>
<h2>Commands</h2>
<h3>parted</h3>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ sudo parted /dev/sda p
Model: ATA ST320LT000-9VL14 (scsi)
Disk /dev/sda: 320GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos
Disk Flags:

Number  Start   End     Size    Type      File system     Flags
 1      1049kB  22.1GB  22.1GB  primary   ext4            boot
 2      22.1GB  47.1GB  25.1GB  primary   ext4
 3      47.1GB  320GB   273GB   extended
 5      47.1GB  55.1GB  7999MB  logical   linux-swap(v1)
 6      55.1GB  320GB   265GB   logical
</code></pre></div>

<p><strong>fdisk</strong></p>
<div class="highlight"><pre><span></span><code># sudo fdisk /dev/sda
[sudo] password for jadi:

Welcome to fdisk (util-linux 2.25.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.


Command (m for help): p
Disk /dev/sda: 298.1 GiB, 320072933376 bytes, 625142448 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x000beca1

Device     Boot     Start       End   Sectors   Size Id Type
/dev/sda1  *         2048  43094015  43091968  20.6G 83 Linux
/dev/sda2        43094016  92078390  48984375  23.4G 83 Linux
/dev/sda3        92080126 625141759 533061634 254.2G  5 Extended
/dev/sda5        92080128 107702271  15622144   7.5G 82 Linux swap / Solaris
/dev/sda6       107704320 625141759 517437440 246.8G 83 Linux
</code></pre></div>

<blockquote>
<p>Note: parted does not understands GPT</p>
</blockquote>
<p><strong>gparted</strong></p>
<p>A graphical tool for managing disks and partitions.</p>
<p><img alt="gparted" src="/images/gparted.png"></p>
<h3>LVM</h3>
<p>In many cases, you need to resize your partitions or even install new disks and <em>add</em> them to your current mount points; Increasing the total size. LVM is designed for this.</p>
<p>LVM helps you create one partition from different disks and add or remove space from/to them. The main concepts are:</p>
<ul>
<li>Physical Volume (PV): A whole drive or a partition. It is better to define partitions and <strong>not use whole disks - unpartitioned</strong>.</li>
<li>Volume Groups (VG): This is the collection of one or more <strong>PV</strong>s. OS will see the vg as one big disk. PVs in one VG, can have different sizes or even be on different physical disks.</li>
<li>Logical Volumes (LV): OS will see lvs as partitions. You can format an LV with your OS and use it.</li>
</ul>
<h2>Design Hard disk layout</h2>
<p>Disk layout and allocation partitions to directories depend on your usage. First, we will discuss <em>swap</em> and <em>boot</em> and then will see three different cases.</p>
<p><strong>swap</strong></p>
<p>Swap in Linux works like an extended memory. The Kernel will <em>page</em> memory to this partition/file. It is enough to format one partition with <strong>swap file system</strong> and define it in <code>/etc/fstab</code> (you will see this later in 104 modules).</p>
<blockquote>
<p>Note: There is no strict formula for swap size. People used to say "double the ram but not more than 8GB". On recent machines with SSDs, some say "RAM + 2" (Hibernation + some extra ) or "RAM * 2" depending on your usage.</p>
</blockquote>
<p><strong>/boot</strong></p>
<p>Older Linux systems were not able to handle HUGE disks during boot (say Terabytes) so the <code>/boot</code> partition was separated. this separation comes in handy in situations such as  recovering broken systems. you can even make <code>/boot</code> read-only. Most of the time, having 100MB for <code>/boot</code> is enough. This partition can be on a different disk or a separated partition.</p>
<p>This partition should be accessible by BIOS/UEFI during boot (No network drive).</p>
<p>On UEFI systems, there is a <code>/boot/efi</code> mount point called EFI (Extensible Firmware Interface) system partition or ESP. This contains the bootloader and kernel and should be accessible by the UEFI firmware during boot.</p>
<h3>Case one: Desktop computer</h3>
<p>On a desktop computer, it is good to have one swap, one <code>/boot</code>, and allocate all other space to <code>/</code> (root).</p>
<h3>Case two: Network workstation</h3>
<p>As any other system <code>/boot</code> should be local (a physical disk is connected to the machine) and most of the time, the <code>/</code> (root file system) is also local. But in a network station, <code>/home</code> can be mounted from a network drive (NFS, SMB, SSH, ..). This lets users sit at any station, login, and have their own home mounted from a network drive. Swap can be mounted from network or local.</p>
<h3>Case three: Server</h3>
<p>On servers <code>/boot</code> is still local and based on usage, <code>/home</code> can be local or network. In many cases, we separate the <code>/var</code> because logs and many other files are there and being updated so it is good to separate it or even put it on more advanced storage (like RAID disks to prevent data loss). Some people also separate the <code>/usr</code> and write-protect it (read-only file systems) or even mount the <code>/usr</code> from the network so they can change/update one file on the network storage and all the servers will use the new file (You remember? <code>/usr</code> contains important executables like Apache webserver).</p>
<h2>Bonus! know about zram</h2>
<p>Here I'll review the 3 different methods to add a <em>swap</em> to your OS. We will have a look at 3 different distros:</p>
<ul>
<li>Debian 11: Uses a swap partition</li>
<li>Ubuntu 22.04: Uses a swap file</li>
<li>Fedora 36: uses <code>zram</code>
In short, <code>zram</code> is a virtual disk on your RAM which can be used as swap space or be mounted anywhere you like; A common example is <code>\tmp</code>. Let's see.</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Y6aceqC0p0Q" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


             
 
            
            
            







            <hr/>

            <!-- show next and previous links -->
            <table style="background: white; border: 0; font-size: 0.8em;"><tr>
                
                
                
                
                
                
                <td style="background: white; border: 0;">
                            <a href="./1013-change-runlevels-boot-targets-and-shutdown-or-reboot-the-system.html">← 101.3 Change runlevels / boot targets and shutdown or reboot the system</a>
                </td>
                <td style="background: white; border: 0;"><center ><a href="/archives.html">Chapter List</a></center></td>
                <td style="background: white; border: 0; text-align: right;">
                            <a href="./1022-install-a-boot-manager.html">102.2 Install a boot manager →</a>
                </td>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </tr></table>
            
            <hr />


	<div class=comment>

<div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://linux1st.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


	</div>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#lpic1-ref">LPIC1</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#linux-installation-and-package-management-ref">Linux Installation and Package Management
                    <span class="superscript">1</span>
</a></li>
                <li><a href="./tags.html#lpic1-ref">LPIC1
                    <span class="superscript">42</span>
</a></li>
                <li><a href="./tags.html#lpic1-101-500-ref">LPIC1-101-500
                    <span class="superscript">22</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>