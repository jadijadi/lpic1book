<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Jadi" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="LPIC1, 101, LPIC1-101-500, LPIC1, " />

<meta property="og:title" content="107.2 Automate system administration tasks by scheduling jobs "/>
<meta property="og:url" content="./1072-automate-system-administration-tasks-by-scheduling-jobs.html" />
<meta property="og:description" content="" />
<meta property="og:site_name" content="lpic1book" />
<meta property="og:article:author" content="Jadi" />
<meta property="og:article:published_time" content="2010-12-03T10:20:00+01:00" />
<meta name="twitter:title" content="107.2 Automate system administration tasks by scheduling jobs ">
<meta name="twitter:description" content="">

        <title>107.2 Automate system administration tasks by scheduling jobs  · lpic1book
</title>



        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4CZV14VZXW"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-4CZV14VZXW');
        </script>
        
    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>lpic1book</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                </li>
                                <li ><a href="./">Home</a></li>
                                <li ><a href="./support">Support/Donate</a></li>
                                <li ><a href="./archives.html">Chapters</a></li>
                                <li ><a href="./tags.html">Tags</a></li>

                                <li><form class="navbar-search" action="./search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./1072-automate-system-administration-tasks-by-scheduling-jobs.html">
                107.2 Automate system administration tasks by scheduling jobs
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <h2>107.2 Automate system administration tasks by scheduling jobs</h2>
<p><em>Weight: 4</em></p>
<p>Candidates should be able to use cron or anacron to run jobs at regular intervals and to use at to run jobs at a specific time.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Manage cron and at jobs.</li>
<li>Configure user access to cron and at services.</li>
<li>Configure anacron.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li>/etc/cron.{d,daily,hourly,monthly,weekly}/</li>
<li>/etc/at.deny</li>
<li>/etc/at.allow</li>
<li>/etc/crontab</li>
<li>/etc/cron.allow</li>
<li>/etc/cron.deny</li>
<li>/var/spool/cron/</li>
<li>crontab</li>
<li>at</li>
<li>atq</li>
<li>atrm</li>
<li>anacron</li>
<li>/etc/anacrontab</li>
</ul>
<h3>Crontab format</h3>
<p>Crontab files are responsible to run some commands on specific intervals. Each line has 5 fileds to specify the run time and whatever after it is considered the command to be run.</p>
<div class="highlight"><pre><span></span><code>A    B    C    D    E    command and arguments
</code></pre></div>

<table>
<thead>
<tr>
<th align="left">filed</th>
<th align="left">Meaning</th>
<th align="left">values</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">A</td>
<td align="left">minute</td>
<td align="left">0-59</td>
</tr>
<tr>
<td align="left">B</td>
<td align="left">hour</td>
<td align="left">0-23</td>
</tr>
<tr>
<td align="left">C</td>
<td align="left">day of month</td>
<td align="left">1-31</td>
</tr>
<tr>
<td align="left">D</td>
<td align="left">month</td>
<td align="left">1-12 (or names, see below)</td>
</tr>
<tr>
<td align="left">E</td>
<td align="left">day of week</td>
<td align="left">0-7 (0 or 7 is Sunday, or use names)</td>
</tr>
</tbody>
</table>
<p>Each time field can be a <code>*</code> to indicate <em>ANY</em>. Also if you have <code>@reboot</code> or <code>@daily</code> instead of time fields, the command will be run once after the reboot or daily. Lets see some examples:</p>
<div class="highlight"><pre><span></span><code>5 0 * * *       $HOME/bin/daily.job &gt;&gt; $HOME/tmp/out 2&gt;&amp;1
# run at 2:15pm on the first of every month -- output mailed to paul
15 14 1 * *     $HOME/bin/monthly
# run at 10 pm on weekdays, annoy Joe
0 22 * * 1-5    mail -s &quot;It&#39;s 10pm&quot; joe%Joe,%%Where are your kids?%
23 0-23/2 * * * echo &quot;run 23 minutes after midn, 2am, 4am ..., everyday&quot;
5 4 * * sun     echo &quot;run at 5 after 4 every sunday&quot;
*/5 * * * *    echo &quot;each 5 mintues&quot;
42 8,18 * * 1-5    echo &quot;8:42 and 18:42 and only on weekdays (monday till friday)&quot;
@reboot        echo &quot;runs after the reboot&quot;
</code></pre></div>

<blockquote>
<p>Note: be careful about using a * on the first filed. That will run your cron on every minute!</p>
<p>Note: Use with care. Something like <code>42 8 1 1 0</code> runs ONLY IF 1st Of Jan is a Monday!</p>
</blockquote>
<p>When a cron runs, the output will be emailed to the owner of the cron.</p>
<h3>user specific crons</h3>
<p>Cron is a linux service. To see your crons you can use <code>crontab -l</code> (list) and for editing it you can use <code>crontab -e</code> (edit) which will open the cron files with a special editor and will load your inserted crons (if they are correct) after wards.</p>
<p>The files will be saved at <code>/var/spool/cron/tabs/</code> or `/var/spool/crontabs':</p>
<div class="highlight"><pre><span></span><code># cat /var/spool/cron/tabs/jadi
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.khObLu installed on Thu Oct 29 22:04:43 2015)
# (Cronie version 4.2)
* * * * * date &gt;&gt; /tmp/date.cron.txt
</code></pre></div>

<p>You should never edit these files directly; Use <code>crontab -e</code> instead.</p>
<h3>at</h3>
<p>We say that crontab runs commands on specific intervals but what will happen if you needed to run a command only once? Here <code>at</code> is your friend.</p>
<div class="highlight"><pre><span></span><code>$ at now + 1 min
warning: commands will be executed using /bin/sh
at&gt; touch /tmp/at
at&gt; &lt;EOT&gt;
job 3 at Thu Oct 29 22:12:00 2015
</code></pre></div>

<blockquote>
<p>Note: As always, at the end of input we press Ctrl+D</p>
</blockquote>
<p>If you want to check what is in the queue you can use <code>atq</code> and then try <code>atrm 4</code> to delete job number 4;</p>
<div class="highlight"><pre><span></span><code>$ at teatime
warning: commands will be executed using /bin/sh
at&gt; echo &quot;tea time is 4pm&quot;
at&gt; &lt;EOT&gt;
job 4 at Fri Oct 30 16:00:00 2015
jadi@funlife:~$ at tomorrow
warning: commands will be executed using /bin/sh
at&gt; echo &quot;tomorrow this time&quot;
at&gt; &lt;EOT&gt;
job 5 at Fri Oct 30 22:15:00 2015
jadi@funlife:~$ at 17:30
warning: commands will be executed using /bin/sh
at&gt; echo &quot;this is the first 17:30&quot;
at&gt; &lt;EOT&gt;
job 6 at Fri Oct 30 17:30:00 2015
jadi@funlife:~$ atq
5    Fri Oct 30 22:15:00 2015 a jadi
4    Fri Oct 30 16:00:00 2015 a jadi
6    Fri Oct 30 17:30:00 2015 a jadi
jadi@funlife:~$ atrm 4
jadi@funlife:~$ atq
5    Fri Oct 30 22:15:00 2015 a jadi
6    Fri Oct 30 17:30:00 2015 a jadi
</code></pre></div>

<h3>system wide cron</h3>
<p>There is file called <code>/etc/crontab</code>. This looks like a normal user file opened with <code>crontab -e</code> but has one extra filed:</p>
<div class="highlight"><pre><span></span><code>A    B    C    D    E    USER    command and arguments
</code></pre></div>

<p>This file should be edited with an editor directly and we can mention which user runs this commands.</p>
<div class="highlight"><pre><span></span><code># cat /etc/crontab
SHELL=/bin/sh
PATH=/usr/bin:/usr/sbin:/sbin:/bin:/usr/lib/news/bin
MAILTO=root
#
# check scripts in cron.hourly, cron.daily, cron.weekly, and cron.monthly
#
-*/15 * * * *   root  test -x /usr/lib/cron/run-crons &amp;&amp; /usr/lib/cron/run-crons &gt;/dev/null 2&gt;&amp;1
</code></pre></div>

<blockquote>
<p>Note: Have a look at first two line. It configures the shell which will run the commands and the PATH variable plus who will get the output emails.</p>
</blockquote>
<p>As you can see this default crontab runs other crons! They are hourly, daily, weekly and monthly crons.</p>
<h3>System hourly, daliy, weekly, monthly, .. crons</h3>
<p>We have some system level crontab files in <code>/etc/cron.d/</code> too. In other words, whatever file which is copied there, will be treated just like <code>/etc/crontab</code> file (a system wide cron file). This make systems much cleaner and lets programs to copy one file there instead of editing the /etc/crontab.</p>
<div class="highlight"><pre><span></span><code>$ sudo tree /etc/cron*
root&#39;s password:
/etc/cron.d
└── mdadm
/etc/cron.daily
├── google-chrome
├── mdadm
├── mlocate.cron
├── packagekit-background.cron
├── suse-clean_catman
├── suse.de-backup-rc.config
├── suse.de-backup-rpmdb
├── suse.de-check-battery
├── suse.de-cron-local
├── suse.de-snapper
└── suse-do_mandb
/etc/cron.deny [error opening dir]
/etc/cron.hourly
└── suse.de-snapper
/etc/cron.monthly
/etc/crontab [error opening dir]
/etc/cron.weekly
</code></pre></div>

<p>Lets have a look at one of the cron.d files:</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/cron.d/mdadm
#
# cron.d/mdadm - regular redundancy checks
#

# Start checking each month early in the morning.
# Continue each day until all done

PATH=/sbin:/usr/sbin:/bin:/usr/bin
0 1 * * 0 root source /etc/sysconfig/mdadm; [ -n &quot;$MDADM_CHECK_DURATION&quot; -a -x /usr/share/mdadm/mdcheck -a $(date +\%d) -le 7 ] &amp;&amp; /usr/share/mdadm/mdcheck --duration &quot;$MDADM_CHECK_DURATION&quot;
0 1 * * 1-6 root source /etc/sysconfig/mdadm; [ -n &quot;$MDADM_CHECK_DURATION&quot; -a -x /usr/share/mdadm/mdcheck ] &amp;&amp; /usr/share/mdadm/mdcheck --continue --duration &quot;$MDADM_CHECK_DURATION&quot;
</code></pre></div>

<p>But /etc/cron.hourly, /etc/cron.daily, /etc/cron.weekly, /etc/cron.monthly is <strong>TOTALLY DIFFERENT</strong>. In these directories are actual executable scripts and files. The cron will run these files one a hour, one a day, once a week or once a month based on their directory names.</p>
<h3>anacron</h3>
<p>The difference between cron and anacron, is this:</p>
<blockquote>
<p>If the system is down when the cron should run a task, that cron job wont run till the next occurrence! But anacron creates the timestamp each time a <strong>daily</strong>, <strong>weekly</strong> or <strong>monthly</strong> job runs. If the system <strong>boots up</strong> and find outs that one of the anacron jobs are missed, it will run it during the boot!</p>
</blockquote>
<p>As you can see anacron is useful for important tasks. If you need to take a backup once a week it is better to use anacron instead of cron; or feeding your dog once a day using cron may lead to it staying hungry for a day if the system is down when he should be fed.</p>
<blockquote>
<p>Note: anacron checks the timestamps at BOOT TIME and do not handle hourly crons.</p>
</blockquote>
<h3>controlling access using files</h3>
<p>You have already seen files at /var/spool/cron/tabs/USERNAME. There are also 4 more files to control who can and can not use cron and at. The files are:</p>
<div class="highlight"><pre><span></span><code>/etc/cron.allow
/etc/cron.deny

/etc/at.allow
/etc/at.deny
</code></pre></div>

<p>In most systems none of these files exist but if you create them, they will become active as follow:</p>
<table>
<thead>
<tr>
<th align="left">file extension</th>
<th align="left">functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">.allow</td>
<td align="left">ONLY users mentioned in this file are allowed to run this service. All other users will be denied</td>
</tr>
<tr>
<td align="left">.deny</td>
<td align="left">Everybody can use the service except the users mentioned in this file</td>
</tr>
</tbody>
</table>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#lpic1-ref">LPIC1</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#101-ref">101
                    <span class="superscript">38</span>
</a></li>
                <li><a href="./tags.html#lpic1-ref">LPIC1
                    <span class="superscript">42</span>
</a></li>
                <li><a href="./tags.html#lpic1-101-500-ref">LPIC1-101-500
                    <span class="superscript">41</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>