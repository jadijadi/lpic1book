<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Jadi" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="System Architecture, LPIC1, LPIC1-101-500, LPIC1, " />

<meta property="og:title" content="101.2 Boot the System "/>
<meta property="og:url" content="./1012-boot-the-system.html" />
<meta property="og:description" content="Candidates should be able to guide the system through the booting process." />
<meta property="og:site_name" content="lpic1book" />
<meta property="og:article:author" content="Jadi" />
<meta property="og:article:published_time" content="2010-12-03T10:20:00+01:00" />
<meta name="twitter:title" content="101.2 Boot the System ">
<meta name="twitter:description" content="Candidates should be able to guide the system through the booting process.">

        <title>101.2 Boot the System  · lpic1book
</title>



        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4CZV14VZXW"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-4CZV14VZXW');
        </script>
        
    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>lpic1book</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                </li>
                                <li ><a href="./">Home</a></li>
                                <li ><a href="./support">Support/Donate</a></li>
                                <li ><a href="./archives.html">Chapters</a></li>
                                <li ><a href="./tags.html">Tags</a></li>
                                <li><form action="https://www.google.com/search" method="get" target="_blank" class="navbar-search"> <input type="hidden" name="sitesearch" value="https://linux1st.com/"/><input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./1012-boot-the-system.html">
                101.2 Boot the System
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p><em>Weight: 3</em></p>
<p>Candidates should be able to guide the system through the booting process.</p>
<h2>Key Knowledge Areas</h2>
<ul>
<li>Provide common commands to the boot loader and options to the kernel at boot time</li>
<li>Demonstrate knowledge of the boot sequence from BIOS/UEFI to boot completion</li>
<li>Understanding of SysVinit and systemd</li>
<li>Awareness of Upstart</li>
<li>Check boot events in the log files</li>
</ul>
<h2>Terms</h2>
<ul>
<li>dmesg</li>
<li>journalctl</li>
<li>BIOS</li>
<li>UEFI</li>
<li>bootloader</li>
<li>kernel</li>
<li>initramfs</li>
<li>init</li>
<li>SysVinit</li>
<li>systemd</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Zn_IGnNMHvc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>The Boot Process</h2>
<p>It is important to understand because at this stage, you have very little control over the system and you can not issue commands to troubleshoot much. You should have a good understanding of what is happening.</p>
<ol>
<li>Motherboard Firmware does a PowerOnSelfTest</li>
<li>Motherboard loads the bootloader</li>
<li>Bootloader loads the Linux Kernel-based on its configs/commands</li>
<li>The Kernel loads and prepares the system (root filesystem) and runs the initialization program</li>
<li>Init program start the service, other programs, ... (web server, graphical interface, networking, etc.)</li>
</ol>
<p>As we discussed in the previous section (101.1), the Firmware on the motherboard can be BIOS or UEFI. </p>
<h3>BIOS</h3>
<p>Basic Input Output System</p>
<ul>
<li>Older</li>
<li>Limited to one sector of the disk and needs a multi-stage bootloader</li>
<li>Can start the bootloader from internal/external HDD, CD/DVD, USB Flash drive, Network server</li>
<li>If booting from the HDD, the Master Boot Record will be used (1 sector)</li>
</ul>
<h3>UEFI</h3>
<p>Unified Extensible Firmware Interface. </p>
<ul>
<li>Modern and fancy</li>
<li>Specifies a special disk partition for the bootloader. Called EFI System Partition (ESP)</li>
<li>ESP is FAT and mounted on <code>/boot/efi</code> and bootloader files has .efi extensions</li>
</ul>
<blockquote>
<p>You can check <code>/sys/firmware/efi</code> to see if you are using a UEFI system or not</p>
</blockquote>
<h3>Bootloader</h3>
<p>Bootloader initializes the minimum hardware needed to boot the system and then finds and runs the OS.</p>
<p>Technically you can point your UEFI to run anything you want but typically under GNU/Linux systems, we use GRUB. Even the GRUB can be used to run any specific program you need but generally it runs the OS. </p>
<h3>Kernel</h3>
<p>The Kernel is the core of your operating system, the LINUX itself. Your bootloader loads the kernel in the memory and runs it. But kernel needs some initial info to start; Things like drivers are necessary to work with the hardware. Those are stored in <code>initrd</code> or <code>initramfs</code> alongside the kernel and used during the boot. </p>
<p>You can also send parameters to the kernel during the boot using the Grub configs. For example, sending a 1 or S will result the system booting in single-user mode (recovery). Or you can force your graphics to work in 1024×768x24 mode by passing <code>vga=792</code> to the Kernel during the boot. </p>
<hr>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Sn20NKM0hbw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h4>dmesg</h4>
<p>Linux will show you the boot process logs during the boot. Some desktop systems hide this behind a fancy boot splash which you can hide using the Esc key or press Ctrl+Alt+F1.</p>
<blockquote>
<p><strong>Fun Fact:</strong> During the bootup, only The Kernel is running so it should record and keep its logs!</p>
</blockquote>
<p>dmesg command will show the full data from <strong>kernel ring buffer</strong> up to now. But</p>
<div class="highlight"><pre><span></span><code>cat /var/log/dmesg
</code></pre></div>

<p>will show <strong>only</strong> the data during the boot.</p>
<p>We can also use <code>journalctl -k</code> to check Kernel logs or use <code>journalctl -b</code> to check for boot logs (or even use <code>journalctl -u kernel</code> to see all previous logs too).</p>
<p>In addition to these, most systems keep the boot logs in a text-like file too. Under Debian-based systems, it's called <code>/var/log/boot</code> and for RedHat-based systems, it's <code>/var/log/boot.log</code>.</p>
<h4>/var/log/messages</h4>
<p>After the init process comes up, syslog daemon will log messages. It has timestamps and will persist during restarts.</p>
<ul>
<li>The Kernel is still logging its messages in dmesg</li>
<li>in some systems, it might be called <code>/var/log/syslog</code></li>
<li>there are many other logs at <code>/var/log</code></li>
</ul>
<h2>init</h2>
<p>When the Kernel finished its initialization, its time to start other programs. To do so, the Kernel runs the Initialization Daemon process, and it takes care of starting other daemons, services, subsystems and programs. Using the init system one can say "I need service A and then service B. Then I need C and D and E but do not start D unless the A and B are running". The system admin can use the init system to stop and start the services later.</p>
<p>There are different init systems:</p>
<ul>
<li><strong>SysVinit</strong> is based on Unix System V. Not being used much but people loved it and you may see it on older machines or even on recently installed ones</li>
<li><strong>systemd</strong> is the new replacement. Some people hate it but it is being used by all the major distros. Can start services in parallel and do lots of fancy stuff! </li>
<li><strong>upstart</strong> was an event-based replacement for the traditional init daemon. The project was started in 2014 by Canonical (the company behind Ubuntu) to replace the SysV but did not continue after 2015 and Ubuntu is now using the systemd as its init system.</li>
</ul>
<p>The init process had the ID of 1 and you can find it by running the </p>
<div class="highlight"><pre><span></span><code># which init
/sbin/init
# readlink -f /sbin/init
/usr/lib/systemd/systemd
# ps -p 1
PID TTY TIME     CMD
1   ?   00:00:06 systemd
</code></pre></div>

<p>You can check the hierarchy of processes using the <code>pstree</code> command.</p>
<div class="highlight"><pre><span></span><code>pstree
</code></pre></div>

<h2>systemd</h2>
<p>Is new, loved, and hated. Lots of new ideas but not following some of the beloved UNIX principles (say.. not saving logs in a text file or trying to help you too much but asking for the root password when you are not running commands with sudo). It lets us run services if the hardware is connected, in time intervals, if another service is started, and ...</p>
<p>The systemd is made around <strong>unit</strong>s. A unit can be a service, group of services, or an action. Units do have a name, a type, and a configuration file. There are 12 unit types: automount, device, mount, path, scope, service, slice, snapshot, socket, swap, target &amp; timer.</p>
<p>We use <code>systemctl</code> to work with these units and <code>journalctl</code> to see the logs.</p>
<div class="highlight"><pre><span></span><code># systemctl list-units
# systemctl list-units --type=target
# systemctl get-default # default target (groups of services are started via target unit files)
</code></pre></div>

<p>The units can be found in these places (sorted by priority):</p>
<ol>
<li><code>/etc/systemd/system/</code></li>
<li><code>/run/systemd/system/</code></li>
<li><code>/usr/lib/systemd/system</code></li>
</ol>
<div class="highlight"><pre><span></span><code># systemctl list-unit-files
# systemctl cat ntpd.service
# systemctl cat graphical.target
</code></pre></div>

<p>We can use these commands to work with services:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># systemctl stop sshd</span><span class="w"></span>
<span class="c1"># systemctl start sshd</span><span class="w"></span>
<span class="c1"># systemctl status sshd</span><span class="w"></span>
<span class="c1"># systemctl is-active sshd</span><span class="w"></span>
<span class="c1"># systemctl is-failed sshd</span><span class="w"></span>
<span class="c1"># systemctl restart sshd</span><span class="w"></span>
<span class="c1"># systemctl reload sshd # re-reads the configuration of the service configs</span><span class="w"></span>
<span class="c1"># systemctl daemon-reload sshd # re-reads the configuration of the systemd configs of this service</span><span class="w"></span>
<span class="c1"># systemctl enable sshd</span><span class="w"></span>
<span class="c1"># systemctl disable sshd</span><span class="w"></span>
</code></pre></div>

<p>there are other commands too:</p>
<div class="highlight"><pre><span></span><code># systemctl is-system-running # running, degraded, maintenance, initializing, starting, stopping
# systemctl --failed
</code></pre></div>

<p>to check the logs, we have to use the <code>journalctl</code> utility:</p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span>#<span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">journal</span><span class="w"></span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">--</span><span class="nv">no</span><span class="o">-</span><span class="nv">pager</span><span class="w"> </span>#<span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">less</span><span class="w"></span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">n</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span>#<span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nv">lines</span><span class="w"></span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">S</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nv">d</span><span class="w"> </span>#<span class="w"> </span><span class="nv">last</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">day</span><span class="w"></span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">xe</span><span class="w"> </span>#<span class="w"> </span><span class="nv">last</span><span class="w"> </span><span class="nv">few</span><span class="w"> </span><span class="nv">logs</span><span class="w"></span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">u</span><span class="w"> </span><span class="nv">ntp</span><span class="w"> </span>#<span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">ntp</span><span class="w"> </span><span class="nv">unit</span><span class="w"></span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="nv">_PID</span><span class="o">=</span><span class="mi">1234</span><span class="w"></span>
</code></pre></div>

<h2>SysV</h2>
<p>Is the older init system. Still can be used on many systems. The control files are located at <code>/etc/init.d/</code> and are closer to the general bash scripts. In many cases you can call like:</p>
<div class="highlight"><pre><span></span><code>/etc/init.d/ntpd status
/etc/init.d/ntpd stop
/etc/init.d/ntpd start
/etc/init.d/ntpd restart
</code></pre></div>

<p>We will speak more about runlevels on 101.3.</p>


             
 
            
            
            







            <hr/>

            <!-- show next and previous links -->
            <table style="background: white; border: 0; font-size: 0.8em;"><tr>
                
                
                
                
                <td style="background: white; border: 0;">
                            <a href="./1011-determine-and-configure-hardware-settings.html">← 101.1 Determine and configure hardware settings</a>
                </td>
                <td style="background: white; border: 0;"><center ><a href="/archives.html">Chapter List</a></center></td>
                <td style="background: white; border: 0; text-align: right;">
                            <a href="./1013-change-runlevels-boot-targets-and-shutdown-or-reboot-the-system.html">101.3 Change runlevels / boot targets and shutdown or reboot the system →</a>
                </td>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </tr></table>
            
            <hr />


	<div class=comment>

<div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://linux1st.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


	</div>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#lpic1-ref">LPIC1</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#lpic1-ref">LPIC1
                    <span class="superscript">42</span>
</a></li>
                <li><a href="./tags.html#lpic1-101-500-ref">LPIC1-101-500
                    <span class="superscript">41</span>
</a></li>
                <li><a href="./tags.html#system-architecture-ref">System Architecture
                    <span class="superscript">2</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>