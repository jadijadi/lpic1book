<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">
        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Jadi" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">
        <title>lpic1book</title>



        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4CZV14VZXW"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-4CZV14VZXW');
        </script>
        
    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">

                        
                        <div class="row-fluid">
                            <header class="page-header span10 offset2">
                            <h1><a href=".">Free LPIC1 Course (Book & Videos)</a></h1>
                            <h2><a href=".">Latest version + All videos: Linux1st.com</a></h2>
                            <h3>jadijadi@gmail.com</h3>
                            </header>
                        </div>
                        <div class="row-fluid">
                            <div class="span10 offset2">
                                <div class="blog-archives">
                                            <h1>Know your LPIC1 version 5 exam</h1>
                                            <br clear="both" />
                                            <iframe width="560" height="315" src="https://www.youtube.com/embed/AKkNUvEHXhk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>This document is written based on <a href="https://www.lpi.org/our-certifications/lpic-1-overview">LPIC1 version 5 (exams 101-500 and 102-500)</a>. It covers all the objectives. Each LPIC exam has 60 multiple choice and fill-in-the-blank questions which should be answered in 90 minutes.</p>
                                            <br clear="both" />
                                            <h1>Prepare your Lab</h1>
                                            <br clear="both" />
                                            <p>Watching videos or even reading books is never enough. You need to have Linux installed and practice your newly acquired knowledge. As you may know, LPIC is a <em>distro agnostic</em> test and an LPIC-certified guru should be able to work in any GNU/Linux system, or at least on the major ones. Because of this, I suggest you have two Linux machines which you can work on. One RPM-based and one Debian-based. </p>
<p>One common way is to use a Virtual Machine. You can install something like <a href="https://www.virtualbox.org">VirtualBox</a> (for Win/Linux and Intel Macs) or <a href="https://mac.getutm.app">UTM</a> (for M1 Macs) or any other solution to install your test machines in a Virtual Machine. </p>
<p>For your distribution, I suggest <a href="https://ubuntu.com">Ubuntu</a> or <a href="https://www.debian.org">Debian</a> as your Debian-based system and <a href="https://getfedora.org">Fedora</a> or <a href="https://rockylinux.org">Rocky Linux</a> as your RPM-based machine. Feel free to install anything else and do whatever you enjoy!</p>
<p>If you want to walk in my steps, do a normal GUI installation. Here is me, installing the Ubuntu 22.04:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/dm_1z7dLAuQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>And here, you can follow the Fedora 36 installation:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/LhvhEtzkb9w" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Note: The version is not that important. Here I'm installing Fedora 36 &amp; Ubuntu 22.04. </p>
                                            <br clear="both" />
                                            <h1>101.1 Determine and configure hardware settings</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Candidates should be able to determine and configure fundamental system hardware.</p>
<h2>Objectives</h2>
<ul>
<li>Enable and disable integrated peripherals</li>
<li>Differentiate between the various types of mass storage devices</li>
<li>Determine hardware resources for devices</li>
<li>Tools and utilities to list various hardware information (e.g. lsusb, lspci, etc.)</li>
<li>Tools and utilities to manipulate USB devices</li>
<li>Conceptual understanding of sysfs, udev, dbus</li>
<li><code>/sys</code></li>
<li><code>/proc</code></li>
<li><code>/dev</code></li>
<li>modprobe</li>
<li>lsmod</li>
<li>lspci</li>
<li>lsusb</li>
</ul>
<h2>Find out about the hardware</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xCPDxgp0zXY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>An operating system (OS) is system software that manages computer hardware, and software resources, and provides common services for computer programs. It sits on top of the hardware and manages the resources when other software (Sometimes called an userspace program) asks for it. </p>
<p>Firmware is the software <em>on</em> your hardware that runs it; Think of it as a built-in OS or driver for your hardware. Motherboards need some firmware to be able to work too. </p>
<p>Firmware is a type of software that lives in hardware. Software is any program or group of programs run by a computer.</p>
<p><img alt="BIOS" src="/images/bios.png">
1. BIOS (Basic Input/Output System). Old and redundant. It is intractable through a text menu-based system and it boots the computer by accessing the first sector of the first partition of your hard disk (MBR). This is not enough for modern systems and most systems use a two-step boot procedure.</p>
<p><img alt="UEFI" src="/images/uefi.jpeg">
2. UEFI (Unified Extensible Firmware Interface). Started as EFI in 1998 in Intel. Now the standard. Uses a specific disk partition for boot (EFI System Partition (ESP)) and uses FAT. On Linux it's located on <code>/boot/efi</code> and the files use the <code>.efi</code> extension. You need to register each bootloader.</p>
<p><img alt="BIOSvsUEFI" src="/images/BIOSvsUEFI.png"></p>
<h2>Peripheral Devices</h2>
<p>These are device interfaces.</p>
<h3>PCI</h3>
<p>Peripheral Component Interconnect. Enables the user to add extra components to the Motherboard. Now most servers use PCI Express (PCIe)</p>
<p><img alt="PCI" src="/images/pci.jpeg"></p>
<ul>
<li>Internal HDD.<ul>
<li>PATA (old)</li>
<li>SATA (serial &amp; up to 4 devices) (II-III)</li>
<li>SCSI (parallel &amp; up to 8 devices) (Small Computer System Interface)</li>
</ul>
</li>
<li>External HDD. Fiber (Providing a high-speed data connection). SSD over USB</li>
<li>Network cards. RJ 45 (Registered Jack 45)</li>
<li>Wireless cards. IEEE 802.11</li>
<li>Bluetooth. IEEE 802.15 (Short-range (up to 10m) wireless technology standard)</li>
<li>Video accelerators. Hardware circuits on a graphics card that speed up full-motion video.</li>
<li>Audio cards</li>
</ul>
<h4>SSD vs HDD</h4>
<ul>
<li>SSDs are faster (reads up to 10 times and writes up to 20 times faster), quieter, smaller, more durable, and consume less energy, while HDDs are cheaper and offer more storage capacity and easier data recovery if damaged.</li>
<li>SSDs don't have moving parts such as actuator arms and spinning platters like hard drives (an SSD uses flash memory without any moving parts). That's one reason why SSDs can withstand accidental drops and other shocks, vibration, extreme temperatures, and magnetic fields better than HDDs.</li>
<li>HDDs tend to last around 3-5 years, SSDs can last up to 10 years or more. (Current SSDs have reserve capacities. These storage spaces aren't available to the user, but are used to repair damaged cells, so to speak. The defect cells are replaced with brand-new reserve cells; this procedure is called “Bad-Block-Management”. Thus, SSD storage cells in normal operation last a lifetime.)</li>
</ul>
<h4>Network cards vs Wireless cards</h4>
<ul>
<li>NIC (Network Interface Card) provides computing network connectivity on a computing device to Ethernet network in Home or Office through RJ45 port. Wireless Adapter Card provides wireless connectivity to computing network enabled by Access Points on premises (in home or office) on a Computing Device.</li>
<li>Wireless cards are installed on an industrial computer is used to enable wireless connectivity to the internet.</li>
</ul>
<h3>USB</h3>
<p>Universal Serial Bus. Serial and need fewer connections.</p>
<p><img alt="USB Interfaces" src="/images/usb.png"></p>
<ul>
<li>1 (12Mbps), 2 (480Mbps), 3 (PCI.e 2.0 Bus:5Gbps, PCI.e 3.0 Bus:10Gbps, PCI.e 3.2 Bus:20Gbps, PCI.e 4.0 Bus:40Gbps)</li>
<li>A, B, C</li>
</ul>
<h3>GPIO</h3>
<p>General Purpose Input Output. </p>
<p><img alt="GPIO on a Raspberry Pi" src="/images/gpio.jpeg"></p>
<ul>
<li>To control other devices</li>
<li>Examples include Arduino, raspberrypi, etc.</li>
</ul>
<h2>Sysfs</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/879oHKwgDG8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Sysfs is a pseudo file system provided by the Linux kernel that exports information about various kernel subsystems, hardware devices, and associated device drivers from the kernel's device model to user space through virtual files.[1] In addition to providing information about various devices and kernel subsystems, exported virtual files are also used for their configuration.</p>
<p>Sysfs is mounted under the <code>/sys</code> mount point.</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">/</span><span class="n">sys</span>
<span class="n">block</span><span class="w">  </span><span class="n">bus</span><span class="w">  </span><span class="k">class</span><span class="w">  </span><span class="n">dev</span><span class="w">  </span><span class="n">devices</span><span class="w">  </span><span class="n">firmware</span><span class="w">  </span><span class="n">fs</span><span class="w">  </span><span class="n">hypervisor</span><span class="w">  </span><span class="n">kernel</span><span class="w">  </span><span class="k">module</span><span class="w">  </span><span class="nf">power</span>
</code></pre></div>

<p>All block devices are at the <code>block</code> and <code>bus</code> directory has all the connected PCI, USB, serial, ... devices. Note that here in <code>sys</code> we have the devices based on their technology but <code>/dev/</code> is abstracted.</p>
<h2>udev</h2>
<p>udev (userspace <code>/dev</code>) is a device manager for the Linux kernel. As the successor of devfsd and hotplug, udev primarily manages device nodes in the <code>/dev</code> directory. At the same time, udev also handles all user space events raised when hardware devices are added into the system or removed from it, including firmware loading as required by certain devices.</p>
<p>There are a lot of devices in <code>/dev/</code> and if you plug in any device, it will be assigned a file in <code>/dev</code> (say <code>/dev/sdb2</code>). <strong>udev</strong> lets you control what will be what in <code>/dev</code>. For example, you can use a rule to force your 128GB flash drive with one specific vendor to be <code>/dev/mybackup</code> every single time you connect it and you can even start a backprocess as soon as it connects.</p>
<p>In essence, <strong>udev</strong> serves as the custodian of the <code>/dev/</code> directory. It abstracts the representation of devices, such as a hard disk, which is identified as <code>/dev/sda</code> or <code>/dev/hd0</code>, irrespective of its manufacturer, model, or underlying technology.</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">/</span><span class="n">dev</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span><span class="o">*</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span><span class="w">  </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span><span class="w">  </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda2</span><span class="w">  </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="w">  </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span><span class="w">  </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda6</span>
</code></pre></div>

<p>If a program wants to read/write from/to a device, it will use the corresponding file in /dev to do so. This can be done on <strong>character devices</strong> or <strong>block devices</strong>. When listing, a <code>b</code> or <code>c</code> will indicate this:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@ocean</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Partial</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">shown</span>
<span class="n">crw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">tty</span><span class="w">       </span><span class="mi">4</span><span class="p">,</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="k">Dec</span><span class="w"> </span><span class="mi">15</span><span class="w">  </span><span class="mi">2019</span><span class="w"> </span><span class="n">tty1</span>
<span class="n">crw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span><span class="w">   </span><span class="mi">5</span><span class="w"> </span><span class="k">Dec</span><span class="w"> </span><span class="mi">15</span><span class="w">  </span><span class="mi">2019</span><span class="w"> </span><span class="n">zero</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="k">disk</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="k">Dec</span><span class="w"> </span><span class="mi">15</span><span class="w">  </span><span class="mi">2019</span><span class="w"> </span><span class="n">ram0</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="c1">---- 1 root disk 253,   0 Dec 15  2019 /dev/vda</span>
</code></pre></div>

<h2>dbus</h2>
<p>D-Bus is a message bus system, a simple way for applications to talk to one another. In addition to inter-process communication, D-Bus helps coordinate process lifecycle; It makes it simple and reliable to code a "single instance" application or daemon and to launch applications and daemons on demand when their services are needed.</p>
<h2>proc directory</h2>
<p>This is where the Kernel keeps its settings and properties. This directory is created on ram and files might have write access (say for some hardware configurations). You can find things like:</p>
<ul>
<li>IRQs (interrupt requests)</li>
<li>I/O ports (locations in memory where CPU can talk with devices)</li>
<li>DMA (direct memory access, faster than I/O ports)</li>
<li>Processes</li>
<li>Network Settings</li>
<li>...</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">/</span><span class="n">proc</span><span class="o">/</span>
<span class="mi">1</span><span class="w">      </span><span class="mi">1249</span><span class="w">   </span><span class="mi">1451</span><span class="w">   </span><span class="mi">1565</span><span class="w">   </span><span class="mi">18069</span><span class="w">  </span><span class="mi">20346</span><span class="w">  </span><span class="mi">2426</span><span class="w">  </span><span class="mi">2765</span><span class="w">  </span><span class="mi">2926</span><span class="w">  </span><span class="mi">3175</span><span class="w">  </span><span class="mi">3317</span><span class="w">  </span><span class="mi">3537</span><span class="w">  </span><span class="mi">39</span><span class="w">    </span><span class="mi">468</span><span class="w">   </span><span class="mi">4921</span><span class="w">  </span><span class="mi">53</span><span class="w">    </span><span class="mi">689</span><span class="w">   </span><span class="mi">969</span><span class="w">      </span><span class="n">filesystems</span><span class="w">  </span><span class="n">misc</span><span class="w">       </span><span class="n">sysvipc</span>
<span class="mi">10</span><span class="w">     </span><span class="mi">13</span><span class="w">     </span><span class="mi">146</span><span class="w">    </span><span class="mi">157</span><span class="w">    </span><span class="mi">18093</span><span class="w">  </span><span class="mi">20681</span><span class="w">  </span><span class="mi">2452</span><span class="w">  </span><span class="mi">2766</span><span class="w">  </span><span class="mi">2929</span><span class="w">  </span><span class="mi">3183</span><span class="w">  </span><span class="mi">3318</span><span class="w">  </span><span class="mi">354</span><span class="w">   </span><span class="mi">397</span><span class="w">   </span><span class="mi">4694</span><span class="w">  </span><span class="mi">4934</span><span class="w">  </span><span class="mi">538</span><span class="w">   </span><span class="mi">7</span><span class="w">     </span><span class="mi">97</span><span class="w">       </span><span class="n">fs</span><span class="w">       </span><span class="n">modules</span><span class="w">        </span><span class="n">timer_list</span>
<span class="mi">1039</span><span class="w">   </span><span class="mi">1321</span><span class="w">   </span><span class="mi">147</span><span class="w">    </span><span class="mi">1572</span><span class="w">   </span><span class="mi">18243</span><span class="w">  </span><span class="mi">21</span><span class="w">     </span><span class="mi">2456</span><span class="w">  </span><span class="mi">28</span><span class="w">    </span><span class="mi">2934</span><span class="w">  </span><span class="mi">3187</span><span class="w">  </span><span class="mi">34</span><span class="w">    </span><span class="mi">3541</span><span class="w">  </span><span class="mi">404</span><span class="w">   </span><span class="mi">4695</span><span class="w">  </span><span class="mi">4955</span><span class="w">  </span><span class="mi">54</span><span class="w">    </span><span class="mi">737</span><span class="w">   </span><span class="n">acpi</span><span class="w">     </span><span class="n">interrupts</span><span class="w">   </span><span class="n">mounts</span><span class="w">         </span><span class="n">timer_stats</span>
<span class="mi">10899</span><span class="w">  </span><span class="mi">13346</span><span class="w">  </span><span class="mi">148</span><span class="w">    </span><span class="mi">1576</span><span class="w">   </span><span class="mi">18274</span><span class="w">  </span><span class="mi">21021</span><span class="w">  </span><span class="mi">2462</span><span class="w">  </span><span class="mi">2841</span><span class="w">  </span><span class="mi">2936</span><span class="w">  </span><span class="mi">3191</span><span class="w">  </span><span class="mi">3450</span><span class="w">  </span><span class="mi">3550</span><span class="w">  </span><span class="mi">41</span><span class="w">    </span><span class="mi">47</span><span class="w">    </span><span class="mi">4970</span><span class="w">  </span><span class="mi">546</span><span class="w">   </span><span class="mi">74</span><span class="w">    </span><span class="n">asound</span><span class="w">   </span><span class="n">iomem</span><span class="w">        </span><span class="n">mtrr</span><span class="w">       </span><span class="n">tty</span>
<span class="mi">10960</span><span class="w">  </span><span class="mi">13438</span><span class="w">  </span><span class="mi">14817</span><span class="w">  </span><span class="mi">158</span><span class="w">    </span><span class="mi">1859</span><span class="w">   </span><span class="mi">21139</span><span class="w">  </span><span class="mi">25</span><span class="w">    </span><span class="mi">2851</span><span class="w">  </span><span class="mi">2945</span><span class="w">  </span><span class="mi">32</span><span class="w">    </span><span class="mi">3459</span><span class="w">  </span><span class="mi">357</span><span class="w">   </span><span class="mi">42</span><span class="w">    </span><span class="mi">4720</span><span class="w">  </span><span class="mi">4982</span><span class="w">  </span><span class="mi">55</span><span class="w">    </span><span class="mi">742</span><span class="w">   </span><span class="n">buddyinfo</span><span class="w">    </span><span class="n">ioports</span><span class="w">      </span><span class="n">net</span><span class="w">        </span><span class="n">uptime</span>
<span class="mi">11</span><span class="w">     </span><span class="mi">13619</span><span class="w">  </span><span class="mi">149</span><span class="w">    </span><span class="mi">16</span><span class="w">     </span><span class="mi">18617</span><span class="w">  </span><span class="mi">2129</span><span class="w">   </span><span class="mi">2592</span><span class="w">  </span><span class="mi">2852</span><span class="w">  </span><span class="mi">2947</span><span class="w">  </span><span class="mi">3202</span><span class="w">  </span><span class="mi">3466</span><span class="w">  </span><span class="mi">36</span><span class="w">    </span><span class="mi">43</span><span class="w">    </span><span class="mi">4731</span><span class="w">  </span><span class="mi">4995</span><span class="w">  </span><span class="mi">551</span><span class="w">   </span><span class="mi">75</span><span class="w">    </span><span class="n">bus</span><span class="w">      </span><span class="n">irq</span><span class="w">          </span><span class="n">pagetypeinfo</span><span class="w">   </span><span class="n">version</span>
<span class="mi">11120</span><span class="w">  </span><span class="mi">13661</span><span class="w">  </span><span class="mi">15</span><span class="w">     </span><span class="mi">1613</span><span class="w">   </span><span class="mi">18781</span><span class="w">  </span><span class="mi">214</span><span class="w">    </span><span class="mi">26</span><span class="w">    </span><span class="mi">2862</span><span class="w">  </span><span class="mi">2948</span><span class="w">  </span><span class="mi">3206</span><span class="w">  </span><span class="mi">3467</span><span class="w">  </span><span class="mi">3683</span><span class="w">  </span><span class="mi">44</span><span class="w">    </span><span class="mi">4756</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="mi">56</span><span class="w">    </span><span class="mi">77</span><span class="w">    </span><span class="n">cgroups</span><span class="w">  </span><span class="n">kallsyms</span><span class="w">     </span><span class="n">partitions</span><span class="w">     </span><span class="n">version_signature</span>
<span class="mi">11145</span><span class="w">  </span><span class="mi">13671</span><span class="w">  </span><span class="mi">150</span><span class="w">    </span><span class="mi">1630</span><span class="w">   </span><span class="mi">1880</span><span class="w">   </span><span class="mi">215</span><span class="w">    </span><span class="mi">27</span><span class="w">    </span><span class="mi">2865</span><span class="w">  </span><span class="mi">2952</span><span class="w">  </span><span class="mi">3208</span><span class="w">  </span><span class="mi">3469</span><span class="w">  </span><span class="mi">3699</span><span class="w">  </span><span class="mi">4484</span><span class="w">  </span><span class="mi">4774</span><span class="w">  </span><span class="mi">50</span><span class="w">    </span><span class="mi">577</span><span class="w">   </span><span class="mi">8</span><span class="w">     </span><span class="n">cmdline</span><span class="w">  </span><span class="n">kcore</span><span class="w">        </span><span class="n">sched_debug</span><span class="w">    </span><span class="n">vmallocinfo</span>
<span class="mi">1159</span><span class="w">   </span><span class="mi">13927</span><span class="w">  </span><span class="mi">151</span><span class="w">    </span><span class="mi">1633</span><span class="w">   </span><span class="mi">1882</span><span class="w">   </span><span class="mi">2199</span><span class="w">   </span><span class="mi">2707</span><span class="w">  </span><span class="mi">2866</span><span class="w">  </span><span class="mi">2955</span><span class="w">  </span><span class="mi">3212</span><span class="w">  </span><span class="mi">3470</span><span class="w">  </span><span class="mi">37</span><span class="w">    </span><span class="mi">4495</span><span class="w">  </span><span class="mi">4795</span><span class="w">  </span><span class="mi">5008</span><span class="w">  </span><span class="mi">5806</span><span class="w">  </span><span class="mi">892</span><span class="w">   </span><span class="n">consoles</span><span class="w">     </span><span class="n">keys</span><span class="w">         </span><span class="n">schedstat</span><span class="w">      </span><span class="n">vmstat</span>
<span class="mi">1163</span><span class="w">   </span><span class="mi">14</span><span class="w">     </span><span class="mi">1512</span><span class="w">   </span><span class="mi">1634</span><span class="w">   </span><span class="mi">19</span><span class="w">     </span><span class="mi">22</span><span class="w">     </span><span class="mi">2708</span><span class="w">  </span><span class="mi">2884</span><span class="w">  </span><span class="mi">2957</span><span class="w">  </span><span class="mi">3225</span><span class="w">  </span><span class="mi">3474</span><span class="w">  </span><span class="mi">3710</span><span class="w">  </span><span class="mi">45</span><span class="w">    </span><span class="mi">48</span><span class="w">    </span><span class="mi">5013</span><span class="w">  </span><span class="mi">60</span><span class="w">    </span><span class="mi">9</span><span class="w">     </span><span class="n">cpuinfo</span><span class="w">  </span><span class="n">key</span><span class="o">-</span><span class="n">users</span><span class="w">    </span><span class="n">scsi</span><span class="w">       </span><span class="n">zoneinfo</span>
<span class="mi">1164</span><span class="w">   </span><span class="mi">14045</span><span class="w">  </span><span class="mi">1515</span><span class="w">   </span><span class="mi">1693</span><span class="w">   </span><span class="mi">19061</span><span class="w">  </span><span class="mi">2219</span><span class="w">   </span><span class="mi">2709</span><span class="w">  </span><span class="mi">2887</span><span class="w">  </span><span class="mi">2961</span><span class="w">  </span><span class="mi">3236</span><span class="w">  </span><span class="mi">3475</span><span class="w">  </span><span class="mi">3752</span><span class="w">  </span><span class="mi">4506</span><span class="w">  </span><span class="mi">4811</span><span class="w">  </span><span class="mi">5077</span><span class="w">  </span><span class="mi">61</span><span class="w">    </span><span class="mi">904</span><span class="w">   </span><span class="n">crypto</span><span class="w">   </span><span class="n">kmsg</span><span class="w">         </span><span class="bp">self</span>
<span class="mi">1170</span><span class="w">   </span><span class="mi">14047</span><span class="w">  </span><span class="mi">152</span><span class="w">    </span><span class="mi">17</span><span class="w">     </span><span class="mi">19068</span><span class="w">  </span><span class="mi">23</span><span class="w">     </span><span class="mi">2710</span><span class="w">  </span><span class="mi">2891</span><span class="w">  </span><span class="mi">3</span><span class="w">     </span><span class="mi">324</span><span class="w">   </span><span class="mi">3477</span><span class="w">  </span><span class="mi">3761</span><span class="w">  </span><span class="mi">4529</span><span class="w">  </span><span class="mi">4821</span><span class="w">  </span><span class="mi">5082</span><span class="w">  </span><span class="mi">62</span><span class="w">    </span><span class="mi">9061</span><span class="w">  </span><span class="n">devices</span><span class="w">  </span><span class="n">kpagecount</span><span class="w">   </span><span class="n">slabinfo</span>
<span class="mi">1174</span><span class="w">   </span><span class="mi">14052</span><span class="w">  </span><span class="mi">153</span><span class="w">    </span><span class="mi">17173</span><span class="w">  </span><span class="mi">19069</span><span class="w">  </span><span class="mi">23055</span><span class="w">  </span><span class="mi">2711</span><span class="w">  </span><span class="mi">2895</span><span class="w">  </span><span class="mi">3047</span><span class="w">  </span><span class="mi">3261</span><span class="w">  </span><span class="mi">3517</span><span class="w">  </span><span class="mi">3778</span><span class="w">  </span><span class="mi">4558</span><span class="w">  </span><span class="mi">484</span><span class="w">   </span><span class="mi">5091</span><span class="w">  </span><span class="mi">677</span><span class="w">   </span><span class="mi">915</span><span class="w">   </span><span class="n">diskstats</span><span class="w">    </span><span class="n">kpageflags</span><span class="w">   </span><span class="n">softirqs</span>
<span class="mi">12</span><span class="w">     </span><span class="mi">1409</span><span class="w">   </span><span class="mi">154</span><span class="w">    </span><span class="mi">1732</span><span class="w">   </span><span class="mi">19075</span><span class="w">  </span><span class="mi">2354</span><span class="w">   </span><span class="mi">2718</span><span class="w">  </span><span class="mi">29</span><span class="w">    </span><span class="mi">3093</span><span class="w">  </span><span class="mi">3284</span><span class="w">  </span><span class="mi">3522</span><span class="w">  </span><span class="mi">38</span><span class="w">    </span><span class="mi">4562</span><span class="w">  </span><span class="mi">4861</span><span class="w">  </span><span class="mi">51</span><span class="w">    </span><span class="mi">678</span><span class="w">   </span><span class="mi">923</span><span class="w">   </span><span class="n">dma</span><span class="w">      </span><span class="n">loadavg</span><span class="w">      </span><span class="n">stat</span>
<span class="mi">1231</span><span class="w">   </span><span class="mi">1444</span><span class="w">   </span><span class="mi">155</span><span class="w">    </span><span class="mi">17413</span><span class="w">  </span><span class="mi">2</span><span class="w">      </span><span class="mi">2390</span><span class="w">   </span><span class="mi">2719</span><span class="w">  </span><span class="mi">2904</span><span class="w">  </span><span class="mi">31</span><span class="w">    </span><span class="mi">3287</span><span class="w">  </span><span class="mi">3525</span><span class="w">  </span><span class="mi">3803</span><span class="w">  </span><span class="mi">46</span><span class="w">    </span><span class="mi">4891</span><span class="w">  </span><span class="mi">52</span><span class="w">    </span><span class="mi">679</span><span class="w">   </span><span class="mi">939</span><span class="w">   </span><span class="n">driver</span><span class="w">   </span><span class="n">locks</span><span class="w">        </span><span class="n">swaps</span>
<span class="mi">1234</span><span class="w">   </span><span class="mi">1446</span><span class="w">   </span><span class="mi">156</span><span class="w">    </span><span class="mi">17751</span><span class="w">  </span><span class="mi">20</span><span class="w">     </span><span class="mi">24</span><span class="w">     </span><span class="mi">2723</span><span class="w">  </span><span class="mi">2908</span><span class="w">  </span><span class="mi">3132</span><span class="w">  </span><span class="mi">3298</span><span class="w">  </span><span class="mi">3528</span><span class="w">  </span><span class="mi">3823</span><span class="w">  </span><span class="mi">4622</span><span class="w">  </span><span class="mi">49</span><span class="w">    </span><span class="mi">5202</span><span class="w">  </span><span class="mi">680</span><span class="w">   </span><span class="mi">940</span><span class="w">   </span><span class="n">execdomains</span><span class="w">  </span><span class="n">mdstat</span><span class="w">       </span><span class="n">sys</span>
<span class="mi">1236</span><span class="w">   </span><span class="mi">145</span><span class="w">    </span><span class="mi">1563</span><span class="w">   </span><span class="mi">18</span><span class="w">     </span><span class="mi">2028</span><span class="w">   </span><span class="mi">2418</span><span class="w">   </span><span class="mi">2763</span><span class="w">  </span><span class="mi">2911</span><span class="w">  </span><span class="mi">3171</span><span class="w">  </span><span class="mi">33</span><span class="w">    </span><span class="mi">3533</span><span class="w">  </span><span class="mi">3845</span><span class="w">  </span><span class="mi">4661</span><span class="w">  </span><span class="mi">4907</span><span class="w">  </span><span class="mi">525</span><span class="w">   </span><span class="mi">687</span><span class="w">   </span><span class="mi">96</span><span class="w">    </span><span class="n">fb</span><span class="w">       </span><span class="n">meminfo</span><span class="w">      </span><span class="n">sysrq</span><span class="o">-</span><span class="n">trigger</span>
</code></pre></div>

<p>The numbers are the process IDs! There are also other files like <code>cpuinfo</code>, <code>mounts</code>, <code>meminfo</code>, ...</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/proc/cpuinfo
processor<span class="w">   </span>:<span class="w"> </span><span class="m">0</span>
vendor_id<span class="w">   </span>:<span class="w"> </span>GenuineIntel
cpu<span class="w"> </span>family<span class="w">  </span>:<span class="w"> </span><span class="m">6</span>
model<span class="w">       </span>:<span class="w"> </span><span class="m">42</span>
model<span class="w"> </span>name<span class="w">  </span>:<span class="w"> </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Core<span class="o">(</span>TM<span class="o">)</span><span class="w"> </span>i5-2520M<span class="w"> </span>CPU<span class="w"> </span>@<span class="w"> </span><span class="m">2</span>.50GHz
stepping<span class="w">    </span>:<span class="w"> </span><span class="m">7</span>
microcode<span class="w">   </span>:<span class="w"> </span>0x15
cpu<span class="w"> </span>MHz<span class="w">     </span>:<span class="w"> </span><span class="m">3195</span>.312
cache<span class="w"> </span>size<span class="w">  </span>:<span class="w"> </span><span class="m">3072</span><span class="w"> </span>KB
physical<span class="w"> </span>id<span class="w"> </span>:<span class="w"> </span><span class="m">0</span>
siblings<span class="w">    </span>:<span class="w"> </span><span class="m">4</span>
core<span class="w"> </span>id<span class="w">     </span>:<span class="w"> </span><span class="m">0</span>
cpu<span class="w"> </span>cores<span class="w">   </span>:<span class="w"> </span><span class="m">2</span>
apicid<span class="w">      </span>:<span class="w"> </span><span class="m">0</span>
initial<span class="w"> </span>apicid<span class="w">  </span>:<span class="w"> </span><span class="m">0</span>
fpu<span class="w">     </span>:<span class="w"> </span>yes
fpu_exception<span class="w">   </span>:<span class="w"> </span>yes
cpuid<span class="w"> </span>level<span class="w"> </span>:<span class="w"> </span><span class="m">13</span>
wp<span class="w">      </span>:<span class="w"> </span>yes
flags<span class="w">       </span>:<span class="w"> </span>fpu<span class="w"> </span>vme<span class="w"> </span>de<span class="w"> </span>pse<span class="w"> </span>tsc<span class="w"> </span>msr<span class="w"> </span>pae<span class="w"> </span>mce<span class="w"> </span>cx8<span class="w"> </span>apic<span class="w"> </span>sep<span class="w"> </span>mtrr<span class="w"> </span>pge<span class="w"> </span>mca<span class="w"> </span>cmov<span class="w"> </span>pat<span class="w"> </span>pse36<span class="w"> </span>clflush<span class="w"> </span>dts<span class="w"> </span>acpi<span class="w"> </span>mmx<span class="w"> </span>fxsr<span class="w"> </span>sse<span class="w"> </span>sse2<span class="w"> </span>ss<span class="w"> </span>ht<span class="w"> </span>tm<span class="w"> </span>pbe<span class="w"> </span>syscall<span class="w"> </span>nx<span class="w"> </span>rdtscp<span class="w"> </span>lm<span class="w"> </span>constant_tsc<span class="w"> </span>arch_perfmon<span class="w"> </span>pebs<span class="w"> </span>bts<span class="w"> </span>nopl<span class="w"> </span>xtopology<span class="w"> </span>nonstop_tsc<span class="w"> </span>aperfmperf<span class="w"> </span>eagerfpu<span class="w"> </span>pni<span class="w"> </span>pclmulqdq<span class="w"> </span>dtes64<span class="w"> </span>monitor<span class="w"> </span>ds_cpl<span class="w"> </span>vmx<span class="w"> </span>smx<span class="w"> </span>est<span class="w"> </span>tm2<span class="w"> </span>ssse3<span class="w"> </span>cx16<span class="w"> </span>xtpr<span class="w"> </span>pdcm<span class="w"> </span>pcid<span class="w"> </span>sse4_1<span class="w"> </span>sse4_2<span class="w"> </span>x2apic<span class="w"> </span>popcnt<span class="w"> </span>tsc_deadline_timer<span class="w"> </span>aes<span class="w"> </span>xsave<span class="w"> </span>avx<span class="w"> </span>lahf_lm<span class="w"> </span>ida<span class="w"> </span>arat<span class="w"> </span>epb<span class="w"> </span>xsaveopt<span class="w"> </span>pln<span class="w"> </span>pts<span class="w"> </span>dtherm<span class="w"> </span>tpr_shadow<span class="w"> </span>vnmi<span class="w"> </span>flexpriority<span class="w"> </span>ept<span class="w"> </span>vpid
bogomips<span class="w">    </span>:<span class="w"> </span><span class="m">4983</span>.79
clflush<span class="w"> </span>size<span class="w">    </span>:<span class="w"> </span><span class="m">64</span>
cache_alignment<span class="w"> </span>:<span class="w"> </span><span class="m">64</span>
address<span class="w"> </span>sizes<span class="w">   </span>:<span class="w"> </span><span class="m">36</span><span class="w"> </span>bits<span class="w"> </span>physical,<span class="w"> </span><span class="m">48</span><span class="w"> </span>bits<span class="w"> </span>virtual
power<span class="w"> </span>management:

processor<span class="w">   </span>:<span class="w"> </span><span class="m">1</span>
vendor_id<span class="w">   </span>:<span class="w"> </span>GenuineIntel
cpu<span class="w"> </span>family<span class="w">  </span>:<span class="w"> </span><span class="m">6</span>
model<span class="w">       </span>:<span class="w"> </span><span class="m">42</span>
model<span class="w"> </span>name<span class="w">  </span>:<span class="w"> </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Core<span class="o">(</span>TM<span class="o">)</span><span class="w"> </span>i5-2520M<span class="w"> </span>CPU<span class="w"> </span>@<span class="w"> </span><span class="m">2</span>.50GHz
stepping<span class="w">    </span>:<span class="w"> </span><span class="m">7</span>
microcode<span class="w">   </span>:<span class="w"> </span>0x15
cpu<span class="w"> </span>MHz<span class="w">     </span>:<span class="w"> </span><span class="m">3010</span>.839
cache<span class="w"> </span>size<span class="w">  </span>:<span class="w"> </span><span class="m">3072</span><span class="w"> </span>KB
physical<span class="w"> </span>id<span class="w"> </span>:<span class="w"> </span><span class="m">0</span>
siblings<span class="w">    </span>:<span class="w"> </span><span class="m">4</span>
core<span class="w"> </span>id<span class="w">     </span>:<span class="w"> </span><span class="m">0</span>
cpu<span class="w"> </span>cores<span class="w">   </span>:<span class="w"> </span><span class="m">2</span>
apicid<span class="w">      </span>:<span class="w"> </span><span class="m">1</span>
initial<span class="w"> </span>apicid<span class="w">  </span>:<span class="w"> </span><span class="m">1</span>
fpu<span class="w">     </span>:<span class="w"> </span>yes
fpu_exception<span class="w">   </span>:<span class="w"> </span>yes
cpuid<span class="w"> </span>level<span class="w"> </span>:<span class="w"> </span><span class="m">13</span>
wp<span class="w">      </span>:<span class="w"> </span>yes
flags<span class="w">       </span>:<span class="w"> </span>fpu<span class="w"> </span>vme<span class="w"> </span>de<span class="w"> </span>pse<span class="w"> </span>tsc<span class="w"> </span>msr<span class="w"> </span>pae<span class="w"> </span>mce<span class="w"> </span>cx8<span class="w"> </span>apic<span class="w"> </span>sep<span class="w"> </span>mtrr<span class="w"> </span>pge<span class="w"> </span>mca<span class="w"> </span>cmov<span class="w"> </span>pat<span class="w"> </span>pse36<span class="w"> </span>clflush<span class="w"> </span>dts<span class="w"> </span>acpi<span class="w"> </span>mmx<span class="w"> </span>fxsr<span class="w"> </span>sse<span class="w"> </span>sse2<span class="w"> </span>ss<span class="w"> </span>ht<span class="w"> </span>tm<span class="w"> </span>pbe<span class="w"> </span>syscall<span class="w"> </span>nx<span class="w"> </span>rdtscp<span class="w"> </span>lm<span class="w"> </span>constant_tsc<span class="w"> </span>arch_perfmon<span class="w"> </span>pebs<span class="w"> </span>bts<span class="w"> </span>nopl<span class="w"> </span>xtopology<span class="w"> </span>nonstop_tsc<span class="w"> </span>aperfmperf<span class="w"> </span>eagerfpu<span class="w"> </span>pni<span class="w"> </span>pclmulqdq<span class="w"> </span>dtes64<span class="w"> </span>monitor<span class="w"> </span>ds_cpl<span class="w"> </span>vmx<span class="w"> </span>smx<span class="w"> </span>est<span class="w"> </span>tm2<span class="w"> </span>ssse3<span class="w"> </span>cx16<span class="w"> </span>xtpr<span class="w"> </span>pdcm<span class="w"> </span>pcid<span class="w"> </span>sse4_1<span class="w"> </span>sse4_2<span class="w"> </span>x2apic<span class="w"> </span>popcnt<span class="w"> </span>tsc_deadline_timer<span class="w"> </span>aes<span class="w"> </span>xsave<span class="w"> </span>avx<span class="w"> </span>lahf_lm<span class="w"> </span>ida<span class="w"> </span>arat<span class="w"> </span>epb<span class="w"> </span>xsaveopt<span class="w"> </span>pln<span class="w"> </span>pts<span class="w"> </span>dtherm<span class="w"> </span>tpr_shadow<span class="w"> </span>vnmi<span class="w"> </span>flexpriority<span class="w"> </span>ept<span class="w"> </span>vpid
bogomips<span class="w">    </span>:<span class="w"> </span><span class="m">4983</span>.79
clflush<span class="w"> </span>size<span class="w">    </span>:<span class="w"> </span><span class="m">64</span>
cache_alignment<span class="w"> </span>:<span class="w"> </span><span class="m">64</span>
address<span class="w"> </span>sizes<span class="w">   </span>:<span class="w"> </span><span class="m">36</span><span class="w"> </span>bits<span class="w"> </span>physical,<span class="w"> </span><span class="m">48</span><span class="w"> </span>bits<span class="w"> </span>virtual
power<span class="w"> </span>management:
</code></pre></div>

<p>We can also write here. Since I'm on an IBM Lenovo laptop I can turn my LED on and off by writing here:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">/</span><span class="k">proc</span><span class="o">/</span><span class="n">acpi</span><span class="o">/</span><span class="n">ibm</span><span class="err">#</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">light</span>
<span class="n">root</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">/</span><span class="k">proc</span><span class="o">/</span><span class="n">acpi</span><span class="o">/</span><span class="n">ibm</span><span class="err">#</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="k">off</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">light</span>
</code></pre></div>

<p>One more traditional example is changing the max number of open files per user:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">/</span><span class="k">proc</span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">fs</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="k">file</span><span class="o">-</span><span class="nf">max</span>
<span class="mi">797946</span>
<span class="n">root</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">/</span><span class="k">proc</span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">fs</span><span class="err">#</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="mi">1000000</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">file</span><span class="o">-</span><span class="nf">max</span>
<span class="n">root</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">/</span><span class="k">proc</span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">fs</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="k">file</span><span class="o">-</span><span class="nf">max</span>
<span class="mi">1000000</span>
</code></pre></div>

<p>Another very useful directory here, is <code>/proc/sys/net/ipv4</code> which controls real-time networking configurations.</p>
<blockquote>
<p>All these changes will be reverted after a boot. You have to write into config files in <code>/etc/</code> to make these changes permanent</p>
</blockquote>
<p>Try yourself! Check the <code>/proc/ioports</code> or <code>/proc/dma</code> or <code>/proc/iomem</code>.</p>
<h2>lsusb, lspci, lsblk, lshw</h2>
<p>Just like <code>ls</code> but for pci, usb, ... </p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/b5bAXRSYmoA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>lspci</h3>
<p>Shows PCI devices that are connected to the computer.</p>
<div class="highlight"><pre><span></span><code><span class="cp"># lspci</span>
<span class="mo">00</span><span class="o">:</span><span class="mf">00.0</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="n">bridge</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">2</span><span class="n">nd</span><span class="w"> </span><span class="n">Generation</span><span class="w"> </span><span class="n">Core</span><span class="w"> </span><span class="n">Processor</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">DRAM</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mi">09</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mf">02.0</span><span class="w"> </span><span class="n">VGA</span><span class="w"> </span><span class="n">compatible</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">2</span><span class="n">nd</span><span class="w"> </span><span class="n">Generation</span><span class="w"> </span><span class="n">Core</span><span class="w"> </span><span class="n">Processor</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">Integrated</span><span class="w"> </span><span class="n">Graphics</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mi">09</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mf">16.0</span><span class="w"> </span><span class="n">Communication</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">MEI</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mf">19.0</span><span class="w"> </span><span class="n">Ethernet</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mf">82579L</span><span class="n">M</span><span class="w"> </span><span class="n">Gigabit</span><span class="w"> </span><span class="n">Network</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mi">1</span><span class="n">a</span><span class="mf">.0</span><span class="w"> </span><span class="n">USB</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">USB</span><span class="w"> </span><span class="n">Enhanced</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="err">#</span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mi">1</span><span class="n">b</span><span class="mf">.0</span><span class="w"> </span><span class="n">Audio</span><span class="w"> </span><span class="n">device</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">High</span><span class="w"> </span><span class="n">Definition</span><span class="w"> </span><span class="n">Audio</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mi">1</span><span class="n">c</span><span class="mf">.0</span><span class="w"> </span><span class="n">PCI</span><span class="w"> </span><span class="n">bridge</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">PCI</span><span class="w"> </span><span class="n">Express</span><span class="w"> </span><span class="n">Root</span><span class="w"> </span><span class="n">Port</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="n">b4</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mi">1</span><span class="n">c</span><span class="mf">.1</span><span class="w"> </span><span class="n">PCI</span><span class="w"> </span><span class="n">bridge</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">PCI</span><span class="w"> </span><span class="n">Express</span><span class="w"> </span><span class="n">Root</span><span class="w"> </span><span class="n">Port</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="n">b4</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mi">1</span><span class="n">c</span><span class="mf">.4</span><span class="w"> </span><span class="n">PCI</span><span class="w"> </span><span class="n">bridge</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">PCI</span><span class="w"> </span><span class="n">Express</span><span class="w"> </span><span class="n">Root</span><span class="w"> </span><span class="n">Port</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="n">b4</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mi">1</span><span class="n">d</span><span class="mf">.0</span><span class="w"> </span><span class="n">USB</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">USB</span><span class="w"> </span><span class="n">Enhanced</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mf">1f.0</span><span class="w"> </span><span class="n">ISA</span><span class="w"> </span><span class="n">bridge</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="n">QM67</span><span class="w"> </span><span class="n">Express</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">LPC</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mf">1f.2</span><span class="w"> </span><span class="n">SATA</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">SATA</span><span class="w"> </span><span class="n">AHCI</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">00</span><span class="o">:</span><span class="mf">1f.3</span><span class="w"> </span><span class="n">SMBus</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">Series</span><span class="o">/</span><span class="n">C200</span><span class="w"> </span><span class="n">Series</span><span class="w"> </span><span class="n">Chipset</span><span class="w"> </span><span class="n">Family</span><span class="w"> </span><span class="n">SMBus</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">04</span><span class="p">)</span>
<span class="mo">03</span><span class="o">:</span><span class="mf">00.0</span><span class="w"> </span><span class="n">Network</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="n">Centrino</span><span class="w"> </span><span class="n">Wireless</span><span class="o">-</span><span class="n">N</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">[</span><span class="n">Condor</span><span class="w"> </span><span class="n">Peak</span><span class="p">]</span>
<span class="mi">0</span><span class="n">d</span><span class="o">:</span><span class="mf">00.0</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="n">peripheral</span><span class="o">:</span><span class="w"> </span><span class="n">Ricoh</span><span class="w"> </span><span class="n">Co</span><span class="w"> </span><span class="n">Ltd</span><span class="w"> </span><span class="n">MMC</span><span class="o">/</span><span class="n">SD</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="p">(</span><span class="n">rev</span><span class="w"> </span><span class="mo">07</span><span class="p">)</span>
</code></pre></div>

<h3>lsusb</h3>
<p>Shows all the USB devices connected to the system.</p>
<div class="highlight"><pre><span></span><code># lsusb
Bus 002 Device 003: ID 1c4f:0026 SiGma Micro Keyboard
Bus 002 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching Hub
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 005: ID 04f2:b217 Chicony Electronics Co., Ltd Lenovo Integrated Camera (0.3MP)
Bus 001 Device 004: ID 0a5c:217f Broadcom Corp. BCM2045B (BDC-2.1)
Bus 001 Device 003: ID 192f:0916 Avago Technologies, Pte.
Bus 001 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching Hub
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</code></pre></div>

<h3>lshw</h3>
<p>Shows hardware. Might need root status to get the full list. Test it!</p>
<h3>lsblk</h3>
<p>Used for list devices that can read from or write to by blocks of data.</p>
<h2>Loadable Kernel Modules</h2>
<p>Linux like any other OS needs drivers to work with hardware. In Microsoft Windows, you need to install the drivers separately but in Linux, the system has most of the drivers built-in. But to prevent the kernel from loading all of them at the same time and to decrease the Kernel size, Linux uses Kernel Modules. Loadable kernel modules (.ko files) are object files that are used to extend the kernel of the Linux Distribution. They are used to provide drivers for new hardware like IoT expansion cards that have not been included in the Linux Distribution.</p>
<p>You can inspect the modules using the <code>lsmod</code> or manage them via <code>modprobe</code> commands.</p>
<h3>lsmod</h3>
<p>Shows kernel modules. They are located at <code>/lib/modules</code>. </p>
<div class="highlight"><pre><span></span><code><span class="n">root@funlife</span><span class="p">:</span><span class="o">/</span><span class="n">dev#</span><span class="w"> </span><span class="n">lsmod</span>
<span class="k">Module</span><span class="w">                  </span><span class="nn">Size</span><span class="w">  </span><span class="n">Used</span><span class="w"> </span><span class="n">by</span>
<span class="n">pci_stub</span><span class="w">               </span><span class="mi">12622</span><span class="w">  </span><span class="mi">1</span>
<span class="n">vboxpci</span><span class="w">                </span><span class="mi">23256</span><span class="w">  </span><span class="mi">0</span>
<span class="n">vboxnetadp</span><span class="w">             </span><span class="mi">25670</span><span class="w">  </span><span class="mi">0</span>
<span class="n">vboxnetflt</span><span class="w">             </span><span class="mi">27605</span><span class="w">  </span><span class="mi">0</span>
<span class="n">vboxdrv</span><span class="w">               </span><span class="mi">418013</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">vboxnetadp</span><span class="p">,</span><span class="n">vboxnetflt</span><span class="p">,</span><span class="n">vboxpci</span>
<span class="n">ctr</span><span class="w">                    </span><span class="mi">13049</span><span class="w">  </span><span class="mi">3</span>
<span class="n">ccm</span><span class="w">                    </span><span class="mi">17731</span><span class="w">  </span><span class="mi">3</span>
<span class="n">dm_crypt</span><span class="w">               </span><span class="mi">23172</span><span class="w">  </span><span class="mi">1</span>
<span class="n">bnep</span><span class="w">                   </span><span class="mi">19543</span><span class="w">  </span><span class="mi">2</span>
<span class="n">rfcomm</span><span class="w">                 </span><span class="mi">69509</span><span class="w">  </span><span class="mi">8</span>
<span class="n">uvcvideo</span><span class="w">               </span><span class="mi">81065</span><span class="w">  </span><span class="mi">0</span>
<span class="n">arc4</span><span class="w">                   </span><span class="mi">12608</span><span class="w">  </span><span class="mi">2</span>
<span class="n">videobuf2_vmalloc</span><span class="w">      </span><span class="mi">13216</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">uvcvideo</span>
<span class="n">intel_rapl</span><span class="w">             </span><span class="mi">18783</span><span class="w">  </span><span class="mi">0</span>
<span class="n">iwldvm</span><span class="w">                </span><span class="mi">236430</span><span class="w">  </span><span class="mi">0</span>
<span class="n">x86_pkg_temp_thermal</span><span class="w">    </span><span class="mi">14205</span><span class="w">  </span><span class="mi">0</span>
<span class="n">intel_powerclamp</span><span class="w">       </span><span class="mi">18786</span><span class="w">  </span><span class="mi">0</span>
<span class="n">btusb</span><span class="w">                  </span><span class="mi">32448</span><span class="w">  </span><span class="mi">0</span>
<span class="n">videobuf2_memops</span><span class="w">       </span><span class="mi">13362</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">videobuf2_vmalloc</span>
<span class="n">videobuf2_core</span><span class="w">         </span><span class="mi">59104</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">uvcvideo</span>
<span class="n">v4l2_common</span><span class="w">            </span><span class="mi">15682</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">videobuf2_core</span>
<span class="n">mac80211</span><span class="w">              </span><span class="mi">660592</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">iwldvm</span>
<span class="n">coretemp</span><span class="w">               </span><span class="mi">13441</span><span class="w">  </span><span class="mi">0</span>
<span class="n">videodev</span><span class="w">              </span><span class="mi">149725</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">uvcvideo</span><span class="p">,</span><span class="n">v4l2_common</span><span class="p">,</span><span class="n">videobuf2_core</span>
<span class="n">media</span><span class="w">                  </span><span class="mi">21963</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">uvcvideo</span><span class="p">,</span><span class="n">videodev</span>
<span class="n">bluetooth</span><span class="w">             </span><span class="mi">446190</span><span class="w">  </span><span class="mi">22</span><span class="w"> </span><span class="n">bnep</span><span class="p">,</span><span class="n">btusb</span><span class="p">,</span><span class="n">rfcomm</span>
<span class="n">kvm_intel</span><span class="w">             </span><span class="mi">143592</span><span class="w">  </span><span class="mi">0</span>
<span class="n">kvm</span><span class="w">                   </span><span class="mi">459835</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">kvm_intel</span>
<span class="n">snd_hda_codec_hdmi</span><span class="w">     </span><span class="mi">47547</span><span class="w">  </span><span class="mi">1</span>
<span class="n">crct10dif_pclmul</span><span class="w">       </span><span class="mi">14307</span><span class="w">  </span><span class="mi">0</span>
<span class="mi">6l</span><span class="n">owpan_iphc</span><span class="w">           </span><span class="mi">18702</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">bluetooth</span>
<span class="n">crc32_pclmul</span><span class="w">           </span><span class="mi">13133</span><span class="w">  </span><span class="mi">0</span>
<span class="n">snd_hda_codec_conexant</span><span class="w">    </span><span class="mi">23064</span><span class="w">  </span><span class="mi">1</span>
<span class="n">ghash_clmulni_intel</span><span class="w">    </span><span class="mi">13230</span><span class="w">  </span><span class="mi">0</span>
<span class="n">snd_hda_codec_generic</span><span class="w">    </span><span class="mi">68914</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">snd_hda_codec_conexant</span>
<span class="n">aesni_intel</span><span class="w">           </span><span class="mi">152552</span><span class="w">  </span><span class="mi">10</span>
<span class="n">snd_seq_midi</span><span class="w">           </span><span class="mi">13564</span><span class="w">  </span><span class="mi">0</span>
<span class="n">snd_seq_midi_event</span><span class="w">     </span><span class="mi">14899</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">snd_seq_midi</span>
<span class="n">aes_x86_64</span><span class="w">             </span><span class="mi">17131</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">aesni_intel</span>
<span class="n">mei_me</span><span class="w">                 </span><span class="mi">19742</span><span class="w">  </span><span class="mi">0</span>
<span class="n">lrw</span><span class="w">                    </span><span class="mi">13287</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">aesni_intel</span>
<span class="n">iwlwifi</span><span class="w">               </span><span class="mi">183038</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">iwldvm</span>
</code></pre></div>

<p>These are the kernel modules that are loaded. Use <code>modinfo</code> to get more info about a module; If you want.</p>
<p>If you need to add a module to your kernel (say a new driver for hardware) or remove it (uninstall a driver) you can use <code>rmmod</code> and <code>modprobe</code>.</p>
<div class="highlight"><pre><span></span><code># rmmod iwlwifi
</code></pre></div>

<p>And this is for installing the modules:</p>
<div class="highlight"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">insmod</span><span class="w"> </span><span class="n">kernel</span><span class="o">/</span><span class="n">drivers</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">wireless</span><span class="o">/</span><span class="n">iwlwifi</span><span class="p">.</span><span class="n">ko</span>
</code></pre></div>

<p>But nobody uses <code>insmod</code> because it does not understand dependencies and you need to give it the whole path to the module file. Instead, use the <code>modprobe</code> command:</p>
<div class="highlight"><pre><span></span><code># modprobe iwlwifi
</code></pre></div>

<blockquote>
<p>you can use <code>-f</code> switch to FORCE <code>rmmod</code> to remove the module even if it is in use</p>
</blockquote>
<p>If you need to load some modules every time your system boots do one of the following:</p>
<ol>
<li>Add their name to this file <code>/etc/modules</code></li>
<li>Add their config files to the <code>/etc/modprobe.d/</code></li>
</ol>
                                            <br clear="both" />
                                            <h1>101.2 Boot the System</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to guide the system through the booting process.</p>
<h2>Key Knowledge Areas</h2>
<ul>
<li>Provide common commands to the boot loader and options to the kernel at boot time</li>
<li>Demonstrate knowledge of the boot sequence from BIOS/UEFI to boot completion</li>
<li>Understanding of SysVinit and systemd</li>
<li>Awareness of Upstart</li>
<li>Check boot events in the log files</li>
</ul>
<h2>Terms</h2>
<ul>
<li>dmesg</li>
<li>journalctl</li>
<li>BIOS</li>
<li>UEFI</li>
<li>bootloader</li>
<li>kernel</li>
<li>initramfs</li>
<li>init</li>
<li>SysVinit</li>
<li>systemd</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Zn_IGnNMHvc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>The Boot Process</h2>
<p>It is important to understand because at this stage, you have very little control over the system and you can not issue commands to troubleshoot much. You should have a good understanding of what is happening.</p>
<ol>
<li>Motherboard Firmware does a PowerOnSelfTest(POST)</li>
<li>Motherboard loads the bootloader</li>
<li>Bootloader loads the Linux Kernel-based on its configs/commands</li>
<li>The Kernel loads and prepares the system (root filesystem) and runs the initialization program</li>
<li>Init program start the service such as web server, graphical interface, networking, etc.</li>
</ol>
<p>As we discussed in the previous section (101.1), the Firmware on the motherboard can be BIOS or UEFI. </p>
<h3>BIOS</h3>
<p>Basic Input Output System</p>
<ul>
<li>Older</li>
<li>Limited to one sector of the disk and needs a multi-stage bootloader</li>
<li>Can start the bootloader from internal/external HDD, CD/DVD, USB Flash drive, Network server</li>
<li>If booting from the HDD, the Master Boot Record will be used (1 sector)</li>
</ul>
<h3>UEFI</h3>
<p>Unified Extensible Firmware Interface. </p>
<ul>
<li>Modern and fancy</li>
<li>Specifies a special disk partition for the bootloader. Called EFI System Partition (ESP)</li>
<li>ESP is FAT and mounted on <code>/boot/efi</code> and bootloader files has <code>.efi</code> extensions</li>
</ul>
<blockquote>
<p>You can check <code>/sys/firmware/efi</code> to see if you are using a UEFI system or not</p>
</blockquote>
<h3>Bootloader</h3>
<p>Bootloader initializes the minimum hardware needed to boot the system. then, it locates and runs the OS.</p>
<p>Technically you can point your UEFI to run anything you want but typically under GNU/Linux systems, we use GRUB. GRUB can be used to run any specific program you need but it generally runs the OS. </p>
<h3>Kernel</h3>
<p>The Kernel is the core of your operating system. it basically is LINUX itself. Your bootloader loads the kernel in the memory and runs it. But the kernel needs some initial info to start; Things like drivers which are necessary to work with the hardware. Those are stored in <code>initrd</code> or <code>initramfs</code> alongside the kernel and used during the boot. </p>
<p>You can also send parameters to the kernel during the boot using the Grub configs. For example, sending a 1 or S will result the system booting in single-user mode (recovery). Or you can force your graphics to work in 1024×768x24 mode by passing <code>vga=792</code> to the Kernel during the boot. </p>
<hr>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Sn20NKM0hbw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h4>dmesg</h4>
<p>Linux will show you the boot process logs during the boot. Some desktop systems hide this behind a fancy splash screen which you can hide using the <code>Esc</code> key or press <code>Ctrl+Alt+F1</code>.</p>
<p>due to several reasons which are beyond the scope of this course, the kernel saves it's own logs into the "Kernel Ring Buffer". after the compilation of the boot process, the syslog daemon collects the <em>boot logs</em> and stores them in <code>/var/log/dmesg</code>.</p>
<p>to view all the logs including what has been logged after the boot process we use the <code>dmesg</code> command.</p>
<p>We can also use <code>journalctl -k</code> to check Kernel logs or use <code>journalctl -b</code> to check for boot logs (or even use <code>journalctl -u kernel</code> to see all previous logs too).</p>
<p>In addition to these, most systems keep the boot logs in a text-like file too and they can be found in <code>/var/log/boot</code> or <code>/var/log/boot.log</code> in Debian or Red-Hat based systems, respectively.</p>
<h4>/var/log/messages</h4>
<p>After the init process comes up, syslog daemon will log messages. It has timestamps and will persist during restarts.</p>
<ul>
<li>The Kernel is still logging its messages in Kernel Buffer Ring</li>
<li>in some systems, it might be called <code>/var/log/syslog</code></li>
<li>there are many other logs at <code>/var/log</code></li>
</ul>
<h2>init</h2>
<p>When the Kernel initialization is finished, its time to start other programs. To do so, the Kernel runs the Initialization Daemon process, and it takes care of starting other daemons, services, subsystems and programs. Using the init system one can say "I need service A and then service B. Then I need C and D and E but do not start D unless the A and B are running". The system admin can use the init system to stop and start the services later.</p>
<p>There are different init systems:</p>
<ul>
<li><strong>SysVinit</strong> is based on Unix System V. Not being used much anymore but people loved it because it followed Unix philosophies. you may see it on older machines or even on recently installed ones.</li>
<li><strong>upstart</strong> was an event-based replacement for the traditional init daemon developed by Canonical (The people behind Ubuntu). The goal of the project was to build a replacement for SysV when it got released in 2007. eventually, the project got discontinued due to the wide adoption of Systemd. Even Ubuntu uses Systemd these days, but upstart still can be found in google's ChromeOS.</li>
<li><strong>Systemd</strong> is the new replacement. It is hated by Linux elitists for not following Unix principles but it's widely adopted by major distros. It can start services in parallel and do lots of fancy stuff! </li>
</ul>
<p>The init process had the ID of 1 and you can find it by running the </p>
<div class="highlight"><pre><span></span><code># which init
/sbin/init
# readlink -f /sbin/init
/usr/lib/systemd/systemd
# ps -p 1
PID TTY TIME     CMD
1   ?   00:00:06 systemd
</code></pre></div>

<p>You can check the hierarchy of processes using the <code>pstree</code> command.</p>
<div class="highlight"><pre><span></span><code>pstree
</code></pre></div>

<h2>systemd</h2>
<p>Is new, loved, and hated. Lots of new ideas but not following some of the beloved UNIX principles (say.. not saving logs in a text file or trying to help you too much but asking for the root password when you are not running commands with sudo). It lets us run services if the hardware is connected, in time intervals, if another service is started, and ...</p>
<p>The systemd is made around <strong>units</strong>. A unit can be a service, group of services, or an action. Units do have a name, a type, and a configuration file. There are 12 unit types: automount, device, mount, path, scope, service, slice, snapshot, socket, swap, target &amp; timer.</p>
<p>We use <code>systemctl</code> to work with these units and <code>journalctl</code> to see the logs.</p>
<div class="highlight"><pre><span></span><code># systemctl list-units
# systemctl list-units --type=target
# systemctl get-default # default target (groups of services are started via target unit files)
</code></pre></div>

<p>The units can be found in these places (sorted by priority):</p>
<ol>
<li><code>/etc/systemd/system/</code></li>
<li><code>/run/systemd/system/</code></li>
<li><code>/usr/lib/systemd/system</code></li>
</ol>
<div class="highlight"><pre><span></span><code># systemctl list-unit-files
# systemctl cat ntpd.service
# systemctl cat graphical.target
</code></pre></div>

<p>We can use these commands to work with services:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># systemctl stop sshd</span>
<span class="c1"># systemctl start sshd</span>
<span class="c1"># systemctl status sshd</span>
<span class="c1"># systemctl is-active sshd</span>
<span class="c1"># systemctl is-failed sshd</span>
<span class="c1"># systemctl restart sshd</span>
<span class="c1"># systemctl reload sshd # re-reads the configuration of the service configs</span>
<span class="c1"># systemctl daemon-reload sshd # re-reads the configuration of the systemd configs of this service</span>
<span class="c1"># systemctl enable sshd</span>
<span class="c1"># systemctl disable sshd</span>
</code></pre></div>

<p>there are other commands too:</p>
<div class="highlight"><pre><span></span><code># systemctl is-system-running # running, degraded, maintenance, initializing, starting, stopping
# systemctl --failed
</code></pre></div>

<p>to check the logs, we have to use the <code>journalctl</code> utility:</p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span>#<span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">journal</span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">--</span><span class="nv">no</span><span class="o">-</span><span class="nv">pager</span><span class="w"> </span>#<span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">less</span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">n</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span>#<span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nv">lines</span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">S</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nv">d</span><span class="w"> </span>#<span class="w"> </span><span class="nv">last</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">day</span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">xe</span><span class="w"> </span>#<span class="w"> </span><span class="nv">last</span><span class="w"> </span><span class="nv">few</span><span class="w"> </span><span class="nv">logs</span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="o">-</span><span class="nv">u</span><span class="w"> </span><span class="nv">ntp</span><span class="w"> </span>#<span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">ntp</span><span class="w"> </span><span class="nv">unit</span>
#<span class="w"> </span><span class="nv">journalctl</span><span class="w"> </span><span class="nv">_PID</span><span class="o">=</span><span class="mi">1234</span>
</code></pre></div>

<h2>SysV</h2>
<p>Is the older init system. Still can be used on many systems. The control files are located at <code>/etc/init.d/</code> and are closer to the general bash scripts. In many cases you can call like:</p>
<div class="highlight"><pre><span></span><code>/etc/init.d/ntpd status
/etc/init.d/ntpd stop
/etc/init.d/ntpd start
/etc/init.d/ntpd restart
</code></pre></div>

<p>We will speak more about runlevels on 101.3.</p>
                                            <br clear="both" />
                                            <h1>101.3 Change runlevels / boot targets and shutdown or reboot the system</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Description: Candidates should be able to manage the SysVinit runlevel or systemd boot target of the system. This objective includes changing to single-user mode, and shutdown or rebooting the system. Candidates should be able to alert users before switching runlevels / boot targets and properly terminate processes. This objective also includes setting the default SysVinit runlevel or systemd boot target. It also includes awareness of Upstart as an alternative to SysVinit or systemd.</p>
<h2>Key Knowledge Areas:</h2>
<ul>
<li>Set the default runlevel or boot target.</li>
<li>Change between runlevels / boot targets including single-user mode.</li>
<li>Shutdown and reboot from the command line.</li>
<li>Alert users before switching runlevels / boot targets or other major system events.</li>
<li>Properly terminate processes.</li>
<li>Awareness of acpi.</li>
</ul>
<h2>The following is a partial list of the used files, terms and utilities:</h2>
<ul>
<li><code>/etc/inittab</code></li>
<li>shutdown</li>
<li>init</li>
<li><code>/etc/init.d/</code></li>
<li>telinit</li>
<li>systemd</li>
<li>systemctl</li>
<li><code>/etc/systemd/</code></li>
<li><code>/usr/lib/systemd/</code></li>
<li>wall</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/1mOKv5LsPsw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>runlevels</h2>
<p>Runlevels define what tasks can be accomplished in the current state (or runlevel) of a Linux system. Think of it as different stages of <em>being alive</em>.</p>
<h3>systemd</h3>
<p>On systemd, we have different targets which are groups of services:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># systemctl list-units --type=target # On a Debian machine</span>
<span class="w">  </span><span class="n">UNIT</span><span class="w">                </span><span class="n">LOAD</span><span class="w">   </span><span class="n">ACTIVE</span><span class="w"> </span><span class="n">SUB</span><span class="w">    </span><span class="n">DESCRIPTION</span>
<span class="o">---------------------------------------------------------</span>
<span class="w">  </span><span class="n">basic</span><span class="o">.</span><span class="n">target</span><span class="w">        </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Basic</span><span class="w"> </span><span class="n">System</span>
<span class="w">  </span><span class="n">cryptsetup</span><span class="o">.</span><span class="n">target</span><span class="w">   </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="n">Encrypted</span><span class="w"> </span><span class="n">Volumes</span>
<span class="w">  </span><span class="n">getty</span><span class="o">.</span><span class="n">target</span><span class="w">        </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Login</span><span class="w"> </span><span class="n">Prompts</span>
<span class="w">  </span><span class="n">graphical</span><span class="o">.</span><span class="n">target</span><span class="w">    </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Graphical</span><span class="w"> </span><span class="n">Interface</span>
<span class="w">  </span><span class="n">local</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">pre</span><span class="o">.</span><span class="n">target</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">Systems</span><span class="w"> </span><span class="p">(</span><span class="n">Pre</span><span class="p">)</span>
<span class="w">  </span><span class="n">local</span><span class="o">-</span><span class="n">fs</span><span class="o">.</span><span class="n">target</span><span class="w">     </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">Systems</span>
<span class="w">  </span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span><span class="w">   </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Multi</span><span class="o">-</span><span class="n">User</span><span class="w"> </span><span class="n">System</span>
<span class="w">  </span><span class="n">network</span><span class="o">.</span><span class="n">target</span><span class="w">      </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Network</span>
<span class="w">  </span><span class="n">paths</span><span class="o">.</span><span class="n">target</span><span class="w">        </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Paths</span>
<span class="w">  </span><span class="k">remote</span><span class="o">-</span><span class="n">fs</span><span class="o">.</span><span class="n">target</span><span class="w">    </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Remote</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">Systems</span>
<span class="w">  </span><span class="n">slices</span><span class="o">.</span><span class="n">target</span><span class="w">       </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Slices</span>
<span class="w">  </span><span class="n">sockets</span><span class="o">.</span><span class="n">target</span><span class="w">      </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Sockets</span>
<span class="w">  </span><span class="n">sound</span><span class="o">.</span><span class="n">target</span><span class="w">        </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Sound</span><span class="w"> </span><span class="n">Card</span>
<span class="w">  </span><span class="n">swap</span><span class="o">.</span><span class="n">target</span><span class="w">         </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Swap</span>
<span class="w">  </span><span class="n">sysinit</span><span class="o">.</span><span class="n">target</span><span class="w">      </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="n">Initialization</span>
<span class="w">  </span><span class="n">time</span><span class="o">-</span><span class="n">set</span><span class="o">.</span><span class="n">target</span><span class="w">     </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">Set</span>
<span class="w">  </span><span class="n">time</span><span class="o">-</span><span class="n">sync</span><span class="o">.</span><span class="n">target</span><span class="w">    </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">Synchronized</span>
<span class="w">  </span><span class="n">timers</span><span class="o">.</span><span class="n">target</span><span class="w">       </span><span class="n">loaded</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">Timers</span>
</code></pre></div>

<p>And we can check the default one or get the status of each of them: </p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># systemctl get-default </span>
<span class="n">graphical</span><span class="o">.</span><span class="n">target</span>

<span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># systemctl status multi-user.target </span>
<span class="err">●</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Multi</span><span class="o">-</span><span class="n">User</span><span class="w"> </span><span class="n">System</span>
<span class="w">     </span><span class="n">Loaded</span><span class="p">:</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span><span class="p">;</span><span class="w"> </span><span class="k">static</span><span class="p">)</span>
<span class="w">     </span><span class="n">Active</span><span class="p">:</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">Sat</span><span class="w"> </span><span class="mi">2022</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">07</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">36</span><span class="w"> </span><span class="n">EDT</span><span class="p">;</span><span class="w"> </span><span class="mi">4</span><span class="n">h</span><span class="w"> </span><span class="mi">24</span><span class="nb">min</span><span class="w"> </span><span class="n">left</span>
<span class="w">       </span><span class="n">Docs</span><span class="p">:</span><span class="w"> </span><span class="n">man</span><span class="p">:</span><span class="n">systemd</span><span class="o">.</span><span class="n">special</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</code></pre></div>

<p>It is also possible to <em>isolate</em> any of the targets or move to two special targets too:</p>
<ol>
<li><code>rescue</code>: Local file systems are mounted, no networking, and root-user only (<em>maintenance</em> mode)</li>
<li><code>emergency</code>: Only the root file system and in read-only mode, No networking and root-user only(<em>maintenance</em> mode)</li>
<li><code>reboot</code></li>
<li><code>halt</code>: Stops all processes and halts CPU activities</li>
<li><code>poweroff</code>: Like halt but also sends an ACPI shutdown signal (No lights!)</li>
</ol>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">systemctl</span><span class="w"> </span><span class="nv">isolate</span><span class="w"> </span><span class="nv">emergency</span>
<span class="nv">Welcome</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">emergency</span><span class="w"> </span><span class="nv">mode</span><span class="o">!</span><span class="w"> </span><span class="nv">After</span><span class="w"> </span><span class="nv">logging</span><span class="w"> </span><span class="nv">in</span>,<span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="s2">&quot;journalctl -xb&quot;</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="nv">logs</span>,<span class="w"> </span><span class="s2">&quot;systemctl reboot&quot;</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">reboot</span>,<span class="w"> </span><span class="s2">&quot;systemctl default&quot;</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="o">^</span><span class="nv">D</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">try</span><span class="w"> </span><span class="nv">again</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">boot</span><span class="w"> </span><span class="nv">into</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">mode</span>.
<span class="nv">Give</span><span class="w"> </span><span class="nv">root</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">maintenance</span>
<span class="ss">(</span><span class="nv">or</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="nv">Control</span><span class="o">-</span><span class="nv">D</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="k">continue</span><span class="ss">)</span>:
#
#<span class="w"> </span><span class="nv">systemctl</span><span class="w"> </span><span class="nv">is</span><span class="o">-</span><span class="nv">system</span><span class="o">-</span><span class="nv">running</span>
<span class="nv">maintenance</span>
</code></pre></div>

<h3>SysV runlevels</h3>
<p>On SysV we were able to define different stages. On a Red Hat-based system we usually had 7:</p>
<ul>
<li>0- Shutdown</li>
<li>1- Single-user mode (recovery); Also called S or s</li>
<li>2- Multi-user without networking</li>
<li>3- Multi-user with networking</li>
<li>4- to be customized by the admin</li>
<li>5- Multi-user with networking and graphics</li>
<li>6- Reboot</li>
</ul>
<p>And in Debian based system we had:</p>
<ul>
<li>0- Shutdown</li>
<li>1- Single-user mode</li>
<li>2- Multi-user mode with graphics</li>
<li>6- Reboot</li>
</ul>
<h2>Checking status and setting defaults</h2>
<p>You can check your current runlevel with <code>runlevel</code> command. It comes from SysV era but still works on systemd systems. 
The default was in <code>/etc/inittab</code> </p>
<div class="highlight"><pre><span></span><code>grep &quot;^id:&quot; /etc/inittab #on initV systems
id:5:initdefault:
</code></pre></div>

<p>It can also be done on grub kernel parameters.</p>
<p>Or using the runlevel and <code>telinit</code> command.</p>
<div class="highlight"><pre><span></span><code># runlevel
N 3
# telinit 5
# runlevel
3 5
# init 0 # shutdown the system
</code></pre></div>

<p>You can find the files in <code>/etc/init.d</code> and runlevels in <code>/etc/rc[0-6].d</code> directories where S indicates Start and K indicates Kill. </p>
<p>On systemd, you can find the configs in:</p>
<ul>
<li><code>/etc/systemd</code></li>
<li><code>/usr/lib/systemd/</code></li>
</ul>
<p>As discussed in 101.2</p>
<h3>/etc/inittab</h3>
<p>Is being replaced by upstart and systemd but is still part of the exam.</p>
<div class="highlight"><pre><span></span><code>#
# inittab       This file describes how the INIT process should be set up
#               the system in a certain run-level.
#
# Author:       Miquel van Smoorenburg, &lt;miquels@drinkel.nl.mugnet.org&gt;
#               Modified for RHS Linux by Marc Ewing and Donnie Barnes
#

# Default runlevel. The runlevels used by RHS are:
#   0 - halt (Do NOT set initdefault to this)
#   1 - Single-user mode
#   2 - Multiuser, without NFS (The same as 3, if you do not have networking)
#   3 - Full multiuser mode
#   4 - unused
#   5 - X11
#   6 - reboot (Do NOT set initdefault to this)
#
id:5:initdefault:

# System initialization.
si::sysinit:/etc/rc.d/rc.sysinit

l0:0:wait:/etc/rc.d/rc 0
l1:1:wait:/etc/rc.d/rc 1
l2:2:wait:/etc/rc.d/rc 2
l3:3:wait:/etc/rc.d/rc 3
l4:4:wait:/etc/rc.d/rc 4
l5:5:wait:/etc/rc.d/rc 5
l6:6:wait:/etc/rc.d/rc 6

# Trap CTRL-ALT-DELETE
ca::ctrlaltdel:/sbin/shutdown -t3 -r now

# When our UPS tells us power has failed, assume we have a few minutes
# of power left.  Schedule a shutdown for 2 minutes from now.
# This does, of course, assume you have powered installed and your
# UPS connected and working correctly.
pf::powerfail:/sbin/shutdown -f -h +2 &quot;Power Failure; System Shutting Down&quot;

# If power was restored before the shutdown kicked in, cancel it.
pr:12345:powerokwait:/sbin/shutdown -c &quot;Power Restored; Shutdown Cancelled&quot;


# Run gettys in standard runlevels
1:2345:respawn:/sbin/mingetty tty1
2:2345:respawn:/sbin/mingetty tty2
3:2345:respawn:/sbin/mingetty tty3
4:2345:respawn:/sbin/mingetty tty4
5:2345:respawn:/sbin/mingetty tty5
6:2345:respawn:/sbin/mingetty tty6

# Run xdm in runlevel 5
x:5:respawn:/etc/X11/prefdm -nodaemon
</code></pre></div>

<p>This is the format:</p>
<div class="highlight"><pre><span></span><code>id:runlevels:action:process
</code></pre></div>

<ul>
<li>id: 2 or 3 chars</li>
<li>runlevels: Which runlevel this commands refers to (empty means all)</li>
<li>action: Respawn, wait, once, initdefault (default run level as seen above), ctrlaltdel (What to do with Ctrl+Alt+Delete)</li>
</ul>
<p>All scripts are here:</p>
<div class="highlight"><pre><span></span><code>ls -ltrh /etc/init.d
</code></pre></div>

<p>And start/stop on runlevels are controlled from these directories:</p>
<div class="highlight"><pre><span></span><code>root@funlife:~# ls /etc/rc2.d/
</code></pre></div>

<h2>Stopping the system</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/C7kr7fZtWqs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>The preferred method to shut down or reboot the system is to use the <code>shutdown</code> command, which first sends a warning message to all logged-in users and blocks any further non-root logins. It then signals init to switch runlevels. The init process then sends all running processes a SIGTERM signal, giving them a chance to save data or otherwise properly terminate. After 1 minute or another delay, if specified, init sends a SIGKILL signal to forcibly end each remaining process.</p>
<ul>
<li>Default is a 1-minute delay and then going to runlevel 1</li>
<li><code>-h</code> will halt the system</li>
<li><code>-r</code> will reboot the system</li>
<li>Time is <code>hh:mm</code> or n (minutes) or now</li>
<li>Whatever you add, will be broadcasted to logged-in users using the <code>wall</code> command</li>
<li>If the command is running, ctrl+c or the <code>shutdown -c</code> will cancel it</li>
</ul>
<div class="highlight"><pre><span></span><code>shutdown -r 60 Reloading updated kernel
</code></pre></div>

<p>for more advanced users:</p>
<ul>
<li>-t60 will delay 60 seconds between SIGTERM and SIGKILL</li>
<li>if you cancel a shutdown, users will get the news</li>
</ul>
<h3>Halt, reboot, and poweroff</h3>
<ul>
<li>The <code>halt</code> command halts the system.</li>
<li>The <code>poweroff</code> command halts the system and then attempts to power it off.</li>
<li>The <code>reboot</code> command halts the system and then reboots it.</li>
</ul>
<blockquote>
<p>On most distros, these are symbolic links to the systemctl utility</p>
</blockquote>
<h3>Advanced Configuration and Power Interface (ACPI)</h3>
<p>ACPI provides an open standard that operating systems can use to discover and configure computer hardware components, perform power management (e.g. putting unused hardware components to sleep), perform auto-configuration (e.g. Plug and Play, and hot-swapping), and perform status monitoring.</p>
<p>This subsystem lets OS commands (like shutdown) send signals to the computer which results in powering down of the whole PC. In older times we used to have these mechanical keyboards to do a <em>real</em> power down after the OS has done its shutdown and told us that "it is not safe to power down your computer".</p>
<p><img alt="Vintage poweroff" src="/images/vintage_poweroff.jpeg"></p>
<h2>Notifying users</h2>
<p>It is good to be informed! Especially if the system is going down; Especially on a shared server. Linux has different tools for system admins to notify their users:</p>
<ul>
<li><code>wall</code>: Sending <em>wall messages</em> to logged-in users</li>
<li><code>/etc/issue</code>: Text to be displayed on the tty terminal logins (before login)</li>
<li><code>/etc/issue.net</code>: Text to be displayed on the remote terminal logins (before login)</li>
<li><code>/etc/motd</code>: Message of the day (after login). Some companies add "Do not enter if you are not allowed" texts here for legal reasons.</li>
<li><code>mesg</code>: Command controls if you want to get wall messages or not. You can do <code>mesg n</code> and <code>who -T</code> will show mesg status. Note that <code>shutdown</code> wall messages do not respect the <code>mesg</code> status</li>
</ul>
<blockquote>
<p>systemctl sends wall messages for emergency, halt, power-off, reboot, and rescue</p>
</blockquote>
                                            <br clear="both" />
                                            <h1>102.1 Design hard disk layout</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Description: Candidates should be able to design a disk partitioning scheme for a Linux system.</p>
<h2>Key Knowledge Areas</h2>
<ul>
<li>Allocate filesystems and swap space to separate partitions or disks</li>
<li>Tailor the design to the intended use of the system</li>
<li>Ensure the <code>/boot</code> partition conforms to the hardware architecture requirements for booting</li>
<li>Knowledge of basic features of LVM</li>
</ul>
<p>The following is a partial list of the used files, terms, and utilities:</p>
<ul>
<li><code>/</code> (root) filesystem</li>
<li><code>/var</code> filesystem</li>
<li><code>/home</code> filesystem</li>
<li><code>/boot</code> filesystem</li>
<li>EFI System Partition (ESP)</li>
<li>Swap space</li>
<li>Mount points</li>
<li>Partitions</li>
</ul>
<h2>Basics</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/AGu0ulELDzE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Like any contemporary OS, Linux uses <em>files</em> and <em>directories</em> to operate. But unlike <em>Windows</em>, it does not use A:, C:, D:, etc. In Linux, everything is in <em>*one big tree</em>, starting with <code>/</code> (called root). Any partition, disk, CD, USB, network drive, ... will be placed somewhere in this huge tree.</p>
<blockquote>
<p>Note: Most of external devices (USB, CD, ...) are mounted at <code>/media/</code> or <code>/mnt/</code> .</p>
</blockquote>
<h2>Unix directories</h2>
<p>This might be your enlightening moment in your Linux journey. Understanding <strong>Filesystem Hierarchy Standard (FHS)</strong> can help you find your programs, configs, logs and more without having prior knowledge about them. The table below has been the standard the latest revision since 2015.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Directory</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bin</td>
<td style="text-align: left;">Essential command binaries</td>
</tr>
<tr>
<td style="text-align: left;">boot</td>
<td style="text-align: left;">Static files of the boot loader</td>
</tr>
<tr>
<td style="text-align: left;">dev</td>
<td style="text-align: left;">Device files</td>
</tr>
<tr>
<td style="text-align: left;">etc</td>
<td style="text-align: left;">Host-specific system configuration</td>
</tr>
<tr>
<td style="text-align: left;">home</td>
<td style="text-align: left;">Home directory of the users</td>
</tr>
<tr>
<td style="text-align: left;">lib</td>
<td style="text-align: left;">Essential shared libraries and kernel modules</td>
</tr>
<tr>
<td style="text-align: left;">media</td>
<td style="text-align: left;">Mount point for removable media</td>
</tr>
<tr>
<td style="text-align: left;">mnt</td>
<td style="text-align: left;">Mount point for mounting a filesystem temporarily</td>
</tr>
<tr>
<td style="text-align: left;">opt</td>
<td style="text-align: left;">Add-on application software packages</td>
</tr>
<tr>
<td style="text-align: left;">root</td>
<td style="text-align: left;">Home directory of the root user</td>
</tr>
<tr>
<td style="text-align: left;">sbin</td>
<td style="text-align: left;">Essential system binaries</td>
</tr>
<tr>
<td style="text-align: left;">srv</td>
<td style="text-align: left;">Data for services provided by this system</td>
</tr>
<tr>
<td style="text-align: left;">tmp</td>
<td style="text-align: left;">Temporary files, sometimes purged on each boot</td>
</tr>
<tr>
<td style="text-align: left;">usr</td>
<td style="text-align: left;">Secondary hierarchy</td>
</tr>
<tr>
<td style="text-align: left;">var</td>
<td style="text-align: left;">Variable data (logs, ...)</td>
</tr>
</tbody>
</table>
<h2>Partitions</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/WHsjpzCYXo8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>In the Linux world, devices are defined at <code>/dev/</code> and for different types of disks, there are different naming conventions:
- PATA (Obsolete): <code>/dev/hdc</code>
- SATA (Serial ATA) &amp; SCSI disks: <code>/dev/sda</code>
- SD/emmc &amp; bare NAND/NOR devices: <code>/dev/mmcblk0</code> &amp; their partitions are available as: <code>/dev/mmcblk0p0</code>
- NVME drives: <code>/dev/nvme0</code> &amp; their partitions are available as: <code>/dev/nvme0n1</code></p>
<p>You have to <em>PARTITION</em> the disks, that is to create smaller parts on a big disk. These are self-contained sections on the main drive. OS sees these as standalone disks.  We recognize them as:
- /dev/sd<strong>a</strong>1 (first partition of the first SCSI disk) 
- /dev/hd<strong>b</strong>3 (3rd partition on the second disk)</p>
<p>BIOS systems were using MBR and could have up to 4 partitions on each disk, although instead of creating 4 Primary partitions, you could create an Extended partition and define more Logical partitions inside it.  </p>
<blockquote>
<p>Note: an Extended partition is just an empty box for creating Logical partitions inside it.</p>
</blockquote>
<p>So:</p>
<ul>
<li><code>/dev/sda3</code> is the 3rd primary partition on the first disk</li>
<li><code>/dev/sdb5</code> is the first logical partition on the second disk</li>
<li><code>/dev/sda7</code> is the 3rd logical partition of the first physical disk</li>
</ul>
<p>UEFI systems use GUID Partition Table (GPT) which supports 128 partitions on each device.</p>
<blockquote>
<p>If you define an extended partition on a BIOS system, that will be <code>/dev/sdx5</code> (1-4 for primary, and the first extended will be 5). </p>
</blockquote>
<p>Linux systems can <strong>mount</strong> these partitions on different paths. Say you can have a separated disk with one huge partition for your <code>/home</code> and another one for your <code>/var/logs/</code>.</p>
<div class="highlight"><pre><span></span><code># fdisk /dev/sda
Welcome to fdisk (util-linux 2.25.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.


Command (m for help): p
Disk /dev/sda: 298.1 GiB, 320072933376 bytes, 625142448 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x000beca1

Device     Boot     Start       End   Sectors   Size Id Type
/dev/sda1  *         2048  43094015  43091968  20.6G 83 Linux
/dev/sda2        43094016  92078390  48984375  23.4G 83 Linux
/dev/sda3        92080126 625141759 533061634 254.2G  5 Extended
/dev/sda5        92080128 107702271  15622144   7.5G 82 Linux swap / Solaris
/dev/sda6       107704320 625141759 517437440 246.8G 83 Linux
</code></pre></div>

<p>The newer <strong>GUID Partition Table (or GPT)</strong> solves these problems. If you format your disk with GPT you can have 128 primary partitions (no need for extended and logical).</p>
<h2>Commands</h2>
<h3>parted</h3>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ sudo parted /dev/sda p
Model: ATA ST320LT000-9VL14 (scsi)
Disk /dev/sda: 320GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos
Disk Flags:

Number  Start   End     Size    Type      File system     Flags
 1      1049kB  22.1GB  22.1GB  primary   ext4            boot
 2      22.1GB  47.1GB  25.1GB  primary   ext4
 3      47.1GB  320GB   273GB   extended
 5      47.1GB  55.1GB  7999MB  logical   linux-swap(v1)
 6      55.1GB  320GB   265GB   logical
</code></pre></div>

<p><strong>fdisk</strong></p>
<div class="highlight"><pre><span></span><code># sudo fdisk /dev/sda
[sudo] password for jadi:

Welcome to fdisk (util-linux 2.25.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.


Command (m for help): p
Disk /dev/sda: 298.1 GiB, 320072933376 bytes, 625142448 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x000beca1

Device     Boot     Start       End   Sectors   Size Id Type
/dev/sda1  *         2048  43094015  43091968  20.6G 83 Linux
/dev/sda2        43094016  92078390  48984375  23.4G 83 Linux
/dev/sda3        92080126 625141759 533061634 254.2G  5 Extended
/dev/sda5        92080128 107702271  15622144   7.5G 82 Linux swap / Solaris
/dev/sda6       107704320 625141759 517437440 246.8G 83 Linux
</code></pre></div>

<blockquote>
<p>Note: parted does not understands GPT</p>
</blockquote>
<p><strong>gparted</strong></p>
<p>A graphical tool for managing disks and partitions.</p>
<p><img alt="gparted" src="/images/gparted.png"></p>
<h3>LVM</h3>
<p>In many cases, you need to resize your partitions or even install new disks and <em>add</em> them to your current mount points; Increasing the total size. LVM is designed for this.</p>
<p>LVM helps you create one partition from different disks and add or remove space from/to them. The main concepts are:</p>
<ul>
<li>Physical Volume (PV): A whole drive or a partition. It is better to define partitions and <strong>not use whole disks - unpartitioned</strong>.</li>
<li>Volume Groups (VG): This is the collection of one or more <strong>PV</strong>s. OS will see the vg as one big disk. PVs in one VG, can have different sizes or even be on different physical disks.</li>
<li>Logical Volumes (LV): OS will see lvs as partitions. You can format an LV with your OS and use it.</li>
</ul>
<h2>Design Hard disk layout</h2>
<p>Disk layout and allocation partitions to directories depend on your usage. First, we will discuss <em>swap</em> and <em>boot</em> and then will see three different cases.</p>
<p><strong>swap</strong></p>
<p>Swap in Linux works like an extended memory. The Kernel will <em>page</em> memory to this partition/file. It is enough to format one partition with <strong>swap file system</strong> and define it in <code>/etc/fstab</code> (you will see this later in 104 modules).</p>
<blockquote>
<p>Note: There is no strict formula for swap size. People used to say "double the ram but not more than 8GB". On recent machines with SSDs, some say "RAM + 2" (Hibernation + some extra ) or "RAM * 2" depending on your usage.</p>
</blockquote>
<p><strong>/boot</strong></p>
<p>Older Linux systems were not able to handle HUGE disks during boot (say Terabytes) so the <code>/boot</code> partition was separated. this separation comes in handy in situations such as  recovering broken systems. you can even make <code>/boot</code> read-only. Most of the time, having 100MB for <code>/boot</code> is enough. This partition can be on a different disk or a separated partition.</p>
<p>This partition should be accessible by BIOS/UEFI during boot (No network drive).</p>
<p>On UEFI systems, there is a <code>/boot/efi</code> mount point called EFI (Extensible Firmware Interface) system partition or ESP. This contains the bootloader and kernel and should be accessible by the UEFI firmware during boot.</p>
<h3>Case one: Desktop computer</h3>
<p>On a desktop computer, it is good to have one swap, one <code>/boot</code>, and allocate all other space to <code>/</code> (root).</p>
<h3>Case two: Network workstation</h3>
<p>As any other system <code>/boot</code> should be local (a physical disk is connected to the machine) and most of the time, the <code>/</code> (root file system) is also local. But in a network station, <code>/home</code> can be mounted from a network drive (NFS, SMB, SSH, ..). This lets users sit at any station, login, and have their own home mounted from a network drive. Swap can be mounted from network or local.</p>
<h3>Case three: Server</h3>
<p>On servers <code>/boot</code> is still local and based on usage, <code>/home</code> can be local or network. In many cases, we separate the <code>/var</code> because logs and many other files are there and being updated so it is good to separate it or even put it on more advanced storage (like RAID disks to prevent data loss). Some people also separate the <code>/usr</code> and write-protect it (read-only file systems) or even mount the <code>/usr</code> from the network so they can change/update one file on the network storage and all the servers will use the new file (You remember? <code>/usr</code> contains important executables like Apache webserver).</p>
<h2>Bonus! know about zram</h2>
<p>Here I'll review the 3 different methods to add a <em>swap</em> to your OS. We will have a look at 3 different distros:</p>
<ul>
<li>Debian 11: Uses a swap partition</li>
<li>Ubuntu 22.04: Uses a swap file</li>
<li>Fedora 36: uses <code>zram</code>
In short, <code>zram</code> is a virtual disk on your RAM which can be used as swap space or be mounted anywhere you like; A common example is <code>\tmp</code>. Let's see.</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Y6aceqC0p0Q" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                            <br clear="both" />
                                            <h1>102.2 Install a boot manager</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em> </p>
<p>Description: Candidates should be able to select, install and configure a boot manager.</p>
<h2>Objectives</h2>
<ul>
<li>Providing alternative boot locations and backup boot options.</li>
<li>Install and configure a boot loader such as GRUB Legacy.</li>
<li>Perform basic configuration changes for GRUB 2.</li>
<li>Interact with the boot loader</li>
</ul>
<h2>Terms and Utilities</h2>
<ul>
<li><code>menu.lst</code>, <code>grub.cfg</code> and <code>grub.conf</code></li>
<li>grub-install</li>
<li>grub-mkconfig</li>
<li>MBR</li>
</ul>
<h2>Boot overview</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/G_FzcMZYDbg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Most systems use BIOS or UEFI. When on BIOS, the system will do a self test called POST (Power-On Self-Test). Then it will hand over the boot process to the first sector of Master Boot Record (MBR) which is track (Cylinder) 0, side (Head) 0 and Sector 1 of the first disk. </p>
<p>MBR is only 512 bytes so we need a <em>smart bootloader</em> to handle larger boot managers and even multiple systems. Some of these boot loaders are LILO, GRUB and GRUB2.</p>
<p>If the system is using UEFI, the hardware will follow the UEFI stages. They start with a security phase and will continue till the end phase where the UEFI looks for an EFI System Partition, which is just a FAT32 partition (Usually the first one, but that's implementation-defined) with PE executables and runs them. </p>
<p>In both cases, the binary starts the boot loader. It might be a complete bootloader on <code>/boot/efi/</code> of your computer or a small loader for the main grub on the MBR or a windows loader or even a chainloader.</p>
<blockquote>
<p>Chain Loading is when a boot loader, loads another boot loader. This is done when a Linux bootloader needs to start a Windows system.</p>
</blockquote>
<h2>GRUB</h2>
<p><strong>GRUB</strong> (<strong>GR</strong>and <strong>U</strong>nified <strong>B</strong>ootloader) started to replace the older LILO. The first version (1) is called Grub Legacy and started in 1999. The 2nd version started in 2005 and is a complete rewrite of version 1.</p>
<p>It's a menu-based system where you can choose which Kernel or chainloader to boot. It is also possible to edit the menus on the fly or give direct commands from a command line.</p>
<h3>Grub Legacy</h3>
<p>Usually the GRUB v1 (actually 0.9) is installed in <code>/boot/grub</code>. Its main configuration is in <code>/boot/grub/menu.lst</code> but nowadays some distros (including RedHat Based ones) link this to the <code>/boot/grub/grub.conf</code>.</p>
<p>A sample <code>menu.lst</code> / <code>grub.conf</code> file for GRUB legacy consists of two sections. The first section contains global configs and the 2nd part defines different kernel/initram or chainloader options.</p>
<p>The global configs are:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Config</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">#</td>
<td style="text-align: left;">Comment</td>
</tr>
<tr>
<td style="text-align: left;">color</td>
<td style="text-align: left;">Foreground and background colors for normal and active items</td>
</tr>
<tr>
<td style="text-align: left;">default</td>
<td style="text-align: left;">Which boot menu item is the default</td>
</tr>
<tr>
<td style="text-align: left;">fallback</td>
<td style="text-align: left;">Which boot menu should be used if the <em>default</em> fails</td>
</tr>
<tr>
<td style="text-align: left;">hiddenmenu</td>
<td style="text-align: left;">Hide the menu options</td>
</tr>
<tr>
<td style="text-align: left;">splashimage</td>
<td style="text-align: left;">Show this image in the background!</td>
</tr>
<tr>
<td style="text-align: left;">timeout</td>
<td style="text-align: left;">Wait this much and then start the default</td>
</tr>
<tr>
<td style="text-align: left;">password</td>
<td style="text-align: left;">Security is important! Will ask this password</td>
</tr>
<tr>
<td style="text-align: left;">savedefault</td>
<td style="text-align: left;">Remember the last booted item</td>
</tr>
</tbody>
</table>
<p>On the second part of the config, we have these:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Config</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">Defines the section name</td>
</tr>
<tr>
<td style="text-align: left;">root</td>
<td style="text-align: left;">Disk and partition where <code>/boot</code> directory is. In the form of (hddrive, partition), say (hd0, 0) or (hd0, msdos0)</td>
</tr>
<tr>
<td style="text-align: left;">kernel</td>
<td style="text-align: left;">Kernel image file name in <code>/boot</code></td>
</tr>
<tr>
<td style="text-align: left;">initrd</td>
<td style="text-align: left;">Initramfs file in <code>/boot</code></td>
</tr>
<tr>
<td style="text-align: left;">rootnoverify</td>
<td style="text-align: left;">Defines a non-Linux root partition</td>
</tr>
<tr>
<td style="text-align: left;">chainloader</td>
<td style="text-align: left;">Another file will act as stage 1 loader. Used for booting Windows systems</td>
</tr>
</tbody>
</table>
<p>Here you can see a sample of GRUB-Legacy config:</p>
<div class="highlight"><pre><span></span><code># grub.conf generated by anaconda
#
# Note that you do not have to rerun grub after making changes to this file
# NOTICE:  You do not have a /boot partition.  This means that
#          all kernel and initrd paths are relative to /, eg.
#          root (hd0,5)
#          kernel /boot/vmlinuz-version ro root=/dev/sda6
#          initrd /boot/initrd-version.img
#boot=/dev/sda6
default=1
timeout=10
splashimage=(hd0,5)/boot/grub/splash.xpm.gz
#hiddenmenu
password --md5 $1$RW1VW/$4XGAklxB7/GJk0uO47Srx1
title Upgrade to Fedora 11 (Leonidas)
    kernel /boot/upgrade/vmlinuz preupgrade \
      repo=hd::/var/cache/yum/preupgrade stage2=\
      hd:UUID=8b4c62e7-2022-4288-8995-5eda92cd149b:/boot/upgrade/install.img \
      ks=hd:UUID=8b4c62e7-2022-4288-8995-5eda92cd149b:/boot/upgrade/ks.cfg
    initrd /boot/upgrade/initrd.img
title Fedora (2.6.26.8-57.fc8)
    root (hd0,5)
    kernel /boot/vmlinuz-2.6.26.8-57.fc8 ro root=LABEL=FEDORA8 rhgb quiet
    initrd /boot/initrd-2.6.26.8-57.fc8.img
title Fedora (2.6.26.6-49.fc8)
    root (hd0,5)
    kernel /boot/vmlinuz-2.6.26.6-49.fc8 ro root=LABEL=FEDORA8 rhgb quiet
    initrd /boot/initrd-2.6.26.6-49.fc8.img
title GRUB Menu
    rootnoverify (hd0,1)
    chainloader +1
title Windows
    rootnoverify (hd0,0)
    chainloader +1
</code></pre></div>

<h4>GRUB (legacy) commands</h4>
<p>After creating the configuration, you need to install the grub on a disk MBR. To do this you can use two different formats:</p>
<div class="highlight"><pre><span></span><code># grub-install /dev/fd0
# grub-install &#39;(fd0)&#39;
</code></pre></div>

<p>Just like any other boot manager, you can install grub on a CD, floppy, MBR (<code>/dev/sda</code>, <code>/dev/sdb</code>, ..) or a partition (<code>/dev/sdb2</code>, <code>/dev/sda6</code>, ..). But if you want to install it on anywhere other than the MBR, use a chainloader to point your boot sequence toward it.</p>
<p>If you needed to change or reconfigure anything during the startup, just press the <code>e</code> on that item and you'll get an interactive editing environment. Press <strong>Enter</strong> when done and <code>b</code> for boot.</p>
<h4>Interacting with GRUB Legacy</h4>
<p>If you press <code>c</code> on the grub menu, you will go into the <em>GRUB Command Line</em> or <em>GRUB shell</em>. There you can type commands like <code>root</code> and <code>kernel</code> and <code>initrd</code> and boot the system with <code>boot</code> or press the <code>Esc</code> key to return back to the menu. </p>
<h3>GRUB2</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lB-1orohGA0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>This is the most common boot loader these days. On BIOS systems it is installed on <code>/boot/grub/</code> or <code>/boot/grub2/</code> and under UEFI it goes in <code>/boot/efi/EFI/distro-name/</code> (say <code>/boot/efi/EFI/fedora/</code>). GRUB2's configuration file is called <code>grub.cfg</code>.</p>
<p>Here is a simplified <code>grub.cfg</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">set</span><span class="w"> </span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>
<span class="n">menuentry</span><span class="w"> </span><span class="s2">&quot;Fedora&quot;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">root</span><span class="o">=</span><span class="p">(</span><span class="n">hd0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="n">linux</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">arm64</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="n">quiet</span>
<span class="w">  </span><span class="n">initrd</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">initrd</span><span class="o">.</span><span class="n">img</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">arm64</span>
<span class="p">}</span>
<span class="n">menuentry</span><span class="w"> </span><span class="s2">&quot;Windows&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">chainloader</span><span class="w"> </span><span class="p">(</span><span class="n">hd1</span><span class="p">,</span><span class="n">msdos2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="p">}</span>
</code></pre></div>

<p>As you can see, GRUB uses Linux-style numbering for partitions, so the first partition on the first hard disk is <code>(hd0,1)</code> or <code>(hd0,msdos1)</code> for DOS partitions or <code>(hd0,gpt1)</code> for GPT drives.</p>
<p>Here you can see some of the options:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Option</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">menuentry</td>
<td style="text-align: left;">Defines a new menuentry</td>
</tr>
<tr>
<td style="text-align: left;">set root</td>
<td style="text-align: left;">Defines the root where <code>/boot</code> located</td>
</tr>
<tr>
<td style="text-align: left;">linux, linux16</td>
<td style="text-align: left;">Defines the location of the Linux kernel on BIOS systems</td>
</tr>
<tr>
<td style="text-align: left;">linuxefi</td>
<td style="text-align: left;">Defines the Linux kernel on UEFI systems</td>
</tr>
<tr>
<td style="text-align: left;">initrd</td>
<td style="text-align: left;">Defines the initramfs image for BIOS systems</td>
</tr>
<tr>
<td style="text-align: left;">initrdefi</td>
<td style="text-align: left;">Defines the initramfs image for UEFI systems</td>
</tr>
</tbody>
</table>
<p>And here is a real-world <code>grub.cfg</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># DO NOT EDIT THIS FILE</span>
<span class="c1">#</span>
<span class="c1"># It is automatically generated by grub-mkconfig using templates</span>
<span class="c1"># from /etc/grub.d and settings from /etc/default/grub</span>
<span class="c1">#</span>

<span class="c1">### BEGIN /etc/grub.d/00_header ###</span>
<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">$</span><span class="n">prefix</span><span class="o">/</span><span class="n">grubenv</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">have_grubenv</span><span class="o">=</span><span class="bp">true</span>
<span class="w">  </span><span class="n">load_env</span>
<span class="n">fi</span>
<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;${next_entry}&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">then</span>
<span class="w">   </span><span class="n">set</span><span class="w"> </span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;${next_entry}&quot;</span>
<span class="w">   </span><span class="n">set</span><span class="w"> </span><span class="n">next_entry</span><span class="o">=</span>
<span class="w">   </span><span class="n">save_env</span><span class="w"> </span><span class="n">next_entry</span>
<span class="w">   </span><span class="n">set</span><span class="w"> </span><span class="n">boot_once</span><span class="o">=</span><span class="bp">true</span>
<span class="k">else</span>
<span class="w">   </span><span class="n">set</span><span class="w"> </span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>
<span class="n">fi</span>

<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="s2">&quot;${feature_menuentry_id}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">menuentry_id_option</span><span class="o">=</span><span class="s2">&quot;--id&quot;</span>
<span class="k">else</span>
<span class="w">  </span><span class="n">menuentry_id_option</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="n">fi</span>

<span class="k">export</span><span class="w"> </span><span class="n">menuentry_id_option</span>

<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;${prev_saved_entry}&quot;</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">saved_entry</span><span class="o">=</span><span class="s2">&quot;${prev_saved_entry}&quot;</span>
<span class="w">  </span><span class="n">save_env</span><span class="w"> </span><span class="n">saved_entry</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">prev_saved_entry</span><span class="o">=</span>
<span class="w">  </span><span class="n">save_env</span><span class="w"> </span><span class="n">prev_saved_entry</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">boot_once</span><span class="o">=</span><span class="bp">true</span>
<span class="n">fi</span>

<span class="n">function</span><span class="w"> </span><span class="n">savedefault</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="s2">&quot;${boot_once}&quot;</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">    </span><span class="n">saved_entry</span><span class="o">=</span><span class="s2">&quot;${chosen}&quot;</span>
<span class="w">    </span><span class="n">save_env</span><span class="w"> </span><span class="n">saved_entry</span>
<span class="w">  </span><span class="n">fi</span>
<span class="p">}</span>
<span class="n">function</span><span class="w"> </span><span class="n">load_video</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_all_video_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">all_video</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">efi_gop</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">efi_uga</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">ieee1275_fb</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">vbe</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">vga</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">video_bochs</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">video_cirrus</span>
<span class="w">  </span><span class="n">fi</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_default_font_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">then</span>
<span class="w">   </span><span class="n">font</span><span class="o">=</span><span class="n">unicode</span>
<span class="k">else</span>
<span class="n">insmod</span><span class="w"> </span><span class="n">part_gpt</span>
<span class="n">insmod</span><span class="w"> </span><span class="n">ext2</span>
<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_platform_search_hint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w">  </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="k">else</span>
<span class="w">  </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w"> </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="n">fi</span>
<span class="w">    </span><span class="n">font</span><span class="o">=</span><span class="s2">&quot;/usr/share/grub/unicode.pf2&quot;</span>
<span class="n">fi</span>

<span class="k">if</span><span class="w"> </span><span class="n">loadfont</span><span class="w"> </span><span class="o">$</span><span class="n">font</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">gfxmode</span><span class="o">=</span><span class="n">auto</span>
<span class="w">  </span><span class="n">load_video</span>
<span class="w">  </span><span class="n">insmod</span><span class="w"> </span><span class="n">gfxterm</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">locale_dir</span><span class="o">=$</span><span class="n">prefix</span><span class="o">/</span><span class="n">locale</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">lang</span><span class="o">=</span><span class="n">en_US</span>
<span class="w">  </span><span class="n">insmod</span><span class="w"> </span><span class="n">gettext</span>
<span class="n">fi</span>
<span class="n">terminal_output</span><span class="w"> </span><span class="n">gfxterm</span>
<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;${recordfail}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">30</span>
<span class="k">else</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_timeout_style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">then</span>
<span class="w">    </span><span class="n">set</span><span class="w"> </span><span class="n">timeout_style</span><span class="o">=</span><span class="n">menu</span>
<span class="w">    </span><span class="n">set</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span>
<span class="w">  </span><span class="c1"># Fallback normal timeout code in case the timeout_style feature is</span>
<span class="w">  </span><span class="c1"># unavailable.</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span><span class="n">set</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span>
<span class="w">  </span><span class="n">fi</span>
<span class="n">fi</span>
<span class="c1">### END /etc/grub.d/00_header ###</span>

<span class="c1">### BEGIN /etc/grub.d/05_debian_theme ###</span>
<span class="n">insmod</span><span class="w"> </span><span class="n">part_gpt</span>
<span class="n">insmod</span><span class="w"> </span><span class="n">ext2</span>
<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_platform_search_hint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w">  </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="k">else</span>
<span class="w">  </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w"> </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="n">fi</span>
<span class="n">insmod</span><span class="w"> </span><span class="n">png</span>
<span class="k">if</span><span class="w"> </span><span class="n">background_image</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">desktop</span><span class="o">-</span><span class="n">base</span><span class="o">/</span><span class="n">homeworld</span><span class="o">-</span><span class="n">theme</span><span class="o">/</span><span class="n">grub</span><span class="o">/</span><span class="n">grub</span><span class="o">-</span><span class="mi">4</span><span class="n">x3</span><span class="o">.</span><span class="n">png</span><span class="p">;</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">color_normal</span><span class="o">=</span><span class="n">white</span><span class="o">/</span><span class="n">black</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">color_highlight</span><span class="o">=</span><span class="n">black</span><span class="o">/</span><span class="n">white</span>
<span class="k">else</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">menu_color_normal</span><span class="o">=</span><span class="n">cyan</span><span class="o">/</span><span class="n">blue</span>
<span class="w">  </span><span class="n">set</span><span class="w"> </span><span class="n">menu_color_highlight</span><span class="o">=</span><span class="n">white</span><span class="o">/</span><span class="n">blue</span>
<span class="n">fi</span>
<span class="c1">### END /etc/grub.d/05_debian_theme ###</span>

<span class="c1">### BEGIN /etc/grub.d/10_linux ###</span>
<span class="n">function</span><span class="w"> </span><span class="n">gfxmode</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">set</span><span class="w"> </span><span class="n">gfxpayload</span><span class="o">=</span><span class="s2">&quot;${1}&quot;</span>
<span class="p">}</span>
<span class="n">set</span><span class="w"> </span><span class="n">linux_gfx_mode</span><span class="o">=</span>
<span class="k">export</span><span class="w"> </span><span class="n">linux_gfx_mode</span>
<span class="n">menuentry</span><span class="w"> </span><span class="s1">&#39;Debian GNU/Linux&#39;</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">gnu</span><span class="o">-</span><span class="n">linux</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">gnu</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">os</span><span class="w"> </span><span class="o">$</span><span class="n">menuentry_id_option</span><span class="w"> </span><span class="s1">&#39;gnulinux-simple-df2d9e14-f1e9-4b1b-95d4-0167caa2461e&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">load_video</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">gzio</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">grub_platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xxen</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">insmod</span><span class="w"> </span><span class="n">xzio</span><span class="p">;</span><span class="w"> </span><span class="n">insmod</span><span class="w"> </span><span class="n">lzopio</span><span class="p">;</span><span class="w"> </span><span class="n">fi</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">part_gpt</span>
<span class="w">    </span><span class="n">insmod</span><span class="w"> </span><span class="n">ext2</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_platform_search_hint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">      </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w">  </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w"> </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="w">    </span><span class="n">fi</span>
<span class="w">    </span><span class="n">echo</span><span class="w">    </span><span class="s1">&#39;Loading Linux 5.10.0-9-arm64 ...&#39;</span>
<span class="w">    </span><span class="n">linux</span><span class="w">   </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">arm64</span><span class="w"> </span><span class="n">root</span><span class="o">=</span><span class="n">UUID</span><span class="o">=</span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span><span class="w"> </span><span class="n">ro</span><span class="w">  </span><span class="n">quiet</span>
<span class="w">    </span><span class="n">echo</span><span class="w">    </span><span class="s1">&#39;Loading initial ramdisk ...&#39;</span>
<span class="w">    </span><span class="n">initrd</span><span class="w">  </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">initrd</span><span class="o">.</span><span class="n">img</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">arm64</span>
<span class="p">}</span>
<span class="n">submenu</span><span class="w"> </span><span class="s1">&#39;Advanced options for Debian GNU/Linux&#39;</span><span class="w"> </span><span class="o">$</span><span class="n">menuentry_id_option</span><span class="w"> </span><span class="s1">&#39;gnulinux-advanced-df2d9e14-f1e9-4b1b-95d4-0167caa2461e&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">menuentry</span><span class="w"> </span><span class="s1">&#39;Debian GNU/Linux, with Linux 5.10.0-9-arm64&#39;</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">gnu</span><span class="o">-</span><span class="n">linux</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">gnu</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">os</span><span class="w"> </span><span class="o">$</span><span class="n">menuentry_id_option</span><span class="w"> </span><span class="s1">&#39;gnulinux-5.10.0-9-arm64-advanced-df2d9e14-f1e9-4b1b-95d4-0167caa2461e&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">load_video</span>
<span class="w">        </span><span class="n">insmod</span><span class="w"> </span><span class="n">gzio</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">grub_platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xxen</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">insmod</span><span class="w"> </span><span class="n">xzio</span><span class="p">;</span><span class="w"> </span><span class="n">insmod</span><span class="w"> </span><span class="n">lzopio</span><span class="p">;</span><span class="w"> </span><span class="n">fi</span>
<span class="w">        </span><span class="n">insmod</span><span class="w"> </span><span class="n">part_gpt</span>
<span class="w">        </span><span class="n">insmod</span><span class="w"> </span><span class="n">ext2</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_platform_search_hint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">          </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w">  </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">          </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w"> </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="w">        </span><span class="n">fi</span>
<span class="w">        </span><span class="n">echo</span><span class="w">    </span><span class="s1">&#39;Loading Linux 5.10.0-9-arm64 ...&#39;</span>
<span class="w">        </span><span class="n">linux</span><span class="w">   </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">arm64</span><span class="w"> </span><span class="n">root</span><span class="o">=</span><span class="p">(</span><span class="n">hd0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">ro</span><span class="w">  </span><span class="n">quiet</span>
<span class="w">        </span><span class="n">echo</span><span class="w">    </span><span class="s1">&#39;Loading initial ramdisk ...&#39;</span>
<span class="w">        </span><span class="n">initrd</span><span class="w">  </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">initrd</span><span class="o">.</span><span class="n">img</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">arm64</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">menuentry</span><span class="w"> </span><span class="s1">&#39;Debian GNU/Linux, with Linux 5.10.0-8-arm64 (recovery mode)&#39;</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">gnu</span><span class="o">-</span><span class="n">linux</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">gnu</span><span class="w"> </span><span class="o">--</span><span class="k">class</span><span class="w"> </span><span class="n">os</span><span class="w"> </span><span class="o">$</span><span class="n">menuentry_id_option</span><span class="w"> </span><span class="s1">&#39;gnulinux-5.10.0-8-arm64-recovery-df2d9e14-f1e9-4b1b-95d4-0167caa2461e&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">load_video</span>
<span class="w">        </span><span class="n">insmod</span><span class="w"> </span><span class="n">gzio</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">grub_platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xxen</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">insmod</span><span class="w"> </span><span class="n">xzio</span><span class="p">;</span><span class="w"> </span><span class="n">insmod</span><span class="w"> </span><span class="n">lzopio</span><span class="p">;</span><span class="w"> </span><span class="n">fi</span>
<span class="w">        </span><span class="n">insmod</span><span class="w"> </span><span class="n">part_gpt</span>
<span class="w">        </span><span class="n">insmod</span><span class="w"> </span><span class="n">ext2</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">feature_platform_search_hint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">          </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w">  </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">          </span><span class="n">search</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">floppy</span><span class="w"> </span><span class="o">--</span><span class="n">fs</span><span class="o">-</span><span class="n">uuid</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">=</span><span class="n">root</span><span class="w"> </span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span>
<span class="w">        </span><span class="n">fi</span>
<span class="w">        </span><span class="n">echo</span><span class="w">    </span><span class="s1">&#39;Loading Linux 5.10.0-8-arm64 ...&#39;</span>
<span class="w">        </span><span class="n">linux</span><span class="w">   </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="n">arm64</span><span class="w"> </span><span class="n">root</span><span class="o">=</span><span class="n">UUID</span><span class="o">=</span><span class="n">df2d9e14</span><span class="o">-</span><span class="n">f1e9</span><span class="o">-</span><span class="mi">4</span><span class="n">b1b</span><span class="o">-</span><span class="mi">95</span><span class="n">d4</span><span class="o">-</span><span class="mi">0167</span><span class="n">caa2461e</span><span class="w"> </span><span class="n">ro</span><span class="w"> </span><span class="n">single</span><span class="w"> </span>
<span class="w">        </span><span class="n">echo</span><span class="w">    </span><span class="s1">&#39;Loading initial ramdisk ...&#39;</span>
<span class="w">        </span><span class="n">initrd</span><span class="w">  </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">initrd</span><span class="o">.</span><span class="n">img</span><span class="o">-</span><span class="mf">5.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="n">arm64</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">### END /etc/grub.d/10_linux ###</span>

<span class="c1">### BEGIN /etc/grub.d/20_linux_xen ###</span>

<span class="c1">### END /etc/grub.d/20_linux_xen ###</span>

<span class="c1">### BEGIN /etc/grub.d/30_os-prober ###</span>
<span class="c1">### END /etc/grub.d/30_os-prober ###</span>

<span class="c1">### BEGIN /etc/grub.d/30_uefi-firmware ###</span>
<span class="n">menuentry</span><span class="w"> </span><span class="s1">&#39;System setup&#39;</span><span class="w"> </span><span class="o">$</span><span class="n">menuentry_id_option</span><span class="w"> </span><span class="s1">&#39;uefi-firmware&#39;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fwsetup</span>
<span class="p">}</span>
<span class="c1">### END /etc/grub.d/30_uefi-firmware ###</span>

<span class="c1">### BEGIN /etc/grub.d/40_custom ###</span>
<span class="c1"># This file provides an easy way to add custom menu entries.  Simply type the</span>
<span class="c1"># menu entries you want to add after this comment.  Be careful not to change</span>
<span class="c1"># the &#39;exec tail&#39; line above.</span>
<span class="c1">### END /etc/grub.d/40_custom ###</span>

<span class="c1">### BEGIN /etc/grub.d/41_custom ###</span>
<span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w">  </span><span class="o">$</span><span class="p">{</span><span class="n">config_directory</span><span class="p">}</span><span class="o">/</span><span class="n">custom</span><span class="o">.</span><span class="n">cfg</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">source</span><span class="w"> </span><span class="o">$</span><span class="p">{</span><span class="n">config_directory</span><span class="p">}</span><span class="o">/</span><span class="n">custom</span><span class="o">.</span><span class="n">cfg</span>
<span class="k">elif</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="s2">&quot;${config_directory}&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w">  </span><span class="o">$</span><span class="n">prefix</span><span class="o">/</span><span class="n">custom</span><span class="o">.</span><span class="n">cfg</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">then</span>
<span class="w">  </span><span class="n">source</span><span class="w"> </span><span class="o">$</span><span class="n">prefix</span><span class="o">/</span><span class="n">custom</span><span class="o">.</span><span class="n">cfg</span><span class="p">;</span>
<span class="n">fi</span>
<span class="c1">### END /etc/grub.d/41_custom ###</span>
</code></pre></div>

<h4>GRUB2 commands</h4>
<p>The installation is done with <code>grub-install /dev/sda</code> and after changing the config files, you need to issue  <code>grub2-mkconfig</code> or <code>grub-mkconfig</code>. It reads the configuration files from <code>/etc/grub.d/</code> and <code>/etc/default/grub/</code> and create the <code>grub.cfg</code> file based on them. You run it like this:</p>
<div class="highlight"><pre><span></span><code>grub2-mkconfig &gt; /boot/grub2/grub.cfg
</code></pre></div>

<p>or </p>
<div class="highlight"><pre><span></span><code>grub2-mkconfig -o /boot/grub2/grub.cfg
</code></pre></div>

<p>There is also a command called <code>update-grub</code> as a frontend to <code>grub-mkconfig</code> which runs <code>grub-mkconfig -o /boot/grub/grub.cfg</code></p>
<blockquote>
<p>Please note that on some modern distros, you have both <code>grub</code> and <code>grub2</code> commands available for compatibility reasons, and one links to the other.</p>
</blockquote>
<h4>Interacting with GRUB2</h4>
<p>If you press <code>c</code> on the grub menu, you will go into the <em>GRUB Command Line</em> or <em>GRUB shell</em>. There you can type commands like <code>root</code> and <code>kernel</code> and <code>initrd</code> and boot the system with <code>boot</code> or press the <code>Esc</code> key to return back to the menu. </p>
<h3>Kernel boot parameters</h3>
<p>In the above configs, we sent some parameters to the kernel like this:</p>
<div class="highlight"><pre><span></span><code>        linux   /boot/vmlinuz-5.10.0-9-arm64 root=/dev/sda1 ro  quiet
</code></pre></div>

<p>This tells the kernel to boot in <em>ReadOnly</em> mode and does not show lots of logs during the boot (<em>quiet</em>).</p>
<p>These are some of the other options you may use:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Option</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">console=</td>
<td style="text-align: left;">Set the console</td>
</tr>
<tr>
<td style="text-align: left;">debug</td>
<td style="text-align: left;">Start in debug mode</td>
</tr>
<tr>
<td style="text-align: left;">init=</td>
<td style="text-align: left;">Run an specific program instead of the default init</td>
</tr>
<tr>
<td style="text-align: left;">initrd=</td>
<td style="text-align: left;">Use this initrd</td>
</tr>
<tr>
<td style="text-align: left;">ro</td>
<td style="text-align: left;">Mount the root filesystem read only</td>
</tr>
<tr>
<td style="text-align: left;">rw</td>
<td style="text-align: left;">Mount the root filesystem for read and write</td>
</tr>
<tr>
<td style="text-align: left;">root=</td>
<td style="text-align: left;">Use this as the root filesystem</td>
</tr>
<tr>
<td style="text-align: left;">selinux</td>
<td style="text-align: left;">Disable <code>selinux</code> on boot</td>
</tr>
<tr>
<td style="text-align: left;">single,S,1,Single</td>
<td style="text-align: left;">Boot in single user mode for troubleshooting (SysV)</td>
</tr>
<tr>
<td style="text-align: left;">systemd.unit=</td>
<td style="text-align: left;">Boot in this systemd target</td>
</tr>
</tbody>
</table>
                                            <br clear="both" />
                                            <h1>102.3 Manage shared libraries</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 1</em></p>
<h2>Objectives</h2>
<p>Candidates should be able to determine the shared libraries that executable programs depend on and install them when necessary.</p>
<ul>
<li>Identify shared libraries.</li>
<li>Identify the typical locations of system libraries.</li>
<li>Load shared libraries.</li>
</ul>
<h2>Terms and Utilities</h2>
<ul>
<li>ldd</li>
<li>ldconfig</li>
<li><code>/etc/ld.so.conf</code></li>
<li>LD_LIBRARY_PATH</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/1P58gW8xCkk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>Linking</h2>
<p>When we write a program, we use libraries. For example, if you need to read text from standard input, you need to <em>link</em> a library that provides this. Think linking has two forms:</p>
<ul>
<li><strong>Static</strong> Linking is when you add this library to your executable program. In this method, your program size is big because it has all the needed libraries. One good advantage is your program can be run without being dependent on other programs/libraries.</li>
<li><strong>Dynamic</strong> Linking is when you just say in your program "We need this and that library to run this program". This way your program is smaller but you need to install those libraries separately. This makes programs more secure (Because libraries can be updated centrally, and more advanced any improvement in a library will improve the whole program), and smaller.</li>
</ul>
<p>Linux dynamic libraries have names like <code>libLIBNAME.so.VERSION</code> and are located at places like <code>/lib*/</code> and <code>/usr/lib*/</code>. On Windows, we call them Dynamic Linked Libraries (DLLs). </p>
<blockquote>
<p>Dynamic linking is also called <strong>shared</strong> libraries because all the programs are sharing one library which is separately installed.</p>
</blockquote>
<h2>What libraries do I need</h2>
<p>Libraries related to system utilities are installed in <code>/lib</code> and <code>/lib64</code> (for 32bit and 64bit libraries) and libraries installed by other software will be located at <code>/usr/lib</code> and <code>/usr/lib64</code>.</p>
<h3>ldd</h3>
<p>The <code>ldd</code> command helps you find:</p>
<ul>
<li>If a program is dynamically or statically linked</li>
<li>What libraries a program needs</li>
</ul>
<p>Let's have a look at two files:</p>
<div class="highlight"><pre><span></span><code>[jadi@fedora ~]$ ldd /sbin/ldconfig
    not a dynamic executable

[jadi@fedora ~]$ ldd /bin/ls
    linux-vdso.so.1 (0x00007ffdd53eb000)
    libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00007f5cbc7b0000)
    libcap.so.2 =&gt; /lib64/libcap.so.2 (0x00007f5cbc7a6000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f5cbc5a5000)
    libpcre2-8.so.0 =&gt; /lib64/libpcre2-8.so.0 (0x00007f5cbc50f000)
    /lib64/ld-linux-x86-64.so.2 (0x00007f5cbc813es
</code></pre></div>

<p>As you can see, <code>ldd</code> tells us that the <code>/sbin/ldconfig</code> is not dynamically linked but shows us the libraries needed by <code>/bin/ls</code>.</p>
<h3>Symbolic links for libraries</h3>
<p>If you are writing a program and you use udev functions, you will ask for a library called <em>libudev.so.1</em>. But a Linux distro, might call its version of udev library <em>libudev.so.1.4.0</em>. How can we solve this problem? The answer is <strong>symbolic links</strong>; You will learn more about them in the next chapters but for short, a symbolic name is a new name for the same file.</p>
<p>I will check the same thing on my system. First I'll find where the <code>libudev.so.1</code> on my system is:</p>
<div class="highlight"><pre><span></span><code># locate libudev.so.1
/lib/i386-linux-gnu/libudev.so.1
/usr/lib64/libudev.so.1.7.3
</code></pre></div>

<p>And then will check that file:</p>
<div class="highlight"><pre><span></span><code># ls -la /lib/i386-linux-gnu/libudev.so.1
lrwxrwxrwx 1 root root    16 Nov 13 23:05 /lib/i386-linux-gnu/libudev.so.1 -&gt; libudev.so.1.4.0
</code></pre></div>

<p>As you can see, this is a symbolic link pointing to the version of libudev I have installed (1.4.0) so even if a software says it needs libudev.so.1, my system will use its libusdev.so.1.4.0.</p>
<h3>Dynamic library configs and cache</h3>
<p>As with most other Linux tools, dynamic linking is also configured using a text config file. It is located at <em>/etc/ld.so.conf</em>. On an Ubuntu system it just points to other config files in <code>/etc/ld.so.conf.d/</code> but all those lines can be included in the main file too:</p>
<div class="highlight"><pre><span></span><code>[jadi@fedora ~]$ cat /etc/ld.so.conf
include ld.so.conf.d/*.conf
[jadi@fedora ~]$ ls /etc/ld.so.conf.d/
llvm13-x86_64.conf  pipewire-jack-x86_64.conf
[jadi@fedora ~]$ cat /etc/ld.so.conf.d/llvm13-x86_64.conf
/usr/lib64/llvm13/lib
</code></pre></div>

<p>The <code>ldconfig</code> commands processed all these files to make the loading of libraries faster. This command creates <code>ld.so.cache</code> to locate files that are to be dynamically loaded and linked.</p>
<blockquote>
<p>If you change the <code>ld.so.conf</code> (or sub-directories) you need to run <code>ldconfig</code>. Try it with <code>-v</code> switch to see the progress / data.</p>
</blockquote>
<p>To close this section, let's run ldconfig with the <strong>-p</strong> switch to see what is saved in ld.so.cache:</p>
<div class="highlight"><pre><span></span><code>[jadi@fedora ~]$ ldconfig -p | head
1373 libs found in cache `/etc/ld.so.cache&#39;
    libzstd.so.1 (libc6,x86-64) =&gt; /lib64/libzstd.so.1
    libzmf-0.0.so.0 (libc6,x86-64) =&gt; /lib64/libzmf-0.0.so.0
    libzip.so.5 (libc6,x86-64) =&gt; /lib64/libzip.so.5
    libzhuyin.so.13 (libc6,x86-64) =&gt; /lib64/libzhuyin.so.13
    libzck.so.1 (libc6,x86-64) =&gt; /lib64/libzck.so.1
    libz.so.1 (libc6,x86-64) =&gt; /lib64/libz.so.1
    libyui.so.15 (libc6,x86-64) =&gt; /lib64/libyui.so.15
    libyui-mga.so.15 (libc6,x86-64) =&gt; /lib64/libyui-mga.so.15
    libyelp.so.0 (libc6,x86-64) =&gt; /lib64/libyelp.so.0
</code></pre></div>

<p>As you can see, this file tells the kernel that if anyone asks for <code>libzstd.so.1</code>, the <code>/lib64/libzstd.so.1</code> file should be loaded and used.</p>
<h3>Where OS finds dynamic libraries</h3>
<p>When a program needs a shared library, the system will search files in this order:</p>
<ol>
<li>LD_LIBRARY_PATH environment variable</li>
<li>Programs PATH</li>
<li><code>/etc/ld.so.conf</code> (Which might load more files from <code>/etc/ld.so.conf.d/</code> in its beginning or its end)</li>
<li><code>/lib/</code>, <code>/lib64/</code>, <code>/usr/lib/</code>, <code>/usr/lib64/</code></li>
</ol>
<p>In some cases, you might need to override the default system libraries. Some examples are:</p>
<ul>
<li>You are running an old software which needs an old version of a library.</li>
<li>You are developing a shared library and want to test it without installing it</li>
<li>You are running a specific program (say from opt) which needs to access its own libraries</li>
</ul>
<p>In these cases, you can point the environment variable <strong>LD_LIBRARY_PATH</strong> to the library you need to use and then run your program. A colon (:) separated list of directories will tell your program where to search for needed libraries <strong>before</strong> checking the libraries in <code>/etc/ld.so.cache</code>.</p>
<p>For example, if you give this command:</p>
<div class="highlight"><pre><span></span><code>export  LD_LIBRARY_PATH=/usr/lib/myoldlibs:/home/jadi/lpic/libs/
</code></pre></div>

<p>And then run any command, the system will search <code>/usr/lib/myoldlibs</code> and then <code>/home/jadi/lpic/libs/</code> before going to the main system libraries (defined in <code>/etc/ld.so.cache</code>). . .</p>
<h2>Loading dynamically</h2>
<p>In the last part of this section, let's see how we can manually tell Linux to run a program using its <em>dynamic linker</em>. Its also called a dynamic loader and is used to load dynamic libraries needed by an executable. It might be called <code>ld</code> or <code>ld-linux</code>. You can find yours by running:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">locate</span><span class="w"> </span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">64.</span><span class="n">so</span><span class="mf">.2</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">man</span><span class="o">/</span><span class="n">man8</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="mf">.8</span><span class="p">.</span><span class="n">gz</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">man</span><span class="o">/</span><span class="n">man8</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="p">.</span><span class="n">so</span><span class="mf">.8</span><span class="p">.</span><span class="n">gz</span>
</code></pre></div>

<p>and run programs using it like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">jadi</span><span class="err">@</span><span class="n">fedora</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="o">$</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">64.</span><span class="n">so</span><span class="o">.</span><span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ls</span>
<span class="n">Desktop</span><span class="w">  </span><span class="n">Documents</span><span class="w">  </span><span class="n">Downloads</span><span class="w">  </span><span class="n">Music</span><span class="w">  </span><span class="n">Pictures</span><span class="w">  </span><span class="n">Public</span><span class="w">  </span><span class="n">Templates</span><span class="w">  </span><span class="n">tmp</span><span class="w">  </span><span class="n">Videos</span>
</code></pre></div>

<p>Do you want to go deeper than LPIC1 and ask why you do not need to run <code>ld-linux</code> when running a command? Because the executable you are running is a Linux ELF executable and if you check its inside, you can see that it says "run this using ld-linux": </p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">readelf</span><span class="w"> </span><span class="o">-</span><span class="n">Wl</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ls</span>

<span class="n">Elf</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">DYN</span><span class="w"> </span><span class="p">(</span><span class="k">Position</span><span class="o">-</span><span class="n">Independent</span><span class="w"> </span><span class="n">Executable</span><span class="w"> </span><span class="k">file</span><span class="p">)</span>
<span class="n">Entry</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="mh">0x6c00</span>
<span class="n">There</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="mi">64</span>

<span class="n">Program</span><span class="w"> </span><span class="nl">Headers</span><span class="p">:</span>
<span class="w">  </span><span class="n">Type</span><span class="w">           </span><span class="n">Offset</span><span class="w">   </span><span class="n">VirtAddr</span><span class="w">           </span><span class="n">PhysAddr</span><span class="w">           </span><span class="n">FileSiz</span><span class="w">  </span><span class="n">MemSiz</span><span class="w">   </span><span class="n">Flg</span><span class="w"> </span><span class="n">Align</span>
<span class="w">  </span><span class="n">PHDR</span><span class="w">           </span><span class="mh">0x000040</span><span class="w"> </span><span class="mh">0x0000000000000040</span><span class="w"> </span><span class="mh">0x0000000000000040</span><span class="w"> </span><span class="mh">0x0002d8</span><span class="w"> </span><span class="mh">0x0002d8</span><span class="w"> </span><span class="n">R</span><span class="w">   </span><span class="mh">0x8</span>
<span class="w">  </span><span class="n">INTERP</span><span class="w">         </span><span class="mh">0x000318</span><span class="w"> </span><span class="mh">0x0000000000000318</span><span class="w"> </span><span class="mh">0x0000000000000318</span><span class="w"> </span><span class="mh">0x00001c</span><span class="w"> </span><span class="mh">0x00001c</span><span class="w"> </span><span class="n">R</span><span class="w">   </span><span class="mh">0x1</span>
<span class="w">      </span><span class="o">[</span><span class="n">Requesting program interpreter: /lib64/ld-linux-x86-64.so.2</span><span class="o">]</span>
<span class="w">  </span><span class="k">LOAD</span><span class="w">           </span><span class="mh">0x000000</span><span class="w"> </span><span class="mh">0x0000000000000000</span><span class="w"> </span><span class="mh">0x0000000000000000</span><span class="w"> </span><span class="mh">0x003798</span><span class="w"> </span><span class="mh">0x003798</span><span class="w"> </span><span class="n">R</span><span class="w">   </span><span class="mh">0x1000</span>
<span class="w">  </span><span class="k">LOAD</span><span class="w">           </span><span class="mh">0x004000</span><span class="w"> </span><span class="mh">0x0000000000004000</span><span class="w"> </span><span class="mh">0x0000000000004000</span><span class="w"> </span><span class="mh">0x013c21</span><span class="w"> </span><span class="mh">0x013c21</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="mh">0x1000</span>
<span class="w">  </span><span class="k">LOAD</span><span class="w">           </span><span class="mh">0x018000</span><span class="w"> </span><span class="mh">0x0000000000018000</span><span class="w"> </span><span class="mh">0x0000000000018000</span><span class="w"> </span><span class="mh">0x0074d8</span><span class="w"> </span><span class="mh">0x0074d8</span><span class="w"> </span><span class="n">R</span><span class="w">   </span><span class="mh">0x1000</span>
<span class="w">  </span><span class="o">[</span><span class="n">...</span><span class="o">]</span>
</code></pre></div>

<p>💀 There is a <em>hack</em> here: <em>You can run any Linux executable even if its executable bit is not set!</em> just run it using <code>ld-linux</code> as we did a few lines above!</p>
                                            <br clear="both" />
                                            <h1>102.4 Use Debian package management</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to perform package management using the Debian package tools.</p>
<ul>
<li>Install, upgrade and uninstall Debian binary packages.</li>
<li>Find packages containing specific files or libraries which may or may not be installed.</li>
<li>Obtain package information like version, content, dependencies, package integrity, and installation status (Whether or not the package is installed).</li>
<li>Awareness of apt.</li>
</ul>
<h2>Terms and Utilities</h2>
<ul>
<li><code>/etc/apt/sources.list</code></li>
<li>dpkg</li>
<li>dpkg-reconfigure</li>
<li>apt-get</li>
<li>apt-cache</li>
</ul>
<h2>Concept of the package management system</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/jtwbweigRxo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Some people think that on GNU/Linux we have to compile all the software we need manually. This is not the case in 99% of cases and never has been the case in the last 20 years. GNU/Linux is the predecessor of what we call the App Store these days. All major distros do have huge archives of pre-compiled software called their <em>repositories</em> and some kind of a <strong>package manager</strong> software that takes care of searching these repositories, installing software from them, finding dependencies, installing them, resolving conflicts, and updating the system and installed software. Debian-based distros use <code>.deb</code> files as their "packages" and use tools like <code>apt-get</code>, <code>dpkg</code>, <code>apt</code>, and other tools to manage them.</p>
<p>Debian packages are names like <code>NAME-VERSION-RELEASE_ARCHITECTURE.deb</code>; Say <code>tmux_3.2a-4build1_amd64.deb</code>. </p>
<h2>Repositories</h2>
<p>But where did this package come from? How does the OS know where to look for this deb package? The answer is <strong>Repositories</strong>. Each distro has its repository of packages. It can be on a Disk, A network drive, a collection of DVDs, or most commonly, a network address on the Internet. </p>
<p>On debian systems, the main configuration locations are:
* <code>/etc/apt/sources.list</code>
* <code>/etc/apt/sources.list.d/</code></p>
<div class="highlight"><pre><span></span><code>jadi@lpicjadi:~$ cat /etc/apt/sources.list
#deb cdrom:[Ubuntu 22.04 LTS _Jammy Jellyfish_ - Beta amd64 (20220329.1)]/ jammy main restricted

# See http://help.ubuntu.com/community/UpgradeNotes for how to upgrade to
# newer versions of the distribution.
deb http://us.archive.ubuntu.com/ubuntu/ jammy main restricted
# deb-src http://us.archive.ubuntu.com/ubuntu/ jammy main restricted

## Major bug fix updates produced after the final release of the
## distribution.
deb http://us.archive.ubuntu.com/ubuntu/ jammy-updates main restricted
# deb-src http://us.archive.ubuntu.com/ubuntu/ jammy-updates main restricted

## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu
## team. Also, please note that software in the universe WILL NOT receive any
## review or updates from the Ubuntu security team.
deb http://us.archive.ubuntu.com/ubuntu/ jammy universe
# deb-src http://us.archive.ubuntu.com/ubuntu/ jammy universe
deb http://us.archive.ubuntu.com/ubuntu/ jammy-updates universe
# deb-src http://us.archive.ubuntu.com/ubuntu/ jammy-updates universe

## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu
## team, and may not be under a free license. Please satisfy yourself as to
## your rights to use the software. Also, please note that the software in
## multiverse WILL NOT receive any review or updates from the Ubuntu
## security team.
deb http://us.archive.ubuntu.com/ubuntu/ jammy multiverse
# deb-src http://us.archive.ubuntu.com/ubuntu/ jammy multiverse
deb http://us.archive.ubuntu.com/ubuntu/ jammy-updates multiverse
# deb-src http://us.archive.ubuntu.com/ubuntu/ jammy-updates multiverse

## N.B. software from this repository may not have been tested as
## extensively as that contained in the main release, although it includes
## newer versions of some applications which may provide useful features.
## Also, please note that software in backports WILL NOT receive any review
## or updates from the Ubuntu security team.
deb http://us.archive.ubuntu.com/ubuntu/ jammy-backports main restricted universe multiverse
# deb-src http://us.archive.ubuntu.com/ubuntu/ jammy-backports main restricted universe multiverse

deb http://security.ubuntu.com/ubuntu jammy-security main restricted
# deb-src http://security.ubuntu.com/ubuntu jammy-security main restricted
deb http://security.ubuntu.com/ubuntu jammy-security universe
# deb-src http://security.ubuntu.com/ubuntu jammy-security universe
deb http://security.ubuntu.com/ubuntu jammy-security multiverse
# deb-src http://security.ubuntu.com/ubuntu jammy-security multiverse

# This system was installed using small removable media
# (e.g. netinst, live or single CD). The matching &quot;deb cdrom&quot;
# entries were disabled at the end of the installation process.
# For information about how to configure apt package sources,
# see the sources.list(5) manual.
</code></pre></div>

<p>Updating sources information:</p>
<div class="highlight"><pre><span></span><code>apt-get update
</code></pre></div>

<p>This will check all the sources in the configs and update the information about the latest software available there.</p>
<blockquote>
<p>This won't actually <em>Upgrade</em> the software. The <em>Update</em> will only <em>Update the information about the packages and not the packages themselves</em>.</p>
</blockquote>
<h2>Installing packages</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/IBnxIX_WceI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Say you have heard about this amazing terminal multiplexer called <code>tmux</code> and you want to give it a try.</p>
<div class="highlight"><pre><span></span><code>$ tmux
The program &#39;tmux&#39; is currently not installed. You can install it by typing:
sudo apt-get install tmux
$ which tmux
$ type tmux
bash: type: tmux: not found
</code></pre></div>

<p>So let's install it. If it's in the repositories it's enough to tell the package manager to install it:</p>
<div class="highlight"><pre><span></span><code>apt-get install tmux
</code></pre></div>

<p>Note that</p>
<ul>
<li>apt-get install asked for confirmation (Y)</li>
<li>apt-get resolved <em>dependencies</em>, It knows what is needed to install this package and installs them</li>
<li>Debian packages are something.deb</li>
</ul>
<p>If you only want a dry-run/simulation:</p>
<div class="highlight"><pre><span></span><code>apt-get install -s tmux
</code></pre></div>

<p>and this will only download the files needed into the cache without installing them:</p>
<div class="highlight"><pre><span></span><code>apt-get install --download-only tmux
</code></pre></div>

<p>The downloaded packages are stored as a cache in <code>/var/cache/apt/archive/</code>.</p>
<p>If you want to download only one specific package, you can do:</p>
<div class="highlight"><pre><span></span><code><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">tmux</span>
</code></pre></div>

<h2>Removing debian packages</h2>
<div class="highlight"><pre><span></span><code>apt-get remove tmux
</code></pre></div>

<p>And if you want to remove automatically installed dependencies:</p>
<div class="highlight"><pre><span></span><code>$ apt-get autoremove tmux
</code></pre></div>

<p>or even</p>
<div class="highlight"><pre><span></span><code>$ apt-get autoremove
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages will be REMOVED:
  linux-image-3.16.0-25-generic linux-image-extra-3.16.0-25-generic
0 upgraded, 0 newly installed, 2 to remove, and 0 not upgraded.
After this operation, 203 MB of disk space will be freed.
Do you want to continue? [Y/n] y
</code></pre></div>

<p>To autoremove whatever is not needed anymore.</p>
<p>Notes:</p>
<ul>
<li>Removing a package will not remove its dependencies</li>
<li>If removing a dependency, you'll get a warning about what will be removed alongside this package</li>
</ul>
<h2>Searching for packages</h2>
<p>If you are using the apt suit, the search is done via <code>apt-cache</code> or you can use the general <code>apt</code>. </p>
<div class="highlight"><pre><span></span><code>$ apt-cache search &quot;tiny window&quot;
$ apt search grub2
</code></pre></div>

<h2>Upgrading</h2>
<p>For updating a single package:</p>
<div class="highlight"><pre><span></span><code>apt-get install tzdata
</code></pre></div>

<p>And for upgrading whatever is installed:</p>
<div class="highlight"><pre><span></span><code>apt-get upgrade
</code></pre></div>

<p>Or going to a new distribution:</p>
<div class="highlight"><pre><span></span><code>apt-get dist-upgrade
</code></pre></div>

<p>Note: like most other tools, you can configure the default configs at <code>/etc/apt/apt.conf</code> and there is a program apt-config for this purpose.</p>
<h2>Reconfiguring packages</h2>
<p>Debian packages can have <em>configuration actions</em> that will take after the package is installed. This is done by <code>debconf</code>. For example, tzdata will ask you about the timezone settings after you installed it. If you want to <em>reconfigure</em> a package that is already installed, you can use the <code>dpkg-reconfigure</code>:</p>
<div class="highlight"><pre><span></span><code> dpkg-reconfigure tzdata
</code></pre></div>

<h2>Package information with dpkg</h2>
<p>The underlying tool to work with <code>.deb</code> files is the <code>dpkg</code>. It is your to-go tool if you want to do manual actions on a deb package. The general format is:</p>
<div class="highlight"><pre><span></span><code><span class="n">dpkg</span><span class="w"> </span><span class="o">[</span><span class="n">OPTIONS</span><span class="o">]</span><span class="w"> </span><span class="k">ACTION</span><span class="w"> </span><span class="n">PACKAGE</span>
</code></pre></div>

<p>Some common actions are:</p>
<table>
<thead>
<tr>
<th>Switch</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-c or --contents</td>
<td>Show the contents of a package</td>
</tr>
<tr>
<td>-C or --audit</td>
<td>Search for broken installed packages and propose solutions</td>
</tr>
<tr>
<td>--configure</td>
<td>Reconfigure an installed package</td>
</tr>
<tr>
<td>-i or --install</td>
<td>Install or Upgrade a package; Wont resolve / install dependencies</td>
</tr>
<tr>
<td>-I or --info</td>
<td>Show Info</td>
</tr>
<tr>
<td>-l or --list</td>
<td>List all installed packages</td>
</tr>
<tr>
<td>-L or --listfiles</td>
<td>List all files related to this package</td>
</tr>
<tr>
<td>-P or --purge</td>
<td>Remove the package and its configuration files</td>
</tr>
<tr>
<td>-r or --remove</td>
<td>Remove the package; Keep the configurations</td>
</tr>
<tr>
<td>-s or --status</td>
<td>Display status of a package</td>
</tr>
<tr>
<td>-S or --search</td>
<td>Search and see which package owns this file</td>
</tr>
</tbody>
</table>
<p>You can check the contents:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">--</span><span class="n">contents</span><span class="w"> </span><span class="n">bzr_2</span><span class="mf">.7.0</span><span class="o">+</span><span class="n">bzr6622</span><span class="o">+</span><span class="n">brz_all</span><span class="p">.</span><span class="n">deb</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="w">         </span><span class="mi">0</span><span class="w"> </span><span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">19</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="p">.</span><span class="o">/</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="w">         </span><span class="mi">0</span><span class="w"> </span><span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">19</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="w">         </span><span class="mi">0</span><span class="w"> </span><span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">19</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="w">         </span><span class="mi">0</span><span class="w"> </span><span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">19</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="w">         </span><span class="mi">0</span><span class="w"> </span><span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">19</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">bzr</span><span class="o">/</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="w">       </span><span class="mi">404</span><span class="w"> </span><span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">19</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">bzr</span><span class="o">/</span><span class="n">NEWS</span><span class="p">.</span><span class="n">Debian</span><span class="p">.</span><span class="n">gz</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="w">      </span><span class="mi">1301</span><span class="w"> </span><span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">19</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">25</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">bzr</span><span class="o">/</span><span class="n">changelog</span><span class="p">.</span><span class="n">gz</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="c1">--r-- root/root      1769 2019-09-19 18:25 ./usr/share/doc/bzr/copyright</span>
</code></pre></div>

<p>Or install a deb package (without its dependencies) or check its status:</p>
<div class="highlight"><pre><span></span><code>$ dpkg -s bzr
Package: bzr
Status: deinstall ok config-files
Priority: optional
Section: vcs
Installed-Size: 102
Maintainer: Ubuntu Developers &lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;
Architecture: all
Version: 2.6.0+bzr6595-1ubuntu1
Config-Version: 2.6.0+bzr6595-1ubuntu1
Depends: python-bzrlib (&lt;= 2.6.0+bzr6595-1ubuntu1.1~), python-bzrlib (&gt;= 2.6.0+bzr6595-1ubuntu1), python:any
Recommends: python-gpgme
Suggests: bzr-doc, bzrtools, python-bzrlib.tests
Breaks: bzr-pqm (&lt;&lt; 1.4.0~bzr80), bzr-xmloutput (&lt;&lt; 0.8.8+bzr160), python-bzrlib (&lt;&lt; 2.4.0~beta3~)
Conffiles:
 /etc/bash_completion.d/bzr b8d9ca95521a7c5f14860e205a854da2
Description: easy to use distributed version control system
 Bazaar is a distributed version control system designed to be easy to
 use and intuitive, able to adapt to many workflows, reliable, and
 easily extendable.
 .
 Publishing of branches can be done over plain HTTP, that is, no special
 software is needed on the server to host Bazaar branches. Branches can
 be pushed to the server via sftp (which most SSH installations come
 with), FTP, or over a custom and faster protocol if bzr is installed in
 the remote end.
 .
 Merging in Bazaar is easy, as the implementation can avoid many
 spurious conflicts deals well with repeated merges between branches,
 and can handle modifications to renamed files correctly.
 .
 Bazaar is written in Python and has a flexible plugin interface that
 can be used to extend its functionality. Many plugins exist, providing
 useful commands (bzrtools), graphical interfaces (qbzr), or native
 interaction with Subversion branches (bzr-svn).
 .
 Install python-paramiko if you are going to push branches to remote
 hosts with sftp, and python-pycurl if you&#39;d like SSL certificates
 always to be verified.
Homepage: http://bazaar-vcs.org
Original-Maintainer: Debian Bazaar Maintainers &lt;pkg-bazaar-maint@lists.alioth.debian.org&gt;
</code></pre></div>

<p>Or even <strong>purge</strong> an installed package; Removing the package and all of its configurations. To Purge a package, use the <strong>-P</strong> or <strong>--purge</strong> switch.</p>
<p>There is also <strong>-L</strong> to check the files and directories a package installed:</p>
<div class="highlight"><pre><span></span><code>$ dpkg -L bzr
/.
/usr
/usr/bin
/usr/bin/jcal
/usr/share
/usr/share/doc
/usr/share/doc/jcal
/usr/share/doc/jcal/README
/usr/share/doc/jcal/copyright
/usr/share/man
/usr/share/man/man1
/usr/share/man/man1/jcal.1.gz
/usr/share/doc/jcal/changelog.Debian.gz
</code></pre></div>

<p>and <strong>-S</strong> will show which package installed the given file:</p>
<div class="highlight"><pre><span></span><code>$ dpkg -S /var/lib/mplayer/prefs/mirrors
mplayer: /var/lib/mplayer/prefs/mirrors
</code></pre></div>

<h2>Common apt-get options</h2>
<table>
<thead>
<tr>
<th>Option</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>autoclean</td>
<td>Removes unused packages</td>
</tr>
<tr>
<td>check</td>
<td>Check db for issues</td>
</tr>
<tr>
<td>clean</td>
<td>Clean the DB, you can do a <code>clean all</code> to clean everything and start afresh</td>
</tr>
<tr>
<td>dist-upgrade</td>
<td>Checks for new versions of the OS; Major upgrade</td>
</tr>
<tr>
<td>install</td>
<td>Install or upgrade packages</td>
</tr>
<tr>
<td>remove</td>
<td>Removes a package</td>
</tr>
<tr>
<td>source</td>
<td>Install the source of a package</td>
</tr>
<tr>
<td>update</td>
<td>Updates the information about packages from repositories</td>
</tr>
<tr>
<td>upgrade</td>
<td>Upgrades all packages</td>
</tr>
</tbody>
</table>
<blockquote>
<p>In some cases a package is installed but without proper dependencies (say using <code>dpkg</code>) or an installation is interrupted for any reason. In these cases a <code>apt-get install -f</code> might help, <code>-f</code> is for <code>fix broken</code>. </p>
</blockquote>
<h2>Common apt-cache options</h2>
<table>
<thead>
<tr>
<th>Option</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>depends</td>
<td>Show dependencies</td>
</tr>
<tr>
<td>pkgnames</td>
<td>Shows all installed packages</td>
</tr>
<tr>
<td>search</td>
<td>Search</td>
</tr>
<tr>
<td>showpkg</td>
<td>Show information about a package</td>
</tr>
<tr>
<td>stats</td>
<td>Show statistics</td>
</tr>
<tr>
<td>unmet</td>
<td>Show unmet dependencies for all installed packages or the one you specified</td>
</tr>
</tbody>
</table>
<h2>Other tools</h2>
<p>There are even more tools, the tools with fancy GUIs or text-based tools and user interface tools like <code>aptitude</code>.</p>
                                            <br clear="both" />
                                            <h1>102.5 Use RPM and YUM package management</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to perform package management using RPM, YUM, and Zypper.</p>
<h2>Key Knowledge Areas</h2>
<ul>
<li>Install, re-install, upgrade and remove packages using RPM, YUM, and Zypper</li>
<li>Obtain information on RPM packages such as version, status, dependencies, integrity, and signatures
Determine what files a package provides, as well as find which package a specific file comes from
Awareness of dnf</li>
</ul>
<p>The following is a partial list of the used files, terms, and utilities:</p>
<h2>Terms and Utilities</h2>
<ul>
<li>rpm</li>
<li>rpm2cpio</li>
<li><code>/etc/yum.conf</code></li>
<li><code>/etc/yum.repos.d/</code></li>
<li>yum</li>
<li>zypper</li>
</ul>
<h2>Introduction</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/qk6qcEAvf4A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p><strong>RedHat Package Manager (RPM)</strong> and <strong>YellowDog Update Manager (YUM)</strong> are used by Fedora, RedHat, RHEL, CentOS, RocksOS, ... to manage packages. The package format is called RPM and can be managed by <code>rpm</code> tools but if you want to use the repositories to install, update, search, ... packages, or even upgrade the whole system, you can use the <code>yum</code> command. To have a deeper understanding of the repositories, please refer to the previous section (102.4); Here I assume that you know the concept.</p>
<h2>yum</h2>
<p><code>yum</code> is the package manager used by RedHat-based systems. Its configuration files are located at <code>/etc/yum.conf</code> and <code>/etc/yum.repos.d/</code>. Below is a sample.</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">conf</span>
<span class="o">[</span><span class="n">main</span><span class="o">]</span>
<span class="n">cachedir</span><span class="o">=/</span><span class="nf">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">yum</span><span class="o">/</span><span class="err">$</span><span class="n">basearch</span><span class="o">/</span><span class="err">$</span><span class="n">releasever</span>
<span class="n">keepcache</span><span class="o">=</span><span class="mi">0</span>
<span class="n">debuglevel</span><span class="o">=</span><span class="mi">2</span>
<span class="n">logfile</span><span class="o">=/</span><span class="nf">var</span><span class="o">/</span><span class="nf">log</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="nf">log</span>
<span class="n">exactarch</span><span class="o">=</span><span class="mi">1</span>
<span class="n">obsoletes</span><span class="o">=</span><span class="mi">1</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">1</span>
<span class="n">plugins</span><span class="o">=</span><span class="mi">1</span>
<span class="n">installonly_limit</span><span class="o">=</span><span class="mi">3</span>
</code></pre></div>

<p>And here is a sample of an actual Repo file on a Fedora system:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">fedora</span><span class="p">.</span><span class="n">repo</span>
<span class="o">[</span><span class="n">fedora</span><span class="o">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">Fedora</span><span class="w"> </span><span class="err">$</span><span class="n">releasever</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">$</span><span class="n">basearch</span>
<span class="n">#baseurl</span><span class="o">=</span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="p">.</span><span class="n">example</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">fedora</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="err">$</span><span class="n">releasever</span><span class="o">/</span><span class="n">Everything</span><span class="o">/</span><span class="err">$</span><span class="n">basearch</span><span class="o">/</span><span class="n">os</span><span class="o">/</span>
<span class="n">metalink</span><span class="o">=</span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="p">.</span><span class="n">fedoraproject</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">metalink</span><span class="vm">?</span><span class="n">repo</span><span class="o">=</span><span class="n">fedora</span><span class="o">-</span><span class="err">$</span><span class="n">releasever</span><span class="o">&amp;</span><span class="n">arch</span><span class="o">=</span><span class="err">$</span><span class="n">basearch</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span>
<span class="n">countme</span><span class="o">=</span><span class="mi">1</span>
<span class="n">metadata_expire</span><span class="o">=</span><span class="mi">7</span><span class="n">d</span>
<span class="n">repo_gpgcheck</span><span class="o">=</span><span class="mi">0</span>
<span class="n">type</span><span class="o">=</span><span class="n">rpm</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">1</span>
<span class="n">gpgkey</span><span class="o">=</span><span class="k">file</span><span class="err">:</span><span class="o">///</span><span class="n">etc</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">rpm</span><span class="o">-</span><span class="n">gpg</span><span class="o">/</span><span class="n">RPM</span><span class="o">-</span><span class="n">GPG</span><span class="o">-</span><span class="k">KEY</span><span class="o">-</span><span class="n">fedora</span><span class="o">-</span><span class="err">$</span><span class="n">releasever</span><span class="o">-</span><span class="err">$</span><span class="n">basearch</span>
<span class="n">skip_if_unavailable</span><span class="o">=</span><span class="k">False</span>

<span class="o">[</span><span class="n">fedora-debuginfo</span><span class="o">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">Fedora</span><span class="w"> </span><span class="err">$</span><span class="n">releasever</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">$</span><span class="n">basearch</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Debug</span>
<span class="n">#baseurl</span><span class="o">=</span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="p">.</span><span class="n">example</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">fedora</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="err">$</span><span class="n">releasever</span><span class="o">/</span><span class="n">Everything</span><span class="o">/</span><span class="err">$</span><span class="n">basearch</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">tree</span><span class="o">/</span>
<span class="n">metalink</span><span class="o">=</span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="p">.</span><span class="n">fedoraproject</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">metalink</span><span class="vm">?</span><span class="n">repo</span><span class="o">=</span><span class="n">fedora</span><span class="o">-</span><span class="n">debug</span><span class="o">-</span><span class="err">$</span><span class="n">releasever</span><span class="o">&amp;</span><span class="n">arch</span><span class="o">=</span><span class="err">$</span><span class="n">basearch</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">0</span>
<span class="n">metadata_expire</span><span class="o">=</span><span class="mi">7</span><span class="n">d</span>
<span class="n">repo_gpgcheck</span><span class="o">=</span><span class="mi">0</span>
<span class="n">type</span><span class="o">=</span><span class="n">rpm</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">1</span>
<span class="n">gpgkey</span><span class="o">=</span><span class="k">file</span><span class="err">:</span><span class="o">///</span><span class="n">etc</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">rpm</span><span class="o">-</span><span class="n">gpg</span><span class="o">/</span><span class="n">RPM</span><span class="o">-</span><span class="n">GPG</span><span class="o">-</span><span class="k">KEY</span><span class="o">-</span><span class="n">fedora</span><span class="o">-</span><span class="err">$</span><span class="n">releasever</span><span class="o">-</span><span class="err">$</span><span class="n">basearch</span>
<span class="n">skip_if_unavailable</span><span class="o">=</span><span class="k">False</span>

<span class="o">[</span><span class="n">fedora-source</span><span class="o">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">Fedora</span><span class="w"> </span><span class="err">$</span><span class="n">releasever</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Source</span>
<span class="n">#baseurl</span><span class="o">=</span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="p">.</span><span class="n">example</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">fedora</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="err">$</span><span class="n">releasever</span><span class="o">/</span><span class="n">Everything</span><span class="o">/</span><span class="n">source</span><span class="o">/</span><span class="n">tree</span><span class="o">/</span>
<span class="n">metalink</span><span class="o">=</span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="p">.</span><span class="n">fedoraproject</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">metalink</span><span class="vm">?</span><span class="n">repo</span><span class="o">=</span><span class="n">fedora</span><span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="err">$</span><span class="n">releasever</span><span class="o">&amp;</span><span class="n">arch</span><span class="o">=</span><span class="err">$</span><span class="n">basearch</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">0</span>
<span class="n">metadata_expire</span><span class="o">=</span><span class="mi">7</span><span class="n">d</span>
<span class="n">repo_gpgcheck</span><span class="o">=</span><span class="mi">0</span>
<span class="n">type</span><span class="o">=</span><span class="n">rpm</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">1</span>
<span class="n">gpgkey</span><span class="o">=</span><span class="k">file</span><span class="err">:</span><span class="o">///</span><span class="n">etc</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">rpm</span><span class="o">-</span><span class="n">gpg</span><span class="o">/</span><span class="n">RPM</span><span class="o">-</span><span class="n">GPG</span><span class="o">-</span><span class="k">KEY</span><span class="o">-</span><span class="n">fedora</span><span class="o">-</span><span class="err">$</span><span class="n">releasever</span><span class="o">-</span><span class="err">$</span><span class="n">basearch</span>
<span class="n">skip_if_unavailable</span><span class="o">=</span><span class="k">False</span>
</code></pre></div>

<p>We use yum like <code>yum [OPTIONS] [COMMAND] [PACKAGE_NAME]</code>.</p>
<p>One of the most important options is <code>-y</code> which says <em>yes</em> to the Y/N questions.</p>
<p>And here you can find some of the commands:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>update</td>
<td>Updates the repositories and update the names of packages, or all if nothing is named</td>
</tr>
<tr>
<td>install</td>
<td>Install a package</td>
</tr>
<tr>
<td>reinstall</td>
<td>Reinstall a package</td>
</tr>
<tr>
<td>list</td>
<td>Show a list of packages</td>
</tr>
<tr>
<td>info</td>
<td>Show information about a package</td>
</tr>
<tr>
<td>remove</td>
<td>Removes an installed package</td>
</tr>
<tr>
<td>search</td>
<td>Searches repositories for packages</td>
</tr>
<tr>
<td>provides</td>
<td>Check which packages provide a specific file</td>
</tr>
<tr>
<td>upgrade</td>
<td>Upgrades packages and removes the obsolete ones</td>
</tr>
<tr>
<td>localinstall</td>
<td>Install from a local rpm file</td>
</tr>
<tr>
<td>localupdate</td>
<td>Updates from a local rpm file</td>
</tr>
<tr>
<td>check-update</td>
<td>Checks repositories for updates to the installed packages</td>
</tr>
<tr>
<td>deplist</td>
<td>Shows dependencies of a package</td>
</tr>
<tr>
<td>groupinstall</td>
<td>Install a group, say "KDE Plasma Workspaces"</td>
</tr>
<tr>
<td>history</td>
<td>Show history of the usage</td>
</tr>
</tbody>
</table>
<p>This is a sample installation:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># yum install bzr</span>
<span class="n">Last</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">expiration</span><span class="w"> </span><span class="n">check</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">47</span><span class="w"> </span><span class="n">ago</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">Tue</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="n">Jun</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">06</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="n">PM</span><span class="w"> </span><span class="o">+</span><span class="mf">0430.</span>
<span class="n">Dependencies</span><span class="w"> </span><span class="n">resolved</span><span class="o">.</span>
<span class="o">=====================================================================================================================</span>
<span class="w"> </span><span class="n">Package</span><span class="w">                                  </span><span class="n">Architecture</span><span class="w">       </span><span class="n">Version</span><span class="w">                       </span><span class="n">Repository</span><span class="w">           </span><span class="n">Size</span>
<span class="o">=====================================================================================================================</span>
<span class="n">Installing</span><span class="p">:</span>
<span class="w"> </span><span class="n">breezy</span><span class="w">                                   </span><span class="n">x86_64</span><span class="w">             </span><span class="mf">3.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">              </span><span class="mf">6.0</span><span class="w"> </span><span class="n">M</span>
<span class="n">Installing</span><span class="w"> </span><span class="n">dependencies</span><span class="p">:</span>
<span class="w"> </span><span class="n">libsodium</span><span class="w">                                </span><span class="n">x86_64</span><span class="w">             </span><span class="mf">1.0</span><span class="o">.</span><span class="mi">18</span><span class="o">-</span><span class="mf">9.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">fedora</span><span class="w">              </span><span class="mi">163</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">bcrypt</span><span class="w">                           </span><span class="n">x86_64</span><span class="w">             </span><span class="mf">3.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">updates</span><span class="w">              </span><span class="mi">43</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">certifi</span><span class="w">                          </span><span class="n">noarch</span><span class="w">             </span><span class="mf">2021.10</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="w">              </span><span class="n">fedora</span><span class="w">               </span><span class="mi">15</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">configobj</span><span class="w">                        </span><span class="n">noarch</span><span class="w">             </span><span class="mf">5.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">27.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">fedora</span><span class="w">               </span><span class="mi">63</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">cryptography</span><span class="w">                     </span><span class="n">x86_64</span><span class="w">             </span><span class="mf">36.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">fedora</span><span class="w">              </span><span class="mf">1.0</span><span class="w"> </span><span class="n">M</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">dulwich</span><span class="w">                          </span><span class="n">x86_64</span><span class="w">             </span><span class="mf">0.20</span><span class="o">.</span><span class="mi">32</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="w">                </span><span class="n">fedora</span><span class="w">              </span><span class="mi">408</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">httplib2</span><span class="w">                         </span><span class="n">noarch</span><span class="w">             </span><span class="mf">0.20</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">fedora</span><span class="w">              </span><span class="mi">122</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jeepney</span><span class="w">                          </span><span class="n">noarch</span><span class="w">             </span><span class="mf">0.7</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">              </span><span class="mi">324</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="w">                              </span><span class="n">noarch</span><span class="w">             </span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">updates</span><span class="w">              </span><span class="mi">41</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">keyring</span><span class="w">                          </span><span class="n">noarch</span><span class="w">             </span><span class="mf">23.6</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">updates</span><span class="w">              </span><span class="mi">78</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">restfulclient</span><span class="w">               </span><span class="n">noarch</span><span class="w">             </span><span class="mf">0.14</span><span class="o">.</span><span class="mi">4</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">fedora</span><span class="w">               </span><span class="mi">84</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">uri</span><span class="w">                         </span><span class="n">noarch</span><span class="w">             </span><span class="mf">1.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">               </span><span class="mi">33</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="w">                         </span><span class="n">noarch</span><span class="w">             </span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">fedora</span><span class="w">              </span><span class="mi">169</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">paramiko</span><span class="w">                         </span><span class="n">noarch</span><span class="w">             </span><span class="mf">2.11</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">updates</span><span class="w">             </span><span class="mi">303</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">patiencediff</span><span class="w">                     </span><span class="n">x86_64</span><span class="w">             </span><span class="mf">0.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">               </span><span class="mi">45</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pynacl</span><span class="w">                           </span><span class="n">x86_64</span><span class="w">             </span><span class="mf">1.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">5.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">              </span><span class="mi">108</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">secretstorage</span><span class="w">                    </span><span class="n">noarch</span><span class="w">             </span><span class="mf">3.3</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">               </span><span class="mi">35</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">wadllib</span><span class="w">                          </span><span class="n">noarch</span><span class="w">             </span><span class="mf">1.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">               </span><span class="mi">60</span><span class="w"> </span><span class="n">k</span>
<span class="n">Installing</span><span class="w"> </span><span class="n">weak</span><span class="w"> </span><span class="n">dependencies</span><span class="p">:</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">+</span><span class="n">crypto</span><span class="w">                       </span><span class="n">noarch</span><span class="w">             </span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">updates</span><span class="w">             </span><span class="mf">8.9</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">launchpadlib</span><span class="w">                     </span><span class="n">noarch</span><span class="w">             </span><span class="mf">1.10</span><span class="o">.</span><span class="mf">15.1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="w">              </span><span class="n">fedora</span><span class="w">              </span><span class="mi">167</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">+</span><span class="n">signedtoken</span><span class="w">             </span><span class="n">noarch</span><span class="w">             </span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="w">                 </span><span class="n">fedora</span><span class="w">              </span><span class="mf">8.5</span><span class="w"> </span><span class="n">k</span>
<span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pyasn1</span><span class="w">                           </span><span class="n">noarch</span><span class="w">             </span><span class="mf">0.4</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">8.</span><span class="n">fc36</span><span class="w">                  </span><span class="n">fedora</span><span class="w">              </span><span class="mi">134</span><span class="w"> </span><span class="n">k</span>

<span class="n">Transaction</span><span class="w"> </span><span class="n">Summary</span>
<span class="o">=====================================================================================================================</span>
<span class="n">Install</span><span class="w">  </span><span class="mi">23</span><span class="w"> </span><span class="n">Packages</span>

<span class="n">Total</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">size</span><span class="p">:</span><span class="w"> </span><span class="mf">9.4</span><span class="w"> </span><span class="n">M</span>
<span class="n">Installed</span><span class="w"> </span><span class="n">size</span><span class="p">:</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="n">M</span>
<span class="n">Is</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="p">[</span><span class="n">y</span><span class="o">/</span><span class="n">N</span><span class="p">]:</span><span class="w"> </span><span class="n">y</span>
<span class="n">Downloading</span><span class="w"> </span><span class="n">Packages</span><span class="p">:</span>
<span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">certifi</span><span class="o">-</span><span class="mf">2021.10</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                  </span><span class="mf">1.8</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">15</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">08</span>
<span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">libsodium</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">18</span><span class="o">-</span><span class="mf">9.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                            </span><span class="mi">15</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">163</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span>
<span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">configobj</span><span class="o">-</span><span class="mf">5.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">27.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                    </span><span class="mi">10</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">63</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">06</span>
<span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">breezy</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                               </span><span class="mi">262</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">6.0</span><span class="w"> </span><span class="n">MB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">23</span>
<span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">dulwich</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">32</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                     </span><span class="mi">47</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">408</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">08</span>
<span class="p">(</span><span class="mi">6</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">cryptography</span><span class="o">-</span><span class="mf">36.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                 </span><span class="mi">77</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="n">MB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">13</span>
<span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">httplib2</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                    </span><span class="mi">105</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">122</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span>
<span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jeepney</span><span class="o">-</span><span class="mf">0.7</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                      </span><span class="mi">259</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">324</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span>
<span class="p">(</span><span class="mi">9</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">launchpadlib</span><span class="o">-</span><span class="mf">1.10</span><span class="o">.</span><span class="mf">15.1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                              </span><span class="mi">74</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">167</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">restfulclient</span><span class="o">-</span><span class="mf">0.14</span><span class="o">.</span><span class="mi">4</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                          </span><span class="mi">36</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">84</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">uri</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                     </span><span class="mi">15</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">33</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">+</span><span class="n">signedtoken</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                       </span><span class="mf">4.2</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">8.5</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">13</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                    </span><span class="mi">58</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">169</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">14</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">patiencediff</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                 </span><span class="mi">15</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">45</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">15</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pyasn1</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">8.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                       </span><span class="mi">61</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">134</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pynacl</span><span class="o">-</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">5.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                       </span><span class="mi">36</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">108</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">03</span>
<span class="p">(</span><span class="mi">17</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">secretstorage</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                </span><span class="mi">12</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">35</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">18</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">wadllib</span><span class="o">-</span><span class="mf">1.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                      </span><span class="mi">24</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">60</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">19</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">bcrypt</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                       </span><span class="mi">16</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">43</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">20</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">+</span><span class="n">crypto</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                  </span><span class="mf">3.2</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">8.9</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">21</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                          </span><span class="mi">16</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">41</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="p">(</span><span class="mi">22</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">keyring</span><span class="o">-</span><span class="mf">23.6</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                     </span><span class="mi">18</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">78</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">04</span>
<span class="p">(</span><span class="mi">23</span><span class="o">/</span><span class="mi">23</span><span class="p">):</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">paramiko</span><span class="o">-</span><span class="mf">2.11</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span><span class="w">                                    </span><span class="mi">38</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">303</span><span class="w"> </span><span class="n">kB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">08</span>
<span class="o">---------------------------------------------------------------------------------------------------------------------</span>
<span class="n">Total</span><span class="w">                                                                                </span><span class="mi">177</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">9.4</span><span class="w"> </span><span class="n">MB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">54</span>
<span class="n">Running</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="n">check</span>
<span class="n">Transaction</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">succeeded</span><span class="o">.</span>
<span class="n">Running</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="n">test</span>
<span class="n">Transaction</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">succeeded</span><span class="o">.</span>
<span class="n">Running</span><span class="w"> </span><span class="n">transaction</span>
<span class="w">  </span><span class="n">Preparing</span><span class="w">        </span><span class="p">:</span><span class="w">                                                                                             </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">cryptography</span><span class="o">-</span><span class="mf">36.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                  </span><span class="mi">1</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">uri</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                       </span><span class="mi">2</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jeepney</span><span class="o">-</span><span class="mf">0.7</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                        </span><span class="mi">3</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">httplib2</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                      </span><span class="mi">4</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">secretstorage</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                  </span><span class="mi">5</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">keyring</span><span class="o">-</span><span class="mf">23.6</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                       </span><span class="mi">6</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">wadllib</span><span class="o">-</span><span class="mf">1.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                        </span><span class="mi">7</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                            </span><span class="mi">8</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">+</span><span class="n">crypto</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                     </span><span class="mi">9</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                     </span><span class="mi">10</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">+</span><span class="n">signedtoken</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                         </span><span class="mi">11</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">restfulclient</span><span class="o">-</span><span class="mf">0.14</span><span class="o">.</span><span class="mi">4</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                           </span><span class="mi">12</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">launchpadlib</span><span class="o">-</span><span class="mf">1.10</span><span class="o">.</span><span class="mf">15.1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                              </span><span class="mi">13</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">bcrypt</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                        </span><span class="mi">14</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pyasn1</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">8.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                        </span><span class="mi">15</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">patiencediff</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                  </span><span class="mi">16</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">configobj</span><span class="o">-</span><span class="mf">5.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">27.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                    </span><span class="mi">17</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">certifi</span><span class="o">-</span><span class="mf">2021.10</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                   </span><span class="mi">18</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">dulwich</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">32</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                     </span><span class="mi">19</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">libsodium</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">18</span><span class="o">-</span><span class="mf">9.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                            </span><span class="mi">20</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pynacl</span><span class="o">-</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">5.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                        </span><span class="mi">21</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">paramiko</span><span class="o">-</span><span class="mf">2.11</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                     </span><span class="mi">22</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Installing</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="n">breezy</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                                </span><span class="mi">23</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Running</span><span class="w"> </span><span class="n">scriptlet</span><span class="p">:</span><span class="w"> </span><span class="n">breezy</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                                </span><span class="mi">23</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">breezy</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                                 </span><span class="mi">1</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">libsodium</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">18</span><span class="o">-</span><span class="mf">9.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                             </span><span class="mi">2</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">certifi</span><span class="o">-</span><span class="mf">2021.10</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                    </span><span class="mi">3</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">configobj</span><span class="o">-</span><span class="mf">5.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">27.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                     </span><span class="mi">4</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">cryptography</span><span class="o">-</span><span class="mf">36.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                  </span><span class="mi">5</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">dulwich</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">32</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                      </span><span class="mi">6</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">httplib2</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                      </span><span class="mi">7</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jeepney</span><span class="o">-</span><span class="mf">0.7</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                        </span><span class="mi">8</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">launchpadlib</span><span class="o">-</span><span class="mf">1.10</span><span class="o">.</span><span class="mf">15.1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                               </span><span class="mi">9</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">restfulclient</span><span class="o">-</span><span class="mf">0.14</span><span class="o">.</span><span class="mi">4</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                           </span><span class="mi">10</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">uri</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                      </span><span class="mi">11</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">+</span><span class="n">signedtoken</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                         </span><span class="mi">12</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                     </span><span class="mi">13</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">patiencediff</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                  </span><span class="mi">14</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pyasn1</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">8.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                        </span><span class="mi">15</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pynacl</span><span class="o">-</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">5.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                        </span><span class="mi">16</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">secretstorage</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                 </span><span class="mi">17</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">wadllib</span><span class="o">-</span><span class="mf">1.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                       </span><span class="mi">18</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">bcrypt</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                                        </span><span class="mi">19</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">+</span><span class="n">crypto</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                    </span><span class="mi">20</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                           </span><span class="mi">21</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">keyring</span><span class="o">-</span><span class="mf">23.6</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                      </span><span class="mi">22</span><span class="o">/</span><span class="mi">23</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">paramiko</span><span class="o">-</span><span class="mf">2.11</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                                                     </span><span class="mi">23</span><span class="o">/</span><span class="mi">23</span>

<span class="n">Installed</span><span class="p">:</span>
<span class="w">  </span><span class="n">breezy</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                 </span><span class="n">libsodium</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">18</span><span class="o">-</span><span class="mf">9.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">bcrypt</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                         </span><span class="n">python3</span><span class="o">-</span><span class="n">certifi</span><span class="o">-</span><span class="mf">2021.10</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">configobj</span><span class="o">-</span><span class="mf">5.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">27.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                     </span><span class="n">python3</span><span class="o">-</span><span class="n">cryptography</span><span class="o">-</span><span class="mf">36.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">dulwich</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">32</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                      </span><span class="n">python3</span><span class="o">-</span><span class="n">httplib2</span><span class="o">-</span><span class="mf">0.20</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">jeepney</span><span class="o">-</span><span class="mf">0.7</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                        </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">jwt</span><span class="o">+</span><span class="n">crypto</span><span class="o">-</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                     </span><span class="n">python3</span><span class="o">-</span><span class="n">keyring</span><span class="o">-</span><span class="mf">23.6</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">launchpadlib</span><span class="o">-</span><span class="mf">1.10</span><span class="o">.</span><span class="mf">15.1</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">               </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">restfulclient</span><span class="o">-</span><span class="mf">0.14</span><span class="o">.</span><span class="mi">4</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">lazr</span><span class="o">-</span><span class="n">uri</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">                       </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">oauthlib</span><span class="o">+</span><span class="n">signedtoken</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">12.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span><span class="w">          </span><span class="n">python3</span><span class="o">-</span><span class="n">paramiko</span><span class="o">-</span><span class="mf">2.11</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">patiencediff</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                   </span><span class="n">python3</span><span class="o">-</span><span class="n">pyasn1</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">8.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">pynacl</span><span class="o">-</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">5.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                         </span><span class="n">python3</span><span class="o">-</span><span class="n">secretstorage</span><span class="o">-</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">4.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>
<span class="w">  </span><span class="n">python3</span><span class="o">-</span><span class="n">wadllib</span><span class="o">-</span><span class="mf">1.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="mf">2.</span><span class="n">fc36</span><span class="o">.</span><span class="n">noarch</span>

<span class="n">Complete</span><span class="o">!</span>
</code></pre></div>

<p>You can also use the wildcards:</p>
<div class="highlight"><pre><span></span><code># yum update &#39;cal*&#39;
</code></pre></div>

<blockquote>
<p>Fun fact: Fedora Linux uses <code>dnf</code> as its package manager and will translate your <code>yum</code> commands to its <code>dnf</code> equivalents.</p>
</blockquote>
<h3>yumdownloader</h3>
<p>This tool will download rpms from repositories without installing them. If you need to download all the dependencies too, use the <code>--resolve</code> switch:</p>
<div class="highlight"><pre><span></span><code>yumdownloader --resolve bzr
</code></pre></div>

<h2>RPM</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/0E_EuBUSuz4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>The <code>rpm</code> command can run ACTIONs on individual RPM files. You can use it like <code>rpm ACTION [OPTION] rpm_file.rpm</code></p>
<p>One of common options is <code>-v</code> for verbose output and these are the common ACTIONs:</p>
<table>
<thead>
<tr>
<th>Short Form</th>
<th>Long Form</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-i</td>
<td>--install</td>
<td>Installs a package</td>
</tr>
<tr>
<td>-e</td>
<td>--erase</td>
<td>Removes a package</td>
</tr>
<tr>
<td>-U</td>
<td>--upgrade</td>
<td>Installs/Upgrades a package</td>
</tr>
<tr>
<td>-q</td>
<td>--query</td>
<td>Checks if the package is installed</td>
</tr>
<tr>
<td>-F</td>
<td>--freshen</td>
<td>Only update if it's already installed</td>
</tr>
<tr>
<td>-V</td>
<td>--verify</td>
<td>Check the integrity of the installation</td>
</tr>
<tr>
<td>-K</td>
<td>--checksig</td>
<td>Checks the integrity of an rpm package</td>
</tr>
</tbody>
</table>
<p>Please note that each action might have its specific options.</p>
<h3>Install and update</h3>
<p>In most cases, we use <code>-U</code> which Installs or upgrades a package. </p>
<ul>
<li>RPM does not have a database of automatic package installation, so it can not remove the automatically installed dependencies.</li>
</ul>
<p>If you have an rpm with all of its dependencies, you can install them using <code>rpm -Uvh *.rpm</code>. This will tell rpm not to complain about the dependencies if it is presented in other files. Here the <code>-h</code> creates 50 hash signs to show the progress.</p>
<p>In some cases - if you know what you are doing - you can use <code>--nodeps</code> to prevent the dependency check or even use <code>--force</code> to force the install / upgrade despite all the issues &amp; complains.</p>
<h3>Query</h3>
<p>A normal query is like this:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@fedora tmp</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">rpm</span><span class="w"> </span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="n">breezy</span><span class="o">-</span><span class="mf">3.2.1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="p">.</span><span class="n">x86_64</span><span class="p">.</span><span class="n">rpm</span>
<span class="n">breezy</span><span class="o">-</span><span class="mf">3.2.1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="p">.</span><span class="n">x86_64</span>
<span class="o">[</span><span class="n">root@fedora tmp</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">rpm</span><span class="w"> </span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="n">breezy</span>
<span class="n">breezy</span><span class="o">-</span><span class="mf">3.2.1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="p">.</span><span class="n">x86_64</span>
<span class="o">[</span><span class="n">root@fedora tmp</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">rpm</span><span class="w"> </span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="n">emacs</span>
<span class="n">package</span><span class="w"> </span><span class="n">emacs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">installed</span>
</code></pre></div>

<p>And you can use these options to spice it up:</p>
<table>
<thead>
<tr>
<th>Short</th>
<th>Long</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-c</td>
<td>--configfiles</td>
<td>Show the packages configuration files</td>
</tr>
<tr>
<td>-i</td>
<td>--info</td>
<td>Detailed info about a pacakge</td>
</tr>
<tr>
<td>-a</td>
<td>--all</td>
<td>Show all Installed packages</td>
</tr>
<tr>
<td></td>
<td>--whatprovides</td>
<td>Shows what packages provide this file</td>
</tr>
<tr>
<td>-l</td>
<td>--list</td>
<td>Query the list of files a package installs</td>
</tr>
<tr>
<td>-R</td>
<td>--requires</td>
<td>Show dependencies of a package</td>
</tr>
<tr>
<td>-f</td>
<td>--file</td>
<td>Query package owning file</td>
</tr>
</tbody>
</table>
<h3>Verify</h3>
<p>You can verify your packages and see if they are installed correctly or not. You can use the <code>-Vv</code> option for verbose output or just use the <code>-V</code> to verify and see only the issues. This is the output after I edited the <code>/bin/tmux</code> manually:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@fedora tmp</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">rpm</span><span class="w"> </span><span class="o">-</span><span class="n">V</span><span class="w"> </span><span class="n">tmux</span>
<span class="n">S</span><span class="mf">.5</span><span class="p">....</span><span class="n">T</span><span class="p">.</span><span class="w">    </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">tmux</span>
</code></pre></div>

<p>And this is part of the <code>man rpm</code>'s <code>-V</code> section:</p>
<div class="highlight"><pre><span></span><code>    S Size differs
    M Mode differs (includes permissions and file type)
    5 digest (formerly MD5 sum) differs
    D Device major/minor number mismatch
    L readLink(2) path mismatch
    U User ownership differs
    G Group ownership differs
    T mTime differs
    P caPabilities differ
</code></pre></div>

<p>You can also check the integrity of an rpm package with <code>-K</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># rpm -Kv breezy-3.2.1-3.fc36.x86_64.rpm</span>
<span class="n">breezy</span><span class="o">-</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mf">3.</span><span class="n">fc36</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="p">:</span>
<span class="w">    </span><span class="n">Header</span><span class="w"> </span><span class="n">V4</span><span class="w"> </span><span class="n">RSA</span><span class="o">/</span><span class="n">SHA256</span><span class="w"> </span><span class="n">Signature</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="mi">38</span><span class="n">ab71f4</span><span class="p">:</span><span class="w"> </span><span class="n">OK</span>
<span class="w">    </span><span class="n">Header</span><span class="w"> </span><span class="n">SHA256</span><span class="w"> </span><span class="n">digest</span><span class="p">:</span><span class="w"> </span><span class="n">OK</span>
<span class="w">    </span><span class="n">Header</span><span class="w"> </span><span class="n">SHA1</span><span class="w"> </span><span class="n">digest</span><span class="p">:</span><span class="w"> </span><span class="n">OK</span>
<span class="w">    </span><span class="n">Payload</span><span class="w"> </span><span class="n">SHA256</span><span class="w"> </span><span class="n">digest</span><span class="p">:</span><span class="w"> </span><span class="n">OK</span>
<span class="w">    </span><span class="n">V4</span><span class="w"> </span><span class="n">RSA</span><span class="o">/</span><span class="n">SHA256</span><span class="w"> </span><span class="n">Signature</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="mi">38</span><span class="n">ab71f4</span><span class="p">:</span><span class="w"> </span><span class="n">OK</span>
<span class="w">    </span><span class="n">MD5</span><span class="w"> </span><span class="n">digest</span><span class="p">:</span><span class="w"> </span><span class="n">OK</span>
</code></pre></div>

<p>The above output shows that this file is valid.</p>
<h3>Uninstall</h3>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@fedora tmp</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">rpm</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">tmux</span>
<span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="nl">dependencies</span><span class="p">:</span>
<span class="w">    </span><span class="n">tmux</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="p">(</span><span class="n">installed</span><span class="p">)</span><span class="w"> </span><span class="n">anaconda</span><span class="o">-</span><span class="n">install</span><span class="o">-</span><span class="n">env</span><span class="o">-</span><span class="n">deps</span><span class="o">-</span><span class="mf">36.16.5</span><span class="o">-</span><span class="mf">1.</span><span class="n">fc36</span><span class="p">.</span><span class="n">x86_64</span>
</code></pre></div>

<ul>
<li>rpm removes the package without asking!</li>
<li>rpm won't remove a package that is needed by another package</li>
</ul>
<h3>Extract RPM Files</h3>
<h4>rpm2cpio</h4>
<p>The <strong>cpio</strong> is an archive format (Just like zip or rar or tar). You can use the <code>rpm2cpio</code> command to convert RPM files to <em>cpio</em> and then use the <code>cpio</code> tool to extract them:</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">fedora</span><span class="w"> </span><span class="n">tmp</span><span class="p">]</span><span class="c1"># rpm2cpio breezy-3.2.1-3.fc36.x86_64.rpm &gt; breezy.cpio</span>
<span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">fedora</span><span class="w"> </span><span class="n">tmp</span><span class="p">]</span><span class="c1"># cpio -idv &lt; breezy.cpio</span>
<span class="o">./</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">brz</span>
<span class="o">./</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bzr</span>
<span class="o">./</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bzr</span><span class="o">-</span><span class="n">receive</span><span class="o">-</span><span class="n">pack</span>
<span class="o">./</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bzr</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">pack</span>
<span class="o">./</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">git</span><span class="o">-</span><span class="k">remote</span><span class="o">-</span><span class="n">brz</span>
<span class="o">./</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">git</span><span class="o">-</span><span class="k">remote</span><span class="o">-</span><span class="n">bzr</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
</code></pre></div>

<h2>Zypper</h2>
<p>The SUSE Linux and its sibling openSUSE use ZYpp as their package manager engine. You can use YAST or Zypper tools to communicate with it. </p>
<p>These are the main commands used in <code>zypper</code>:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>help</td>
<td>General help</td>
</tr>
<tr>
<td>install</td>
<td>Installs a package</td>
</tr>
<tr>
<td>info</td>
<td>Displays information of a package</td>
</tr>
<tr>
<td>list-updates</td>
<td>Shows available updates</td>
</tr>
<tr>
<td>lr</td>
<td>Shows repository information</td>
</tr>
<tr>
<td>packages</td>
<td>List all available packages or packages from a specific repo</td>
</tr>
<tr>
<td>what-provides</td>
<td>Show the owner of a file</td>
</tr>
<tr>
<td>refresh</td>
<td>Refreshes the repositories information</td>
</tr>
<tr>
<td>remove</td>
<td>Removes a package from the system</td>
</tr>
<tr>
<td>search</td>
<td>Searches for a package</td>
</tr>
<tr>
<td>update</td>
<td>Checks the repositories and updates the installed packages</td>
</tr>
<tr>
<td>verify</td>
<td>Checks a package and its dependencies</td>
</tr>
</tbody>
</table>
<blockquote>
<p>You can shorten the command when using <code>zypper</code>, so <code>zypper se tmux</code> will <em>search</em> for tmux.</p>
</blockquote>
<h2>Other tools</h2>
<p>YUM and RPM are the main package managers on Fedora, RHEL &amp; Centos but other tools are also available. As mentioned, SUSE uses <code>YaST</code>, and some modern desktops (KDE &amp; Gnome) use <code>PackageKit</code> which is a graphical tool. It is also good to note that the <code>dnf</code> suite is also gaining popularity and is pre-installed on Fedora systems.</p>
                                            <br clear="both" />
                                            <h1>102.6 Linux as a virtualization guest</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 1</em></p>
<p>Candidates should understand the implications of virtualization and cloud computing on a Linux guest system.</p>
<h2>Key Knowledge Areas</h2>
<ul>
<li>Understand the general concept of virtual machines and containers</li>
<li>Understand common elements of virtual machines in an IaaS cloud, such as computing instances, block storage, and networking</li>
<li>Understand the unique properties of a Linux system which have to be changed when a system is cloned or used as a template</li>
<li>Understand how system images are used to deploy virtual machines, cloud instances, and containers</li>
<li>Understand Linux extensions that integrate Linux with a virtualization product.
Awareness of cloud-init</li>
</ul>
<h3>Terms</h3>
<ul>
<li>Virtual machine</li>
<li>Linux container</li>
<li>Application container</li>
<li>Guest drivers</li>
<li>SSH host keys</li>
<li>D-Bus machine id</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/F3yl5Lx1htc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>Introduction</h2>
<p>Virtual machines (VMs) are <em>simulated</em> computers. You can use Virtual Machines to create new computers on top of your running machine and install new OSs there. In some cases, it's also possible to run only parts of an OS on top of the current OS; This is called having containers. </p>
<p>To run virtual machines, we need <strong>Hypervisor</strong> software (also called Virtual Machine Managers (VMM)). We have two types of hypervisors.</p>
<p>To check and see if your host operating system / CPU, supports using hypervisors check for the <code>vmx</code> (for Intel CPUs) or <code>svm</code> (for AMD CPUs) in your <code>/proc/cpuinfo</code> in flags. </p>
<blockquote>
<p>You may need to turn the hypervisor option On using your BIOS or UEFI.</p>
</blockquote>
<p>Based on your CPU you should have <code>kvm</code> or <code>kvm-amd</code> kernel modules loaded. </p>
<div class="highlight"><pre><span></span><code>lsmod | grep -i kvm
sudo modprobe kvm
</code></pre></div>

<blockquote>
<p>If you see <code>hypervisor</code> in your <code>/proc/cpuinfo</code> it means that you are inside a virtualized Linux machine :)</p>
</blockquote>
<p>Now, let's see the 2 types of hypervisors. First type 2, since it's easier to understand. </p>
<p><img alt="Types of hypervisors" src="images/hypervisor.png"></p>
<h3>Type 2 Hypervisor</h3>
<p>These hypervisors run on a conventional operating system (OS) just as other computer programs do. A guest operating system runs as a process on the host. Type-2 hypervisors abstract guest operating systems from the host operating system.</p>
<p>In other words, a type 2 hypervisor is the software between the guest and host. It completely runs on the host OS and provides virtualization to the guest. </p>
<p>Two of the most famous Type 2 hypervisors are VirtualBox (from Oracle) and VMware.</p>
<h3>Type 1 Hypervisor</h3>
<p>These hypervisors run directly on the host's hardware to control the hardware and manage guest operating systems. For this reason, they are sometimes called bare-metal hypervisors. The first hypervisors, which IBM developed in the 1960s, were native hypervisors. These included the test software SIMMON and the CP/CMS operating system, the predecessor of IBM z/VM.</p>
<p>Some of the most famous Type 1 hypervisors are KVM, Xen &amp; Hyper-V. <strong>KVM</strong> is built-in since Linux Kernel version 2.6.20. </p>
<h2>Creating a Virtual Machine</h2>
<p>First, create the machine itself. We tell the hypervisor this machine how much RAM/disk/CPU/... needs and set a name for our machine. Then we need to <em>install</em> the guest OS. This can be done using:</p>
<ul>
<li>Installing from a CD / DVD / ... </li>
<li><strong>Cloning</strong> an existing machine</li>
<li>Using <strong>Open Virtualization Format (OVF)</strong> to move machines between hypervisors. This is a standard format for virtual machine definition and may include several files, in this case, you can archive all of them into one <strong>Open Virtualization Archive (OVA)</strong> file.</li>
<li>It is also possible to create <strong>Templates</strong> that are <em>master copies</em>* to initiate new machines</li>
</ul>
<blockquote>
<p>You may need to install some <em>guest drivers</em> or <em>additions</em> to help your hypervisor to have better control over your guest machine. These might include graphical drivers for VirtualBox or scripts to help VMWare to control a guest machine or check its status. </p>
</blockquote>
<h2>Guest-specific configs</h2>
<p>Some configurations are machine specific. For example, a network card's MAC address should be unique for whole the network. If we are cloning a machine or sometimes creating them from templates, at least we need to change these on each machine before booting them:</p>
<ul>
<li>Host Name</li>
<li>NIC MAC Address</li>
<li>NIC IP (If not using DHCP)</li>
<li>Machine ID (delete the <code>/etc/machine-id</code> and <code>/var/lib/dbus/machine-id</code> and run <code>dbus-uuidgen --ensure</code>. These two files might be soft links to each other)</li>
<li>Encryption Keys like SSH Fingerprints and PGP keys</li>
<li>HDD UUIDs</li>
<li>Any other UUIDs on the system</li>
</ul>
<blockquote>
<p>Some configs might be empty on templates, do not forget to fill them too.</p>
</blockquote>
<h2>Containers</h2>
<p><img alt="Containers" src="/images/containers.png"></p>
<p>In previous sections, we were dealing with complete guest OSs. But is also possible to virtualize only parts of an OS; This is called OS-level virtualization. </p>
<p>OS-level virtualization is an operating system (OS) paradigm in which the kernel allows the existence of multiple isolated user-space instances, called containers. </p>
<p>This can be done to run an application or a service or even run most parts of a new OS for test purposes. </p>
<h2>IaaS</h2>
<p>As the name implies, <strong>Infrastructure as a Service</strong> or IaaS means offloading parts of your infrastructure to other companies. This means buying <em>services</em> like electricity, cooling, and even running hypervisors to another company and just renting your VirtualMachine from them. This makes your life easier because things like "Adding New Hards" now only mean paying a bit more for more HDD on your machine; Instead of buying HDDs and installing them, ... This is called cloud! You might even be able to move your machine from one continent to another one just with one click. </p>
<p>Samples of these cloud providers are <a href="(https://aws.amazon.com/)">Amazon Web Services</a>, <a href="(https://cloud.google.com/)">Google Cloud Platform</a>, and <a href="(https://azure.microsoft.com/en-us/)">Microsoft Azure</a>.</p>
<p>Different cloud providers might provide different levels of Infrastructure or services. These are some examples:</p>
<ul>
<li>Load Balancing: Distribute incoming requests between your servers</li>
<li>Block Storage: Providing disks to be configured by you and added to your machines</li>
<li>Object Storage: Lets you store your data directly; Say for photos</li>
<li>Elasticity: Lets you configure an automated increase/decrease in your service capacity based on request volume</li>
<li>SaaS: Software as a Service lets you use the software you need, on the Cloud as a Service. Think of having an online office suite for your company without installing anything on your workstations.</li>
</ul>
<p>There are programs like <code>cloud-init</code> which help you initialize your cloud machine with ease. This service can help you start machines based on templates on AWS, Azure, Digital Ocean, and others with ease.</p>
                                            <br clear="both" />
                                            <h1>103.1 Work on the command line</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Description: Candidates should be able to interact with shells and commands using the command line. The objective assumes the Bash shell.</p>
<h2>Objectives</h2>
<ul>
<li>Use single shell commands and one-line command sequences to perform basic tasks on the command line.</li>
<li>Use and modify the shell environment including defining, referencing, and exporting environment variables.</li>
<li>Use and edit command history.</li>
<li>Invoke commands inside and outside the defined path.</li>
</ul>
<h2>Terms</h2>
<ul>
<li>bash</li>
<li>echo</li>
<li>env</li>
<li>export</li>
<li>pwd</li>
<li>set</li>
<li>unset</li>
<li>type</li>
<li>which</li>
<li>man</li>
<li>uname</li>
<li>history</li>
<li><code>.bash_history</code></li>
<li>Quoting</li>
</ul>
<h3>Shells and Bash</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/X-zq9-FhjOA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>You issue your commands in a shell; it's your command line interface and you have various options for it. To reach your shell you should login into the system in the text mode or run one of the various <em>Terminal Emulators</em> in your GUI. Some samples are <code>gnome-terminal</code>, <code>konsole</code>, <code>xterm</code>, etc.</p>
<p>After running the Terminal Emulator or logging into the text mode, you are in the shell and you can issue commands. Although <code>bash</code> (GNU Bourne Again shell) is the most common one, you might use <code>zsh</code>, <code>dash</code>, <code>ksh</code>, <code>csh</code>, and others.</p>
<p>You can check where your general <code>sh</code> command links to via</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>readlink<span class="w"> </span>/bin/sh
</code></pre></div>

<p>Or check your <code>$SHELL</code> variable using:</p>
<div class="highlight"><pre><span></span><code>echo $SHELL
</code></pre></div>

<p>Your bash has some <em>internal</em> commands that it understands without any external dependency (say <code>cd</code>, <code>break</code>, <code>exec</code>, ...) but if it does not understand something internally, it will try to run it as an external executable.</p>
<p>You can use the <code>type</code> command to determine this:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">cd</span>
<span class="n">cd</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">builtin</span>
<span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">ls</span>
<span class="n">ls</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">aliased</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="err">`</span><span class="n">ls</span><span class="w"> </span><span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="n">auto</span><span class="err">&#39;</span>
<span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">ping</span>
<span class="n">ping</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ping</span>
</code></pre></div>

<h2>cd, pwd &amp; uname</h2>
<h3>cd</h3>
<p>You've already seen lots of <code>cd</code> commands :) it <em>changes directory</em>, including <code>.</code> (current directory) and <code>..</code> (parent directory). </p>
<p>You can point to directories in two ways:</p>
<ol>
<li><strong>Absolute Paths</strong>: Like <code>/home/jadi/lpic1/lesson3.1</code></li>
<li><strong>Relative Paths</strong>: Like <code>lpic1/lesson3.1</code>. In this case, we are not adding the <code>/</code> in the beginning so the bash will try to find <code>lpic1</code> directory where we are (local / relative)</li>
</ol>
<blockquote>
<p>The <code>~</code> characters means <em>home directory of the user issuing the command</em></p>
</blockquote>
<p>It is also possible to issue the <code>cd</code> without any parameters. It will move you to your home directory. So these 3 commands are all equal:</p>
<div class="highlight"><pre><span></span><code>cd
cd ~
cd $HOME
</code></pre></div>

<h3>pwd</h3>
<p>Will show you your current directory:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">jadi@fedora lesson3.1</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">pwd</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="n">lpic1</span><span class="o">/</span><span class="n">lesson3</span><span class="mf">.1</span>
</code></pre></div>

<h3>uname</h3>
<p>Gives you data about the system. Common switches are:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Option</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-s</td>
<td style="text-align: left;">Print the kernel name. This is the default if no option is specified.</td>
</tr>
<tr>
<td style="text-align: left;">-n</td>
<td style="text-align: left;">Print the nodename or hostname.</td>
</tr>
<tr>
<td style="text-align: left;">-r</td>
<td style="text-align: left;">Print the release of the kernel. This option is often used with module-handling commands.</td>
</tr>
<tr>
<td style="text-align: left;">-v</td>
<td style="text-align: left;">Print the version of the kernel.</td>
</tr>
<tr>
<td style="text-align: left;">-m</td>
<td style="text-align: left;">Print the machine's hardware (CPU) name.</td>
</tr>
<tr>
<td style="text-align: left;">-o</td>
<td style="text-align: left;">Print the operating system name.</td>
</tr>
<tr>
<td style="text-align: left;">-a</td>
<td style="text-align: left;">Print all of the above information.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>[jadi@fedora lesson3.1]$ uname -a
Linux fedora 5.14.0-60.fc35.aarch64 #1 SMP Mon Aug 30 16:30:42 UTC 2021 aarch64 aarch64 aarch64 GNU/Linux
</code></pre></div>

<h2>Getting Help</h2>
<p>Most of the commands we use do have a cool and complete manual, accessible via the <code>man</code> command. It uses the <code>less</code> pager by default and contains the documentation, switches, parameters, ... of commands, and utilities. </p>
<p>Make yourself familiar with the man by reading the manual of the <code>yes</code> command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>man<span class="w"> </span>yes
</code></pre></div>

<p>Please note that man pages are categorized in different sections (books). You can check these by reading the man's manual:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>man<span class="w"> </span>man
$<span class="w"> </span>man<span class="w"> </span><span class="m">5</span><span class="w"> </span>passwd
</code></pre></div>

<p>`</p>
<h2>Special characters and Quoting/Escaping</h2>
<p>In the computer world, some characters do have special meanings. For example in bash, the <code>*</code> character will expand to all files. In these cases, if you want to use this character without this expansion, you have to <em>Quote</em> it or <em>Escape</em> it. In many cases this is done via adding a <code>\</code> character before it:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="se">\*</span><span class="w"> </span><span class="nv">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>
<span class="m">2</span><span class="w"> </span>*<span class="w"> </span><span class="nv">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>
</code></pre></div>

<p>These are the character with special meanings that you need to quote if you are using them in your commands:</p>
<p><code>* ?[]'"\$;&amp;()|^&lt;&gt;</code></p>
<p>Please note that there is a space character in the character list above.</p>
<blockquote>
<p>As you can see, the <code>\</code> has a specific meaning so if you want to use the back-slash itself (without its escaping usage), you have to <em>quote</em> your back-slash with another back-slash <code>\\</code>.</p>
</blockquote>
<p>In addition to escaping, you can use <code>\</code> to create some special characters. For example, as you can not type a <em>return</em> character, you create it via <code>\n</code> (new line):</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ echo -e &quot;hello\nthere&quot;
hello
there
</code></pre></div>

<p>Some other cases are:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Escape sequence    Function</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">\a</td>
<td style="text-align: left;">Alert (bell)</td>
</tr>
<tr>
<td style="text-align: left;">\b</td>
<td style="text-align: left;">Backspace</td>
</tr>
<tr>
<td style="text-align: left;">\c</td>
<td style="text-align: left;">Suppress trailing newline (same function as -n option)</td>
</tr>
<tr>
<td style="text-align: left;">\f</td>
<td style="text-align: left;">Form feed (clear the screen on a video display)</td>
</tr>
<tr>
<td style="text-align: left;">\n</td>
<td style="text-align: left;">New line</td>
</tr>
<tr>
<td style="text-align: left;">\r</td>
<td style="text-align: left;">Carriage return</td>
</tr>
<tr>
<td style="text-align: left;">\t</td>
<td style="text-align: left;">Horizontal tab</td>
</tr>
</tbody>
</table>
<p>On bash you can use <code>\</code> to break a command into more lines:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>You<span class="w"> </span>know<span class="w"> </span>slashes!<span class="w"> </span>But<span class="w"> </span>this<span class="w"> </span><span class="se">\</span>
is<span class="w"> </span>another<span class="w"> </span><span class="se">\</span>
usage
You<span class="w"> </span>know<span class="w"> </span>slashes!<span class="w"> </span>But<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>another<span class="w"> </span>usage
</code></pre></div>

<h2>Shell environment variables</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/KMvc1SyPgjw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p><em>Environment Variables</em> contain some configs and information about the shell. For example, your default editor is set in the <code>EDITOR</code> variable. You can query the value of a shell variable like this:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="n">EDITOR</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">nano</span>
</code></pre></div>

<p>It is possible to check all the env variables using the <code>set</code> or <code>env</code> command. </p>
<p>These are some of the most used bash environment variables:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">USER</td>
<td style="text-align: left;">The name of the logged-in user</td>
</tr>
<tr>
<td style="text-align: left;">PATH</td>
<td style="text-align: left;">List of directories to search for commands, colon separated</td>
</tr>
<tr>
<td style="text-align: left;">EDITOR</td>
<td style="text-align: left;">Default editor</td>
</tr>
<tr>
<td style="text-align: left;">HISTFILE</td>
<td style="text-align: left;">Where bash should save its history (normally <code>.bash_history</code>)</td>
</tr>
<tr>
<td style="text-align: left;">HOSTNAME</td>
<td style="text-align: left;">System hostname</td>
</tr>
<tr>
<td style="text-align: left;">PS1</td>
<td style="text-align: left;">The Prompt! Play with it</td>
</tr>
<tr>
<td style="text-align: left;">UID</td>
<td style="text-align: left;">The numeric user id of the logged-in user</td>
</tr>
<tr>
<td style="text-align: left;">HOME</td>
<td style="text-align: left;">The user's home directory</td>
</tr>
<tr>
<td style="text-align: left;">PWD</td>
<td style="text-align: left;">The current working directory</td>
</tr>
<tr>
<td style="text-align: left;">SHELL</td>
<td style="text-align: left;">The name of the shell</td>
</tr>
<tr>
<td style="text-align: left;">$</td>
<td style="text-align: left;">The process id (or PID of the running bash shell (or other) process</td>
</tr>
<tr>
<td style="text-align: left;">PPID</td>
<td style="text-align: left;">The process id of the process that started this process (that is, the id of the parent process)</td>
</tr>
<tr>
<td style="text-align: left;">?</td>
<td style="text-align: left;">The exit code of the last command</td>
</tr>
</tbody>
</table>
<p>When trying to access the value, you should add a <code>$</code> to the beginning of the variable name.</p>
<div class="highlight"><pre><span></span><code>$ echo $USER $UID
jadi 1000
$ echo $SHELL $HOME $PWD
/bin/bash /home/jadi /home/jadi/lpic
</code></pre></div>

<p>To define a new EV (Environment Variable) or change or delete one, we can do:</p>
<div class="highlight"><pre><span></span><code>$ MYMOOD=happy
$ echo I am $MYMOOD
I am happy
$ MYMOOD=&quot;Even Happier&quot; # space has a specific meaning
$ unset MM
</code></pre></div>

<p>If you want new programs starting from this shell to have access to the variable you defined, you have to set them with <code>export</code> or export them later.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span>MYMOOD
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">YOURMOOD</span><span class="o">=</span><span class="s2">&quot;Not Confused&quot;</span>
</code></pre></div>

<blockquote>
<p>Global bash configs are stored at <code>/etc/profile</code> and each user has her config at <code>~/.profile</code> &amp; <code>~/.bash\_profile</code> &amp; <code>~/.bash\_logout</code>. If you need a permanent change, add your configs to these.</p>
</blockquote>
<h2>Path</h2>
<p>When you issue a command, bash will run if it's an internal bash command. Otherwise, bash will go and check the <code>PATH</code> variables one by one and will try to find them there. If not, it will give you an error. If you want to run something on a specific path, you have to exclusively describe the location:</p>
<div class="highlight"><pre><span></span><code>$ echo $PATH
/home/jadi/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
</code></pre></div>

<p>But what happens if I try to run <code>tar</code>? Let's check with <code>which</code>, <code>type</code>, and <code>whereis</code> commands:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">tar</span>
<span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">tar</span>
<span class="n">jadi</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">tar</span>
<span class="n">tar</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">tar</span>
<span class="n">jadi</span><span class="nv">@funlife</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">whereis</span><span class="w"> </span><span class="n">tar</span>
<span class="nl">tar</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tar</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">tar</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">include</span><span class="o">/</span><span class="n">tar</span><span class="p">.</span><span class="n">h</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">man</span><span class="o">/</span><span class="n">man1</span><span class="o">/</span><span class="n">tar</span><span class="mf">.1</span><span class="p">.</span><span class="n">gz</span>
</code></pre></div>

<p>A cooler example is <code>ping</code> on Fedora:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">whereis</span><span class="w"> </span><span class="n">ping</span>
<span class="nl">ping</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ping</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">ping</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">man</span><span class="o">/</span><span class="n">man8</span><span class="o">/</span><span class="n">ping</span><span class="mf">.8</span><span class="p">.</span><span class="n">gz</span>
<span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">ping</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ping</span>
<span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">ping</span><span class="w"> </span><span class="mf">4.2.2.4</span>
<span class="n">PING</span><span class="w"> </span><span class="mf">4.2.2.4</span><span class="w"> </span><span class="p">(</span><span class="mf">4.2.2.4</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="p">.</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">4.2.2.4</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">50</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mi">160</span><span class="w"> </span><span class="n">ms</span>
</code></pre></div>

<blockquote>
<p>That's why when you want to say "run this_program in this directory" you issue "./this_program". You are exclusively telling bash where the file is. In Linux, the current directory (.) is not part of the PATH by default.</p>
</blockquote>
<h2>Command history</h2>
<p>Bash saves its history in <code>~/.bash_history</code>. You can <code>cat</code> it and see its contents or run the <code>history</code> command. You can also use the below keys (combinations) to access your previous commands:</p>
<table>
<thead>
<tr>
<th>Key (Combination)</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>Up and Down Arrow</td>
<td>Move in the history</td>
</tr>
<tr>
<td>Ctrl+R</td>
<td>Backward Search</td>
</tr>
<tr>
<td>Ctrl+O</td>
<td>Run the command you found with Ctrl+R</td>
</tr>
<tr>
<td>!!</td>
<td>Run the last command</td>
</tr>
<tr>
<td>!10</td>
<td>Run command number 10</td>
</tr>
<tr>
<td>!text</td>
<td>search backward for text, and run the first found command</td>
</tr>
</tbody>
</table>
<blockquote>
<p>If you want to clear your history, issue `HISTSIZE=0</p>
</blockquote>
<h2>Exiting the Shell</h2>
<p>The <code>exit</code> command exits the shell. Same as CTRL+d.</p>
<p>If you run a command inside parentheses that command will be run inside a sub-shell and <code>exec</code> will run a command and closes the current shell.</p>
                                            <br clear="both" />
                                            <h1>103.2 Process text streams using filters</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Description: Candidates should be able to apply filters to text streams.</p>
<h2>Objectives</h2>
<p>Send text files and output streams through text utility filters to modify the output using standard UNIX commands found in the GNU textutils package.</p>
<h2>Terms</h2>
<ul>
<li>bzcat</li>
<li>cat</li>
<li>cut</li>
<li>head</li>
<li>less</li>
<li>md5sum</li>
<li>nl</li>
<li>od</li>
<li>paste</li>
<li>sed</li>
<li>sha256sum</li>
<li>sha512sum</li>
<li>sort</li>
<li>split</li>
<li>tail</li>
<li>tr</li>
<li>uniq</li>
<li>wc</li>
<li>xzcat</li>
<li>zcat</li>
</ul>
<h2>Streams</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/2mTH7HbErh8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>In <strong>UNIX</strong> world a lot of data is in TEXT form. Log files, configurations, data, etc. <strong>Filtering</strong> this data means taking an input stream of text and performing some conversion on the text before sending it to an output stream. In this context, a <strong>streams</strong> is nothing more than <em>"a sequence of bytes that can be read or written using library functions that hide the details of an underlying device from the application"</em>.</p>
<p>In simple words, a text stream is an input of text from a keyboard, a file, a network device, ... which can be viewed, changed, examined, and ... via text util commands.</p>
<p>Modern programming environments and shells (including bash) use three standard I/O streams:</p>
<ul>
<li><strong>stdin</strong> is the standard input stream, which provides input to commands.</li>
<li><strong>stdout</strong> is the standard output stream, which displays output from commands.</li>
<li><strong>stderr</strong> is the standard error stream, which displays error output from commands</li>
</ul>
<p>Here we are talking about the <strong>stdin</strong> and viewing or manipulating it via different commands and utilities. You will see more about these streams and will see how we can combine commands to <em>PIPE</em> inputs and outputs of different commands in chapter 103.4.</p>
<h2>Viewing commands</h2>
<h3>cat</h3>
<p>This command simply outputs its input stream (or the filename you give it). As you saw in the previous section. As with most commands, if you do not give input to it, it will read the data from the keyboard.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat &gt; mydata
test
this is the second line
bye
jadi@funlife:~/w/lpic/101$ cat mydata
test
this is the second line
bye
</code></pre></div>

<blockquote>
<p>When entering the input via the keyboard, <code>ctrl+d</code> will end the stream.</p>
</blockquote>
<p>You can also provide more than one input file name:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat mydata directory_data
test
this is the second line
bye
total 0
-rw-rw-r-- 1 jadi jadi 0 Jan  4 17:33 12
-rw-rw-r-- 1 jadi jadi 0 Jan  4 17:33 62
-rw-rw-r-- 1 jadi jadi 0 Jan  4 17:33 neda
-rw-rw-r-- 1 jadi jadi 0 Jan  4 17:33 jadi
-rw-rw-r-- 1 jadi jadi 0 Jan  4 17:33 you
-rw-rw-r-- 1 jadi jadi 0 Jan  4 17:34 amir
-rw-rw-r-- 1 jadi jadi 0 Jan  4 17:37 directory_data
</code></pre></div>

<p>Some common cat switches are <code>-n</code> to show line numbers, <code>-s</code> to squeeze blanks, <code>-T</code> to show tabs, and <code>-v</code> to show non-printing characters.</p>
<h3>bzcat, xzcat, zcat, gzcat</h3>
<p>There are used to directly <code>cat</code> the bz, xz, and Z &amp; gz compressed files. These let you see the contents of compressed files without uncompressing them first.</p>
<h3>less</h3>
<p>This is a powerful tool to view larger text files. It can paginate, search and move in text files. </p>
<blockquote>
<p>There is another command called <code>more</code>. It's more familiar for people coming from the DOS environment and not very common in the Linux world. Do not use it. Remember: <code>less</code> is more than <code>more</code>.</p>
</blockquote>
<p>Some less common commands are as follows.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>q</td>
<td>Exit</td>
</tr>
<tr>
<td>/foo</td>
<td>Searches for foo</td>
</tr>
<tr>
<td>n</td>
<td>Next (search)</td>
</tr>
<tr>
<td>N</td>
<td>Previous (search)</td>
</tr>
<tr>
<td>?foo</td>
<td>Search backward for foo</td>
</tr>
<tr>
<td>G</td>
<td>Go to end</td>
</tr>
<tr>
<td>nG</td>
<td>Go to line n</td>
</tr>
<tr>
<td>PageUp, PageDown, UpArrow, DownArrow</td>
<td>You guess!</td>
</tr>
</tbody>
</table>
<h3>od</h3>
<p>This command _dump_s files (Shows files in formats other than text). Normal behavior is OctalDump (showing in base 8):</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ od mydata
0000000 062564 072163 072012 064550 020163 071551 072040 062550
0000020 071440 061545 067543 062156 066040 067151 005145 074542
0000040 005145
0000042
</code></pre></div>

<p>Not good enough for normal human beings. Let's use some switches:</p>
<ul>
<li><strong>-t</strong> will tell what format to print:
  </br><code>-t a</code> for showing only named characters
  </br><code>-t c</code> for showing escaped chars.</br>
You can summarize the two above to <code>-a</code> and <code>-c</code></li>
<li><strong>-A</strong> for choosing how to present offset field: 
  </br> <code>-A d</code> for Decimal,
  </br> <code>-A o</code> for Octal,
  </br> <code>-A x</code> for hex 
  </br> <code>-A n</code> for None</li>
</ul>
<blockquote>
<p><code>od</code> is very useful to find problems in your text files - Say finding out if you are using tabs or correct line endings.</p>
</blockquote>
<h2>Choosing parts of files</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/nw3Ic3RxbVI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>split</h3>
<p>Will split the files. It is very useful for transferring HUGE files on smaller media (say splitting a 3TB file into 8GB parts and moving them to another machine with a USB Disk).</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat mydata
hello
this is the second line
but as you can see we are
still writing
and this is getting longer
.
.
and longer
and longer!
jadi@funlife:~/w/lpic/101$ ls
mydata
jadi@funlife:~/w/lpic/101$ split -l 2 mydata
jadi@funlife:~/w/lpic/101$ ls
mydata    xaa  xab  xac  xad  xae
jadi@funlife:~/w/lpic/101$ cat xab
but as you can see we are
still writing
</code></pre></div>

<ul>
<li>By default, split uses xaa, xab, xac, ... for output file names. It can be changed with <code>split -l 2 mydata output</code> which split mydata into outputaa, outputab, ...; 2 lines per file.</li>
<li>the <code>-l 2</code> splits 2 lines per file. It is possible to use <code>-b 42</code> to split every 42 bytes or even <code>-n 5</code> to force 5 output files.</li>
<li>If you want numeric output (x00, x01, ..) use <code>-d</code> option.</li>
</ul>
<blockquote>
<p>Need to join these files? <code>cat</code> them with <code>cat x* &gt; originalfile</code>.</p>
</blockquote>
<h3>head and tail</h3>
<p>Will show the beginning (head) or end (tail) of text files. By default, it will show 10 lines but you can change it by <code>-n20</code> or <code>-20</code>.</p>
<blockquote>
<p><code>tail -f</code> follows the new lines which are being written at the end of the file. Very useful.</p>
</blockquote>
<h3>cut</h3>
<p>The <code>cut</code> command will <em>cut</em> one or more columns from a file. Good for separating fields:</p>
<p>Lets cut the <em>first field</em> of a file.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat howcool
jadi    5
sina    6
rubic    2
you     12
jadi@funlife:~/w/lpic/101$ cut -f1 howcool
jadi
sina
rubic
you
</code></pre></div>

<blockquote>
<p>Default delimiter is TAB. use <code>-dx</code> to change it to "x" or <code>-d' '</code> to change it to space</p>
</blockquote>
<p>It is also possible to <em>cut</em> fields 1, 2, and 3 with <code>-f1-3</code> or only characters with index 4, 5, 7, 8 from each line <code>-c4,5,7,8</code>.</p>
<h2>Modifying streams</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/IpJpI3CzN_o" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>nl</h3>
<p>This command is for showing line numbers.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ nl mydata  | head -3
     1    hello
     2    this is the second line
     3    but as you can see we are
</code></pre></div>

<blockquote>
<p><code>cat -n</code> will also number lines.</p>
</blockquote>
<h3>sort &amp; uniq</h3>
<p>Will sorts its input(s).</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat uses
you fedora
jadi ubuntu
rubic windows
neda mac
jadi@funlife:~/w/lpic/101$ cat howcool
jadi    5
sina    6
rubic    2
you     12
jadi@funlife:~/w/lpic/101$ sort howcool uses
jadi    5
jadi ubuntu
neda mac
rubic    2
rubic windows
sina    6
you     12
</code></pre></div>

<p>If you want a reverse sort, use the <code>-r</code> switch.</p>
<blockquote>
<p>If you want to sort NUMERICALLY (so 9 is lower than 19), use <code>-n</code>.</p>
</blockquote>
<p>And the <code>uniq</code> removes duplicate entries from its input. Normal behavior is removing only the duplicated lines but you can change its behavior, for example  <code>-f1</code> switch forces it not to check the first field.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ uniq what_i_have.txt
laptop
socks
tshirt
ball
socks
glasses
jadi@funlife:~/w/lpic/101$ sort what_i_have.txt | uniq
ball
glasses
laptop
socks
tshirt
jadi@funlife:~/w/lpic/101$
</code></pre></div>

<blockquote>
<p>As you can see, the input HAVE TO BE sorted for uniq to work.</p>
</blockquote>
<p>uniq has great switches:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat what_i_have.txt
laptop
socks
tshirt
ball
socks
glasses
jadi@funlife:~/w/lpic/101$ sort what_i_have.txt  | uniq -c  #show count of each item
      1 ball
      1 glasses
      1 laptop
      2 socks
      1 tshirt
jadi@funlife:~/w/lpic/101$ sort what_i_have.txt  | uniq -u #show only non-repeated items
ball
glasses
laptop
tshirt
jadi@funlife:~/w/lpic/101$ sort what_i_have.txt  | uniq -d #show only repeated items
socks
</code></pre></div>

<h2>paste</h2>
<p>The paste command pastes lines from two or more files side-by-side! You cannot do this in a general text editor with ease!</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat howcool
jadi    5
sina    6
rubic    2
you     12
jadi@funlife:~/w/lpic/101$ cat uses
you fedora
jadi ubuntu
rubic windows
neda mac
jadi@funlife:~/w/lpic/101$ paste howcool uses
jadi    5    you fedora
sina    6    jadi ubuntu
rubic    2    rubic windows
you     12    neda mac
</code></pre></div>

<h3>tr</h3>
<p>The <code>tr</code> command <em>translates</em> characters in the stream. For example, <code>tr 'ABC' '123'</code> will replace A with 1, B with 2, and C with 3 in the provided stream. It is a pure filter and does not accept the input file name. If needed you can pipe the cat with it (see chapter 103.4).</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat mydata
hello
this is the second line
but as you can see we are
still writing
and this is getting longer
.
.
and longer
and longer!
jadi@funlife:~/w/lpic/101$ cat mydata | tr &#39;and&#39; &#39;AND&#39;
hello
this is the second liNe
but As you cAN see we Are
still writiNg
AND this is gettiNg loNger
.
.
AND loNger
AND loNger!
</code></pre></div>

<blockquote>
<p>Note: all <strong>'a'</strong>s are replaced with <strong>'A'</strong>.</p>
</blockquote>
<h3>sed</h3>
<p>sed is <strong>s</strong>tream <strong>ed</strong>itor. It is POWERFUL and can do things that are not far from magic! Just like most of the tools we've seen far now, sed can work as a filter or take input from a file. Sed is a great tool for replacing text with using <strong>regular expressions</strong> . If you need to replace A with B only once in each line in a stream just issue  <code>sed 's/A/B/'</code>:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat uses
you fedora
jadi ubuntu
rubic windows
neda mac
jadi@funlife:~/w/lpic/101$ sed &#39;s/ubuntu/debian/&#39; uses
you fedora
jadi debian
rubic windows
neda mac
jadi@funlife:~/w/lpic/101$
</code></pre></div>

<p>The pattern for changing EVERY occurrence of A to B in a line is <code>sed 's/A/B/g'</code>.</p>
<p>Remember escape characters? They also work here and this will remove every <em>new line</em> from a file and will replace it with a space:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ cat mydata
hello
this is the second line
but as you can see we are
still writing
and this is getting longer
.
.
and longer
and longer!
jadi@funlife:~/w/lpic/101$ sed &#39;s/ /\t/g&#39; mydata &gt; mydata.tab
jadi@funlife:~/w/lpic/101$ cat mydata.tab
hello
this    is the second    line
but    as    you    can    see    we    are
still    writing
and    this    is    getting    longer
.
.
and    longer
and    longer!
</code></pre></div>

<h2>Getting stats</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/wUi0lmmzm3k" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>wc</h3>
<p>The <code>wc</code> is <em>word count</em>. It counts the lines, words, and bytes in the input stream.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ wc mydata
  9  25 121 mydata
</code></pre></div>

<blockquote>
<p>It is very common to count the line numbers with <code>-l</code> switch.</p>
</blockquote>
<h3>-</h3>
<p>You should know that if you put <code>-</code> instead of a filename, the data will be replaced from the pipe (or keyboard stdin).</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic/101$ wc -l mydata | cat mydata - mydata  
hello
this is the second line
but as you can see we are
still writing
and this is getting longer
.
.
and longer
and longer!
9 mydata
hello
this is second line
but as you can see we are
still writing
and this is getting longer
.
.
and longer
and longer!
</code></pre></div>

<h2>Hashing</h2>
<p>A hash function is any function that can be used to map data of arbitrary size to fixed-size values. There are different hashes and we use them for different purposes. For example, a site may hash your password in its database to keep it secure (and check the hash of provided password with a hash it already has in DB during logins) a site may provide the hash of a file so you can be sure that you've downloaded the correct file and ...</p>
<p>The hashing algorithms covered in LPIC1 are:</p>
<ul>
<li>md5sum</li>
<li>sha256sum</li>
<li>sha512sum</li>
</ul>
<p>You can check any file (or input streams hash with something like this):</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@ocean</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">md5sum</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">myfile</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">8183</span><span class="n">aa57a23658efe7ba7aebe60816bc</span><span class="w">  </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">myfile</span><span class="p">.</span><span class="n">txt</span>
<span class="n">jadi</span><span class="nv">@ocean</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">sha256sum</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">myfile</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">7</span><span class="n">ddcfda184b55ee06b0c81e0ad136b1aa4a86daeb1078bcaeccc246eb2c8693b</span><span class="w">  </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">myfile</span><span class="p">.</span><span class="n">txt</span>
<span class="n">jadi</span><span class="nv">@ocean</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">sha512sum</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">myfile</span><span class="p">.</span><span class="n">txt</span>
<span class="mf">79e5</span><span class="n">d789528e5e55fc1bddcb381afd56e896b1b452347a76777fb38d76c9754278700036f35df2a53c4d53d3e3623538a8b9ed155a3fd5275e667bdbf3c0b359</span><span class="w">  </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">myfile</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>

<p>As you can see, <code>sha512sum</code> creates a longer hash which is more secure.</p>
                                            <br clear="both" />
                                            <h1>103.3 Perform basic file management</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to use the basic Linux commands to manage files and directories.</p>
<h2>Objectives</h2>
<ul>
<li>Copy, move and remove files and directories individually.</li>
<li>Copy multiple files and directories recursively.</li>
<li>Remove files and directories recursively.</li>
<li>Use simple and advanced wildcard specifications in commands.</li>
<li>Using find to locate and act on files based on type, size, or time.</li>
<li>Usage of tar, cpio, and dd.</li>
</ul>
<h3>Terms</h3>
<ul>
<li>cp</li>
<li>find</li>
<li>mkdir</li>
<li>mv</li>
<li>ls</li>
<li>rm</li>
<li>rmdir</li>
<li>touch</li>
<li>tar</li>
<li>cpio</li>
<li>dd</li>
<li>file</li>
<li>gzip</li>
<li>gunzip</li>
<li>bzip2</li>
<li>bunzip2</li>
<li>xz</li>
<li>unxz</li>
<li>file globbing</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lTnkGg9o6u0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>Wildcards and file globbing</h3>
<p>File globbing is a shell capability that lets you tell things like :
- All files
- everything which starts with A
- all files with 3-letter names which end in A or B or C
- ...</p>
<p>To do so you need to know about these characters:</p>
<ul>
<li><code>*</code> means <strong>any string</strong></li>
<li><code>?</code> means any single character</li>
<li><code>[ABC]</code> matches A, B, or C</li>
<li><code>[a-k]</code> matches a, b, c, ..., k (both lower-case and upper-case)</li>
<li><code>[0-9a-z]</code> matches all digits and numbers</li>
<li><code>[!x]</code> means NOT X.</li>
</ul>
<p>knowing these, you can create your patterns. For example:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">command</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">rm *</td>
<td style="text-align: left;">delete all files in this directory</td>
</tr>
<tr>
<td style="text-align: left;">ls A*B</td>
<td style="text-align: left;">show all files starting with A and ending with B</td>
</tr>
<tr>
<td style="text-align: left;">cp ???.* /tmp</td>
<td style="text-align: left;">Copy all files with 3 characters, then a dot then whatever (even nothing) to /tmp</td>
</tr>
<tr>
<td style="text-align: left;">rmdir [a-z]*</td>
<td style="text-align: left;">remove all empty directories which start with a letter</td>
</tr>
</tbody>
</table>
<h3>general commands</h3>
<h4>listing with <code>ls</code></h4>
<p><code>ls</code> used to <em>list</em> directories &amp; files. You can provide an absolute or relative path; if omitted the "." will be used as a target.</p>
<div class="highlight"><pre><span></span><code>jadi@lpicjadi:~/lpic1-practice-iso/100/103.3$ ls -ltrh
total 16K
-rw-rw-r-- 1 jadi jadi 207 Aug 14 04:43 tasks.txt
-rw-rw-r-- 1 jadi jadi  29 Aug 14 04:43 info.txt
-rw-rw-r-- 1 jadi jadi  24 Aug 14 04:44 data.txt
-rw-rw-r-- 1 jadi jadi 116 Aug 14 04:44 note_to_self
</code></pre></div>

<blockquote>
<p>First field indicates if this is a file (<code>-</code>) or directory (<code>d</code>).</p>
</blockquote>
<p>Some common switches are:</p>
<ul>
<li><code>-l</code> is for <em>long</em> (more info for each file)</li>
<li><code>-1</code> will print one file per line</li>
<li><code>-t</code> sorts based on modification date</li>
<li><code>-r</code> reverses the search (so <code>-tr</code> is reverse time (newer files at the bottom).</li>
</ul>
<blockquote>
<p>you can mix switches. A famous one is <code>-ltrh</code> (long + human readable sizes + reverse time).</p>
</blockquote>
<h3>Copy (<code>cp</code>), Move (<code>mv</code>), and Delete (<code>rm</code>)</h3>
<h4><strong>cp</strong></h4>
<p>This will <em>copy</em> files from one place/name to another place/name. If the target is a directory, all sources will be copied there.</p>
<div class="highlight"><pre><span></span><code>cp source destination
</code></pre></div>

<p>A common switch is <code>-r</code> (or <code>-R</code>) which copies recursively (directories and their contents). So for copying a directory called <code>A</code> to <code>/tmp/</code> you can issue <code>cp -r A /tmp/</code>.</p>
<h4><strong>mv</strong></h4>
<p>Will <em>move</em> or <em>rename</em> files or directories. It works like <code>cp</code> command. If you are moving a file on the same file system, the <strong>inode</strong> won't change.</p>
<p>In general:</p>
<ul>
<li>If the target is an existing directory, then all sources are copied into the target</li>
<li>If the target directory does not exist, then the source must be only one directory which will be renamed to the target directory.</li>
<li>If the target is a file, then the source must be only one file so rename will happen.</li>
</ul>
<p>These look like "formulas" but they are common sense!</p>
<h4><strong>rm</strong></h4>
<p>Removes (Deletes) <strong>files</strong>. You can do this recursively using the <code>-r</code> switch or even prevent it from checking for confirmations using <code>-f</code> (force) switch. So a <code>rm -rf /</code> means <em>delete everything from the file system</em>.</p>
<p><strong>notes</strong></p>
<p>Normally, the cp command will copy a file over an existing copy, if the existing file is writable. On the other hand, the <code>mv</code> will not move or rename a file if the target exists. Although this is highly dependent on your system's configuration. But in all cases, you can overcome this using the <code>-f</code> switch.</p>
<ul>
<li><code>-f</code> (--force) will cause cp to try overwriting the target.</li>
<li><code>-i</code> (--interactive) will ask Y/N question (deleting / overwriting).</li>
<li><code>-b</code> (--backup) will make backups of overwritten files</li>
<li><code>-p</code> will <em>preserve</em> the attributes.</li>
</ul>
<h3>Creating (mkdir) and removing (rmdir) directories</h3>
<p>The <code>mkdir</code> command creates directories.</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">16</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">new_dir</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">20</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">57</span><span class="w"> </span><span class="n">new_dir</span>
</code></pre></div>

<p>If you want to create a tree of directories, you can use <code>-p</code> switch to tell the <code>mkdir</code> to create the <em>parent</em> directories if needed:</p>
<div class="highlight"><pre><span></span><code>jadi@lpicjadi:~/lpic1-practice-iso/100/103.3$ ls -ltrh
total 20K
-rw-rw-r-- 1 jadi jadi  207 Aug 14 04:43 tasks.txt
-rw-rw-r-- 1 jadi jadi   29 Aug 14 04:43 info.txt
-rw-rw-r-- 1 jadi jadi   24 Aug 14 04:44 data.txt
-rw-rw-r-- 1 jadi jadi  116 Aug 14 04:44 note_to_self
drwxrwxr-x 2 jadi jadi 4.0K Aug 14 04:57 new_dir
jadi@lpicjadi:~/lpic1-practice-iso/100/103.3$ mkdir -p 1/2/3 
jadi@lpicjadi:~/lpic1-practice-iso/100/103.3$ tree
.
├── 1
│   └── 2
│       └── 3
├── data.txt
├── info.txt
├── new_dir
├── note_to_self
└── tasks.txt
</code></pre></div>

<p>If you need to delete a directory the command is <code>rmdir</code> and you can also use the -p for nested removing:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">rmdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">rmdir</span><span class="w"> </span><span class="n">new_dir</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">tree</span>
<span class="p">.</span>
<span class="err">├──</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="err">├──</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="err">├──</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="err">└──</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>

<span class="mi">0</span><span class="w"> </span><span class="n">directories</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">files</span>
</code></pre></div>

<blockquote>
<p>If you are using <code>rmdir</code> to remove a directory, it <em>MUST BE EMPTY</em>! That's why many people use <code>rm -rf directory_name</code> to delete the not-empty directory and whatever is in it.</p>
</blockquote>
<iframe width="560" height="315" src="https://www.youtube.com/embed/tSN1MSaFYEw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h4><strong>touch</strong></h4>
<p>The <code>touch</code> will create an empty file (if it does not exists) or updates the <strong>modification</strong> date of a file if it already exists. The default time is <em>now</em> but you can specify other times too.</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">16</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="n">new_file</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">16</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">new_file</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">16</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">new_file</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="c1">-- 1 jadi jadi 116 Aug 14 05:08 note_to_self</span>
</code></pre></div>

<p>Or you can specify times. It is possible to use <code>-d</code> and give dates or use <code>-t</code> and give a timestamp in the form of <code>[[CC]YY]MMDDhhmm[.ss]</code></p>
<div class="highlight"><pre><span></span><code>$ touch -t 200908121510.59 file1
$ touch -d 11am file2
$ touch -d &quot;last fortnight&quot; file3
$ touch -d &quot;yesterday 6am&quot; file4
$ touch -d &quot;2 days ago 12:00&quot; file5
$ touch -d &quot;tomorrow 02:00&quot; file6
$ touch -d &quot;5 Nov&quot; file3
$ ls -ltrh file?
-rw-rw-r-- 1 jadi jadi 0 Aug 12  2009 file1
-rw-rw-r-- 1 jadi jadi 0 Aug 12 12:00 file5
-rw-rw-r-- 1 jadi jadi 0 Aug 13 06:00 file4
-rw-rw-r-- 1 jadi jadi 0 Aug 14  2022 file2
-rw-rw-r-- 1 jadi jadi 0 Aug 15  2022 file6
-rw-rw-r-- 1 jadi jadi 0 Nov  5  2022 file3
</code></pre></div>

<p>Oh.. and it's possible to use another file's time to set, with switch <code>-r</code> (for --reference)):</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">debian_version</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">22</span><span class="w">  </span><span class="mi">2021</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">debian_version</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">debian_version</span><span class="w"> </span><span class="n">file1</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">20</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="c1">-- 1 jadi jadi   0 Aug 22  2021 file1</span>
</code></pre></div>

<h4><strong>file</strong></h4>
<p>To determine the type of a file, you should use <code>file</code> command. It looks <em>into</em> the file and determines its type.</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">file1</span>
<span class="nl">file1</span><span class="p">:</span><span class="w"> </span><span class="n">empty</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="nl">note_to_self</span><span class="p">:</span><span class="w"> </span><span class="nf">ASCII</span><span class="w"> </span><span class="nc">text</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">bash</span><span class="p">:</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="mi">64</span><span class="o">-</span><span class="nc">bit</span><span class="w"> </span><span class="n">LSB</span><span class="w"> </span><span class="n">pie</span><span class="w"> </span><span class="n">executable</span><span class="p">,</span><span class="w"> </span><span class="n">x86</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">SYSV</span><span class="p">),</span><span class="w"> </span><span class="n">dynamically</span><span class="w"> </span><span class="n">linked</span><span class="p">,</span><span class="w"> </span><span class="n">interpreter</span><span class="w"> </span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">64.</span><span class="n">so</span><span class="mf">.2</span><span class="p">,</span><span class="w"> </span><span class="n">BuildID</span><span class="o">[</span><span class="n">sha1</span><span class="o">]=</span><span class="mi">33</span><span class="n">a5554034feb2af38e8c75872058883b2988bc5</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span><span class="w"> </span><span class="mf">3.2.0</span><span class="p">,</span><span class="w"> </span><span class="n">stripped</span>
</code></pre></div>

<blockquote>
<p><code>-i</code> switch prints the mime format</p>
</blockquote>
<h4><strong>dd</strong></h4>
<p>The <code>dd</code> command copies data from its input to its output (say files or devices). You may use it just like copy:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">dd</span><span class="w"> </span><span class="k">if</span><span class="o">=</span><span class="n">note_to_self</span><span class="w"> </span><span class="k">of</span><span class="o">=</span><span class="n">new_file</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="n">records</span><span class="w"> </span><span class="ow">in</span>
<span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="n">records</span><span class="w"> </span><span class="k">out</span>
<span class="mi">116</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">copied</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00141561</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="mf">81.9</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">new_file</span>
<span class="n">I</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="n">learning</span><span class="p">...</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">confused</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="err">&#39;</span><span class="n">ll</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="k">section</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">till</span><span class="w"> </span><span class="n">everything</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">clear</span><span class="err">!</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span>
</code></pre></div>

<ul>
<li><code>if</code> is the Input File</li>
<li><code>of</code> is the Output File</li>
</ul>
<p>But commonly people use it to read/write from block devices. For example, this will read all the sectors from the <code>/dev/sdb</code> and will write them to a file named<code>backup.dd</code>. Later you can restore this backup by swapping the <code>if</code> and <code>of</code> and writing from the <code>backup.dd</code> to <code>/dev/sdb</code>. </p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">dd</span><span class="w"> </span><span class="k">if</span><span class="o">=/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda</span><span class="w"> </span><span class="nv">of</span><span class="o">=</span><span class="nv">backup</span>.<span class="nv">dd</span><span class="w"> </span><span class="nv">bs</span><span class="o">=</span><span class="mi">4096</span>
</code></pre></div>

<p>or even:</p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">dd</span><span class="w"> </span><span class="k">if</span><span class="o">=/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">gzip</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nv">backup</span>.<span class="nv">dd</span>.<span class="nv">gzip</span>
</code></pre></div>

<p>Another common usage is creating files of specific sizes:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>/dev/zero<span class="w"> </span><span class="nv">of</span><span class="o">=</span>1g.bin<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>1G<span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>

<p>or even <em>writing</em> your iso files to a USB disk to have a live bootable USB:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>ubuntu.iso<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/sdc<span class="w"> </span><span class="nv">bs</span><span class="o">=</span><span class="m">2048</span>
</code></pre></div>

<blockquote>
<p>Caution: here you are writing directly on a block device. If you do something wrong... you will ruin your disk and need to reformat it.</p>
</blockquote>
<h4><strong>find</strong></h4>
<p>The <code>find</code> command helps us to find files based on different criteria. Look at this:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>find<span class="w"> </span>.<span class="w"> </span>-iname<span class="w"> </span><span class="s2">&quot;[a-j]*&quot;</span>
./howcool.sort
./alldata
./mydir/howcool.sort
./mydir/newDir/insideNew
./howcool
</code></pre></div>

<ul>
<li>The first parameter says where should we search (including subdirectories).</li>
<li>The <code>-name</code> switch indicates the criteria (here <code>iname</code> means search files with this name and ignore the character cases (z equals Z)). </li>
</ul>
<p>Another common switch is <code>-type</code> to indicate the type we are searching for (<code>f</code> for regular files, <code>d</code> for directories, and <code>l</code> for symbolic links):</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="n">iname</span><span class="w"> </span><span class="ss">&quot;[a-j]*&quot;</span>
<span class="p">.</span><span class="o">/</span><span class="n">directory</span>
<span class="p">.</span><span class="o">/</span><span class="n">directory</span><span class="o">/</span><span class="n">innder_one</span>
</code></pre></div>

<p>if you want to search for file sizes do as below:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">command</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-size 100c</td>
<td style="text-align: left;">files which are exactly 100 characters/bytes (you can also use <code>b</code>)</td>
</tr>
<tr>
<td style="text-align: left;">-size +100k</td>
<td style="text-align: left;">files which are more than 100 kilobytes</td>
</tr>
<tr>
<td style="text-align: left;">-size -20M</td>
<td style="text-align: left;">files smaller than 20Megabytes</td>
</tr>
<tr>
<td style="text-align: left;">-size +2G</td>
<td style="text-align: left;">files bigger than 2Gigabytes</td>
</tr>
</tbody>
</table>
<p>So this will find all files ending in <em>tmp</em> with sizes between 1M and 100M in /var/ directory:</p>
<div class="highlight"><pre><span></span><code>find /var -iname &#39;*tmp&#39; -size +1M -size -100M
</code></pre></div>

<blockquote>
<p>you can find all empty files with <code>find . -size 0b</code> or <code>find . -empty</code></p>
</blockquote>
<p>Another useful search criterion is time. These are some of the options:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">switch</th>
<th style="text-align: left;">meaning</th>
<th style="text-align: left;">samples</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-amin</td>
<td style="text-align: left;">Access Minutes</td>
<td style="text-align: left;"><code>-amin 40</code> means "files accessed exactly 40min ago" or <code>-amin +40</code> mins files accessed more than 40min ago and <code>-amin -40</code> means files accessed less than 40min ago</td>
</tr>
<tr>
<td style="text-align: left;">-cmin</td>
<td style="text-align: left;">Status Change Min</td>
<td style="text-align: left;"><code>-cmin +60</code> file status changed before last hour</td>
</tr>
<tr>
<td style="text-align: left;">-mmin</td>
<td style="text-align: left;">Modified Minutes</td>
<td style="text-align: left;"><code>-mmin -60</code> will give us files modified in last hour</td>
</tr>
<tr>
<td style="text-align: left;">-atime</td>
<td style="text-align: left;">access time in days</td>
<td style="text-align: left;"><code>-atime +1</code> means files access "more than 1 days ago (which means 2 days and more)</td>
</tr>
<tr>
<td style="text-align: left;">-ctime</td>
<td style="text-align: left;">Status Changed in Days</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">-mtime</td>
<td style="text-align: left;">Modified days</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">-newer</td>
<td style="text-align: left;">Newer than reference</td>
<td style="text-align: left;"><code>-newer file1</code> will give you files which are newer than file1</td>
</tr>
</tbody>
</table>
<blockquote>
<p>if you add <code>-daystart</code> switch to -mtime or -atime it means that we want to consider days as calendar days, starting at midnight.</p>
</blockquote>
<h4>Acting on files</h4>
<p>We can execute commands or do other actions on files with various switches:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">switch</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-ls</td>
<td style="text-align: left;">will run ls -dils on each file</td>
</tr>
<tr>
<td style="text-align: left;">-print</td>
<td style="text-align: left;">will print the full name of the files on each line</td>
</tr>
</tbody>
</table>
<p>But the best way to run commands on found files is <code>-exec</code> switch. You can point to the file with <code>'{}'</code> or <code>{}</code> and finish your command with <code>\;</code>.</p>
<p>For example, This will remove all empty files in this directory and its subdirectories:</p>
<div class="highlight"><pre><span></span><code><span class="nv">find</span><span class="w"> </span>.<span class="w"> </span><span class="o">-</span><span class="nv">empty</span><span class="w"> </span><span class="o">-</span><span class="k">exec</span><span class="w"> </span><span class="nv">rm</span><span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span>\<span class="c1">;</span>
</code></pre></div>

<p>or this will rename all htm files to html</p>
<div class="highlight"><pre><span></span><code><span class="nv">find</span><span class="w"> </span>.<span class="w"> </span><span class="o">-</span><span class="nv">name</span><span class="w"> </span><span class="s2">&quot;*.htm&quot;</span><span class="w"> </span><span class="o">-</span><span class="k">exec</span><span class="w"> </span><span class="nv">mv</span><span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span><span class="s1">&#39;{}l&#39;</span><span class="w"> </span>\<span class="c1">;</span>
</code></pre></div>

<blockquote>
<p>since deleting found files is a common task, there is a switch for it: <code>-delete</code></p>
</blockquote>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6MLaCDTRgis" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>Compression</h3>
<h4><strong>gzip &amp; gunzip</strong></h4>
<p>Straight forward, one gzips file and one ungzips file; In place:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">20</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">    </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">new_file</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="n">directory</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">20</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">171</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span><span class="p">.</span><span class="n">gz</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">    </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">new_file</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="n">directory</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">gunzip</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span><span class="p">.</span><span class="n">gz</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">20</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">    </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">new_file</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="n">directory</span>
</code></pre></div>

<ul>
<li>gzip preserves time</li>
<li>gzip creates the new compressed file with the same name but with .gz ending</li>
<li>gzip removes the original files after creating the compressed file (you can keep the input file with <code>-k</code> switch)</li>
</ul>
<h4><strong>bzip2 &amp; bunzip2</strong></h4>
<p>The <code>bzip2</code> is another compressing tool. Works just like the famous <code>gzip</code> but with a different compression algorithm.</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">bzip2</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w">  </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">20</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">172</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span><span class="p">.</span><span class="n">bz2</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">    </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">new_file</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="n">directory</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">bunzip2</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span><span class="p">.</span><span class="n">bz2</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span>
<span class="k">data</span><span class="p">.</span><span class="n">txt</span><span class="w">  </span><span class="n">directory</span><span class="w">  </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span><span class="w">  </span><span class="n">new_file</span><span class="w">  </span><span class="n">note_to_self</span><span class="w">  </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>

<h4><strong>xz &amp; unxz</strong></h4>
<p>Another compression/decompression tool is just like <code>gzip</code> and <code>bzip2</code>. </p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">xz</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">24</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">224</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span><span class="p">.</span><span class="n">xz</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="n">directory</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">51</span><span class="w"> </span><span class="n">new_file</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">unxz</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span><span class="p">.</span><span class="n">xz</span>
<span class="n">jadi</span><span class="nv">@lpicjadi</span><span class="err">:</span><span class="o">~/</span><span class="n">lpic1</span><span class="o">-</span><span class="n">practice</span><span class="o">-</span><span class="n">iso</span><span class="o">/</span><span class="mi">100</span><span class="o">/</span><span class="mf">103.3</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">ltrh</span>
<span class="n">total</span><span class="w"> </span><span class="mi">24</span><span class="n">K</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">207</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">tasks</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">29</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">43</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">   </span><span class="mi">24</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w">  </span><span class="mi">116</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">note_to_self</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="n">jadi</span><span class="w"> </span><span class="mf">4.0</span><span class="n">K</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="n">directory</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="c1">-- 1 jadi jadi  116 Aug 14 07:51 new_file</span>
</code></pre></div>

<p>Please note that <em>compressing</em> a small text file makes it larger. This is <em>normal</em> in small files because of all the headers and metadata.</p>
<blockquote>
<p>In some cases, commands like <code>unxz</code> is just a calls to <code>xz --dcompress</code></p>
</blockquote>
<h3>Archiving with tar &amp; cpio</h3>
<p>Sometimes we need to create an archive file container of many other files. This operation is different than compressing, it combines files into one and then extracts them again. Archiving is mostly used in backups, moving files to a new location (say via email), and such. This is done with <code>cpio</code> and <code>tar</code>.</p>
<h4><strong>tar</strong></h4>
<p>TapeARchive or tar is the most common archiving tool. It automatically creates an archive file from a directory and all its subdirs.</p>
<p>Common switches are:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">switch</th>
<th style="text-align: left;">meanint</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-cf <code>myarchive.tar</code></td>
<td style="text-align: left;">create file named myarchive.tar</td>
</tr>
<tr>
<td style="text-align: left;">-xf <code>myarchive.tar</code></td>
<td style="text-align: left;">extract a file named myarchive.tar</td>
</tr>
<tr>
<td style="text-align: left;">-z</td>
<td style="text-align: left;">compress the archive with gzip after creating it</td>
</tr>
<tr>
<td style="text-align: left;">-j</td>
<td style="text-align: left;">compress the archive with bzip2 after creating it</td>
</tr>
<tr>
<td style="text-align: left;">-v</td>
<td style="text-align: left;">verbose! print a lot of data about what is happening</td>
</tr>
<tr>
<td style="text-align: left;">-r</td>
<td style="text-align: left;">append new files to the currently available archive</td>
</tr>
</tbody>
</table>
<blockquote>
<p>If you issue absolute paths, tar removes the starting slash (/) for safety reasons when creating an archive. If you want to override, use -p option.</p>
<p>tar can work with tapes and other storages. That's why we use <code>-f</code> to tell it that we are working with files.</p>
</blockquote>
<h4><strong>cpio</strong></h4>
<p>Gets a list of files and creates an archive (one file). This file can be used later to extract the original files.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span><span class="p">|</span><span class="w"> </span>cpio<span class="w"> </span>-o<span class="w"> </span>&gt;<span class="w"> </span>allfilesls.cpio
<span class="m">3090354</span><span class="w"> </span>blocks
</code></pre></div>

<ul>
<li><code>-o</code> tells cpio to create an output from its input</li>
</ul>
<p>Please note that <code>cpio</code> does not look into the folders. So mostly we use it with find:</p>
<div class="highlight"><pre><span></span><code>find . -name &quot;*&quot; | cpio -o &gt; myarchivefind.cpio
</code></pre></div>

<p>To extract the original files:</p>
<div class="highlight"><pre><span></span><code>mkdir extract
mv myarchivefind.cpio extract
cd extract
cpio -id &lt; myarchivefind.cpio
</code></pre></div>

<ul>
<li><code>-d</code> will create the folders</li>
<li><code>-i</code> is for extract</li>
</ul>
                                            <br clear="both" />
                                            <h1>103.4 Use streams, pipes, and redirects</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to redirect streams and connect them to efficiently process textual data. Tasks include redirecting standard input, standard output, and standard error, piping the output of one command to the input of another command, using the output of one command as arguments to another command, and sending output to both stdout and a file.</p>
<h2>Objectives</h2>
<ul>
<li>Redirecting standard input, standard output, and standard error.</li>
<li>Pipe the output of one command to the input of another command.</li>
<li>Use the output of one command as arguments to another command.</li>
<li>Send output to both stdout and a file.</li>
</ul>
<h2>Terms</h2>
<ul>
<li>tee</li>
<li>xargs</li>
</ul>
<p>These features help us to control the input/output of the commands and do things like saving the output of a command to a file, getting the input of a command from another command, or separating the normal output from errors. We've already used them in previous sections but let's learn more and deepen our understanding of these.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/PeUhwMoSCko" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>Redirecting standard IO</h2>
<p>On a Linux system, most shells use streams for input and output. These streams can be from (and toward) various things including keyboards, block devices (hards, USB sticks, ..), files, and ...</p>
<p>We have 3 different standard streams:</p>
<ol start="0">
<li><b>STDIN</b> is the standard input stream, which provides input to a command.</li>
<li><b>STDOUT</b> is the standard output stream, which includes the output of a command.</li>
<li><b>STDERR</b> is the standard error stream, which includes the error output of a command.</li>
</ol>

<blockquote>
<p>The <code>0</code>, <code>1</code> &amp; <code>2</code> numbering, indicates the <strong><em>STDIN</em></strong>, <strong><em>STDOUT</em></strong> and <strong>*STDERR</strong> accordingly. For example, if you want to redirect the stderror, you can use 2&gt; and the STDERR will be redirected.</p>
</blockquote>
<p>These are the other redirections you can use:</p>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt;</td>
<td>Redirect STDOUT to a file; Overwrite if exists</td>
</tr>
<tr>
<td>&gt;&gt;</td>
<td>Redirect STDOUT to a file; Append if exists</td>
</tr>
<tr>
<td>2&gt;</td>
<td>Redirect STDERR to a file; Overwrite if exists</td>
</tr>
<tr>
<td>2&gt;&gt;</td>
<td>Redirect STDERR to a file; Append if exists</td>
</tr>
<tr>
<td>&amp;&gt;</td>
<td>Redirect both STDOUT and STDERR; Overwrite if exists</td>
</tr>
<tr>
<td>&amp;&gt;&gt;</td>
<td>Redirect both STDOUT and STDERR; Append if exists</td>
</tr>
<tr>
<td>&lt;</td>
<td>Redirect STDIN from a file</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td>Redirect STDIN from the file and send the STDOUT to it</td>
</tr>
</tbody>
</table>
<p></br>
Some examples: </p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls
bob<span class="w"> </span>jack<span class="w">    </span>jadi<span class="w">    </span>linus<span class="w">   </span>sara<span class="w"> </span>who_uses_what.txt
$<span class="w"> </span>ls<span class="w"> </span>x*
ls:<span class="w"> </span>x*:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
$<span class="w"> </span>ls<span class="w"> </span>j*
jack<span class="w">    </span>jadi
$<span class="w"> </span>ls<span class="w"> </span>j*<span class="w"> </span>x*<span class="w"> </span>&gt;<span class="w"> </span>output<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>errors
$<span class="w"> </span>cat<span class="w"> </span>output
jack
jadi
$<span class="w"> </span>cat<span class="w"> </span>errors
ls:<span class="w"> </span>x*:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
$<span class="w"> </span>cat<span class="w"> </span>who_uses_what.txt
jadi,<span class="w"> </span>fedora
linux,<span class="w"> </span>fedora
bob,<span class="w"> </span>ubuntu
jack,<span class="w"> </span>arch
sara,<span class="w"> </span>fedora
$<span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39; &#39;</span>,<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>&lt;<span class="w"> </span>who_uses_what.txt
tr:<span class="w"> </span>empty<span class="w"> </span>string2
$<span class="w"> </span>cat<span class="w"> </span>who
$<span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;,&#39;</span>,<span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="w"> </span>&lt;<span class="w"> </span>who_uses_what.txt
jadi<span class="p">|</span><span class="w"> </span>fedora
linux<span class="p">|</span><span class="w"> </span>fedora
bob<span class="p">|</span><span class="w"> </span>ubuntu
jack<span class="p">|</span><span class="w"> </span>arch
sara<span class="p">|</span><span class="w"> </span>fedora
</code></pre></div>

<p>It is also possible to use <code>&amp;1</code> and <code>&amp;2</code> and <code>&amp;0</code> to refer to the <strong>target</strong> of STDOUT, STDERR &amp; STDIN. In this case <code>ls &gt; file1 2&gt;&amp;1</code> means <em>redirect output to file1 and output stderr to same place as stdout (file1)</em></p>
<blockquote>
<p>Be careful! <code>ls 2&gt;&amp;1 &gt; file1</code> means <em>print stderr to the current location of stdout (terminal) and then change the stdout to file1</em></p>
</blockquote>
<h4>sending to null</h4>
<p>In Linux <strong>/dev/null</strong> device works like an abyss. You can send anything there and it disappears without being any burden on your system. So it is normal to say:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>j*<span class="w"> </span>x*<span class="w"> </span>&gt;<span class="w"> </span>file1
ls:<span class="w"> </span>x*:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
$<span class="w"> </span>ls<span class="w"> </span>j*<span class="w"> </span>x*<span class="w"> </span>&gt;<span class="w"> </span>file1<span class="w"> </span><span class="m">2</span>&gt;/dev/null
$<span class="w"> </span>cat<span class="w"> </span>file1
jack
jadi
</code></pre></div>

<h4>here-documents</h4>
<p>Many shells have here-documents (also called here-docs) as a way of input. You use <code>&lt;&lt;</code> and a <code>WORD</code> and then whatever you input is considered stdin till you give only the WORD in one line.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="s">&lt;&lt; END_OF_DATA</span>
<span class="s">&gt; this is a line</span>
<span class="s">&gt; and then this</span>
<span class="s">&gt;</span>
<span class="s">&gt; we&#39;ll still type</span>
<span class="s">&gt; and,</span>
<span class="s">&gt; done!</span>
<span class="s">&gt; END_OF_DATA</span>
this.is.a.line
and.then.this

we<span class="err">&#39;</span>ll.still.type
and,
<span class="k">done</span>!
</code></pre></div>

<blockquote>
<p>Here-Documents are very useful if you are writing scripts and automated tasks.</p>
</blockquote>
<iframe width="560" height="315" src="https://www.youtube.com/embed/j3L_7Wxcl0U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h3>Pipes</h3>
<p>With the pipe (<code>|</code>), you can redirect STDOUT, STDIN, and STDERR between multiple commands all on one command line. When you do <code>command1 | command2</code>; command1, is executed but its STDOUT is redirected as STDIN into the COMMAND2. </p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>who_uses_what.txt
jadi,<span class="w"> </span>fedora
linux,<span class="w"> </span>fedora
bob,<span class="w"> </span>ubuntu
jack,<span class="w"> </span>arch
sara,<span class="w"> </span>fedora
$<span class="w"> </span>cut<span class="w"> </span>-f2<span class="w"> </span>-d,<span class="w"> </span>who_uses_what.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/ //g&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w">  </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-nr
<span class="w">   </span><span class="m">3</span><span class="w"> </span>fedora
<span class="w">   </span><span class="m">1</span><span class="w"> </span>ubuntu
<span class="w">   </span><span class="m">1</span><span class="w"> </span>arch
</code></pre></div>

<blockquote>
<p>If you need to start your pipeline with the contents of a file, start with <code>cat filename | ...</code> or use a <code>&lt;</code> stdin redirect.</p>
</blockquote>
<p>Pipes are one of the super strong &amp; super amazing features in the UNIX world. They let you create <em>new</em> tools by combining tools that do atomic things. As an example, check this out:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/86V5amp1u7U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3>xargs</h3>
<p>The xargs utility reads space, tab, newline and end-of-file delimited strings from the standard input and executes the provided utility with the strings as their arguments.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls
bob<span class="w">         </span>file1<span class="w">           </span>jadi<span class="w">            </span>output<span class="w">          </span>who_uses_what.txt
errors<span class="w">          </span>jack<span class="w">            </span>linus<span class="w">           </span>sara
$<span class="w"> </span>ls<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>these<span class="w"> </span>are<span class="w"> </span>files:
these<span class="w"> </span>are<span class="w"> </span>files:<span class="w"> </span>bob<span class="w"> </span>errors<span class="w"> </span>file1<span class="w"> </span>jack<span class="w"> </span>jadi<span class="w"> </span>linus<span class="w"> </span>output<span class="w"> </span>sara<span class="w"> </span>who_uses_what.txt
</code></pre></div>

<blockquote>
<p>if you do not give any command to the <code>xargs</code> , the echo will be the default command. </p>
</blockquote>
<p>One common switch is <code>-I</code>. This is useful if you need to pass stdin arguments in the middle (or even start) of your commands. Use it like this: <code>xargs -I SOMETHING echo here is SOMETHING end</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>who_uses_what.txt
jadi,<span class="w"> </span>fedora
linus,<span class="w"> </span>fedora
bob,<span class="w"> </span>ubuntu
jack,<span class="w"> </span>arch
sara,<span class="w"> </span>fedora
$<span class="w"> </span>cat<span class="w"> </span>who_uses_what.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-I<span class="w"> </span>DATA<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>name<span class="w"> </span>is<span class="w"> </span>DATA<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>choice.
name<span class="w"> </span>is<span class="w"> </span>jadi,<span class="w"> </span>fedora<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>choice.
name<span class="w"> </span>is<span class="w"> </span>linus,<span class="w"> </span>fedora<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>choice.
name<span class="w"> </span>is<span class="w"> </span>bob,<span class="w"> </span>ubuntu<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>choice.
name<span class="w"> </span>is<span class="w"> </span>jack,<span class="w"> </span>arch<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>choice.
name<span class="w"> </span>is<span class="w"> </span>sara,<span class="w"> </span>fedora<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>choice.
</code></pre></div>

<p>Two more useful switches:
1. <code>-L 1</code> breaks based on new lines 
2. <code>-n 1</code> tells xargs to invoke the provided utility after receiving 1 argument.  </p>
<h3>tee</h3>
<p>The problem with redirection is that you cannot see the progress of your commands in the same terminal. The <code>tee</code> utility solves this. If you need to see the output on screen and also save it to a file, <code>tee</code> is your friend. Give it one or more filenames and it will do the trick. </p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>allfiles<span class="w"> </span>myfiles
bob
errors
file1
jack
jadi
linus
output
sara
who_uses_what.txt
$<span class="w"> </span>cat<span class="w"> </span>allfiles<span class="w"> </span>myfiles
bob
errors
file1
jack
jadi
linus
output
sara
who_uses_what.txt
bob
errors
file1
jack
jadi
linus
output
sara
who_uses_what.txt
</code></pre></div>

<p>The <code>-a</code> switch will append to files if they exist.</p>
<blockquote>
<p>If you need to save <strong><em>stderr</em></strong> too, first redirect it to <strong><em>stdout</em></strong></p>
</blockquote>
                                            <br clear="both" />
                                            <h1>103.5 Create, monitor, and kill processes</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to perform basic process management.</p>
<h2>Objectives</h2>
<ul>
<li>Run jobs in the foreground and background.</li>
<li>Signal a program to continue running after logout.</li>
<li>Monitor active processes.</li>
<li>Select and sort processes for display.</li>
<li>Send signals to processes.</li>
</ul>
<h2>Terms</h2>
<ul>
<li>&amp;</li>
<li>bg</li>
<li>fg</li>
<li>jobs</li>
<li>kill</li>
<li>nohup</li>
<li>ps</li>
<li>top</li>
<li>free</li>
<li>uptime</li>
<li>killall</li>
<li>pgrep</li>
<li>pkill</li>
<li>watch</li>
<li>screen</li>
<li>tmux</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/PQp_YPGg7GQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>Managing processes</h2>
<h3>foreground and background jobs</h3>
<p>One of the great points of Linux even from its beginning days is the ability to run different programs and jobs at the same time. This is done by sending programs to the background.</p>
<p>Normally if you run a program on the terminal, it <em>blocks</em> your terminal while it's running but sending a command to the background will prevent this:</p>
<div class="highlight"><pre><span></span><code>xeyes &amp;
</code></pre></div>

<p>Even when a program is running normally in the foreground, you can do two things:
- break it using <code>Ctrl+c</code>
- <em>suspend</em> or pause it using <code>Ctrl+z</code></p>
<p>A <em>stopped</em> job can be brought to the foreground using <code>fg</code> command (or the background using <code>bg</code>). You can also list all the jobs by the <code>jobs</code> command.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>xeyes
^Z
<span class="o">[</span><span class="m">1</span><span class="o">]</span>+<span class="w">  </span>Stopped<span class="w">                 </span>xeyes
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>+<span class="w">  </span>Stopped<span class="w">                 </span>xeyes
$<span class="w"> </span><span class="nb">bg</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>+<span class="w"> </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="m">7395</span>
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span><span class="nb">fg</span><span class="w"> </span>%2
sleep<span class="w"> </span><span class="m">1000</span>
^Z
<span class="o">[</span><span class="m">2</span><span class="o">]</span>+<span class="w">  </span>Stopped<span class="w">                 </span>sleep<span class="w"> </span><span class="m">1000</span>
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span>+<span class="w">  </span>Stopped<span class="w">                 </span>sleep<span class="w"> </span><span class="m">1000</span>
$<span class="w"> </span><span class="nb">bg</span><span class="w"> </span>sle
<span class="o">[</span><span class="m">2</span><span class="o">]</span>+<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="sb">`</span>
</code></pre></div>

<blockquote>
<p><code>jobs -l</code> also shows the process ID of jobs</p>
</blockquote>
<h3>nohup</h3>
<p>The <code>nohup</code> command lets you run your commands even after you close the terminal or logout. By default it writes its output to <code>nohup.out</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nohup<span class="w"> </span>ping<span class="w"> </span><span class="m">4</span>.2.2.4
nohup:<span class="w"> </span>ignoring<span class="w"> </span>input<span class="w"> </span>and<span class="w"> </span>appending<span class="w"> </span>output<span class="w"> </span>to<span class="w"> </span>‘nohup.out’
^C$<span class="w"> </span>cat<span class="w"> </span>nohup.out
PING<span class="w"> </span><span class="m">4</span>.2.2.4<span class="w"> </span><span class="o">(</span><span class="m">4</span>.2.2.4<span class="o">)</span><span class="w"> </span><span class="m">56</span><span class="o">(</span><span class="m">84</span><span class="o">)</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data.
<span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span><span class="m">4</span>.2.2.4:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">51</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">225</span><span class="w"> </span>ms
<span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span><span class="m">4</span>.2.2.4:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">51</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">223</span><span class="w"> </span>ms

---<span class="w"> </span><span class="m">4</span>.2.2.4<span class="w"> </span>ping<span class="w"> </span>statistics<span class="w"> </span>---
<span class="m">4</span><span class="w"> </span>packets<span class="w"> </span>transmitted,<span class="w"> </span><span class="m">2</span><span class="w"> </span>received,<span class="w"> </span><span class="m">50</span>%<span class="w"> </span>packet<span class="w"> </span>loss,<span class="w"> </span><span class="nb">time</span><span class="w"> </span>3010ms
rtt<span class="w"> </span>min/avg/max/mdev<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">223</span>.584/224.767/225.950/1.183<span class="w"> </span>ms
</code></pre></div>

<blockquote>
<p>It is common to use <code>2&gt;</code> to redirect the nohup errors to another file and use a <code>&amp;</code> to run it in the background: <code>nohup script.sh &gt; mynohup.out 2&gt;&amp;1 &amp;</code> </p>
</blockquote>
<h3>kill</h3>
<p>Despite its frightening name, the <code>kill</code> command sends unix <em>signals</em> to processes. Pressing <code>Ctrl+c</code> and <code>Ctrl+z</code> is also sending signals. By default, the <code>kill</code> command sends the signal <strong>15</strong> (which is TERM and tells to process to terminate itself).</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w">   </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">4</span><span class="o">]</span><span class="w">   </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">5</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">3000</span><span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span><span class="nb">kill</span><span class="w"> </span>%4
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w">   </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">4</span><span class="o">]</span><span class="w">   </span>Terminated<span class="w">              </span>sleep<span class="w"> </span><span class="m">1000</span>
<span class="o">[</span><span class="m">5</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">3000</span><span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w">   </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">5</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">3000</span><span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>

<p>It is also possible to use PIDs instead of job numbers and kill other signals. The general format is <code>kill -SIGNAL_ID_OR_NAME process_id</code>:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">signal number</th>
<th style="text-align: center;">signal name</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">HUP</td>
<td style="text-align: left;">Informing the process that its controlling terminal (like an ssh connection) is terminated</td>
</tr>
<tr>
<td style="text-align: center;">15</td>
<td style="text-align: center;">TERM</td>
<td style="text-align: left;">normal termination request</td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;">KILL</td>
<td style="text-align: left;">forcefully kills the proccess</td>
</tr>
</tbody>
</table>
<p></br></p>
<p>So you can do a <code>kill -9 8733</code> to force process ID 8733 to close.</p>
<blockquote>
<p>Remember the <code>nohup</code> command ? :) It means " do not respond to the hup signal ".</p>
</blockquote>
<h3>killall</h3>
<p>This command Will send the given signal (or by default 15) to all processes with the given name:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w">   </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">5</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">3000</span><span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>sleep
jadi<span class="w">      </span><span class="m">7864</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:07<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">2000</span>
jadi<span class="w">      </span><span class="m">7865</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:07<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">3000</span>
jadi<span class="w">      </span><span class="m">7977</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:14<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>sleep
$<span class="w"> </span>killall<span class="w"> </span>sleep
<span class="o">[</span><span class="m">5</span><span class="o">]</span>-<span class="w">  </span>Terminated<span class="w">              </span>sleep<span class="w"> </span><span class="m">2000</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span>+<span class="w">  </span>Terminated<span class="w">              </span>sleep<span class="w"> </span><span class="m">3000</span>
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>sleep
jadi<span class="w">      </span><span class="m">7980</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:14<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>sleep
</code></pre></div>

<h3>pkill</h3>
<p>Will send the given signal (or 15) to all the processes with a specific pattern in their name:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w">   </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">5</span><span class="o">]</span>-<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>sleep<span class="w"> </span><span class="m">3000</span><span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>sleep
jadi<span class="w">      </span><span class="m">7864</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:07<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">2000</span>
jadi<span class="w">      </span><span class="m">7865</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:07<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">3000</span>
jadi<span class="w">      </span><span class="m">7977</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:14<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>sleep
$<span class="w"> </span>pkill<span class="w"> </span>sle
<span class="o">[</span><span class="m">5</span><span class="o">]</span>-<span class="w">  </span>Terminated<span class="w">              </span>sleep<span class="w"> </span><span class="m">2000</span>
<span class="o">[</span><span class="m">6</span><span class="o">]</span>+<span class="w">  </span>Terminated<span class="w">              </span>sleep<span class="w"> </span><span class="m">3000</span>
$<span class="w"> </span><span class="nb">jobs</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span>+<span class="w">  </span>Running<span class="w">                 </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
$<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>sleep
jadi<span class="w">      </span><span class="m">7980</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:14<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>sleep
</code></pre></div>

<iframe width="560" height="315" src="https://www.youtube.com/embed/wOXrckEQosU
" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>Monitoring Processes</h2>
<h3>ps</h3>
<p>The <code>ps</code> command shows running processes on your computer. Each process has a process ID shown as <strong>PID</strong> and a Parent Process ID shown as PPID.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="m">7678</span>
$<span class="w"> </span>sleep<span class="w"> </span><span class="m">1001</span><span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="w"> </span><span class="m">7679</span>
$<span class="w"> </span>xeyes<span class="w"> </span><span class="p">&amp;</span>
<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w"> </span><span class="m">7680</span>
$<span class="w"> </span>ps
<span class="w">  </span>PID<span class="w"> </span>TTY<span class="w">          </span>TIME<span class="w"> </span>CMD
<span class="w"> </span><span class="m">7651</span><span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>bash
<span class="w"> </span><span class="m">7678</span><span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep
<span class="w"> </span><span class="m">7679</span><span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep
<span class="w"> </span><span class="m">7680</span><span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>xeyes
<span class="w"> </span><span class="m">7681</span><span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>ps
</code></pre></div>

<p>Two common switch combination is <code>ps aux</code> ( or <code>-aux</code>) and <code>ps ef</code> which shows ALL processes on a system:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
<span class="m">293</span>
</code></pre></div>

<p>It is also possible to use the <code>--sort</code> switch to sort the output based on different fields (+ for ascending &amp; - for descending).</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-af<span class="w"> </span>--sort<span class="w"> </span>+comm,-sid
UID<span class="w">        </span>PID<span class="w">  </span>PPID<span class="w">  </span>C<span class="w"> </span>STIME<span class="w"> </span>TTY<span class="w">          </span>TIME<span class="w"> </span>CMD
root<span class="w">      </span><span class="m">5486</span><span class="w">  </span><span class="m">5478</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">19</span>:59<span class="w"> </span>pts/12<span class="w">   </span><span class="m">00</span>:00:00<span class="w"> </span>-su
root<span class="w">      </span><span class="m">4444</span><span class="w">  </span><span class="m">1169</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">19</span>:56<span class="w"> </span>tty4<span class="w">     </span><span class="m">00</span>:00:00<span class="w"> </span>-bash
jadi<span class="w">      </span><span class="m">6638</span><span class="w">  </span><span class="m">5412</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:10<span class="w"> </span>pts/0<span class="w">    </span><span class="m">00</span>:00:04<span class="w"> </span>node<span class="w"> </span>/usr/local/bin/sslocal
jadi<span class="w">      </span><span class="m">7778</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:58<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>ps<span class="w"> </span>-af<span class="w"> </span>--sort<span class="w"> </span>+comm,-sid
jadi<span class="w">      </span><span class="m">7678</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:48<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span>
jadi<span class="w">      </span><span class="m">7679</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:48<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">1001</span>
jadi<span class="w">      </span><span class="m">7775</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:58<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span>
jadi<span class="w">      </span><span class="m">7776</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:58<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span>
jadi<span class="w">      </span><span class="m">7777</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:58<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>sleep<span class="w"> </span><span class="m">1000</span>
root<span class="w">      </span><span class="m">5478</span><span class="w">  </span><span class="m">5477</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">19</span>:59<span class="w"> </span>pts/12<span class="w">   </span><span class="m">00</span>:00:00<span class="w"> </span>su<span class="w"> </span>-
root<span class="w">      </span><span class="m">5477</span><span class="w">  </span><span class="m">5008</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">19</span>:59<span class="w"> </span>pts/12<span class="w">   </span><span class="m">00</span>:00:00<span class="w"> </span>sudo<span class="w"> </span>su<span class="w"> </span>-
jadi<span class="w">      </span><span class="m">7680</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:48<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:01<span class="w"> </span>xeyes
</code></pre></div>

<h3>pgrep</h3>
<p>You've seen that <code>ps -ef</code> shows processes from all users. We can <code>grep</code> on that and see who is running <code>gedit</code> and what is its process ID:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>gedit
jadi<span class="w">      </span><span class="m">6213</span><span class="w">  </span><span class="m">4604</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">20</span>:06<span class="w"> </span>?<span class="w">        </span><span class="m">00</span>:04:43<span class="w"> </span>gedit
jadi<span class="w">      </span><span class="m">7725</span><span class="w">  </span><span class="m">7651</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:55<span class="w"> </span>pts/1<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>gedit
</code></pre></div>

<p>but there is also a more direct way to check the PID of all gedit processes:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pgrep<span class="w"> </span>gedit<span class="w"> </span>
<span class="m">6213</span>
</code></pre></div>

<h3>top</h3>
<p>This is the most common tool to do simple monitoring of the system. It will update the status and will give you a good glance at the status:</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="n">top</span>

<span class="n">top</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">21</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">44</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">users</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">1.51</span><span class="p">,</span><span class="w"> </span><span class="mf">1.65</span><span class="p">,</span><span class="w"> </span><span class="mf">1.78</span>
<span class="n">Tasks</span><span class="p">:</span><span class="w"> </span><span class="mi">293</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w">   </span><span class="mi">1</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="mi">292</span><span class="w"> </span><span class="n">sleeping</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">stopped</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">zombie</span>
<span class="o">%</span><span class="n">Cpu</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="w"> </span><span class="mf">19.0</span><span class="w"> </span><span class="n">us</span><span class="p">,</span><span class="w">  </span><span class="mf">5.0</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">ni</span><span class="p">,</span><span class="w"> </span><span class="mf">70.9</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">  </span><span class="mf">5.1</span><span class="w"> </span><span class="n">wa</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">hi</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">si</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">st</span>
<span class="n">KiB</span><span class="w"> </span><span class="n">Mem</span><span class="p">:</span><span class="w">   </span><span class="mi">8060264</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w">  </span><span class="mi">5359812</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w">  </span><span class="mi">2700452</span><span class="w"> </span><span class="n">free</span><span class="p">,</span><span class="w">   </span><span class="mi">169240</span><span class="w"> </span><span class="n">buffers</span>
<span class="n">KiB</span><span class="w"> </span><span class="n">Swap</span><span class="p">:</span><span class="w">  </span><span class="mi">7811068</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w">        </span><span class="mi">0</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w">  </span><span class="mi">7811068</span><span class="w"> </span><span class="n">free</span><span class="o">.</span><span class="w">  </span><span class="mi">2250692</span><span class="w"> </span><span class="n">cached</span><span class="w"> </span><span class="n">Mem</span>

<span class="w">  </span><span class="n">PID</span><span class="w"> </span><span class="n">USER</span><span class="w">      </span><span class="n">PR</span><span class="w">  </span><span class="n">NI</span><span class="w">    </span><span class="n">VIRT</span><span class="w">    </span><span class="n">RES</span><span class="w">    </span><span class="n">SHR</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="o">%</span><span class="n">CPU</span><span class="w"> </span><span class="o">%</span><span class="n">MEM</span><span class="w">     </span><span class="n">TIME</span><span class="o">+</span><span class="w"> </span><span class="n">COMMAND</span><span class="w">                                                                                                                </span>
<span class="w"> </span><span class="mi">6570</span><span class="w"> </span><span class="n">jadi</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1437752</span><span class="w"> </span><span class="mi">546064</span><span class="w">  </span><span class="mi">88312</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="mf">18.4</span><span class="w">  </span><span class="mf">6.8</span><span class="w">  </span><span class="mi">12</span><span class="p">:</span><span class="mf">00.96</span><span class="w"> </span><span class="n">firefox</span><span class="w">                                                                                                                </span>
<span class="w"> </span><span class="mi">4870</span><span class="w"> </span><span class="n">jadi</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1762516</span><span class="w"> </span><span class="mi">299120</span><span class="w">  </span><span class="mi">75664</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="mf">12.2</span><span class="w">  </span><span class="mf">3.7</span><span class="w">   </span><span class="mi">7</span><span class="p">:</span><span class="mf">37.05</span><span class="w"> </span><span class="n">compiz</span><span class="w">                                                                                                                 </span>
<span class="w"> </span><span class="mi">4492</span><span class="w"> </span><span class="n">jadi</span><span class="w">       </span><span class="mi">9</span><span class="w"> </span><span class="o">-</span><span class="mi">11</span><span class="w">  </span><span class="mi">455152</span><span class="w">  </span><span class="mi">11516</span><span class="w">   </span><span class="mi">8940</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">6.1</span><span class="w">  </span><span class="mf">0.1</span><span class="w">   </span><span class="mi">1</span><span class="p">:</span><span class="mf">06.81</span><span class="w"> </span><span class="n">pulseaudio</span><span class="w">                                                                                                             </span>
<span class="w"> </span><span class="mi">4532</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">  </span><span class="mi">389028</span><span class="w">  </span><span class="mi">77116</span><span class="w">  </span><span class="mi">60192</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">6.1</span><span class="w">  </span><span class="mf">1.0</span><span class="w">  </span><span class="mi">12</span><span class="p">:</span><span class="mf">16.63</span><span class="w"> </span><span class="n">Xorg</span><span class="w">                                                                                                                   </span>
<span class="w"> </span><span class="mi">4723</span><span class="w"> </span><span class="n">jadi</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">  </span><span class="mi">358936</span><span class="w">   </span><span class="mi">8288</span><span class="w">   </span><span class="mi">5512</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">6.1</span><span class="w">  </span><span class="mf">0.1</span><span class="w">   </span><span class="mi">9</span><span class="p">:</span><span class="mf">51.52</span><span class="w"> </span><span class="n">ibus</span><span class="o">-</span><span class="n">daemon</span><span class="w">                                                                                                            </span>
<span class="w"> </span><span class="mi">5648</span><span class="w"> </span><span class="n">jadi</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1641556</span><span class="w"> </span><span class="mi">203676</span><span class="w"> </span><span class="mi">102840</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">6.1</span><span class="w">  </span><span class="mf">2.5</span><span class="w">   </span><span class="mi">3</span><span class="p">:</span><span class="mf">20.88</span><span class="w"> </span><span class="n">chrome</span><span class="w">                                                                                                                 </span>
<span class="w"> </span><span class="mi">7082</span><span class="w"> </span><span class="n">jadi</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">1210748</span><span class="w">  </span><span class="mi">73136</span><span class="w">  </span><span class="mi">42528</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">6.1</span><span class="w">  </span><span class="mf">0.9</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">36.51</span><span class="w"> </span><span class="n">Telegram</span><span class="w">                                                                                                               </span>
<span class="w"> </span><span class="mi">7806</span><span class="w"> </span><span class="n">jadi</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">33796</span><span class="w">   </span><span class="mi">3004</span><span class="w">   </span><span class="mi">2500</span><span class="w"> </span><span class="n">R</span><span class="w">   </span><span class="mf">6.1</span><span class="w">  </span><span class="mf">0.0</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">00.02</span><span class="w"> </span><span class="n">top</span><span class="w">                                                                                                                    </span>
<span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">29528</span><span class="w">   </span><span class="mi">4320</span><span class="w">   </span><span class="mi">2584</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.1</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">01.71</span><span class="w"> </span><span class="n">init</span>
</code></pre></div>

<p>You can see the processes, system load, uptime, CPU status, memory, ... and do some stuff:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">key during top</th>
<th style="text-align: left;">functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">h</td>
<td style="text-align: left;">help</td>
</tr>
<tr>
<td style="text-align: center;">q</td>
<td style="text-align: left;">quit</td>
</tr>
<tr>
<td style="text-align: center;">M</td>
<td style="text-align: left;">sort based on memory usage</td>
</tr>
<tr>
<td style="text-align: center;">c</td>
<td style="text-align: left;">show full commands</td>
</tr>
<tr>
<td style="text-align: center;">k</td>
<td style="text-align: left;">kill after asking pid and signal</td>
</tr>
</tbody>
</table>
<h3>free</h3>
<p>The <code>free</code> command will show you info about the system memory. The default is <em>kilobytes</em> but you can change it with <code>-m</code> for megabytes, <code>-g</code> for <em>gigabytes</em> or even <code>-b</code> for bytes. You can also use the <code>-h</code> for <strong>human readable</strong>. </p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>free<span class="w"> </span>-m
<span class="w">             </span>total<span class="w">       </span>used<span class="w">       </span>free<span class="w">     </span>shared<span class="w">    </span>buffers<span class="w">     </span>cached
Mem:<span class="w">          </span><span class="m">7871</span><span class="w">       </span><span class="m">5231</span><span class="w">       </span><span class="m">2640</span><span class="w">        </span><span class="m">332</span><span class="w">        </span><span class="m">169</span><span class="w">       </span><span class="m">2195</span>
-/+<span class="w"> </span>buffers/cache:<span class="w">       </span><span class="m">2866</span><span class="w">       </span><span class="m">5005</span>
Swap:<span class="w">         </span><span class="m">7627</span><span class="w">          </span><span class="m">0</span><span class="w">       </span><span class="m">7627</span>
</code></pre></div>

<blockquote>
<p>A general <strong>hint</strong>: If your system is using Swap, you have memory issues.</p>
</blockquote>
<h3>uptime</h3>
<p>The <code>uptime</code> command shows the time, systems uptime (how long the system has been running), how many users are logged in, and the load average of 1, 5 &amp; 15 minutes:</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">uptime</span>
<span class="w"> </span><span class="mi">21</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">52</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">1</span><span class="p">:</span><span class="mi">34</span><span class="p">,</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">users</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">2.38</span><span class="p">,</span><span class="w"> </span><span class="mf">2.64</span><span class="p">,</span><span class="w"> </span><span class="mf">2.41</span>
</code></pre></div>

<blockquote>
<p>Although it's one of the most important KPIs of the system status, some of the experienced Linux admins do not know what the load average means. The load average shows how many processes are in the <strong>to be run</strong> queue. If this number is higher than the number of your CPU cores, you are in a bad situation. If it's close to the number of your cores constantly, it's kind of dangerous, and if it's less than 1/10th of your core numbers, your system is kind of idle. Do you remember how to check the number of your cores? Its in <code>/proc/cpuinfo</code> or <code>nproc</code>.</p>
</blockquote>
<h3>watch</h3>
<p>Sometimes you have a command which shows you an output but you want to keep running it and observing the output. In these cases, the <code>watch</code> is your friend. It lets you run and check the output of a command in specific time intervals (default is 2 seconds). </p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>watch<span class="w"> </span>free<span class="w"> </span>-h
</code></pre></div>

<p>If you have a pipe in your command, you have to quote the watched command in double-quote <code>"</code> or single-quote <code>'</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>watch<span class="w"> </span><span class="s2">&quot;ls -ltrh | wc -l&quot;</span>
</code></pre></div>

<p>These are some of the switches:</p>
<ul>
<li><code>-n</code> To specify the interval in seconds</li>
<li><code>-b</code> Beep if the command has a non-zero exit</li>
<li><code>-d</code> Shows the difference between runs</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/7SDvwr7jVU8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>Terminal Multiplexers</h2>
<h3>screen</h3>
<p>If you are used to GUI based system, it's easy to run different terminals side to side and use them to run different programs. But if you are on a server, you need other tools to multiplex your terminal. One such command is <code>screen</code>. </p>
<p>Run it with <code>screen</code> and press enter to exit the welcome window into a prompt. You can use it as a normal terminal and detach from it (and let it run in the background) using the Ctrl + A and then D keys. Check the list of your screens with <code>screen -ls</code> and re-attach to any of them with <code>screen -r screen-id</code>. </p>
<p>Below you can see a few common switches, they all should be issued after the <code>Ctrl + A</code> combination.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">\</td>
<td>Kill all processes windows and terminate the screen</td>
</tr>
<tr>
<td style="text-align: center;">|</td>
<td>Split current window into two vertical focuses</td>
</tr>
<tr>
<td style="text-align: center;">Shift+S</td>
<td>Split current window into two horizontal focuses</td>
</tr>
<tr>
<td style="text-align: center;">C</td>
<td>Create a window in the current focus</td>
</tr>
<tr>
<td style="text-align: center;">Tab</td>
<td>Go to the next focus</td>
</tr>
<tr>
<td style="text-align: center;">D</td>
<td>Detach from window</td>
</tr>
<tr>
<td style="text-align: center;">K</td>
<td>Kill current window</td>
</tr>
<tr>
<td style="text-align: center;">N</td>
<td>Move to Next window</td>
</tr>
<tr>
<td style="text-align: center;">P</td>
<td>Move to the Previous window</td>
</tr>
</tbody>
</table>
<p>A great point about screen (and tmux) is the fact it remains running even after you logout of the system and its possible to relogin and re-attach to the same screen (or tmux)</p>
<h3>tmux</h3>
<p>Is a screen on steroids! It is not installed by default in most distributions and you have to install it first. The default command prefix is <code>Ctrl+B</code> and after running the <code>tmux new</code> you can issue these:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Key</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">%</td>
<td>Split current window vertically</td>
</tr>
<tr>
<td style="text-align: center;">"</td>
<td>Split current window horizontally</td>
</tr>
<tr>
<td style="text-align: center;">D</td>
<td>Detach from the current window</td>
</tr>
<tr>
<td style="text-align: center;">&amp;</td>
<td>Kill current window</td>
</tr>
</tbody>
</table>
<p>You can list the tmux sessions using <code>tmux ls</code> and re-attach to one using <code>tmux att</code> to connect to the last one or <code>tmux att -t session_name</code> to attach to a specific one.</p>
<blockquote>
<p>I highly recommend being fluent in tmux. It's super useful even when you are working locally on your machine. watch the below video for the more in-depth session:</p>
</blockquote>
<iframe width="560" height="315" src="https://www.youtube.com/embed/RvsTIt7cjy0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                            <br clear="both" />
                                            <h1>103.6 Modify process execution priorities</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Candidates should be able to manage process execution priorities.</p>
<h2>Objectives</h2>
<ul>
<li>Know the default priority of a job that is created.</li>
<li>Run a program with higher or lower priority than the default.</li>
<li>Change the priority of a running process.</li>
</ul>
<h2>Terms</h2>
<ul>
<li>nice</li>
<li>ps</li>
<li>renice</li>
<li>top</li>
</ul>
<p>On a Linux machine, you might have 100s of processes running at the same time and competing for more CPU &amp; RAM. The good news is that you can give some of the processes higher or lower priority (or nice-ness) in this competition. Let's have a look at a sample <code>top</code> output:</p>
<div class="highlight"><pre><span></span><code>$ top

Tasks: 169 total,   1 running, 168 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  3.0 sy,  0.0 ni, 97.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :   5948.9 total,   4115.2 free,    438.2 used,   1395.5 buff/cache
MiB Swap:    975.0 total,    975.0 free,      0.0 used.   5210.3 avail Mem 

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND                                        
   6496 jadi      20   0   10112   3704   3212 R   6.2   0.1   0:00.01 top                                            
      1 root      20   0  165172  10576   7780 S   0.0   0.2   0:02.80 systemd                                        
      2 root      20   0       0      0      0 S   0.0   0.0   0:00.09 kthreadd                                       
      3 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_gp                                         
      4 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_par_gp                                     
      6 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker/0:0H-events_highpri                    
      8 root       0 -20       0      0      0 I   0.0   0.0   0:12.71 kworker/0:1H-events_highpri                    
      9 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 mm_percpu_wq                                   
     10 root      20   0       0      0      0 S   0.0   0.0   0:00.00 rcu_tasks_rude_                                
     11 root      20   0       0      0      0 S   0.0   0.0   0:00.00 rcu_tasks_trace
</code></pre></div>

<p>The <strong>NI</strong> column shows how <strong>nice</strong> this process is. The nicer the process, the less CPU it asks. The <code>nice</code> values can be from -20 to 19. To interpret this value, look at it like this: a process with nice = <strong>-20</strong> is ANGRY and gets more priority for CPU and RAM while a process with nice = <strong>19</strong> is SUPER NICE and lets <strong>other</strong> processes use the resources before her).</p>
<p>The default value for <code>nice</code> is normally set to 0; this can be checked with:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nice
<span class="m">0</span>
</code></pre></div>

<p>You can also check the nice-ness using the <code>ps</code> command:</p>
<div class="highlight"><pre><span></span><code>$ ps -l
F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD
0 S  1000 15044 15035  0  80   0 -  7453 wait   pts/29   00:00:00 bash
0 S  1000 15052 15044  0  60 -20 -  3976 hrtime pts/29   00:00:00 sleep
0 R  1000 15080 15044  0  80   0 -  4680 -      pts/29   00:00:00 ps
</code></pre></div>

<h3>Setting nice-ness</h3>
<p>If you need to change the niceness level of a program you can run it with <code>nice</code> command and <code>-n</code> switch (for nice):</p>
<div class="highlight"><pre><span></span><code>$ nice -n 19 echo &quot;I am running!&quot;
I am running!
$ nice -n -20 echo &quot;I am running!&quot;
nice: cannot set niceness: Permission denied
I am running!
$ sudo nice -n -20 echo &quot;I am running!&quot;
I am running!
</code></pre></div>

<p>As you can in the above example, only the root can issue high-priority niceness (below 0).</p>
<blockquote>
<p>If you run a command with <code>nice</code> without <code>-n</code>, the default will be <code>-n 10</code></p>
</blockquote>
<div class="highlight"><pre><span></span><code>$ nice xeyes &amp;
[1] 15217
$ ps -l
F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD
0 S  1000 15044 15035  0  80   0 -  7455 wait   pts/29   00:00:00 bash
0 S  1000 15217 15044  0  90  10 - 12522 poll_s pts/29   00:00:00 xeyes
0 R  1000 15218 15044  0  80   0 -  4680 -      pts/29   00:00:00 ps
</code></pre></div>

<h3>Changing priorities</h3>
<p>The <code>renice</code> command can be used to change the <em>niceness</em> of your running processes (or others if you are root):</p>
<div class="highlight"><pre><span></span><code>$ ps -ef | grep firefox
jadi     13605 11226 30 08:28 ?        00:10:13 /usr/lib/firefox/firefox
jadi     15192 15044  0 09:01 pts/29   00:00:00 grep firefox
$ sudo renice -n -10 13605
13605 (process ID) old priority 5, new priority -10
</code></pre></div>

<blockquote>
<p>You can also press <code>r</code> in <code>top</code> command to renice a process</p>
</blockquote>
                                            <br clear="both" />
                                            <h1>103.7 Search text files using regular expressions</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to manipulate files and text data using regular expressions. This objective includes creating simple regular expressions containing several notational elements as well as understanding the differences between basic and extended regular expressions. It also includes using regular expression tools to perform searches through a filesystem or file content.</p>
<h2>Objectives</h2>
<ul>
<li>Create simple regular expressions containing several notational elements.</li>
<li>Understand the differences between basic and extended regular expressions.</li>
<li>Understand the concepts of special characters, character classes, quantifiers, and anchors.</li>
<li>Use regular expression tools to perform searches through a filesystem or file content.</li>
<li>
<p>Use regular expressions to delete, change and substitute text.</p>
</li>
<li>
<p>grep</p>
</li>
<li>egrep</li>
<li>fgrep</li>
<li>sed</li>
<li>regex(7)</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/wa1OFZ-Ck-0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>Regex</h3>
<p>Regular expression, Regex, regex is a pattern to describe what you want to <em>match</em> from a text. For example <code>a</code> and <code>ad</code> both matches <code>jadi</code>. <code>d.</code> is a <em>deeper</em> example because <code>.</code> means <em>anything</em> so <code>d.</code> will match the last two characters of <code>jadi</code>. In this section, we will cover the <em>grep</em>* (generalised regular expression processor) command. It has different regex <em>dialect</em>; in short Basic regex and Extended regex.</p>
<h4>Regex basics</h4>
<p><strong>Simple match</strong>
You can simply write down whatever you want to match and regex will search for that.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Regex</th>
<th style="text-align: left;">Will match</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">a</td>
<td style="text-align: left;"><strong>a</strong>fter, min<strong>a</strong>, b<strong>a</strong>nana, j<strong>a</strong>di</td>
</tr>
<tr>
<td style="text-align: left;">na</td>
<td style="text-align: left;"><strong>na</strong>rator, mi<strong>na</strong>, <strong>na</strong>nanana batman, so<strong>na</strong>r</td>
</tr>
</tbody>
</table>
<p></br></p>
<p><strong>Repeating</strong></p>
<ul>
<li>The <strong><code>\*</code></strong> means repeating the previous character 0 or more times.</li>
<li>The <strong><code>+</code></strong> means repeating the previous character 1 or more times.</li>
<li>the <strong><code>?</code></strong> means zero or one repeats.</li>
<li><strong><code>{n,m}</code></strong> means the item needs to match at least n times, but not more than m times.</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Regex</th>
<th style="text-align: left;">Will match</th>
<th style="text-align: left;">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">a*b</td>
<td style="text-align: left;">ab, aaab, aaaaab, aaabthis</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">a*b</td>
<td style="text-align: left;">b, sober</td>
<td style="text-align: left;">we should have zero or more <code>a</code>s and then a <code>b</code></td>
</tr>
<tr>
<td style="text-align: left;">a+b</td>
<td style="text-align: left;">ab, aab, aaabenz</td>
<td style="text-align: left;">wont match <strong>sober</strong> or <strong>b</strong> because there needs to be at least one <strong>a</strong></td>
</tr>
<tr>
<td style="text-align: left;">a?b</td>
<td style="text-align: left;">ab, a<strong>ab</strong>, b, batman (zero a then b), ...</td>
<td style="text-align: left;">.</td>
</tr>
</tbody>
</table>
<p></br></p>
<p><strong>Alternation (|)</strong></p>
<p>If you say <code>a|b</code> it will match <code>a</code> or <code>b</code>.</p>
<p></br></p>
<p><strong>Character Classes</strong></p>
<p>The dot (<strong><code>.</code></strong>) means any character. So <strong><code>..</code></strong> will match anything with at least two characters in it. You can also create your classes with [abc] which will match a or b or c and [a-z] which match a to z.</p>
<p>You can also refer to digits with \d. </p>
<blockquote>
<p>regex is case-sensitive.</p>
</blockquote>
<p><strong>Ranges</strong></p>
<p>There are shorthands for commonly used classes. Named classes to start with <code>[:</code> and end with <code>:]</code>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Range</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">[:alnum:]</td>
<td style="text-align: left;">Alphanumeric characters</td>
</tr>
<tr>
<td style="text-align: left;">[:blank:]</td>
<td style="text-align: left;">Space and tab characters</td>
</tr>
<tr>
<td style="text-align: left;">[:digit:]</td>
<td style="text-align: left;">The digits 0 through 9 (equivalent to 0-9)</td>
</tr>
<tr>
<td style="text-align: left;">[:upper:] and [:lower:]</td>
<td style="text-align: left;">Upper and lower case letters, respectively.</td>
</tr>
<tr>
<td style="text-align: left;">^ (negation)</td>
<td style="text-align: left;">As the first character after [ in a character class negates the sense of the remaining characters</td>
</tr>
</tbody>
</table>
<blockquote>
<p>A common used regex is .* which matches any character (zero or any length).</p>
</blockquote>
<p><strong>Matching at specific locations</strong></p>
<ul>
<li>The caret <strong><code>^</code></strong> means beginning of the string.</li>
<li>The dollar <strong><code>$</code></strong> means the end of the string.</li>
</ul>
<h4>Samples</h4>
<ul>
<li><code>^a.*</code> Matches anything that starts with <strong>a</strong>.</li>
<li><code>^a.*b$</code> Matches anything that starts with <strong>a</strong> and ends with <strong>b</strong>.</li>
<li><code>^a.*\d+.*b$</code> Matches anything that starting with <strong>a</strong>, have some digits in the middle and ends with <strong>b</strong>.</li>
<li><code>^(l|b)oo</code> Matches anything that starts with <strong>l</strong> or <strong>b</strong> and then have <strong>oo</strong></li>
<li><code>[f-h]|[A-K]$</code> The last character should be <strong>f</strong> to <strong>h</strong> (small) or <strong>A</strong> to <strong>K</strong> (capital)</li>
</ul>
<h3>grep</h3>
<p>The <code>grep</code> command can search inside the files.</p>
<div class="highlight"><pre><span></span><code>$ grep funk words 
Garfunkel
Garfunkel&#39;s
funk
funked
funkier
funkiest
funking
funk&#39;s
funks
funky
</code></pre></div>

<p>These are the most common switches:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">switch</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-c</td>
<td style="text-align: left;">just show the count</td>
</tr>
<tr>
<td style="text-align: left;">-v</td>
<td style="text-align: left;">reverse the search</td>
</tr>
<tr>
<td style="text-align: left;">-n</td>
<td style="text-align: left;">show line numbers</td>
</tr>
<tr>
<td style="text-align: left;">-l</td>
<td style="text-align: left;">show only file names</td>
</tr>
<tr>
<td style="text-align: left;">-i</td>
<td style="text-align: left;">case insensitive</td>
</tr>
<tr>
<td style="text-align: left;">-r</td>
<td style="text-align: left;">Read  all  files  under each directory, recursively</td>
</tr>
</tbody>
</table>
<p></br></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>grep<span class="w"> </span>a<span class="w"> </span>*txt
friends.txt:Rosha
friends.txt:Xavier
friends.txt:Krishna
friends.txt:Mary
my_thinkgs.txt:laptop
$<span class="w"> </span>grep<span class="w"> </span>z<span class="w"> </span>*txt
$<span class="w"> </span>grep<span class="w"> </span>z<span class="w"> </span>*txt<span class="w"> </span>-i<span class="w"> </span>
friends.txt:Zee
$<span class="w"> </span>grep<span class="w"> </span>x<span class="w"> </span>words<span class="w"> </span>-i<span class="w"> </span>-c<span class="w"> </span>
<span class="m">2264</span>
$<span class="w"> </span>grep<span class="w"> </span>z<span class="w"> </span>*txt<span class="w"> </span>-i<span class="w"> </span>-l
friends.txt
$<span class="w"> </span>grep<span class="w"> </span>Z<span class="w"> </span>*txt<span class="w"> </span>-v
friends.txt:Rosha
friends.txt:Jim
friends.txt:Xavier
friends.txt:Krishna
friends.txt:Mary
my_thinkgs.txt:laptop
my_thinkgs.txt:pillow
my_thinkgs.txt:shorts
my_thinkgs.txt:t-shirt
$<span class="w"> </span>grep<span class="w"> </span>Z<span class="w"> </span>friends.txt<span class="w"> </span>-v
Rosha
Jim
Xavier
Krishna
Mary
$<span class="w"> </span>
</code></pre></div>

<p>As another example, let's search all the <code>/etc</code> for all files containing an IP address and send the errors (mostly "you do not have permission to read this") to <code>/dev/null</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>egrep<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;192.168.(1|0).&quot;</span><span class="w"> </span>/etc/<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>/dev/null
/etc/privoxy/config:#<span class="w">      </span>address<span class="w"> </span><span class="m">192</span>.168.0.1<span class="w"> </span>on<span class="w"> </span>your<span class="w"> </span><span class="nb">local</span><span class="w"> </span>private<span class="w"> </span>network
/etc/privoxy/config:#<span class="w">      </span><span class="o">(</span><span class="m">192</span>.168.0.0<span class="o">)</span><span class="w"> </span>and<span class="w"> </span>has<span class="w"> </span>another<span class="w"> </span>outside<span class="w"> </span>connection<span class="w"> </span>with<span class="w"> </span>a
/etc/privoxy/config:#<span class="w">        </span>listen-address<span class="w">  </span><span class="m">192</span>.168.0.1:8118
/etc/avahi/hosts:#<span class="w"> </span><span class="m">192</span>.168.0.1<span class="w"> </span>router.local
/etc/dhcp/dhclient-exit-hooks.d/rfc3442-classless-routes:#<span class="w">   </span><span class="nv">new_rfc3442_classless_static_routes</span><span class="o">=</span><span class="s1">&#39;24 192 168 10 192 168 1 1 8 10 10 17 66 41&#39;</span>
/etc/dhcp/dhclient-exit-hooks.d/rfc3442-classless-routes:#<span class="w">   </span><span class="m">192</span>.168.10.0/24<span class="w"> </span>via<span class="w"> </span><span class="m">192</span>.168.1.1
/etc/hosts:192.168.1.22<span class="w"> </span>atiteltestbed
/etc/hosts:192.168.100.244<span class="w"> </span>adpsms
/etc/ppp/options:#<span class="w"> </span>ms-dns<span class="w"> </span><span class="m">192</span>.168.1.1
/etc/ppp/options:#<span class="w"> </span>ms-dns<span class="w"> </span><span class="m">192</span>.168.1.2
/etc/ppp/options:#<span class="w"> </span>ms-wins<span class="w"> </span><span class="m">192</span>.168.1.50
/etc/ppp/options:#<span class="w"> </span>ms-wins<span class="w"> </span><span class="m">192</span>.168.1.51
/etc/ssl/openssl.cnf:#<span class="w"> </span><span class="nv">proxy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1"># set this as far as needed, e.g., http://192.168.1.1:8080</span>
/etc/cups/cups-browsed.conf:#<span class="w"> </span>BrowseAllow<span class="w"> </span><span class="m">192</span>.168.1.12
/etc/cups/cups-browsed.conf:#<span class="w"> </span>BrowseAllow<span class="w"> </span><span class="m">192</span>.168.1.0/24
/etc/cups/cups-browsed.conf:#<span class="w"> </span>BrowseAllow<span class="w"> </span><span class="m">192</span>.168.1.0/255.255.255.0
/etc/cups/cups-browsed.conf:#<span class="w"> </span>BrowseDeny<span class="w"> </span><span class="m">192</span>.168.1.13
/etc/proxychains4.conf:##<span class="w"> </span>Exclude<span class="w"> </span>connections<span class="w"> </span>to<span class="w"> </span><span class="m">192</span>.168.1.0/24<span class="w"> </span>with<span class="w"> </span>port<span class="w"> </span><span class="m">80</span>
/etc/proxychains4.conf:#<span class="w"> </span>localnet<span class="w"> </span><span class="m">192</span>.168.1.0:80/255.255.255.0
/etc/proxychains4.conf:##<span class="w"> </span>Exclude<span class="w"> </span>connections<span class="w"> </span>to<span class="w"> </span><span class="m">192</span>.168.100.0/24
/etc/proxychains4.conf:#<span class="w"> </span>localnet<span class="w"> </span><span class="m">192</span>.168.100.0/255.255.255.0
/etc/proxychains4.conf:#<span class="w"> </span>localnet<span class="w"> </span><span class="m">192</span>.168.0.0/255.255.0.0
/etc/proxychains4.conf:#<span class="w">        </span>socks4<span class="w">  </span><span class="m">192</span>.168.1.49<span class="w">    </span><span class="m">1080</span>
/etc/sane.d/kodakaio.conf:#net<span class="w"> </span><span class="m">192</span>.168.1.2<span class="w"> </span>0x4041
/etc/sane.d/kodakaio.conf:#net<span class="w"> </span><span class="m">192</span>.168.1.17<span class="w"> </span>0x4067
/etc/sane.d/epsonds.conf:#<span class="w"> </span>net<span class="w"> </span><span class="m">192</span>.168.1.123
/etc/sane.d/airscan.conf:#<span class="s2">&quot;Kyocera MFP Scanner&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>http://192.168.1.102:9095/eSCL
/etc/sane.d/airscan.conf:#ip<span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="m">192</span>.168.0.1<span class="w">    </span><span class="p">;</span><span class="w"> </span>blacklist<span class="w"> </span>by<span class="w"> </span>address
/etc/sane.d/airscan.conf:#ip<span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="m">192</span>.168.0.0/24<span class="w"> </span><span class="p">;</span><span class="w"> </span>blacklist<span class="w"> </span>the<span class="w"> </span>whole<span class="w"> </span>subnet
/etc/sane.d/dell1600n_net.conf:#named_scanner:<span class="w"> </span><span class="m">192</span>.168.0.20
/etc/sane.d/epson2.conf:#<span class="w"> </span>net<span class="w"> </span><span class="m">192</span>.168.1.123
/etc/sane.d/magicolor.conf:#<span class="w"> </span>net<span class="w"> </span><span class="m">192</span>.168.0.1
/etc/sane.d/saned.conf:#192.168.0.1
/etc/sane.d/saned.conf:#192.168.0.1/29
/etc/fwupd/redfish.conf:#<span class="w"> </span>ex:<span class="w"> </span>https://192.168.0.133:443
</code></pre></div>

<h3>Extended grep</h3>
<p>Regex is cool and <code>grep</code> is awesome so many people have tried adding to them or inventing their variants. One is GNU Extended grep. This dialect of regex, does not need much escaping and you can use it via <code>-E</code> switch or using <code>egrep</code> instead of the normal <code>grep</code>. For example, <code>|</code> in an extended regex means "or". So you can do a <code>egrep "a|b" words</code> to match anything with an <code>a</code> or a <code>b</code>. </p>
<h3>Fixed grep</h3>
<p>If you need to search for exact strings (and not interpret it as a regex), use <code>grep -F</code> or <code>fgrep</code> so the <code>fgrep this$</code> won't go for the end of the line and will find <em>this$that</em> instead.</p>
<h3>sed</h3>
<p>In previous lessons, we saw simple <code>sed</code> usage and now I have great news for you: <strong>sed understands regex</strong>! You can use <code>-r</code> switch to tell sed that we are using regexes.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sed<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;s/(Z|R|J)/starts with ZRJ/&quot;</span><span class="w"> </span>friends.txt<span class="w"> </span>
starts<span class="w"> </span>with<span class="w"> </span>ZRJee
starts<span class="w"> </span>with<span class="w"> </span>ZRJosha
starts<span class="w"> </span>with<span class="w"> </span>ZRJim
Xavier
Krishna
Mary
</code></pre></div>

<p>Common switches:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">switch</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-r</td>
<td style="text-align: left;">use advanced regex</td>
</tr>
<tr>
<td style="text-align: left;">-n</td>
<td style="text-align: left;">suppress output, you can use p at the end of your regex ( /something/p ) to print the output</td>
</tr>
</tbody>
</table>
<p></br></p>
<div class="highlight"><pre><span></span><code>sed -rn &quot;s/happy/HAPPY/p&quot; words 
HAPPY
slapHAPPY
unHAPPY
</code></pre></div>

<p>Still eager to learn? See how you can solve the Wordle using regexes:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ZbdTghkVM_4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                            <br clear="both" />
                                            <h1>103.8 Basic file editing</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to edit text files using vi. This objective includes vi navigation, vi modes, inserting, editing, deleting, copying and finding text. It also includes awareness of other common editors and setting the default editor.</p>
<h3>Objectives</h3>
<ul>
<li>Navigate a document using vi.</li>
<li>Understand and use vi modes.</li>
<li>Insert, edit, delete, copy and find text in vi.</li>
<li>Awareness of Emacs, nano and vim.</li>
<li>
<p>Configure the standard editor.</p>
</li>
<li>
<p>vi</p>
</li>
<li>/, ?</li>
<li>h,j,k,l</li>
<li>i, o, a</li>
<li>d, p, y, dd, yy</li>
<li>ZZ, :w!, :q!</li>
<li>EDITOR</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/7S5RaX1OsTE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>Introduction</h3>
<p>As any other tool, we have a wide range of selection when it comes to text editors. One of the most common and super powerful choices is the <code>vi</code> editor. It is pre-installed on all major Linux distributions and you can be sure that knowing it, will let you edit your files on all environments, let it be a remote server over SSH or a coding environment on your desktop machine or a CyberDeck machine with a minimal keyboard. Its only <em>drawback</em> might be its kind of slow learning curve but I'm sure after a 1 hour session with it, you will manage to find your way in <code>vi</code>.</p>
<p>There is an <em>Improved</em> version of <code>vi</code> which is called <em>VIMproved</em> or <code>vim</code>. Sometimes thats what you will find on your system and sometimes the <code>vi</code> command is aliased or linked to <code>vim</code>. Lets check this on our system (Ubuntu 22.04):</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="err">@</span><span class="n">funlife</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="n">whatis</span><span class="w"> </span><span class="n">vi</span>
<span class="n">vi</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">               </span><span class="o">-</span><span class="w"> </span><span class="n">Vi</span><span class="w"> </span><span class="n">IMproved</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">programmer</span><span class="s1">&#39;s text editor</span>
<span class="n">jadi</span><span class="err">@</span><span class="n">funlife</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="n">whereis</span><span class="w"> </span><span class="n">vi</span>
<span class="n">vi</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">vi</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">man</span><span class="o">/</span><span class="n">man1</span><span class="o">/</span><span class="n">vi</span><span class="o">.</span><span class="mf">1.</span><span class="n">gz</span>
<span class="n">jadi</span><span class="err">@</span><span class="n">funlife</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="n">whatis</span><span class="w"> </span><span class="n">vim</span>
<span class="n">vim</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">              </span><span class="o">-</span><span class="w"> </span><span class="n">Vi</span><span class="w"> </span><span class="n">IMproved</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">programmer</span><span class="s1">&#39;s text editor</span>
<span class="n">jadi</span><span class="err">@</span><span class="n">funlife</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="n">whereis</span><span class="w"> </span><span class="n">vim</span>
<span class="n">vim</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">vim</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">vim</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">vim</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">man</span><span class="o">/</span><span class="n">man1</span><span class="o">/</span><span class="n">vim</span><span class="o">.</span><span class="mf">1.</span><span class="n">gz</span>
<span class="n">jadi</span><span class="err">@</span><span class="n">funlife</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="o">--</span><span class="n">version</span>
<span class="n">VIM</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Vi</span><span class="w"> </span><span class="n">IMproved</span><span class="w"> </span><span class="mf">9.0</span><span class="w"> </span><span class="p">(</span><span class="mi">2022</span><span class="w"> </span><span class="n">Jun</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">2022</span><span class="w"> </span><span class="mi">20</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">58</span><span class="p">)</span>
<span class="n">Included</span><span class="w"> </span><span class="n">patches</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="mi">242</span>
<span class="n">Modified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">team</span><span class="o">+</span><span class="n">vim</span><span class="err">@</span><span class="n">tracker</span><span class="o">.</span><span class="n">debian</span><span class="o">.</span><span class="n">org</span>
<span class="n">Compiled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">team</span><span class="o">+</span><span class="n">vim</span><span class="err">@</span><span class="n">tracker</span><span class="o">.</span><span class="n">debian</span><span class="o">.</span><span class="n">org</span>
<span class="n">Huge</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">GUI</span><span class="o">.</span><span class="w">  </span><span class="n">Features</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="p">(</span><span class="o">+</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="p">):</span>
<span class="o">+</span><span class="n">acl</span><span class="w">               </span><span class="o">+</span><span class="n">file_in_path</span><span class="w">      </span><span class="o">+</span><span class="n">mouse_urxvt</span><span class="w">       </span><span class="o">-</span><span class="n">tag_any_white</span>
<span class="o">+</span><span class="n">arabic</span><span class="w">            </span><span class="o">+</span><span class="n">find_in_path</span><span class="w">      </span><span class="o">+</span><span class="n">mouse_xterm</span><span class="w">       </span><span class="o">-</span><span class="n">tcl</span>
<span class="o">+</span><span class="n">autocmd</span><span class="w">           </span><span class="o">+</span><span class="nb nb-Type">float</span><span class="w">             </span><span class="o">+</span><span class="n">multi_byte</span><span class="w">        </span><span class="o">+</span><span class="n">termguicolors</span>
<span class="o">+</span><span class="n">autochdir</span><span class="w">         </span><span class="o">+</span><span class="n">folding</span><span class="w">           </span><span class="o">+</span><span class="n">multi_lang</span><span class="w">        </span><span class="o">+</span><span class="n">terminal</span>
<span class="o">-</span><span class="n">autoservername</span><span class="w">    </span><span class="o">-</span><span class="n">footer</span><span class="w">            </span><span class="o">-</span><span class="n">mzscheme</span><span class="w">          </span><span class="o">+</span><span class="n">terminfo</span>
<span class="o">-</span><span class="n">balloon_eval</span><span class="w">      </span><span class="o">+</span><span class="n">fork</span><span class="p">()</span><span class="w">            </span><span class="o">+</span><span class="n">netbeans_intg</span><span class="w">     </span><span class="o">+</span><span class="n">termresponse</span>
<span class="o">+</span><span class="n">balloon_eval_term</span><span class="w"> </span><span class="o">+</span><span class="n">gettext</span><span class="w">           </span><span class="o">+</span><span class="n">num64</span><span class="w">             </span><span class="o">+</span><span class="n">textobjects</span>
<span class="o">-</span><span class="n">browse</span><span class="w">            </span><span class="o">-</span><span class="n">hangul_input</span><span class="w">      </span><span class="o">+</span><span class="n">packages</span><span class="w">          </span><span class="o">+</span><span class="n">textprop</span>
<span class="o">++</span><span class="n">builtin_terms</span><span class="w">    </span><span class="o">+</span><span class="n">iconv</span><span class="w">             </span><span class="o">+</span><span class="n">path_extra</span><span class="w">        </span><span class="o">+</span><span class="n">timers</span>
<span class="o">+</span><span class="n">byte_offset</span><span class="w">       </span><span class="o">+</span><span class="n">insert_expand</span><span class="w">     </span><span class="o">-</span><span class="n">perl</span><span class="w">              </span><span class="o">+</span><span class="n">title</span>
<span class="o">+</span><span class="n">channel</span><span class="w">           </span><span class="o">+</span><span class="n">ipv6</span><span class="w">              </span><span class="o">+</span><span class="n">persistent_undo</span><span class="w">   </span><span class="o">-</span><span class="n">toolbar</span>
<span class="o">+</span><span class="n">cindent</span><span class="w">           </span><span class="o">+</span><span class="n">job</span><span class="w">               </span><span class="o">+</span><span class="n">popupwin</span><span class="w">          </span><span class="o">+</span><span class="n">user_commands</span>
<span class="o">-</span><span class="n">clientserver</span><span class="w">      </span><span class="o">+</span><span class="n">jumplist</span><span class="w">          </span><span class="o">+</span><span class="n">postscript</span><span class="w">        </span><span class="o">+</span><span class="n">vartabs</span>
<span class="o">-</span><span class="n">clipboard</span><span class="w">         </span><span class="o">+</span><span class="n">keymap</span><span class="w">            </span><span class="o">+</span><span class="n">printer</span><span class="w">           </span><span class="o">+</span><span class="n">vertsplit</span>
<span class="o">+</span><span class="n">cmdline_compl</span><span class="w">     </span><span class="o">+</span><span class="n">lambda</span><span class="w">            </span><span class="o">+</span><span class="n">profile</span><span class="w">           </span><span class="o">+</span><span class="n">vim9script</span>
<span class="o">+</span><span class="n">cmdline_hist</span><span class="w">      </span><span class="o">+</span><span class="n">langmap</span><span class="w">           </span><span class="o">-</span><span class="n">python</span><span class="w">            </span><span class="o">+</span><span class="n">viminfo</span>
<span class="o">+</span><span class="n">cmdline_info</span><span class="w">      </span><span class="o">+</span><span class="n">libcall</span><span class="w">           </span><span class="o">+</span><span class="n">python3</span><span class="w">           </span><span class="o">+</span><span class="n">virtualedit</span>
<span class="o">+</span><span class="n">comments</span><span class="w">          </span><span class="o">+</span><span class="n">linebreak</span><span class="w">         </span><span class="o">+</span><span class="n">quickfix</span><span class="w">          </span><span class="o">+</span><span class="n">visual</span>
<span class="o">+</span><span class="n">conceal</span><span class="w">           </span><span class="o">+</span><span class="n">lispindent</span><span class="w">        </span><span class="o">+</span><span class="n">reltime</span><span class="w">           </span><span class="o">+</span><span class="n">visualextra</span>
<span class="o">+</span><span class="n">cryptv</span><span class="w">            </span><span class="o">+</span><span class="n">listcmds</span><span class="w">          </span><span class="o">+</span><span class="n">rightleft</span><span class="w">         </span><span class="o">+</span><span class="n">vreplace</span>
<span class="o">+</span><span class="n">cscope</span><span class="w">            </span><span class="o">+</span><span class="n">localmap</span><span class="w">          </span><span class="o">-</span><span class="n">ruby</span><span class="w">              </span><span class="o">+</span><span class="n">wildignore</span>
<span class="o">+</span><span class="n">cursorbind</span><span class="w">        </span><span class="o">-</span><span class="n">lua</span><span class="w">               </span><span class="o">+</span><span class="n">scrollbind</span><span class="w">        </span><span class="o">+</span><span class="n">wildmenu</span>
<span class="o">+</span><span class="n">cursorshape</span><span class="w">       </span><span class="o">+</span><span class="n">menu</span><span class="w">              </span><span class="o">+</span><span class="n">signs</span><span class="w">             </span><span class="o">+</span><span class="n">windows</span>
<span class="o">+</span><span class="n">dialog_con</span><span class="w">        </span><span class="o">+</span><span class="n">mksession</span><span class="w">         </span><span class="o">+</span><span class="n">smartindent</span><span class="w">       </span><span class="o">+</span><span class="n">writebackup</span>
<span class="o">+</span><span class="n">diff</span><span class="w">              </span><span class="o">+</span><span class="n">modify_fname</span><span class="w">      </span><span class="o">+</span><span class="n">sodium</span><span class="w">            </span><span class="o">-</span><span class="n">X11</span>
<span class="o">+</span><span class="n">digraphs</span><span class="w">          </span><span class="o">+</span><span class="n">mouse</span><span class="w">             </span><span class="o">-</span><span class="n">sound</span><span class="w">             </span><span class="o">-</span><span class="n">xfontset</span>
<span class="o">-</span><span class="n">dnd</span><span class="w">               </span><span class="o">-</span><span class="n">mouseshape</span><span class="w">        </span><span class="o">+</span><span class="n">spell</span><span class="w">             </span><span class="o">-</span><span class="n">xim</span>
<span class="o">-</span><span class="n">ebcdic</span><span class="w">            </span><span class="o">+</span><span class="n">mouse_dec</span><span class="w">         </span><span class="o">+</span><span class="n">startuptime</span><span class="w">       </span><span class="o">-</span><span class="n">xpm</span>
<span class="o">+</span><span class="n">emacs_tags</span><span class="w">        </span><span class="o">+</span><span class="n">mouse_gpm</span><span class="w">         </span><span class="o">+</span><span class="n">statusline</span><span class="w">        </span><span class="o">-</span><span class="n">xsmp</span>
<span class="o">+</span><span class="n">eval</span><span class="w">              </span><span class="o">-</span><span class="n">mouse_jsbterm</span><span class="w">     </span><span class="o">-</span><span class="n">sun_workshop</span><span class="w">      </span><span class="o">-</span><span class="n">xterm_clipboard</span>
<span class="o">+</span><span class="n">ex_extra</span><span class="w">          </span><span class="o">+</span><span class="n">mouse_netterm</span><span class="w">     </span><span class="o">+</span><span class="n">syntax</span><span class="w">            </span><span class="o">-</span><span class="n">xterm_save</span>
<span class="o">+</span><span class="n">extra_search</span><span class="w">      </span><span class="o">+</span><span class="n">mouse_sgr</span><span class="w">         </span><span class="o">+</span><span class="n">tag_binary</span><span class="w">        </span>
<span class="o">-</span><span class="n">farsi</span><span class="w">             </span><span class="o">-</span><span class="n">mouse_sysmouse</span><span class="w">    </span><span class="o">-</span><span class="n">tag_old_static</span><span class="w">    </span>
<span class="w">   </span><span class="n">system</span><span class="w"> </span><span class="n">vimrc</span><span class="w"> </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/etc/vim/vimrc&quot;</span>
<span class="w">     </span><span class="n">user</span><span class="w"> </span><span class="n">vimrc</span><span class="w"> </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$HOME/.vimrc&quot;</span>
<span class="w"> </span><span class="mi">2</span><span class="n">nd</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">vimrc</span><span class="w"> </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;~/.vim/vimrc&quot;</span>
<span class="w">      </span><span class="n">user</span><span class="w"> </span><span class="n">exrc</span><span class="w"> </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$HOME/.exrc&quot;</span>
<span class="w">       </span><span class="n">defaults</span><span class="w"> </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$VIMRUNTIME/defaults.vim&quot;</span>
<span class="w">  </span><span class="n">fall</span><span class="o">-</span><span class="n">back</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">$</span><span class="n">VIM</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/share/vim&quot;</span>
<span class="n">Compilation</span><span class="p">:</span><span class="w"> </span><span class="n">gcc</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">I</span><span class="o">.</span><span class="w"> </span><span class="o">-</span><span class="n">Iproto</span><span class="w"> </span><span class="o">-</span><span class="n">DHAVE_CONFIG_H</span><span class="w"> </span><span class="o">-</span><span class="n">Wdate</span><span class="o">-</span><span class="n">time</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">-</span><span class="n">O2</span><span class="w"> </span><span class="o">-</span><span class="n">ffile</span><span class="o">-</span><span class="n">prefix</span><span class="o">-</span><span class="n">map</span><span class="o">=/</span><span class="n">build</span><span class="o">/</span><span class="n">vim</span><span class="o">-</span><span class="n">Oy69Mt</span><span class="o">/</span><span class="n">vim</span><span class="o">-</span><span class="mf">9.0</span><span class="o">.</span><span class="mi">0242</span><span class="o">=.</span><span class="w"> </span><span class="o">-</span><span class="n">flto</span><span class="o">=</span><span class="n">auto</span><span class="w"> </span><span class="o">-</span><span class="n">ffat</span><span class="o">-</span><span class="n">lto</span><span class="o">-</span><span class="n">objects</span><span class="w"> </span><span class="o">-</span><span class="n">flto</span><span class="o">=</span><span class="n">auto</span><span class="w"> </span><span class="o">-</span><span class="n">ffat</span><span class="o">-</span><span class="n">lto</span><span class="o">-</span><span class="n">objects</span><span class="w"> </span><span class="o">-</span><span class="n">fstack</span><span class="o">-</span><span class="n">protector</span><span class="o">-</span><span class="n">strong</span><span class="w"> </span><span class="o">-</span><span class="n">Wformat</span><span class="w"> </span><span class="o">-</span><span class="n">Werror</span><span class="o">=</span><span class="n">format</span><span class="o">-</span><span class="n">security</span><span class="w"> </span><span class="o">-</span><span class="n">DSYS_VIMRC_FILE</span><span class="o">=</span>\<span class="s2">&quot;/etc/vim/vimrc</span><span class="se">\&quot;</span><span class="s2"> -DSYS_GVIMRC_FILE=</span><span class="se">\&quot;</span><span class="s2">/etc/vim/gvimrc</span><span class="se">\&quot;</span><span class="s2"> -D_REENTRANT -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1 </span>
<span class="n">Linking</span><span class="p">:</span><span class="w"> </span><span class="n">gcc</span><span class="w"> </span><span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">Bsymbolic</span><span class="o">-</span><span class="n">functions</span><span class="w"> </span><span class="o">-</span><span class="n">flto</span><span class="o">=</span><span class="n">auto</span><span class="w"> </span><span class="o">-</span><span class="n">ffat</span><span class="o">-</span><span class="n">lto</span><span class="o">-</span><span class="n">objects</span><span class="w"> </span><span class="o">-</span><span class="n">flto</span><span class="o">=</span><span class="n">auto</span><span class="w"> </span><span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">relro</span><span class="w"> </span><span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">now</span><span class="w"> </span><span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">--</span><span class="k">as</span><span class="o">-</span><span class="n">needed</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">vim</span><span class="w"> </span><span class="o">-</span><span class="n">lm</span><span class="w"> </span><span class="o">-</span><span class="n">ltinfo</span><span class="w"> </span><span class="o">-</span><span class="n">lselinux</span><span class="w"> </span><span class="o">-</span><span class="n">lsodium</span><span class="w"> </span><span class="o">-</span><span class="n">lacl</span><span class="w"> </span><span class="o">-</span><span class="n">lattr</span><span class="w"> </span><span class="o">-</span><span class="n">lgpm</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">10</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="mf">3.10</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="w"> </span><span class="o">-</span><span class="n">lpython3</span><span class="o">.</span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="n">lcrypt</span><span class="w"> </span><span class="o">-</span><span class="n">ldl</span><span class="w"> </span><span class="o">-</span><span class="n">lm</span><span class="w"> </span><span class="o">-</span><span class="n">lm</span><span class="w"> </span>
</code></pre></div>

<p>To edit a file with vi, just give the file name to it:</p>
<div class="highlight"><pre><span></span><code>$ vi file.txt
</code></pre></div>

<h3>vi modes</h3>
<p><code>vi</code> works in two modes:</p>
<ol>
<li><strong>Command mode</strong> is where you go around the file, search, delete text, copy paste, replace, ... and give other commands to the vi. Some commands start with a <code>:</code> and some are only a keypress.</li>
<li><strong>Insert mode</strong> is where what you type, goes into the file at the cursors position.</li>
</ol>
<blockquote>
<p>To switch to the Command mode, press the ESC key. To go back to the Insert mode, you can use several commands but one common one is pressing the <code>i</code> key.</p>
</blockquote>
<h3>Moving the cursor</h3>
<p>To move around a text file, use these keys in Command mode:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">key</th>
<th style="text-align: left;">function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">h</td>
<td style="text-align: left;">One character to the left (only current line)</td>
</tr>
<tr>
<td style="text-align: center;">j</td>
<td style="text-align: left;">One line down</td>
</tr>
<tr>
<td style="text-align: center;">k</td>
<td style="text-align: left;">One line up</td>
</tr>
<tr>
<td style="text-align: center;">l</td>
<td style="text-align: left;">One character to the right (only current line)</td>
</tr>
<tr>
<td style="text-align: center;">w</td>
<td style="text-align: left;">Next word on the current line</td>
</tr>
<tr>
<td style="text-align: center;">e</td>
<td style="text-align: left;">Next end of word on the current line</td>
</tr>
<tr>
<td style="text-align: center;">b</td>
<td style="text-align: left;">Previous beginning of the word on the current line</td>
</tr>
<tr>
<td style="text-align: center;">Ctrl-f</td>
<td style="text-align: left;">Scroll forward one page</td>
</tr>
<tr>
<td style="text-align: center;">Ctrl-b</td>
<td style="text-align: left;">Scroll backward one page</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Typing a number before most commands will repeat the command that many times (i.e. <code>6h</code> will go 6 characters to the left)</p>
</blockquote>
<h4>Jumping around</h4>
<table>
<thead>
<tr>
<th style="text-align: center;">key</th>
<th style="text-align: left;">function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">G</td>
<td style="text-align: left;">With no number, will jump to the end &amp; 10G will jump to line 10</td>
</tr>
<tr>
<td style="text-align: center;">H</td>
<td style="text-align: left;">5H will go to the 5th line from the top of the screen</td>
</tr>
<tr>
<td style="text-align: center;">L</td>
<td style="text-align: left;">3L will move the cursor to the 3rd line to the last line of the screen</td>
</tr>
</tbody>
</table>
<h3>Editing text</h3>
<p>These command during the <em>command mode</em> will help you enter, edit, replace and text:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">key</th>
<th style="text-align: left;">function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">i</td>
<td style="text-align: left;">Enter the insert mode</td>
</tr>
<tr>
<td style="text-align: center;">a</td>
<td style="text-align: left;">Enter the insert mode after the current position of the cursor</td>
</tr>
<tr>
<td style="text-align: center;">r</td>
<td style="text-align: left;">replace only one character</td>
</tr>
<tr>
<td style="text-align: center;">o</td>
<td style="text-align: left;">open a new line below the cursor and go to the insert mode</td>
</tr>
<tr>
<td style="text-align: center;">O</td>
<td style="text-align: left;">open a new line above the cursor and go to the insert mode</td>
</tr>
<tr>
<td style="text-align: center;">c</td>
<td style="text-align: left;">clear to a location and go to the insert mode the replace till there and then normal insert (<code>cw</code> will overwrite the current word)</td>
</tr>
<tr>
<td style="text-align: center;">d</td>
<td style="text-align: left;">delete. you can mix with w (<code>dw</code>) to delete a word. Same as cw but dw does not go to the insert mode</td>
</tr>
<tr>
<td style="text-align: center;">dd</td>
<td style="text-align: left;">Delete the current line</td>
</tr>
<tr>
<td style="text-align: center;">x</td>
<td style="text-align: left;">Delete character at the position of the cursor</td>
</tr>
<tr>
<td style="text-align: center;">p</td>
<td style="text-align: left;">Paste the last deleted text after the cursor</td>
</tr>
<tr>
<td style="text-align: center;">P</td>
<td style="text-align: left;">Paste the last deleted text before the cursor</td>
</tr>
<tr>
<td style="text-align: center;">xp</td>
<td style="text-align: left;">swaps the character at the cursor position with the one on its right</td>
</tr>
</tbody>
</table>
<h3>Searching</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">key</th>
<th style="text-align: left;">function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">/</td>
<td style="text-align: left;">Search forward (<code>/happiness</code> will find the next happiness)</td>
</tr>
<tr>
<td style="text-align: center;">?</td>
<td style="text-align: left;">Search backward</td>
</tr>
<tr>
<td style="text-align: center;">n</td>
<td style="text-align: left;">repeat previous search. You can also use <code>/</code> and <code>?</code> without any parameters)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Search wraps around to the top once the bottom of file is reached</p>
</blockquote>
<h3>Exiting</h3>
<p>It is always funny when you see someone entering to the vi and not knowing how to exit! Learn these and prevent the laughter:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">key</th>
<th style="text-align: left;">function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">:q!</td>
<td style="text-align: left;">Quit editing without saving = runaway after any mistake</td>
</tr>
<tr>
<td style="text-align: center;">:w!</td>
<td style="text-align: left;">Write the file (whether modified or not). Attempt to overwrite existing files or read-only or other unwritable files</td>
</tr>
<tr>
<td style="text-align: center;">:w myfile.txt</td>
<td style="text-align: left;">Write to a new name</td>
</tr>
<tr>
<td style="text-align: center;">ZZ</td>
<td style="text-align: left;">Exit and save the file if modified</td>
</tr>
<tr>
<td style="text-align: center;">:e!</td>
<td style="text-align: left;">Reload the file from disk</td>
</tr>
<tr>
<td style="text-align: center;">:!</td>
<td style="text-align: left;">Run a shell command</td>
</tr>
</tbody>
</table>
<p>Entering colon (<code>:</code>) during <em>command mode</em> will move the cursor to the bottom of the screen and vi will wait for your commands. Press ESC to return back to the normal command mode.</p>
<blockquote>
<p>The exclamation mark in most commands will say "I know what I'm doing" and will write on read-only files if you have access and will exit without asking</p>
<p>it is possible to combine commands. For example you can combine <code>:w</code> and <code>:q</code> and just say <code>:wq</code> (write and exit).</p>
</blockquote>
<h3>help</h3>
<p>You can always ask for help with <code>:help</code> or <code>:help subject</code>. This way vi will open a help text which you can use / search just like any other text. Close it with <code>:q</code> command.</p>
<h2>Other editors</h2>
<p>You can also use other editors if you want. One easy to use and common option is <code>nano</code> and some other choices are <code>micro</code>, <code>emacs</code> (full featured) and <code>neovim</code> (an update to vim).</p>
<h2>Default editor</h2>
<p>The default editor in <code>bash</code> is set using the <code>EDITOR</code> environment variable. You can change it with:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">EDITOR</span><span class="o">=</span><span class="s1">&#39;vim&#39;</span>
</code></pre></div>

<p>or by adding the above line to the <code>.bashrc</code> file. We will see these in more details in next chapters.</p>
                                            <br clear="both" />
                                            <h1>104.1 Create partitions and filesystems</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Description: Candidates should be able to configure disk partitions and then create filesystems on media such as hard disks. This includes the handling of swap partitions.</p>
<h3>Objective</h3>
<ul>
<li>Manage MBR and GPT partition tables</li>
<li>Use various mkfs commands to create various filesystems such as:<ul>
<li>ext2/ext3/ext4</li>
<li>XFS</li>
<li>VFAT</li>
<li>exFAT</li>
</ul>
</li>
<li>
<p>Basic feature knowledge of Btrfs, including multi-device filesystems, compression and subvolumes.</p>
</li>
<li>
<p>fdisk</p>
</li>
<li>gdisk</li>
<li>parted</li>
<li>mkfs</li>
<li>mkswap</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xSQdIIMGG2g" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>Block devices</h3>
<p>A block device is a nonvolatile mass storage device whose information can be accessed in any order; like hard disks, USB memories, floppy disks, and CD-ROMs. We <em>format</em> these devices to fixed sized blocks.</p>
<p>We can check all block devices using <code>lsblk</code> command. In addition on a long ls format (<code>-l</code>), block devices are shown with a <code>b</code> at the first column:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debianamd</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="ss">&quot;^b&quot;</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="k">disk</span><span class="w">      </span><span class="mi">8</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">Feb</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">2023</span><span class="w"> </span><span class="n">sda</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="k">disk</span><span class="w">      </span><span class="mi">8</span><span class="p">,</span><span class="w">  </span><span class="mi">16</span><span class="w"> </span><span class="n">Feb</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">2023</span><span class="w"> </span><span class="n">sdb</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="k">disk</span><span class="w">      </span><span class="mi">8</span><span class="p">,</span><span class="w">  </span><span class="mi">17</span><span class="w"> </span><span class="n">Feb</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">2023</span><span class="w"> </span><span class="n">sdb1</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="k">disk</span><span class="w">      </span><span class="mi">8</span><span class="p">,</span><span class="w">  </span><span class="mi">18</span><span class="w"> </span><span class="n">Feb</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">2023</span><span class="w"> </span><span class="n">sdb2</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="o">----</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="k">disk</span><span class="w">      </span><span class="mi">8</span><span class="p">,</span><span class="w">  </span><span class="mi">19</span><span class="w"> </span><span class="n">Feb</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">2023</span><span class="w"> </span><span class="n">sdb3</span>
<span class="n">brw</span><span class="o">-</span><span class="n">rw</span><span class="c1">----+ 1 root cdrom    11,   0 Feb  3  2023 sr0</span>
</code></pre></div>

<p>It is possible to create <strong>partitions</strong> on a block device and even split it and use it as multiple disks. Systems with old BIOS boot loaders use the <strong>Master Boot Record (MBR)</strong> method for patitioning and newer UEFI systems, do you <strong>GUID Parition Table (GPT)</strong> formats.</p>
<p>Linux systems use <code>udev</code> to add block devices and their paritions to the <code>/dev</code> in the form of <code>/dev/sdb1</code> (2nd disk (b) and first parition (1)). </p>
<h3>Editing Partition Tables</h3>
<h4>fdisk</h4>
<p><code>fdisk</code> is the main command for viewing / changing and creating partitions on MBR systems. the <code>-l</code> switch lists the partitions:</p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">fdisk</span><span class="w"> </span><span class="o">-</span><span class="nv">l</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb</span>
<span class="nv">Disk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb</span>:<span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="nv">GiB</span>,<span class="w"> </span><span class="mi">21474836480</span><span class="w"> </span><span class="nv">bytes</span>,<span class="w"> </span><span class="mi">41943040</span><span class="w"> </span><span class="nv">sectors</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">model</span>:<span class="w"> </span><span class="nv">QEMU</span><span class="w"> </span><span class="nv">HARDDISK</span>
<span class="nv">Units</span>:<span class="w"> </span><span class="nv">sectors</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Sector</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">logical</span><span class="o">/</span><span class="nv">physical</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">I</span><span class="o">/</span><span class="nv">O</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">minimum</span><span class="o">/</span><span class="nv">optimal</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Disklabel</span><span class="w"> </span><span class="nv">type</span>:<span class="w"> </span><span class="nv">gpt</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">identifier</span>:<span class="w"> </span><span class="mi">11</span><span class="nv">D48091</span><span class="o">-</span><span class="mi">5</span><span class="nv">AA7</span><span class="o">-</span><span class="mi">422</span><span class="nv">A</span><span class="o">-</span><span class="mi">85</span><span class="nv">F7</span><span class="o">-</span><span class="nv">A23F476CDFD7</span>

<span class="nv">Device</span><span class="w">        </span><span class="nv">Start</span><span class="w">      </span><span class="k">End</span><span class="w">  </span><span class="nv">Sectors</span><span class="w">  </span><span class="nv">Size</span><span class="w"> </span><span class="nv">Type</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb1</span><span class="w">      </span><span class="mi">2048</span><span class="w">  </span><span class="mi">1050623</span><span class="w">  </span><span class="mi">1048576</span><span class="w">  </span><span class="mi">512</span><span class="nv">M</span><span class="w"> </span><span class="nv">EFI</span><span class="w"> </span><span class="nv">System</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb2</span><span class="w">   </span><span class="mi">1050624</span><span class="w"> </span><span class="mi">39942143</span><span class="w"> </span><span class="mi">38891520</span><span class="w"> </span><span class="mi">18</span>.<span class="mi">5</span><span class="nv">G</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">filesystem</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb3</span><span class="w">  </span><span class="mi">39942144</span><span class="w"> </span><span class="mi">41940991</span><span class="w">  </span><span class="mi">1998848</span><span class="w">  </span><span class="mi">976</span><span class="nv">M</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">swap</span>
</code></pre></div>

<ul>
<li>The <strong>Boot</strong> flag shows which partition starts the boot on DOS PCs and has no importance on LILO &amp; GRUB</li>
<li>Start and End shows where this partition is located on the disk.</li>
<li>Size shows each partition size .</li>
<li>ID indicates the partition format (82 is swap, 83 is linux data, ... check all with <code>l</code> in interactive mode)</li>
</ul>
<p>It is also possible to run fdisk in interactive mode. <code>m</code> will show you the help menu:</p>
<div class="highlight"><pre><span></span><code><span class="o">~</span><span class="c1"># fdisk /dev/sda</span>

<span class="n">Welcome</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">fdisk</span><span class="w"> </span><span class="p">(</span><span class="n">util</span><span class="o">-</span><span class="n">linux</span><span class="w"> </span><span class="mf">2.36</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span>
<span class="n">Changes</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">only</span><span class="p">,</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">decide</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">them</span><span class="o">.</span>
<span class="n">Be</span><span class="w"> </span><span class="n">careful</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">command</span><span class="o">.</span>

<span class="n">Device</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">recognized</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">table</span><span class="o">.</span>
<span class="n">Created</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">DOS</span><span class="w"> </span><span class="n">disklabel</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="mh">0xe2dbaded</span><span class="o">.</span>

<span class="n">Command</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">help</span><span class="p">):</span><span class="w"> </span><span class="n">m</span>

<span class="n">Help</span><span class="p">:</span>

<span class="w">  </span><span class="n">DOS</span><span class="w"> </span><span class="p">(</span><span class="n">MBR</span><span class="p">)</span>
<span class="w">   </span><span class="n">a</span><span class="w">   </span><span class="n">toggle</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bootable</span><span class="w"> </span><span class="n">flag</span>
<span class="w">   </span><span class="n">b</span><span class="w">   </span><span class="n">edit</span><span class="w"> </span><span class="n">nested</span><span class="w"> </span><span class="n">BSD</span><span class="w"> </span><span class="n">disklabel</span>
<span class="w">   </span><span class="n">c</span><span class="w">   </span><span class="n">toggle</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="n">compatibility</span><span class="w"> </span><span class="n">flag</span>

<span class="w">  </span><span class="n">Generic</span>
<span class="w">   </span><span class="n">d</span><span class="w">   </span><span class="n">delete</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">partition</span>
<span class="w">   </span><span class="n">F</span><span class="w">   </span><span class="n">list</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">unpartitioned</span><span class="w"> </span><span class="n">space</span>
<span class="w">   </span><span class="n">l</span><span class="w">   </span><span class="n">list</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">types</span>
<span class="w">   </span><span class="n">n</span><span class="w">   </span><span class="n">add</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">partition</span>
<span class="w">   </span><span class="n">p</span><span class="w">   </span><span class="nb">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">table</span>
<span class="w">   </span><span class="n">t</span><span class="w">   </span><span class="n">change</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">type</span>
<span class="w">   </span><span class="n">v</span><span class="w">   </span><span class="n">verify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">table</span>
<span class="w">   </span><span class="n">i</span><span class="w">   </span><span class="nb">print</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">partition</span>

<span class="w">  </span><span class="n">Misc</span>
<span class="w">   </span><span class="n">m</span><span class="w">   </span><span class="nb">print</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">menu</span>
<span class="w">   </span><span class="n">u</span><span class="w">   </span><span class="n">change</span><span class="w"> </span><span class="n">display</span><span class="o">/</span><span class="n">entry</span><span class="w"> </span><span class="n">units</span>
<span class="w">   </span><span class="n">x</span><span class="w">   </span><span class="n">extra</span><span class="w"> </span><span class="n">functionality</span><span class="w"> </span><span class="p">(</span><span class="n">experts</span><span class="w"> </span><span class="n">only</span><span class="p">)</span>

<span class="w">  </span><span class="n">Script</span>
<span class="w">   </span><span class="n">I</span><span class="w">   </span><span class="nb">load</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">layout</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">sfdisk</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">file</span>
<span class="w">   </span><span class="n">O</span><span class="w">   </span><span class="n">dump</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="n">layout</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sfdisk</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">file</span>

<span class="w">  </span><span class="n">Save</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">Exit</span>
<span class="w">   </span><span class="n">w</span><span class="w">   </span><span class="n">write</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disk</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">exit</span>
<span class="w">   </span><span class="n">q</span><span class="w">   </span><span class="n">quit</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">saving</span><span class="w"> </span><span class="n">changes</span>

<span class="w">  </span><span class="n">Create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">label</span>
<span class="w">   </span><span class="n">g</span><span class="w">   </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">GPT</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">table</span>
<span class="w">   </span><span class="n">G</span><span class="w">   </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">SGI</span><span class="w"> </span><span class="p">(</span><span class="n">IRIX</span><span class="p">)</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">table</span>
<span class="w">   </span><span class="n">o</span><span class="w">   </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">DOS</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">table</span>
<span class="w">   </span><span class="n">s</span><span class="w">   </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">Sun</span><span class="w"> </span><span class="n">partition</span><span class="w"> </span><span class="n">table</span>


<span class="n">Command</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">help</span><span class="p">):</span>
</code></pre></div>

<p>To check current partition list, try the <code>p</code> (print) command:</p>
<div class="highlight"><pre><span></span><code><span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">p</span>
<span class="nv">Disk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb</span>:<span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="nv">GiB</span>,<span class="w"> </span><span class="mi">21474836480</span><span class="w"> </span><span class="nv">bytes</span>,<span class="w"> </span><span class="mi">41943040</span><span class="w"> </span><span class="nv">sectors</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">model</span>:<span class="w"> </span><span class="nv">QEMU</span><span class="w"> </span><span class="nv">HARDDISK</span>
<span class="nv">Units</span>:<span class="w"> </span><span class="nv">sectors</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Sector</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">logical</span><span class="o">/</span><span class="nv">physical</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">I</span><span class="o">/</span><span class="nv">O</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">minimum</span><span class="o">/</span><span class="nv">optimal</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Disklabel</span><span class="w"> </span><span class="nv">type</span>:<span class="w"> </span><span class="nv">gpt</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">identifier</span>:<span class="w"> </span><span class="mi">11</span><span class="nv">D48091</span><span class="o">-</span><span class="mi">5</span><span class="nv">AA7</span><span class="o">-</span><span class="mi">422</span><span class="nv">A</span><span class="o">-</span><span class="mi">85</span><span class="nv">F7</span><span class="o">-</span><span class="nv">A23F476CDFD7</span>

<span class="nv">Device</span><span class="w">        </span><span class="nv">Start</span><span class="w">      </span><span class="k">End</span><span class="w">  </span><span class="nv">Sectors</span><span class="w">  </span><span class="nv">Size</span><span class="w"> </span><span class="nv">Type</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb1</span><span class="w">      </span><span class="mi">2048</span><span class="w">  </span><span class="mi">1050623</span><span class="w">  </span><span class="mi">1048576</span><span class="w">  </span><span class="mi">512</span><span class="nv">M</span><span class="w"> </span><span class="nv">EFI</span><span class="w"> </span><span class="nv">System</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb2</span><span class="w">   </span><span class="mi">1050624</span><span class="w"> </span><span class="mi">39942143</span><span class="w"> </span><span class="mi">38891520</span><span class="w"> </span><span class="mi">18</span>.<span class="mi">5</span><span class="nv">G</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">filesystem</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdb3</span><span class="w">  </span><span class="mi">39942144</span><span class="w"> </span><span class="mi">41940991</span><span class="w">  </span><span class="mi">1998848</span><span class="w">  </span><span class="mi">976</span><span class="nv">M</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">swap</span>
</code></pre></div>

<p>You should remember the disk layouts concepts from the <a href="/1021-design-hard-disk-layout.html">chapter 102.1</a>. So lets create some paritions using <code>fdisk</code>. I will use the <code>n</code> for <em>new</em>:</p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">fdisk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda</span>

<span class="nv">Welcome</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">fdisk</span><span class="w"> </span><span class="ss">(</span><span class="nv">util</span><span class="o">-</span><span class="nv">linux</span><span class="w"> </span><span class="mi">2</span>.<span class="mi">36</span>.<span class="mi">1</span><span class="ss">)</span>.
<span class="nv">Changes</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">remain</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span><span class="nv">only</span>,<span class="w"> </span><span class="k">until</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">decide</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">write</span><span class="w"> </span><span class="nv">them</span>.
<span class="nv">Be</span><span class="w"> </span><span class="nv">careful</span><span class="w"> </span><span class="nv">before</span><span class="w"> </span><span class="nv">using</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">write</span><span class="w"> </span><span class="nv">command</span>.

<span class="nv">Device</span><span class="w"> </span><span class="nv">does</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">contain</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">recognized</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="nv">table</span>.
<span class="nv">Created</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">DOS</span><span class="w"> </span><span class="nv">disklabel</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">disk</span><span class="w"> </span><span class="nv">identifier</span><span class="w"> </span><span class="mi">0</span><span class="nv">x40bd0f72</span>.

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">n</span>
<span class="nv">Partition</span><span class="w"> </span><span class="nv">type</span>
<span class="w">   </span><span class="nv">p</span><span class="w">   </span><span class="nv">primary</span><span class="w"> </span><span class="ss">(</span><span class="mi">0</span><span class="w"> </span><span class="nv">primary</span>,<span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">extended</span>,<span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">free</span><span class="ss">)</span>
<span class="w">   </span><span class="nv">e</span><span class="w">   </span><span class="nv">extended</span><span class="w"> </span><span class="ss">(</span><span class="nv">container</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">logical</span><span class="w"> </span><span class="nv">partitions</span><span class="ss">)</span>
<span class="nv">Select</span><span class="w"> </span><span class="ss">(</span><span class="nv">default</span><span class="w"> </span><span class="nv">p</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">p</span>
<span class="nv">Partition</span><span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">4</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>:
<span class="nv">First</span><span class="w"> </span><span class="nv">sector</span><span class="w"> </span><span class="ss">(</span><span class="mi">2048</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">2048</span><span class="ss">)</span>:
<span class="nv">Last</span><span class="w"> </span><span class="nv">sector</span>,<span class="w"> </span><span class="o">+/-</span><span class="nv">sectors</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="o">+/-</span><span class="nv">size</span>{<span class="nv">K</span>,<span class="nv">M</span>,<span class="nv">G</span>,<span class="nv">T</span>,<span class="nv">P</span>}<span class="w"> </span><span class="ss">(</span><span class="mi">2048</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">8388607</span><span class="ss">)</span>:<span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="nv">G</span>

<span class="nv">Created</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="s1">&#39;Linux&#39;</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">GiB</span>.

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">p</span>
<span class="nv">Disk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda</span>:<span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">GiB</span>,<span class="w"> </span><span class="mi">4294967296</span><span class="w"> </span><span class="nv">bytes</span>,<span class="w"> </span><span class="mi">8388608</span><span class="w"> </span><span class="nv">sectors</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">model</span>:<span class="w"> </span><span class="nv">QEMU</span><span class="w"> </span><span class="nv">HARDDISK</span>
<span class="nv">Units</span>:<span class="w"> </span><span class="nv">sectors</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Sector</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">logical</span><span class="o">/</span><span class="nv">physical</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">I</span><span class="o">/</span><span class="nv">O</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">minimum</span><span class="o">/</span><span class="nv">optimal</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Disklabel</span><span class="w"> </span><span class="nv">type</span>:<span class="w"> </span><span class="nv">dos</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">identifier</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x40bd0f72</span>

<span class="nv">Device</span><span class="w">     </span><span class="nv">Boot</span><span class="w"> </span><span class="nv">Start</span><span class="w">     </span><span class="k">End</span><span class="w"> </span><span class="nv">Sectors</span><span class="w"> </span><span class="nv">Size</span><span class="w"> </span><span class="nv">Id</span><span class="w"> </span><span class="nv">Type</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda1</span><span class="w">        </span><span class="mi">2048</span><span class="w"> </span><span class="mi">2099199</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>
</code></pre></div>

<p>Lets  create another Extened parition and add a Linux (83) and a Swap (82) parition there. </p>
<div class="highlight"><pre><span></span><code><span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">n</span>
<span class="nv">Partition</span><span class="w"> </span><span class="nv">type</span>
<span class="w">   </span><span class="nv">p</span><span class="w">   </span><span class="nv">primary</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span><span class="w"> </span><span class="nv">primary</span>,<span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">extended</span>,<span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nv">free</span><span class="ss">)</span>
<span class="w">   </span><span class="nv">e</span><span class="w">   </span><span class="nv">extended</span><span class="w"> </span><span class="ss">(</span><span class="nv">container</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">logical</span><span class="w"> </span><span class="nv">partitions</span><span class="ss">)</span>
<span class="nv">Select</span><span class="w"> </span><span class="ss">(</span><span class="nv">default</span><span class="w"> </span><span class="nv">p</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">e</span>
<span class="nv">Partition</span><span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="ss">(</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">2</span><span class="ss">)</span>:
<span class="nv">First</span><span class="w"> </span><span class="nv">sector</span><span class="w"> </span><span class="ss">(</span><span class="mi">2099200</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">2099200</span><span class="ss">)</span>:
<span class="nv">Last</span><span class="w"> </span><span class="nv">sector</span>,<span class="w"> </span><span class="o">+/-</span><span class="nv">sectors</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="o">+/-</span><span class="nv">size</span>{<span class="nv">K</span>,<span class="nv">M</span>,<span class="nv">G</span>,<span class="nv">T</span>,<span class="nv">P</span>}<span class="w"> </span><span class="ss">(</span><span class="mi">2099200</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">8388607</span><span class="ss">)</span>:

<span class="nv">Created</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="s1">&#39;Extended&#39;</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nv">GiB</span>.

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">p</span>
<span class="nv">Disk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda</span>:<span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">GiB</span>,<span class="w"> </span><span class="mi">4294967296</span><span class="w"> </span><span class="nv">bytes</span>,<span class="w"> </span><span class="mi">8388608</span><span class="w"> </span><span class="nv">sectors</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">model</span>:<span class="w"> </span><span class="nv">QEMU</span><span class="w"> </span><span class="nv">HARDDISK</span>
<span class="nv">Units</span>:<span class="w"> </span><span class="nv">sectors</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Sector</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">logical</span><span class="o">/</span><span class="nv">physical</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">I</span><span class="o">/</span><span class="nv">O</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">minimum</span><span class="o">/</span><span class="nv">optimal</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Disklabel</span><span class="w"> </span><span class="nv">type</span>:<span class="w"> </span><span class="nv">dos</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">identifier</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x40bd0f72</span>

<span class="nv">Device</span><span class="w">     </span><span class="nv">Boot</span><span class="w">   </span><span class="nv">Start</span><span class="w">     </span><span class="k">End</span><span class="w"> </span><span class="nv">Sectors</span><span class="w"> </span><span class="nv">Size</span><span class="w"> </span><span class="nv">Id</span><span class="w"> </span><span class="nv">Type</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda1</span><span class="w">          </span><span class="mi">2048</span><span class="w"> </span><span class="mi">2099199</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda2</span><span class="w">       </span><span class="mi">2099200</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">6289408</span><span class="w">   </span><span class="mi">3</span><span class="nv">G</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="nv">Extended</span>

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">n</span>
<span class="nv">All</span><span class="w"> </span><span class="nv">space</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">primary</span><span class="w"> </span><span class="nv">partitions</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">use</span>.
<span class="nv">Adding</span><span class="w"> </span><span class="nv">logical</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">5</span>
<span class="nv">First</span><span class="w"> </span><span class="nv">sector</span><span class="w"> </span><span class="ss">(</span><span class="mi">2101248</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">2101248</span><span class="ss">)</span>:
<span class="nv">Last</span><span class="w"> </span><span class="nv">sector</span>,<span class="w"> </span><span class="o">+/-</span><span class="nv">sectors</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="o">+/-</span><span class="nv">size</span>{<span class="nv">K</span>,<span class="nv">M</span>,<span class="nv">G</span>,<span class="nv">T</span>,<span class="nv">P</span>}<span class="w"> </span><span class="ss">(</span><span class="mi">2101248</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">8388607</span><span class="ss">)</span>:

<span class="nv">Created</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="s1">&#39;Linux&#39;</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nv">GiB</span>.

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">p</span>
<span class="nv">Disk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda</span>:<span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">GiB</span>,<span class="w"> </span><span class="mi">4294967296</span><span class="w"> </span><span class="nv">bytes</span>,<span class="w"> </span><span class="mi">8388608</span><span class="w"> </span><span class="nv">sectors</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">model</span>:<span class="w"> </span><span class="nv">QEMU</span><span class="w"> </span><span class="nv">HARDDISK</span>
<span class="nv">Units</span>:<span class="w"> </span><span class="nv">sectors</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Sector</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">logical</span><span class="o">/</span><span class="nv">physical</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">I</span><span class="o">/</span><span class="nv">O</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">minimum</span><span class="o">/</span><span class="nv">optimal</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Disklabel</span><span class="w"> </span><span class="nv">type</span>:<span class="w"> </span><span class="nv">dos</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">identifier</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x40bd0f72</span>

<span class="nv">Device</span><span class="w">     </span><span class="nv">Boot</span><span class="w">   </span><span class="nv">Start</span><span class="w">     </span><span class="k">End</span><span class="w"> </span><span class="nv">Sectors</span><span class="w"> </span><span class="nv">Size</span><span class="w"> </span><span class="nv">Id</span><span class="w"> </span><span class="nv">Type</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda1</span><span class="w">          </span><span class="mi">2048</span><span class="w"> </span><span class="mi">2099199</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda2</span><span class="w">       </span><span class="mi">2099200</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">6289408</span><span class="w">   </span><span class="mi">3</span><span class="nv">G</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="nv">Extended</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda5</span><span class="w">       </span><span class="mi">2101248</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">6287360</span><span class="w">   </span><span class="mi">3</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>
</code></pre></div>

<p>Oh! I forgot to allocate space for the swap partition. Lets delete the previous one and add two new ones:</p>
<div class="highlight"><pre><span></span><code><span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">d</span>
<span class="nv">Partition</span><span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">2</span>,<span class="mi">5</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">5</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">5</span>

<span class="nv">Partition</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">been</span><span class="w"> </span><span class="nv">deleted</span>.

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">n</span>
<span class="nv">All</span><span class="w"> </span><span class="nv">space</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">primary</span><span class="w"> </span><span class="nv">partitions</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">use</span>.
<span class="nv">Adding</span><span class="w"> </span><span class="nv">logical</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">5</span>
<span class="nv">First</span><span class="w"> </span><span class="nv">sector</span><span class="w"> </span><span class="ss">(</span><span class="mi">2101248</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">2101248</span><span class="ss">)</span>:
<span class="nv">Last</span><span class="w"> </span><span class="nv">sector</span>,<span class="w"> </span><span class="o">+/-</span><span class="nv">sectors</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="o">+/-</span><span class="nv">size</span>{<span class="nv">K</span>,<span class="nv">M</span>,<span class="nv">G</span>,<span class="nv">T</span>,<span class="nv">P</span>}<span class="w"> </span><span class="ss">(</span><span class="mi">2101248</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">8388607</span><span class="ss">)</span>:<span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="nv">G</span>

<span class="nv">Created</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="s1">&#39;Linux&#39;</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">GiB</span>.

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">p</span>
<span class="nv">Disk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda</span>:<span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">GiB</span>,<span class="w"> </span><span class="mi">4294967296</span><span class="w"> </span><span class="nv">bytes</span>,<span class="w"> </span><span class="mi">8388608</span><span class="w"> </span><span class="nv">sectors</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">model</span>:<span class="w"> </span><span class="nv">QEMU</span><span class="w"> </span><span class="nv">HARDDISK</span>
<span class="nv">Units</span>:<span class="w"> </span><span class="nv">sectors</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Sector</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">logical</span><span class="o">/</span><span class="nv">physical</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">I</span><span class="o">/</span><span class="nv">O</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">minimum</span><span class="o">/</span><span class="nv">optimal</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Disklabel</span><span class="w"> </span><span class="nv">type</span>:<span class="w"> </span><span class="nv">dos</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">identifier</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x40bd0f72</span>

<span class="nv">Device</span><span class="w">     </span><span class="nv">Boot</span><span class="w">   </span><span class="nv">Start</span><span class="w">     </span><span class="k">End</span><span class="w"> </span><span class="nv">Sectors</span><span class="w"> </span><span class="nv">Size</span><span class="w"> </span><span class="nv">Id</span><span class="w"> </span><span class="nv">Type</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda1</span><span class="w">          </span><span class="mi">2048</span><span class="w"> </span><span class="mi">2099199</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda2</span><span class="w">       </span><span class="mi">2099200</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">6289408</span><span class="w">   </span><span class="mi">3</span><span class="nv">G</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="nv">Extended</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda5</span><span class="w">       </span><span class="mi">2101248</span><span class="w"> </span><span class="mi">4198399</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">n</span>
<span class="nv">All</span><span class="w"> </span><span class="nv">space</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">primary</span><span class="w"> </span><span class="nv">partitions</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">use</span>.
<span class="nv">Adding</span><span class="w"> </span><span class="nv">logical</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">6</span>
<span class="nv">First</span><span class="w"> </span><span class="nv">sector</span><span class="w"> </span><span class="ss">(</span><span class="mi">4200448</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">4200448</span><span class="ss">)</span>:
<span class="nv">Last</span><span class="w"> </span><span class="nv">sector</span>,<span class="w"> </span><span class="o">+/-</span><span class="nv">sectors</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="o">+/-</span><span class="nv">size</span>{<span class="nv">K</span>,<span class="nv">M</span>,<span class="nv">G</span>,<span class="nv">T</span>,<span class="nv">P</span>}<span class="w"> </span><span class="ss">(</span><span class="mi">4200448</span><span class="o">-</span><span class="mi">8388607</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">8388607</span><span class="ss">)</span>:

<span class="nv">Created</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="s1">&#39;Linux&#39;</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">GiB</span>.
</code></pre></div>

<p>And now, I have to change the type of the parition 6 to swap:</p>
<div class="highlight"><pre><span></span><code><span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">t</span>
<span class="nv">Partition</span><span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">2</span>,<span class="mi">5</span>,<span class="mi">6</span>,<span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="mi">6</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">6</span>
<span class="nv">Hex</span><span class="w"> </span><span class="nv">code</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">alias</span><span class="w"> </span><span class="ss">(</span><span class="nv">type</span><span class="w"> </span><span class="nv">L</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">all</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">L</span>

<span class="mi">00</span><span class="w"> </span><span class="nv">Empty</span><span class="w">            </span><span class="mi">24</span><span class="w"> </span><span class="nv">NEC</span><span class="w"> </span><span class="nv">DOS</span><span class="w">          </span><span class="mi">81</span><span class="w"> </span><span class="nv">Minix</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">old</span><span class="w"> </span><span class="nv">Lin</span><span class="w">  </span><span class="nv">bf</span><span class="w"> </span><span class="nv">Solaris</span>
<span class="mi">01</span><span class="w"> </span><span class="nv">FAT12</span><span class="w">            </span><span class="mi">27</span><span class="w"> </span><span class="nv">Hidden</span><span class="w"> </span><span class="nv">NTFS</span><span class="w"> </span><span class="nv">Win</span><span class="w">  </span><span class="mi">82</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">swap</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">So</span><span class="w">  </span><span class="nv">c1</span><span class="w"> </span><span class="nv">DRDOS</span><span class="o">/</span><span class="nv">sec</span><span class="w"> </span><span class="ss">(</span><span class="nv">FAT</span><span class="o">-</span>
<span class="mi">02</span><span class="w"> </span><span class="nv">XENIX</span><span class="w"> </span><span class="nv">root</span><span class="w">       </span><span class="mi">39</span><span class="w"> </span><span class="nv">Plan</span><span class="w"> </span><span class="mi">9</span><span class="w">           </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span><span class="w">            </span><span class="nv">c4</span><span class="w"> </span><span class="nv">DRDOS</span><span class="o">/</span><span class="nv">sec</span><span class="w"> </span><span class="ss">(</span><span class="nv">FAT</span><span class="o">-</span>
<span class="mi">03</span><span class="w"> </span><span class="nv">XENIX</span><span class="w"> </span><span class="nv">usr</span><span class="w">        </span><span class="mi">3</span><span class="nv">c</span><span class="w"> </span><span class="nv">PartitionMagic</span><span class="w">   </span><span class="mi">84</span><span class="w"> </span><span class="nv">OS</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nv">hidden</span><span class="w"> </span><span class="nv">or</span><span class="w">   </span><span class="nv">c6</span><span class="w"> </span><span class="nv">DRDOS</span><span class="o">/</span><span class="nv">sec</span><span class="w"> </span><span class="ss">(</span><span class="nv">FAT</span><span class="o">-</span>
<span class="mi">04</span><span class="w"> </span><span class="nv">FAT16</span><span class="w"> </span><span class="o">&lt;</span><span class="mi">32</span><span class="nv">M</span><span class="w">       </span><span class="mi">40</span><span class="w"> </span><span class="nv">Venix</span><span class="w"> </span><span class="mi">80286</span><span class="w">      </span><span class="mi">85</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">extended</span><span class="w">   </span><span class="nv">c7</span><span class="w"> </span><span class="nv">Syrinx</span>
<span class="mi">05</span><span class="w"> </span><span class="nv">Extended</span><span class="w">         </span><span class="mi">41</span><span class="w"> </span><span class="nv">PPC</span><span class="w"> </span><span class="nv">PReP</span><span class="w"> </span><span class="nv">Boot</span><span class="w">    </span><span class="mi">86</span><span class="w"> </span><span class="nv">NTFS</span><span class="w"> </span><span class="nv">volume</span><span class="w"> </span><span class="nv">set</span><span class="w">  </span><span class="nv">da</span><span class="w"> </span><span class="nv">Non</span><span class="o">-</span><span class="nv">FS</span><span class="w"> </span><span class="nv">data</span>
<span class="mi">06</span><span class="w"> </span><span class="nv">FAT16</span><span class="w">            </span><span class="mi">42</span><span class="w"> </span><span class="nv">SFS</span><span class="w">              </span><span class="mi">87</span><span class="w"> </span><span class="nv">NTFS</span><span class="w"> </span><span class="nv">volume</span><span class="w"> </span><span class="nv">set</span><span class="w">  </span><span class="nv">db</span><span class="w"> </span><span class="nv">CP</span><span class="o">/</span><span class="nv">M</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">CTOS</span><span class="w"> </span><span class="o">/</span><span class="w"> </span>.
<span class="mi">07</span><span class="w"> </span><span class="nv">HPFS</span><span class="o">/</span><span class="nv">NTFS</span><span class="o">/</span><span class="nv">exFAT</span><span class="w">  </span><span class="mi">4</span><span class="nv">d</span><span class="w"> </span><span class="nv">QNX4</span>.<span class="nv">x</span><span class="w">           </span><span class="mi">88</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">plaintext</span><span class="w">  </span><span class="nv">de</span><span class="w"> </span><span class="nv">Dell</span><span class="w"> </span><span class="nv">Utility</span>
<span class="mi">08</span><span class="w"> </span><span class="nv">AIX</span><span class="w">              </span><span class="mi">4</span><span class="nv">e</span><span class="w"> </span><span class="nv">QNX4</span>.<span class="nv">x</span><span class="w"> </span><span class="mi">2</span><span class="nv">nd</span><span class="w"> </span><span class="nv">part</span><span class="w">  </span><span class="mi">8</span><span class="nv">e</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">LVM</span><span class="w">        </span><span class="nv">df</span><span class="w"> </span><span class="nv">BootIt</span>
<span class="mi">09</span><span class="w"> </span><span class="nv">AIX</span><span class="w"> </span><span class="nv">bootable</span><span class="w">     </span><span class="mi">4</span><span class="nv">f</span><span class="w"> </span><span class="nv">QNX4</span>.<span class="nv">x</span><span class="w"> </span><span class="mi">3</span><span class="nv">rd</span><span class="w"> </span><span class="nv">part</span><span class="w">  </span><span class="mi">93</span><span class="w"> </span><span class="nv">Amoeba</span><span class="w">           </span><span class="nv">e1</span><span class="w"> </span><span class="nv">DOS</span><span class="w"> </span><span class="nv">access</span>
<span class="mi">0</span><span class="nv">a</span><span class="w"> </span><span class="nv">OS</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nv">Boot</span><span class="w"> </span><span class="nv">Manag</span><span class="w">  </span><span class="mi">50</span><span class="w"> </span><span class="nv">OnTrack</span><span class="w"> </span><span class="nv">DM</span><span class="w">       </span><span class="mi">94</span><span class="w"> </span><span class="nv">Amoeba</span><span class="w"> </span><span class="nv">BBT</span><span class="w">       </span><span class="nv">e3</span><span class="w"> </span><span class="nv">DOS</span><span class="w"> </span><span class="nv">R</span><span class="o">/</span><span class="nv">O</span>
<span class="mi">0</span><span class="nv">b</span><span class="w"> </span><span class="nv">W95</span><span class="w"> </span><span class="nv">FAT32</span><span class="w">        </span><span class="mi">51</span><span class="w"> </span><span class="nv">OnTrack</span><span class="w"> </span><span class="nv">DM6</span><span class="w"> </span><span class="nv">Aux</span><span class="w">  </span><span class="mi">9</span><span class="nv">f</span><span class="w"> </span><span class="nv">BSD</span><span class="o">/</span><span class="nv">OS</span><span class="w">           </span><span class="nv">e4</span><span class="w"> </span><span class="nv">SpeedStor</span>
<span class="mi">0</span><span class="nv">c</span><span class="w"> </span><span class="nv">W95</span><span class="w"> </span><span class="nv">FAT32</span><span class="w"> </span><span class="ss">(</span><span class="nv">LBA</span><span class="ss">)</span><span class="w">  </span><span class="mi">52</span><span class="w"> </span><span class="nv">CP</span><span class="o">/</span><span class="nv">M</span><span class="w">             </span><span class="nv">a0</span><span class="w"> </span><span class="nv">IBM</span><span class="w"> </span><span class="nv">Thinkpad</span><span class="w"> </span><span class="nv">hi</span><span class="w">  </span><span class="nv">ea</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">extended</span>
<span class="mi">0</span><span class="nv">e</span><span class="w"> </span><span class="nv">W95</span><span class="w"> </span><span class="nv">FAT16</span><span class="w"> </span><span class="ss">(</span><span class="nv">LBA</span><span class="ss">)</span><span class="w">  </span><span class="mi">53</span><span class="w"> </span><span class="nv">OnTrack</span><span class="w"> </span><span class="nv">DM6</span><span class="w"> </span><span class="nv">Aux</span><span class="w">  </span><span class="nv">a5</span><span class="w"> </span><span class="nv">FreeBSD</span><span class="w">          </span><span class="nv">eb</span><span class="w"> </span><span class="nv">BeOS</span><span class="w"> </span><span class="nv">fs</span>
<span class="mi">0</span><span class="nv">f</span><span class="w"> </span><span class="nv">W95</span><span class="w"> </span><span class="nv">Ext</span><span class="err">&#39;d (LBA)  54 OnTrackDM6       a6 OpenBSD          ee GPT</span>
<span class="err">10 OPUS             55 EZ-Drive         a7 NeXTSTEP         ef EFI (FAT-12/16/</span>
<span class="err">11 Hidden FAT12     56 Golden Bow       a8 Darwin UFS       f0 Linux/PA-RISC b</span>
<span class="err">12 Compaq diagnost  5c Priam Edisk      a9 NetBSD           f1 SpeedStor</span>
<span class="err">14 Hidden FAT16 &lt;3  61 SpeedStor        ab Darwin boot      f4 SpeedStor</span>
<span class="err">16 Hidden FAT16     63 GNU HURD or Sys  af HFS / HFS+       f2 DOS secondary</span>
<span class="err">17 Hidden HPFS/NTF  64 Novell Netware   b7 BSDI fs          fb VMware VMFS</span>
<span class="err">18 AST SmartSleep   65 Novell Netware   b8 BSDI swap        fc VMware VMKCORE</span>
<span class="err">1b Hidden W95 FAT3  70 DiskSecure Mult  bb Boot Wizard hid  fd Linux raid auto</span>
<span class="err">1c Hidden W95 FAT3  75 PC/IX            bc Acronis FAT32 L  fe LANstep</span>
<span class="err">1e Hidden W95 FAT1  80 Old Minix        be Solaris boot     ff BBT</span>

<span class="err">Aliases:</span>
<span class="err">   linux          - 83</span>
<span class="err">   swap           - 82</span>
<span class="err">   extended       - 05</span>
<span class="err">   uefi           - EF</span>
<span class="err">   raid           - FD</span>
<span class="err">   lvm            - 8E</span>
<span class="err">   linuxex        - 85</span>
<span class="err">Hex code or alias (type L to list all): swap</span>

<span class="nv">Changed</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">partition</span><span class="w"> </span><span class="s1">&#39;Linux&#39;</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="s1">&#39;Linux swap / Solaris&#39;</span>.

<span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">p</span>
<span class="nv">Disk</span><span class="w"> </span><span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda</span>:<span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">GiB</span>,<span class="w"> </span><span class="mi">4294967296</span><span class="w"> </span><span class="nv">bytes</span>,<span class="w"> </span><span class="mi">8388608</span><span class="w"> </span><span class="nv">sectors</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">model</span>:<span class="w"> </span><span class="nv">QEMU</span><span class="w"> </span><span class="nv">HARDDISK</span>
<span class="nv">Units</span>:<span class="w"> </span><span class="nv">sectors</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Sector</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">logical</span><span class="o">/</span><span class="nv">physical</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">I</span><span class="o">/</span><span class="nv">O</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="ss">(</span><span class="nv">minimum</span><span class="o">/</span><span class="nv">optimal</span><span class="ss">)</span>:<span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="nv">bytes</span>
<span class="nv">Disklabel</span><span class="w"> </span><span class="nv">type</span>:<span class="w"> </span><span class="nv">dos</span>
<span class="nv">Disk</span><span class="w"> </span><span class="nv">identifier</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x40bd0f72</span>

<span class="nv">Device</span><span class="w">     </span><span class="nv">Boot</span><span class="w">   </span><span class="nv">Start</span><span class="w">     </span><span class="k">End</span><span class="w"> </span><span class="nv">Sectors</span><span class="w"> </span><span class="nv">Size</span><span class="w"> </span><span class="nv">Id</span><span class="w"> </span><span class="nv">Type</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda1</span><span class="w">          </span><span class="mi">2048</span><span class="w"> </span><span class="mi">2099199</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda2</span><span class="w">       </span><span class="mi">2099200</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">6289408</span><span class="w">   </span><span class="mi">3</span><span class="nv">G</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="nv">Extended</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda5</span><span class="w">       </span><span class="mi">2101248</span><span class="w"> </span><span class="mi">4198399</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="nv">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="nv">Linux</span>
<span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sda6</span><span class="w">       </span><span class="mi">4200448</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">4188160</span><span class="w">   </span><span class="mi">2</span><span class="nv">G</span><span class="w"> </span><span class="mi">82</span><span class="w"> </span><span class="nv">Linux</span><span class="w"> </span><span class="nv">swap</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">Solaris</span>
</code></pre></div>

<p>Satisfied! Let's <code>v</code>erify and then <code>w</code>rite the results:</p>
<div class="highlight"><pre><span></span><code><span class="n">Command</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">help</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">v</span>
<span class="k">No</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="n">detected</span><span class="p">.</span>
<span class="n">Remaining</span><span class="w"> </span><span class="mi">4094</span><span class="w"> </span><span class="n">unallocated</span><span class="w"> </span><span class="mi">512</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">sectors</span><span class="p">.</span>

<span class="n">Command</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">help</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">w</span>
<span class="n">The</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">altered</span><span class="p">.</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">ioctl</span><span class="p">()</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="k">read</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span><span class="p">.</span>
<span class="n">Syncing</span><span class="w"> </span><span class="n">disks</span><span class="p">.</span>

<span class="n">root</span><span class="nv">@debianamd</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">fdisk</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>
<span class="k">Disk</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">sda</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">GiB</span><span class="p">,</span><span class="w"> </span><span class="mi">4294967296</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">8388608</span><span class="w"> </span><span class="n">sectors</span>
<span class="k">Disk</span><span class="w"> </span><span class="nl">model</span><span class="p">:</span><span class="w"> </span><span class="n">QEMU</span><span class="w"> </span><span class="n">HARDDISK</span>
<span class="nl">Units</span><span class="p">:</span><span class="w"> </span><span class="n">sectors</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="n">bytes</span>
<span class="n">Sector</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="p">(</span><span class="n">logical</span><span class="o">/</span><span class="n">physical</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="n">bytes</span>
<span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="p">(</span><span class="n">minimum</span><span class="o">/</span><span class="n">optimal</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">512</span><span class="w"> </span><span class="n">bytes</span>
<span class="n">Disklabel</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">dos</span>
<span class="k">Disk</span><span class="w"> </span><span class="nl">identifier</span><span class="p">:</span><span class="w"> </span><span class="mh">0x40bd0f72</span>

<span class="n">Device</span><span class="w">     </span><span class="n">Boot</span><span class="w">   </span><span class="k">Start</span><span class="w">     </span><span class="k">End</span><span class="w"> </span><span class="n">Sectors</span><span class="w"> </span><span class="k">Size</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="n">Type</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span><span class="w">          </span><span class="mi">2048</span><span class="w"> </span><span class="mi">2099199</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="n">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="n">Linux</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda2</span><span class="w">       </span><span class="mi">2099200</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">6289408</span><span class="w">   </span><span class="mi">3</span><span class="n">G</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="n">Extended</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span><span class="w">       </span><span class="mi">2101248</span><span class="w"> </span><span class="mi">4198399</span><span class="w"> </span><span class="mi">2097152</span><span class="w">   </span><span class="mi">1</span><span class="n">G</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="n">Linux</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda6</span><span class="w">       </span><span class="mi">4200448</span><span class="w"> </span><span class="mi">8388607</span><span class="w"> </span><span class="mi">4188160</span><span class="w">   </span><span class="mi">2</span><span class="n">G</span><span class="w"> </span><span class="mi">82</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="n">swap</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Solaris</span>
</code></pre></div>

<h4>gdisk</h4>
<p>As seen on <a href="/1021-design-hard-disk-layout.html">chapter 102.1</a>, we have used <code>gdisk</code> on GPT machines. Its not that different from <code>fdisk</code>. Lets have a look at its main commands:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@debianamd</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">gdisk</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>
<span class="n">GPT</span><span class="w"> </span><span class="n">fdisk</span><span class="w"> </span><span class="p">(</span><span class="n">gdisk</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.0.6</span><span class="w">  </span>

<span class="nl">Warning</span><span class="p">:</span><span class="w"> </span><span class="k">Partition</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">claims</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span>
<span class="n">entries</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">program</span><span class="w">  </span><span class="n">supports</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="mi">128</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">entries</span><span class="p">.</span>
<span class="n">Adjusting</span><span class="w"> </span><span class="n">accordingly</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">garbage</span><span class="p">.</span>
<span class="nl">Warning</span><span class="p">:</span><span class="w"> </span><span class="k">Partition</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">claims</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span>
<span class="n">entries</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">program</span><span class="w">  </span><span class="n">supports</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="mi">128</span><span class="o">-</span><span class="n">byte</span><span class="w"> </span><span class="n">entries</span><span class="p">.</span>
<span class="n">Adjusting</span><span class="w"> </span><span class="n">accordingly</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">garbage</span><span class="p">.</span>
<span class="k">Partition</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="nl">scan</span><span class="p">:</span>
<span class="w">  </span><span class="nl">MBR</span><span class="p">:</span><span class="w"> </span><span class="n">MBR</span><span class="w"> </span><span class="k">only</span>
<span class="w">  </span><span class="nl">BSD</span><span class="p">:</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">present</span>
<span class="w">  </span><span class="nl">APM</span><span class="p">:</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">present</span>
<span class="w">  </span><span class="nl">GPT</span><span class="p">:</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">present</span>


<span class="o">***************************************************************</span>
<span class="k">Found</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">GPT</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">MBR</span><span class="p">;</span><span class="w"> </span><span class="n">converting</span><span class="w"> </span><span class="n">MBR</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">GPT</span><span class="w"> </span><span class="nf">format</span>
<span class="ow">in</span><span class="w"> </span><span class="n">memory</span><span class="p">.</span><span class="w"> </span><span class="n">THIS</span><span class="w"> </span><span class="k">OPERATION</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="n">POTENTIALLY</span><span class="w"> </span><span class="n">DESTRUCTIVE</span><span class="err">!</span><span class="w"> </span><span class="k">Exit</span><span class="w"> </span><span class="k">by</span>
<span class="n">typing</span><span class="w"> </span><span class="s1">&#39;q&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">don</span><span class="s1">&#39;t want to convert your MBR partitions</span>
<span class="s1">to GPT format!</span>
<span class="s1">***************************************************************</span>

<span class="s1">Command (? for help): ?</span>
<span class="s1">b   back up GPT data to a file</span>
<span class="s1">c   change a partition&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">name</span>
<span class="n">d</span><span class="w">   </span><span class="k">delete</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">partition</span>
<span class="n">i</span><span class="w">   </span><span class="n">show</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">partition</span>
<span class="n">l</span><span class="w">   </span><span class="n">list</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">types</span>
<span class="n">n</span><span class="w">   </span><span class="k">add</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">partition</span>
<span class="n">o</span><span class="w">   </span><span class="k">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">GUID</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="p">(</span><span class="n">GPT</span><span class="p">)</span>
<span class="n">p</span><span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span>
<span class="n">q</span><span class="w">   </span><span class="n">quit</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="n">saving</span><span class="w"> </span><span class="n">changes</span>
<span class="n">r</span><span class="w">   </span><span class="n">recovery</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">(</span><span class="n">experts</span><span class="w"> </span><span class="k">only</span><span class="p">)</span>
<span class="n">s</span><span class="w">   </span><span class="n">sort</span><span class="w"> </span><span class="n">partitions</span>
<span class="n">t</span><span class="w">   </span><span class="n">change</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">partition</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">code</span>
<span class="n">v</span><span class="w">   </span><span class="n">verify</span><span class="w"> </span><span class="k">disk</span>
<span class="n">w</span><span class="w">   </span><span class="k">write</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">disk</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">exit</span>
<span class="n">x</span><span class="w">   </span><span class="n">extra</span><span class="w"> </span><span class="n">functionality</span><span class="w"> </span><span class="p">(</span><span class="n">experts</span><span class="w"> </span><span class="k">only</span><span class="p">)</span>
<span class="vm">?</span><span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">menu</span>
</code></pre></div>

<p>As you can see, the partition table have to be compatible with your BIOS/UEFI setup. </p>
<h4>parted</h4>
<p><code>parted</code> is the GNU tool to edit partitions. Its main advantage is the ability to resize currently defined partitions but using it is a bit trickier than <code>fdisk</code> and <code>gdisk</code>:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">parted</span>
<span class="n">GNU</span><span class="w"> </span><span class="n">Parted</span><span class="w"> </span><span class="mf">3.4</span>
<span class="k">Using</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda</span>
<span class="n">Welcome</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">GNU</span><span class="w"> </span><span class="n">Parted</span><span class="err">!</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="s1">&#39;help&#39;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">commands</span><span class="p">.</span>
<span class="p">(</span><span class="n">parted</span><span class="p">)</span><span class="w"> </span><span class="n">help</span>
<span class="w">  </span><span class="n">align</span><span class="o">-</span><span class="k">check</span><span class="w"> </span><span class="n">TYPE</span><span class="w"> </span><span class="n">N</span><span class="w">                       </span><span class="k">check</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">TYPE</span><span class="p">(</span><span class="nf">min</span><span class="o">|</span><span class="n">opt</span><span class="p">)</span><span class="w"> </span><span class="n">alignment</span>
<span class="w">  </span><span class="n">help</span><span class="w"> </span><span class="o">[</span><span class="n">COMMAND</span><span class="o">]</span><span class="w">                           </span><span class="k">print</span><span class="w"> </span><span class="k">general</span><span class="w"> </span><span class="n">help</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">COMMAND</span>
<span class="w">  </span><span class="n">mklabel</span><span class="p">,</span><span class="n">mktable</span><span class="w"> </span><span class="n">LABEL</span><span class="o">-</span><span class="n">TYPE</span><span class="w">               </span><span class="k">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">disklabel</span><span class="w"> </span><span class="p">(</span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span><span class="p">)</span>
<span class="w">  </span><span class="n">mkpart</span><span class="w"> </span><span class="n">PART</span><span class="o">-</span><span class="n">TYPE</span><span class="w"> </span><span class="o">[</span><span class="n">FS-TYPE</span><span class="o">]</span><span class="w"> </span><span class="k">START</span><span class="w"> </span><span class="k">END</span><span class="w">     </span><span class="n">make</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">partition</span>
<span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="n">NUMBER</span><span class="w"> </span><span class="n">NAME</span><span class="w">                         </span><span class="n">name</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">NUMBER</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">NAME</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">[</span><span class="n">devices|free|list,all|NUMBER</span><span class="o">]</span><span class="w">     </span><span class="n">display</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="nc">table</span><span class="p">,</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">devices</span><span class="p">,</span><span class="w"> </span><span class="k">free</span><span class="w"> </span><span class="nf">space</span><span class="p">,</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="n">partitions</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="k">partition</span>
<span class="w">  </span><span class="n">quit</span><span class="w">                                     </span><span class="k">exit</span><span class="w"> </span><span class="n">program</span>
<span class="w">  </span><span class="n">rescue</span><span class="w"> </span><span class="k">START</span><span class="w"> </span><span class="k">END</span><span class="w">                         </span><span class="n">rescue</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">lost</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">near</span><span class="w"> </span><span class="k">START</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">END</span>
<span class="w">  </span><span class="n">resizepart</span><span class="w"> </span><span class="n">NUMBER</span><span class="w"> </span><span class="k">END</span><span class="w">                    </span><span class="n">resize</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">NUMBER</span>
<span class="w">  </span><span class="n">rm</span><span class="w"> </span><span class="n">NUMBER</span><span class="w">                                </span><span class="k">delete</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">NUMBER</span>
<span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">DEVICE</span><span class="w">                            </span><span class="nf">choose</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">edit</span>
<span class="w">  </span><span class="n">disk_set</span><span class="w"> </span><span class="n">FLAG</span><span class="w"> </span><span class="k">STATE</span><span class="w">                      </span><span class="n">change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">FLAG</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">device</span>
<span class="w">  </span><span class="n">disk_toggle</span><span class="w"> </span><span class="o">[</span><span class="n">FLAG</span><span class="o">]</span><span class="w">                       </span><span class="n">toggle</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FLAG</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">device</span>
<span class="w">  </span><span class="k">set</span><span class="w"> </span><span class="n">NUMBER</span><span class="w"> </span><span class="n">FLAG</span><span class="w"> </span><span class="k">STATE</span><span class="w">                    </span><span class="n">change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">FLAG</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">NUMBER</span>
<span class="w">  </span><span class="n">toggle</span><span class="w"> </span><span class="o">[</span><span class="n">NUMBER [FLAG</span><span class="o">]</span><span class="err">]</span><span class="w">                   </span><span class="n">toggle</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FLAG</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">NUMBER</span>
<span class="w">  </span><span class="n">unit</span><span class="w"> </span><span class="n">UNIT</span><span class="w">                                </span><span class="k">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">UNIT</span>
<span class="w">  </span><span class="n">version</span><span class="w">                                  </span><span class="n">display</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">copyright</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">GNU</span><span class="w"> </span><span class="n">Parted</span>
</code></pre></div>

<h4>hint? use gparted</h4>
<p>The <code>gparted</code> tool is a graphical tool to manage your partitioned. It has the ability to resize partitions and is super easy to use. Its not part of the LPIC exam but its good to know about it. just in case ;) <a href="https://gparted.org/">gparted.org</a></p>
<h3>Formatting the partition</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/rQZVYtVOEhU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h4>Filesystems</h4>
<p>After you partitioned your block devices, you have to format them to make them usable to store files and directories. Formatting a file system, creates a map which stores the location and name of files and directories and make it possible to move files between folders, deleting them or renaming them; think of it as the index of a book. </p>
<p>There are several filesystems in the linux world but, these are the most commonly used ones:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Format</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">ext2</td>
<td style="text-align: left;">second extended filesystem was developed to address shortcomings in the older Unix/Minix filesystem used in early versions of Linux. It has been used extensively on Linux for many years. There is no journaling in ext2, and it has largely been replaced by ext3 and more recently ext4.</td>
</tr>
<tr>
<td style="text-align: center;">ext3</td>
<td style="text-align: left;">ext2 + journaling, max file size is 2TB and max filesystem size is 16TB</td>
</tr>
<tr>
<td style="text-align: center;">ext4</td>
<td style="text-align: left;">current version of ext, max file size is 16TB and max filesystem size is 1EB (1000*1000TB)</td>
</tr>
<tr>
<td style="text-align: center;">XFS</td>
<td style="text-align: left;">journaling, caches to RAM, great for uninterruptible power supplies, Max file and filesystem size is 8EB</td>
</tr>
<tr>
<td style="text-align: center;">swap</td>
<td style="text-align: left;">Swap is used when the system needs to use more ram than what is has. It's like an extra ram on disk</td>
</tr>
<tr>
<td style="text-align: center;">VFAT</td>
<td style="text-align: left;">FAT32, no journaling, good for data exchange with windows, does not understand <strong>permissions</strong> and symbolic links</td>
</tr>
<tr>
<td style="text-align: center;">exFAT</td>
<td style="text-align: left;">Extended FAT. A newer version of FAT which is used mainly for extended device which should work on all machines; like USB disks</td>
</tr>
<tr>
<td style="text-align: center;">btrfs</td>
<td style="text-align: left;">A new high performance file system. Max file and filesize is 16 EB. Has its own form of RAID and LVM and build-in snapshots and fault tolerance and data compression on the fly.</td>
</tr>
</tbody>
</table>
<h4>Creating filesystems</h4>
<p>You can format your partitions with <code>mkfs</code> command (and <code>mkswap</code> for swap). This is a front end to commands like <code>mkfs.ext3</code> for <em>ext3</em>, <code>mkfs.ext4</code> for <em>ext4</em> and <code>mkfs.reiserfs</code> for <em>ReiserFS</em>. full list of installed on your system is here:</p>
<div class="highlight"><pre><span></span><code># ls /sbin/mk*
/sbin/mkdosfs  /sbin/mkexfatfs  /sbin/mkfs.bfs     /sbin/mkfs.exfat  /sbin/mkfs.ext3  /sbin/mkfs.fat    /sbin/mkfs.msdos  /sbin/mkfs.vfat     /sbin/mkinitramfs   /sbin/mkntfs
/sbin/mke2fs   /sbin/mkfs   /sbin/mkfs.cramfs  /sbin/mkfs.ext2   /sbin/mkfs.ext4  /sbin/mkfs.minix  /sbin/mkfs.ntfs   /sbin/mkhomedir_helper  /sbin/mklost+found  /sbin/mkswap
</code></pre></div>

<p>If using the <code>mkfs</code>, the main switch is <code>-type</code> (or <code>-t</code>) to specify the format:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">mkfs</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">ext4</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span>
<span class="n">mke2fs</span><span class="w"> </span><span class="mf">1.46.2</span><span class="w"> </span><span class="p">(</span><span class="mi">28</span><span class="o">-</span><span class="n">Feb</span><span class="o">-</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">Discarding</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="nl">blocks</span><span class="p">:</span><span class="w"> </span><span class="n">done</span>
<span class="n">Creating</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="mi">4</span><span class="n">k</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">65536</span><span class="w"> </span><span class="n">inodes</span>
<span class="n">Filesystem</span><span class="w"> </span><span class="nl">UUID</span><span class="p">:</span><span class="w"> </span><span class="mi">63625</span><span class="n">ecd</span><span class="o">-</span><span class="mi">857</span><span class="n">a</span><span class="o">-</span><span class="mi">419</span><span class="n">f</span><span class="o">-</span><span class="n">a300</span><span class="o">-</span><span class="mi">12395</span><span class="n">aaad89f</span>
<span class="n">Superblock</span><span class="w"> </span><span class="n">backups</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="nl">blocks</span><span class="p">:</span>
<span class="w">    </span><span class="mi">32768</span><span class="p">,</span><span class="w"> </span><span class="mi">98304</span><span class="p">,</span><span class="w"> </span><span class="mi">163840</span><span class="p">,</span><span class="w"> </span><span class="mi">229376</span>

<span class="n">Allocating</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="nl">tables</span><span class="p">:</span><span class="w"> </span><span class="n">done</span>
<span class="n">Writing</span><span class="w"> </span><span class="n">inode</span><span class="w"> </span><span class="nl">tables</span><span class="p">:</span><span class="w"> </span><span class="n">done</span>
<span class="n">Creating</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="p">(</span><span class="mi">8192</span><span class="w"> </span><span class="n">blocks</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">done</span>
<span class="n">Writing</span><span class="w"> </span><span class="n">superblocks</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">filesystem</span><span class="w"> </span><span class="n">accounting</span><span class="w"> </span><span class="nl">information</span><span class="p">:</span><span class="w"> </span><span class="n">done</span>

<span class="n">root</span><span class="nv">@debianamd</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">mkfs</span><span class="p">.</span><span class="n">exfat</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span>
<span class="n">mkexfatfs</span><span class="w"> </span><span class="mf">1.3.0</span>
<span class="n">Creating</span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="p">.</span>
<span class="n">Flushing</span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="p">.</span>
<span class="k">File</span><span class="w"> </span><span class="k">system</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="n">successfully</span><span class="p">.</span>
</code></pre></div>

<p>If you need to assign a lable to the partition, you have to use the <code>-L lable_name</code> option. Please note that in recent system, people use UUIDs instead of labels. UUID of a disk can be viewed with:</p>
<div class="highlight"><pre><span></span><code># blkid /dev/sda1
/dev/sda1: UUID=&quot;63625ecd-857a-419f-a300-12395aaad89f&quot; BLOCK_SIZE=&quot;4096&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;40bd0f72-01&quot;
</code></pre></div>

<p>and as the last task, lets create a swap on <code>/dev/sda6</code>:</p>
<div class="highlight"><pre><span></span><code># mkswap /dev/sda6
Setting up swapspace version 1, size = 2 GiB (2144333824 bytes)
no label, UUID=6a59cf20-8fd6-4d86-b044-89f7bc67993b
</code></pre></div>

<p>and then </p>
<div class="highlight"><pre><span></span><code># swapon /dev/sda6
</code></pre></div>

<p>On chapter 14.3 we will see how we can <em>mount</em> / <em>unmount</em> these filesystems.</p>
                                            <br clear="both" />
                                            <h1>104.2 Maintain the integrity of filesystems</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Candidates should be able to maintain a standard filesystem, as well as the extra data associated with a journaling filesystem.</p>
<h2>Objectives</h2>
<ul>
<li>Verify the integrity of filesystems.</li>
<li>Monitor free space and inodes.</li>
<li>
<p>Repair simple filesystem problems.</p>
</li>
<li>
<p>du</p>
</li>
<li>df</li>
<li>fsck</li>
<li>e2fsck</li>
<li>mke2fs</li>
<li>tune2fs</li>
<li>xfs_repair</li>
<li>xfs_fsr</li>
<li>xfs_db</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/qcAZ7vr6W9U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>du &amp; df</h2>
<p>In many cases you want to find out about the free space of a disk or find how much space a directory is using or check how many inodes left.</p>
<blockquote>
<p>The inode (index node) is a data structure in a Unix-style file system that describes a file-system object such as a file or a directory. Each inode stores the attributes and disk block locations of the object's data. File-system object attributes may include metadata (times of last change, access, modification), as well as owner and permission data. A directory is a list of inodes with their assigned names. The list includes an entry for itself, its parent, and each of its children. <small>(<a href="https://en.wikipedia.org/wiki/Inode">wikipedia</a>)</small></p>
</blockquote>
<h3>df</h3>
<p>The <strong>d</strong>isk<strong>f</strong>ree command is used to find out about the free and used space on file systems.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ df -TH
Filesystem        Type      Size  Used Avail Use% Mounted on
/dev/sda2         ext4       23G   15G  7.7G  65% /
none              tmpfs     4.0K     0  4.0K   0% /sys/fs/cgroup
udev              devtmpfs  3.9G  4.0K  3.9G   1% /dev
tmpfs             tmpfs     788M  1.4M  786M   1% /run
none              tmpfs     5.0M  4.0K  5.0M   1% /run/lock
none              tmpfs     3.9G   19M  3.9G   1% /run/shm
none              tmpfs     100M   28K  100M   1% /run/user
/dev/mapper/chome ext4      243G  229G   14G  95% /home/jadi
/dev/sdb1         vfat      3.7G  7.8M  3.6G   1% /media/jadi/BA82-BECD
</code></pre></div>

<p>Here, the <code>-T</code> switch tells <code>df</code> to show the file system types and `-H` make numbers human readable (in powers of 1000 , for powers of 2, use <code>-h</code>).</p>
<p>On some filesystems (like ext2-4) we have a fixed number of inodes, so you may need to check the number of remaining inodes too. To do so, use the <code>-i</code> switch:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ df -i
Filesystem          Inodes  IUsed    IFree IUse% Mounted on
/dev/sda2          1531904 458616  1073288   30% /
none               1007533      4  1007529    1% /sys/fs/cgroup
udev               1003703    542  1003161    1% /dev
tmpfs              1007533    644  1006889    1% /run
none               1007533      3  1007530    1% /run/lock
none               1007533    162  1007371    1% /run/shm
none               1007533     33  1007500    1% /run/user
/dev/mapper/chome 16171008 269293 15901715    2% /home/jadi
/dev/sdb1                0      0        0     - /media/jadi/BA82-BECD
</code></pre></div>

<blockquote>
<p>vfat file format has no inodes; there is no owner or access rights on vfat filesystems.</p>
</blockquote>
<h3>du</h3>
<p>The <strong>d</strong>isk<strong>u</strong>sage command shows the used space of <strong>directories and files</strong>. The common switches are:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">switch</th>
<th style="text-align: left;">usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">-h</td>
<td style="text-align: left;">print sizes in powers of 1024 (e.g., 1023M)</td>
</tr>
<tr>
<td style="text-align: center;">-H</td>
<td style="text-align: left;">print sizes in powers of 1000 (e.g., 1.1G)</td>
</tr>
<tr>
<td style="text-align: center;">-c</td>
<td style="text-align: left;">show the grand total</td>
</tr>
<tr>
<td style="text-align: center;">--max-depth 2</td>
<td style="text-align: left;">Calculate all but show only 2 directories deep</td>
</tr>
<tr>
<td style="text-align: center;">-s</td>
<td style="text-align: left;">Only shows the summary and not all the directories one by one</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code>jadi@funlife:~/w/lpic$ du
16    ./101
701456    ./done
701464    ./Logo/chert
704588    ./Logo
12    ./data
12    ./100
9432884    .
jadi@funlife:~/w/lpic$ du -c
16    ./101
701456    ./done
701464    ./Logo/chert
704588    ./Logo
12    ./data
12    ./100
9432884    .
9432884    total
jadi@funlife:~/w/lpic$ du -hs
9.0G    .
</code></pre></div>

<blockquote>
<p>in many cases when I want to see what uses my serers space, I use something like <code>$sudo du /home -h --max-depth 1</code></p>
</blockquote>
<h2>checking file systems</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/VjnBzwDYbIY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>fsck</h3>
<p>If anything bad happens for your filesystem (say power suddenly goes down) you will have a corrupted file system. The general command to fix this is <code>fsck</code>. Technically this command is a front end for many commands:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ ls /sbin/*fsck*
/sbin/dosfsck       /sbin/fsck.ext2     /sbin/fsck.fat     /sbin/fsck.vfat
/sbin/e2fsck       /sbin/fsck.ext3     /sbin/fsck.minix
/sbin/fsck       /sbin/fsck.ext4     /sbin/fsck.msdos
/sbin/fsck.cramfs  /sbin/fsck.ext4dev  /sbin/fsck.nfs
</code></pre></div>

<blockquote>
<p>Some of these are just hardlinks to <code>e2fsck</code> command</p>
</blockquote>
<p>A common switch during boot is <code>-A</code> which tells <code>fsck</code> to check all file systems in /etc/fstab ordered by <em>passno</em> in that file which is 6th field (File systems with <em>passno</em> of 0, wont be checked during the boot.</p>
<div class="highlight"><pre><span></span><code>root@funlife:~# fsck /dev/sdb
fsck from util-linux 2.25.1
e2fsck 1.42.10 (18-May-2014)
/dev/sdb is in use.
e2fsck: Cannot continue, aborting.


root@funlife:~# umount /dev/sdb
umount: /dev/sdb: not mounted
root@funlife:~# umount /dev/sdb1
root@funlife:~# fsck /dev/sdb
fsck from util-linux 2.25.1
e2fsck 1.42.10 (18-May-2014)
ext2fs_open2: Bad magic number in super-block
fsck.ext2: Superblock invalid, trying backup blocks...
fsck.ext2: Bad magic number in super-block while trying to open /dev/sdb

The superblock could not be read or does not describe a valid ext2/ext3/ext4
filesystem.  If the device is valid and it really contains an ext2/ext3/ext4
filesystem (and not swap or ufs or something else), then the superblock
is corrupt, and you might try running e2fsck with an alternate superblock:
    e2fsck -b 8193 &lt;device&gt;
 or
    e2fsck -b 32768 &lt;device&gt;
</code></pre></div>

<p>You can also check filesystems with UUID (find them with <code>blkid</code> command or with labels) :</p>
<div class="highlight"><pre><span></span><code>root@funlife:~# fsck /dev/sdb
fsck from util-linux 2.25.1
e2fsck 1.42.10 (18-May-2014)
ext2fs_open2: Bad magic number in super-block
fsck.ext2: Superblock invalid, trying backup blocks...
fsck.ext2: Bad magic number in super-block while trying to open /dev/sdb

The superblock could not be read or does not describe a valid ext2/ext3/ext4
filesystem.  If the device is valid and it really contains an ext2/ext3/ext4
filesystem (and not swap or ufs or something else), then the superblock
is corrupt, and you might try running e2fsck with an alternate superblock:
    e2fsck -b 8193 &lt;device&gt;
 or
    e2fsck -b 32768 &lt;device&gt;

root@funlife:~# blkid
/dev/sda1: LABEL=&quot;movies&quot;
/dev/sdb1: UUID=&quot;BA82-BECD&quot; TYPE=&quot;vfat&quot; PARTUUID=&quot;381add66-01&quot;
root@funlife:~# fsck LABEL=movies
fsck from util-linux 2.25.1
root@funlife:~# fsck UUID=&quot;BA82-BECD&quot;
fsck from util-linux 2.25.1
fsck.fat 3.0.26 (2014-03-07)
/dev/sdb1: 14 files, 1972/945094 clusters
</code></pre></div>

<p>Use <code>-N</code> to see what command/test is going to be executed without actually running them:</p>
<div class="highlight"><pre><span></span><code>root@funlife:~# fsck -N UUID=&quot;BA82-BECD&quot;
fsck from util-linux 2.25.1
[/sbin/fsck.vfat (1) -- /dev/sdb1] fsck.vfat /dev/sdb1
</code></pre></div>

<blockquote>
<p>If you want to check a XFS filesystem, you have to use <code>xfs_check</code> command</p>
</blockquote>
<p>Some version do have a <code>-a</code> for automatic fixing all found issues but its not recommended. </p>
<h3>e2fsck</h3>
<p><code>e2fsck</code> is used to check the ext2/ext3/ext4 family of file systems.  For ext3 and ext4 file systems that use a <code>journal</code>, if the system has been shutdown uncleanly without any errors,normally, after replaying the committed transactions  in the journal, the file system should be marked as clean. Hence, for file systems that use <strong>journaling</strong> , e2fsck will normally replay the journal and exit, unless its superblock indicates that further checking is required.</p>
<p>device is a block device (e.g., <code>/dev/sdc1</code>) or file containing the file system.</p>
<p>Note that in general it is not safe to run <code>e2fsck</code> on  <strong><em>mounted</em></strong> file systems.  The only exception is if the <code>-n</code> option is specified, and <code>-c</code>, <code>-l</code>, or <code>-L</code> options are not specified. However, even if it is safe to do so, the results printed by <code>e2fsck</code> are not valid if the file system is <strong><em>mounted</em></strong> . If <code>e2fsck</code> asks whether or not you should check a file system which is mounted, the only correct answer is ``no''.  Only experts who really know what they are doing should consider answering this question in any other way.</p>
<p>If <code>e2fsck</code> is run in interactive mode (meaning that none of <code>-y</code>, <code>-n</code>, or <code>-p</code> are specified), the program will ask the user to fix each problem found in the file system. A response of <code>'y'</code> will fix the error; <code>'n'</code> will leave the error unfixed; and <code>'a'</code> will fix the problem and all subsequent problems; pressing Enter will proceed with the default response, which is printed before the question mark.  Pressing <code>Control-C</code> terminates <code>e2fsck</code> immediately.</p>
<h3>mke2fs</h3>
<p>mke2fs is used to create an ext2, ext3, or ext4 filesystem, usually in a disk partition. device is the special file corresponding to the device (e.g /dev/hdXX). blocks-count is the number of blocks on the device. If omitted, mke2fs automagically figures the file system size. If called as mkfs.ext3 a journal is created as if the <code>-j</code> option was specified.</p>
<p>The defaults of the parameters for the newly created filesystem, if not overridden by the options listed below, are controlled by the /etc/mke2fs.conf configuration file. See the mke2fs.conf(5) manual page for more details.</p>
<h3>tune2fs</h3>
<p>This is a command to tune <em>ext</em> file systems. It can show information and set many options. The <code>-l</code> option lists the current configs:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ sudo tune2fs -l /dev/sda2
tune2fs 1.42.10 (18-May-2014)
Filesystem volume name:   &lt;none&gt;
Last mounted on:          /
Filesystem UUID:          1651a94e-0b4e-47fb-aca0-f77e05714617
Filesystem magic number:  0xEF53
Filesystem revision #:    1 (dynamic)
Filesystem features:      has_journal ext_attr resize_inode dir_index filetype needs_recovery extent flex_bg sparse_super large_file huge_file uninit_bg dir_nlink extra_isize
Filesystem flags:         signed_directory_hash
Default mount options:    user_xattr acl
Filesystem state:         clean
Errors behavior:          Continue
Filesystem OS type:       Linux
Inode count:              1531904
Block count:              6123046
Reserved block count:     306152
Free blocks:              2302702
Free inodes:              1073461
First block:              0
Block size:               4096
Fragment size:            4096
Reserved GDT blocks:      1022
Blocks per group:         32768
Fragments per group:      32768
Inodes per group:         8192
Inode blocks per group:   512
Flex block group size:    16
Filesystem created:       Mon Dec  1 10:21:42 2014
Last mount time:          Sat Jan 31 17:21:51 2015
Last write time:          Sat Jan 31 17:21:51 2015
Mount count:              32
Maximum mount count:      -1
Last checked:             Mon Dec  1 10:21:42 2014
Check interval:           0 (&lt;none&gt;)
Lifetime writes:          103 GB
Reserved blocks uid:      0 (user root)
Reserved blocks gid:      0 (group root)
First inode:              11
Inode size:              256
Required extra isize:     28
Desired extra isize:      28
Journal inode:            8
First orphan inode:       786620
Default directory hash:   half_md4
Directory Hash Seed:      16c38a41-e709-4e04-b1c2-8a79d71ea7e8
Journal backup:           inode blocks
</code></pre></div>

<h3>debugfs</h3>
<p>This is an interactive tool for debug an ext filesystem. It opens the filesystem in read-only mode unless we tell it not to (with <code>-w</code> option). It can un-delete files and directories..</p>
<div class="highlight"><pre><span></span><code>root@funlife:~# debugfs /dev/sda2
debugfs 1.42.10 (18-May-2014)
debugfs:  cd /etc/        &lt;-- cd
debugfs:  pwd            &lt;-- show were am I
[pwd]   INODE: 524289  PATH: /etc
[root]  INODE:      2  PATH: /
debugfs:  stat passwd        &lt;-- show data on one file
Inode: 527187   Type: regular    Mode:  0644   Flags: 0x80000
Generation: 1875144872    Version: 0x00000000:00000001
User:     0   Group:     0   Size: 2145
File ACL: 0    Directory ACL: 0
Links: 1   Blockcount: 8
Fragment:  Address: 0    Number: 0    Size: 0
 ctime: 0x548d4241:a7b196fc -- Sun Dec 14 11:24:41 2014
 atime: 0x54cc635b:6acfc148 -- Sat Jan 31 08:38:43 2015
 mtime: 0x548d4241:a01076f8 -- Sun Dec 14 11:24:41 2014
crtime: 0x548d4241:9f1c52f8 -- Sun Dec 14 11:24:41 2014
Size of extra inode fields: 28
EXTENTS:
(0):2188172
debugfs:  ncheck 527187        &lt;-- node check an inode
Inode    Pathname        
527187    /etc/passwd
debugfs:  q            &lt;-- quit
</code></pre></div>

<h4>Superblock</h4>
<p>Unix systems use superblocks to save <em>filesystem metadata</em>. Most of the times this block is located at the beginning of the file system and replicated on other locations too. The <code>-n</code> of <code>mke2fs</code> displays superblock locations</p>
<div class="highlight"><pre><span></span><code># mke2fs -n /dev/sda7
mke2fs 1.41.9 (22-Aug-2009)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
7159808 inodes, 28637862 blocks
1431893 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=4294967296
874 block groups
32768 blocks per group, 32768 fragments per group
8192 inodes per group
Superblock backups stored on blocks:
    32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,
    4096000, 7962624, 11239424, 20480000, 23887872
</code></pre></div>

<h2>xfs tools</h2>
<p>Note: in some distros, xfs tools are not installed by default and you might need to install <code>xfsprogs</code> package. </p>
<p>This is same as the <code>tune2fs</code> but for xfs file systems.</p>
<blockquote>
<p>xfs_info should be used on mounted file systems</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align: center;">Command</th>
<th style="text-align: left;">usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">xfs_info</td>
<td style="text-align: left;">display information</td>
</tr>
<tr>
<td style="text-align: center;">xfs_growfs</td>
<td style="text-align: left;">expand file system</td>
</tr>
<tr>
<td style="text-align: center;">xfs_admin</td>
<td style="text-align: left;">change parameters on XFS file systems</td>
</tr>
<tr>
<td style="text-align: center;">xfs_repair</td>
<td style="text-align: left;">repair the problems. Please note that the filesytem under repair should be unmounted</td>
</tr>
<tr>
<td style="text-align: center;">xfs_db</td>
<td style="text-align: left;">checks and debug the filesystem. xfs_db is used to examine an XFS filesystem. Under rare circumstances it can also be used to modify an XFS filesystem, but that task is normally left to xfs_repair or to scripts such as xfs_admin that run xfs_db.</td>
</tr>
<tr>
<td style="text-align: center;">xfs_fsr</td>
<td style="text-align: left;">filesystem reorganizer for XFS. When invoked with no arguments xfs_fsr reorganizes all regular files in all mounted filesystems. xfs_fsr makes many cycles over /etc/mtab each time making a single pass over each XFS filesystem. Each pass goes through and selects files that have the largest number of extents. It attempts to defragment the top 10% of these files on each pass.</td>
</tr>
</tbody>
</table>
<h3>Repairing</h3>
<p>We used the <code>fsck</code> for showing file system information but it is designed to <em>fix</em> file systems too. If the boot time check find a problems, you will be put into a command line to fix the problems.</p>
<p>On non-journaling file systems (ext2) the fsck will show you many questions about each block and you have to say <code>y</code> if you want it to fix them. On journaling file systems (ext3&amp;4, xfs, ..) the fsck has much less tasks to perform.</p>
<blockquote>
<p>for xfs file systems, we have <code>xfs_check</code> command</p>
</blockquote>
<p>An important switch is <code>-n</code> which causes these commands <strong>not to fix</strong> anything and just show what was going to be done.</p>
<h2>Other tools</h2>
<p>For the LPIC exam, it is good to know about these commands.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">filesystem</th>
<th style="text-align: center;">command</th>
<th style="text-align: left;">usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">ext</td>
<td style="text-align: center;">tune2fs</td>
<td style="text-align: left;">Show or set ext2 and ext3 parameters or even set the journaling options</td>
</tr>
<tr>
<td style="text-align: center;">ext</td>
<td style="text-align: center;">dumpe2fs</td>
<td style="text-align: left;">Prints the super block and block group descriptor information for an ext2 or ext3 filesystem.</td>
</tr>
<tr>
<td style="text-align: center;">ext</td>
<td style="text-align: center;">debugfs</td>
<td style="text-align: left;">Is an interactive file system debugger. Use it to examine or change the state of an ext2 or ext3file system.</td>
</tr>
<tr>
<td style="text-align: center;">reiserfs</td>
<td style="text-align: center;">reiserfstune</td>
<td style="text-align: left;">show and set parameters</td>
</tr>
<tr>
<td style="text-align: center;">reiserfs</td>
<td style="text-align: center;">debugreiserfs</td>
<td style="text-align: left;">Prints the super block and block group descriptor information for an ext2 or ext3 filesystem.</td>
</tr>
<tr>
<td style="text-align: center;">XFS</td>
<td style="text-align: center;">xfs_info</td>
<td style="text-align: left;">display information</td>
</tr>
<tr>
<td style="text-align: center;">XFS</td>
<td style="text-align: center;">xfs_growfs</td>
<td style="text-align: left;">expand file system</td>
</tr>
<tr>
<td style="text-align: center;">XFS</td>
<td style="text-align: center;">xfs_admin</td>
<td style="text-align: left;">change parameters on XFS file systems</td>
</tr>
<tr>
<td style="text-align: center;">XFS</td>
<td style="text-align: center;">xfs_repair</td>
<td style="text-align: left;">repair the problems</td>
</tr>
<tr>
<td style="text-align: center;">XFS</td>
<td style="text-align: center;">xfs_db</td>
<td style="text-align: left;">checks and debugs the filesystem</td>
</tr>
</tbody>
</table>
                                            <br clear="both" />
                                            <h1>104.3 Control mounting and unmounting of filesystems</h1>
                                            <br clear="both" />
                                            <p><em>weight: 3</em></p>
<p>Candidates should be able to configure the mounting of a filesystem.</p>
<ul>
<li>Manually mount and unmount filesystems.</li>
<li>Configure filesystem mounting on bootup.</li>
<li>Configure user mountable removable filesystems.</li>
<li>Use of labels and UUIDs for identifying and mounting file systems.</li>
<li>
<p>Awareness of systemd mount units.</p>
</li>
<li>
<p>/etc/fstab</p>
</li>
<li>/media/</li>
<li>mount</li>
<li>umount</li>
<li>blkid</li>
<li>lsblk</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/dod65eKzWtw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Mounting and Unmounting</h2>
<p>When we have a formatted partition and need to use it, we have to <code>mount</code> it somewhere in the Linux directory hierarchy. Unlike Windows, the new <em>driver</em> do now show up as separated disks, but like <em>virtual subdirectories</em> somewhere in your <code>/</code> tree. </p>
<p>Say we want to <em>mount</em> the <code>/dev/sda3</code> on <code>/media/mydisk</code>. The directory <code>/media/mydisk</code> should be there and then, we just run:</p>
<div class="highlight"><pre><span></span><code>sudo mount -t ext4 /dev/sda3 /media/mydisk
</code></pre></div>

<p>All files and folders in /dev/sda3 will be accessible from /media/mydisk.</p>
<p>Run <code>mount</code> with no parameter to see all mounted devices. To <strong>un mount</strong>, simply use the <code>umount</code> on the drive or the directory. These two are equivalent:</p>
<div class="highlight"><pre><span></span><code>sudo umount /dev/sda3
sudo umount /media/mydisk
</code></pre></div>

<p>Mounting and umounting can happen on many different storage types, for example on NFS storages, ISO (with <code>-o loop</code>), tmpfs, ...</p>
<blockquote>
<p>swap disks do not need mounting. You should use <code>swapon</code> and <code>swapoff</code> to use them.</p>
</blockquote>
<div class="highlight"><pre><span></span><code>mount -t ext4 /dev/sda1 /media
</code></pre></div>

<p>The <code>-t</code> switch indicates the type of the filesystem .</p>
<div class="highlight"><pre><span></span><code>mount -o remount,ro /dev/sda1
</code></pre></div>

<p>The <code>-o</code> switch passes some options (say <code>ro</code> for readonly)</p>
<p>It's usually used as one-line command:</p>
<div class="highlight"><pre><span></span><code>mount -t ext4 -o remount,ro /dev/sda1 /media 
</code></pre></div>

<blockquote>
<p>The <code>/media</code> and <code>/mnt</code> directories are used to mount filesystems, even though you can use any directory for this purpose.</p>
</blockquote>
<h3>UUID &amp; Labels</h3>
<p>As you already know, there is a problem when working with classical device names like <code>/dev/vdb1</code>: they change! The current <code>/dev/sdb</code> might be seen as <code>/dev/sdd</code> after you remove / reconnect it. To solve this, its better to work with UUIDs (Universal Unique Identifiers). Check them with <code>lsblk</code> ( <code>-O</code> will show all available columns or specify with -o as below) and <code>blkid</code>.</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">lsblk</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="n">UUID</span>
<span class="n">NAME</span><span class="w">   </span><span class="nl">MAJ</span><span class="p">:</span><span class="nf">MIN</span><span class="w"> </span><span class="n">RM</span><span class="w">  </span><span class="k">SIZE</span><span class="w"> </span><span class="n">RO</span><span class="w"> </span><span class="n">TYPE</span><span class="w"> </span><span class="n">MOUNTPOINTS</span><span class="w">                             </span><span class="n">UUID</span>
<span class="n">sr0</span><span class="w">     </span><span class="mi">11</span><span class="err">:</span><span class="mi">0</span><span class="w">    </span><span class="mi">1</span><span class="w">  </span><span class="mf">1.8</span><span class="n">G</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">rom</span><span class="w">  </span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="n">Fedora</span><span class="o">-</span><span class="n">WS</span><span class="o">-</span><span class="n">Live</span><span class="o">-</span><span class="mi">35</span><span class="n">_B</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="mi">2021</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">22</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">47</span><span class="o">-</span><span class="mi">34</span><span class="o">-</span><span class="mi">00</span>
<span class="n">zram0</span><span class="w">  </span><span class="mi">251</span><span class="err">:</span><span class="mi">0</span><span class="w">    </span><span class="mi">0</span><span class="w">  </span><span class="mf">1.9</span><span class="n">G</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="k">disk</span><span class="w"> </span><span class="o">[</span><span class="n">SWAP</span><span class="o">]</span><span class="w">                                  </span>
<span class="n">vda</span><span class="w">    </span><span class="mi">252</span><span class="err">:</span><span class="mi">0</span><span class="w">    </span><span class="mi">0</span><span class="w">   </span><span class="mi">20</span><span class="n">G</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="k">disk</span><span class="w">                                         </span>
<span class="err">├─</span><span class="n">vda1</span><span class="w"> </span><span class="mi">252</span><span class="err">:</span><span class="mi">1</span><span class="w">    </span><span class="mi">0</span><span class="w">  </span><span class="mi">600</span><span class="n">M</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">efi</span><span class="w">                               </span><span class="n">E13A</span><span class="o">-</span><span class="n">EF36</span>
<span class="err">├─</span><span class="n">vda2</span><span class="w"> </span><span class="mi">252</span><span class="err">:</span><span class="mi">2</span><span class="w">    </span><span class="mi">0</span><span class="w">    </span><span class="mi">1</span><span class="n">G</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="w">                                   </span><span class="mi">19</span><span class="n">ed96a1</span><span class="o">-</span><span class="mi">3</span><span class="n">b36</span><span class="o">-</span><span class="mi">4202</span><span class="o">-</span><span class="mi">81</span><span class="n">bb</span><span class="o">-</span><span class="mi">349</span><span class="n">f7adfb8b1</span>
<span class="err">└─</span><span class="n">vda3</span><span class="w"> </span><span class="mi">252</span><span class="err">:</span><span class="mi">3</span><span class="w">    </span><span class="mi">0</span><span class="w"> </span><span class="mf">18.4</span><span class="n">G</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="w">                                   </span><span class="mi">076766</span><span class="n">a5</span><span class="o">-</span><span class="mi">8864</span><span class="o">-</span><span class="mf">4e35</span><span class="o">-</span><span class="n">a632</span><span class="o">-</span><span class="mi">464</span><span class="n">b03396f7a</span>
<span class="w">                                </span><span class="o">/</span><span class="w">                                       </span>
<span class="n">vdb</span><span class="w">    </span><span class="mi">252</span><span class="err">:</span><span class="mi">16</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="mi">2</span><span class="n">G</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="k">disk</span><span class="w">                                         </span>
<span class="err">└─</span><span class="n">vdb1</span><span class="w"> </span><span class="mi">252</span><span class="err">:</span><span class="mi">17</span><span class="w">   </span><span class="mi">0</span><span class="w">    </span><span class="mi">2</span><span class="n">G</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">lkj</span><span class="w">                                </span><span class="mi">4</span><span class="n">c1a51e6</span><span class="o">-</span><span class="mi">47</span><span class="n">bf</span><span class="o">-</span><span class="mi">4</span><span class="n">a34</span><span class="o">-</span><span class="mi">84</span><span class="n">a2</span><span class="o">-</span><span class="mi">87027</span><span class="n">c91e14a</span>

<span class="err">#</span><span class="w"> </span><span class="n">blkid</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">vdb1</span><span class="p">:</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;4c1a51e6-47bf-4a34-84a2-87027c91e14a&quot;</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="o">=</span><span class="ss">&quot;4096&quot;</span><span class="w"> </span><span class="n">TYPE</span><span class="o">=</span><span class="ss">&quot;ext4&quot;</span><span class="w"> </span><span class="n">PARTUUID</span><span class="o">=</span><span class="ss">&quot;5415e516-01&quot;</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">sr0</span><span class="p">:</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="o">=</span><span class="ss">&quot;2048&quot;</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;2021-09-22-21-47-34-00&quot;</span><span class="w"> </span><span class="n">LABEL</span><span class="o">=</span><span class="ss">&quot;Fedora-WS-Live-35_B-1-2&quot;</span><span class="w"> </span><span class="n">TYPE</span><span class="o">=</span><span class="ss">&quot;iso9660&quot;</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">zram0</span><span class="p">:</span><span class="w"> </span><span class="n">LABEL</span><span class="o">=</span><span class="ss">&quot;zram0&quot;</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;e459f522-1675-40d2-b318-51d9bd16d7bb&quot;</span><span class="w"> </span><span class="n">TYPE</span><span class="o">=</span><span class="ss">&quot;swap&quot;</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">vda2</span><span class="p">:</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;19ed96a1-3b36-4202-81bb-349f7adfb8b1&quot;</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="o">=</span><span class="ss">&quot;4096&quot;</span><span class="w"> </span><span class="n">TYPE</span><span class="o">=</span><span class="ss">&quot;ext4&quot;</span><span class="w"> </span><span class="n">PARTUUID</span><span class="o">=</span><span class="ss">&quot;5f4ee154-3ade-4af6-8809-6d90d5827d39&quot;</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">vda3</span><span class="p">:</span><span class="w"> </span><span class="n">LABEL</span><span class="o">=</span><span class="ss">&quot;fedora_localhost-live&quot;</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;076766a5-8864-4e35-a632-464b03396f7a&quot;</span><span class="w"> </span><span class="n">UUID_SUB</span><span class="o">=</span><span class="ss">&quot;a4340a29-6d9b-4c28-a7c8-b4aab5d08893&quot;</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="o">=</span><span class="ss">&quot;4096&quot;</span><span class="w"> </span><span class="n">TYPE</span><span class="o">=</span><span class="ss">&quot;btrfs&quot;</span><span class="w"> </span><span class="n">PARTUUID</span><span class="o">=</span><span class="ss">&quot;a46e64aa-65ef-4a62-9bf8-96fd19aee353&quot;</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">vda1</span><span class="p">:</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;E13A-EF36&quot;</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="o">=</span><span class="ss">&quot;512&quot;</span><span class="w"> </span><span class="n">TYPE</span><span class="o">=</span><span class="ss">&quot;vfat&quot;</span><span class="w"> </span><span class="n">PARTLABEL</span><span class="o">=</span><span class="ss">&quot;EFI System Partition&quot;</span><span class="w"> </span><span class="n">PARTUUID</span><span class="o">=</span><span class="ss">&quot;a7a2b260-0302-45bc-a4db-42bd2e0ee7f2&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="n">blkid</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vdb1</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nl">vdb1</span><span class="p">:</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;4c1a51e6-47bf-4a34-84a2-87027c91e14a&quot;</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="o">=</span><span class="ss">&quot;4096&quot;</span><span class="w"> </span><span class="n">TYPE</span><span class="o">=</span><span class="ss">&quot;ext4&quot;</span><span class="w"> </span><span class="n">PARTUUID</span><span class="o">=</span><span class="ss">&quot;5415e516-01&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="n">mount</span><span class="w"> </span><span class="n">UUID</span><span class="o">=</span><span class="ss">&quot;4c1a51e6-47bf-4a34-84a2-87027c91e14a&quot;</span><span class="w"> </span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">mydisk</span><span class="o">/</span>
</code></pre></div>

<h3>fstab</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lQGvxIkdcSE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>For automatic mounting, Linux uses the <code>/etc/fstab</code> file. Its like a table which shows what file system should be mounted where during the boot. This is my the <code>/etc/fstab</code> of my Fedora:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cat /etc/fstab</span>

<span class="c1">#</span>
<span class="c1"># /etc/fstab</span>
<span class="c1"># Created by anaconda on Wed Oct 20 13:16:38 2021</span>
<span class="c1">#</span>
<span class="c1"># Accessible filesystems, by reference, are maintained under &#39;/dev/disk/&#39;.</span>
<span class="c1"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.</span>
<span class="c1">#</span>
<span class="c1"># After editing this file, run &#39;systemctl daemon-reload&#39; to update systemd</span>
<span class="c1"># units generated from this file.</span>
<span class="c1">#</span>
<span class="n">UUID</span><span class="o">=</span><span class="mi">076766</span><span class="n">a5</span><span class="o">-</span><span class="mi">8864</span><span class="o">-</span><span class="mf">4e35</span><span class="o">-</span><span class="n">a632</span><span class="o">-</span><span class="mi">464</span><span class="n">b03396f7a</span><span class="w"> </span><span class="o">/</span><span class="w">                       </span><span class="n">btrfs</span><span class="w">   </span><span class="n">subvol</span><span class="o">=</span><span class="n">root</span><span class="p">,</span><span class="n">compress</span><span class="o">=</span><span class="n">zstd</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span>
<span class="n">UUID</span><span class="o">=</span><span class="mi">19</span><span class="n">ed96a1</span><span class="o">-</span><span class="mi">3</span><span class="n">b36</span><span class="o">-</span><span class="mi">4202</span><span class="o">-</span><span class="mi">81</span><span class="n">bb</span><span class="o">-</span><span class="mi">349</span><span class="n">f7adfb8b1</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="w">                   </span><span class="n">ext4</span><span class="w">    </span><span class="n">defaults</span><span class="w">        </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span>
<span class="n">UUID</span><span class="o">=</span><span class="n">E13A</span><span class="o">-</span><span class="n">EF36</span><span class="w">          </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">efi</span><span class="w">               </span><span class="n">vfat</span><span class="w">    </span><span class="n">umask</span><span class="o">=</span><span class="mi">0077</span><span class="p">,</span><span class="n">shortname</span><span class="o">=</span><span class="n">winnt</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span>
<span class="n">UUID</span><span class="o">=</span><span class="mi">076766</span><span class="n">a5</span><span class="o">-</span><span class="mi">8864</span><span class="o">-</span><span class="mf">4e35</span><span class="o">-</span><span class="n">a632</span><span class="o">-</span><span class="mi">464</span><span class="n">b03396f7a</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="w">                   </span><span class="n">btrfs</span><span class="w">   </span><span class="n">subvol</span><span class="o">=</span><span class="n">home</span><span class="p">,</span><span class="n">compress</span><span class="o">=</span><span class="n">zstd</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>

<p>These are the columns:</p>
<ul>
<li>file system: Label, UUID, device</li>
<li>mount point: swap or none for swap</li>
<li>type: can be ext4 , xfs ,nfs or other types of filesystem</li>
<li>options:  defaults, rw / ro, noauto, user, exec / noexec, noatime, umask</li>
<li>dump: do dump command backup this? mostly 0</li>
<li>pass: Non-zero values of pass specify the order of checking filesystems at boot time</li>
</ul>
<p><strong>note:</strong></p>
<ul>
<li>User-mounted filesystems default to noexec unless exec is specified after user.</li>
<li>noatime will disable recording of access times. Not using access times may improve performance.</li>
</ul>
<h2>Systemd mount units</h2>
<p>When using systemd, a unit configuration file whose name ends in ".mount" encodes information about a file system mount point controlled and supervised by systemd.</p>
                                            <br clear="both" />
                                            <h1>104.4 Removed</h1>
                                            <br clear="both" />
                                            <div class="alert alert-danger" role="alert">
  This chapter is removed in the latest version (500) of LPIC1 and is kept here as a reference.
</div>

<iframe width="560" height="315" src="https://www.youtube.com/embed/KJPvfqe-Bls" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>104.4 Manage disk quotas</h2>
<p><em>Weight: 1</em></p>
<p>Candidates should be able to manage disk quotas for users.</p>
<h3>Objectives</h3>
<ul>
<li>Set up a disk quota for a filesystem.</li>
<li>Edit, check and generate user quota reports.</li>
<li>quota</li>
<li>edquota</li>
<li>repquota</li>
<li>quotaon</li>
</ul>
<h3>Enabling quotas</h3>
<p>Quotas will let the system admin to control how much a user or a group consumes disk. The version 2 quota discussed in LPIC, needs kernel 2.4 and above. The package is called <code>quota</code>.</p>
<p>The option should be added to required <code>/etc/fstab</code> file. The most famous ones are:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">option</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">usrquota</td>
<td style="text-align: left;">user quotas</td>
</tr>
<tr>
<td style="text-align: left;">uqouta</td>
<td style="text-align: left;">same as usrquota</td>
</tr>
<tr>
<td style="text-align: left;">quota</td>
<td style="text-align: left;">same as usrquota</td>
</tr>
<tr>
<td style="text-align: left;">grpquota</td>
<td style="text-align: left;">group quotas</td>
</tr>
<tr>
<td style="text-align: left;">gquota</td>
<td style="text-align: left;">same as grpquota</td>
</tr>
</tbody>
</table>
<p>So for example is we want to enable quotas on sda2 we have to change the line in /etc/fstab like this:</p>
<div class="highlight"><pre><span></span><code>/dev/sda2  /home  ext4    defaults,usrquota,grpquota          1 2
</code></pre></div>

<p>Next we need to specify the quotas of each user and each group. Two files called <code>aquota.user</code> and <code>aquota.group</code> in the root file system will do this. Now it is enough to run the <code>quotacheck</code> command.</p>
<blockquote>
<p>the <code>quotacheck</code> command will create the aquota.user and aquota.group if they do not exist</p>
</blockquote>
<div class="highlight"><pre><span></span><code># quotacheck -u -a -m -c -v
quotacheck: Your kernel probably supports journaled quota but you are not using it. Consider switching to journaled quota to avoid running quotacheck after an unclean shutdown.
quotacheck: Scanning /dev/sda1 [/boot] done
quotacheck: Old group file name could not been determined. Usage will not be subtracted.
quotacheck: Checked 13 directories and 389 files
# ls /boot/
aquota.user
</code></pre></div>

<p><strong>C</strong>reates quota files for <strong>u</strong>sers on <strong>a</strong>ll file systems and will work on <strong>m</strong>ounted file systems; being <strong>v</strong>erbose.</p>
<p>Then you need to turn the quota checking on:</p>
<div class="highlight"><pre><span></span><code># quotaon -auv ##all in /etc/fstab, for user quotas and be verbose
/dev/sda1 [/boot]: user quotas turned on
</code></pre></div>

<h3>Setting limits</h3>
<p>The main command for <em>editing</em> quota is <em>*edquota</em>. It will check the users quota from all file systems and presents them in a file editor to you.</p>
<div class="highlight"><pre><span></span><code>#edquota -u jadi
Disk quotas for user jadi (uid 1000):
  Filesystem                   blocks       soft       hard     inodes     soft     hard
  /dev/sda1                         0          0          0          0        0        0
</code></pre></div>

<p>As you can see, the system shows the current blocks of 1k data, number of inodes (number of files and directories) and soft and hard limits for each of them. If a user goes over its soft-limits, there will be emails. Hard limits are real limits and user can not go over them. If you need to save soft or hard limits, just change the file and save it.</p>
<blockquote>
<p>You have to run <code>quotacheck</code> to update these data</p>
</blockquote>
<p>For copying one users limits to another user, use the <code>-p</code> switch:</p>
<div class="highlight"><pre><span></span><code># edquota -p jadi newuser neweruser lastuser
</code></pre></div>

<h3>quota reports</h3>
<p>If you need to check the quota of only one user use the <code>quota</code> command.</p>
<div class="highlight"><pre><span></span><code># quota  jadi
Disk quotas for user jadi (uid 1000):
     Filesystem  blocks   quota   limit   grace   files   quota   limit   grace
      /dev/sda1       5    5000       0               2       0       0
</code></pre></div>

<p>This is not easy if you have many users so you can use <code>repquota</code> as follow:</p>
<div class="highlight"><pre><span></span><code># repquota -u -a
*** Report for user quotas on device /dev/sda1
Block grace time: 7days; Inode grace time: 7days
                        Block limits                File limits
User            used    soft    hard  grace    used  soft  hard  grace
----------------------------------------------------------------------
root      --  120288       0       0            401     0     0       
jadi      --       5    5000       0              2     0     0
</code></pre></div>

<h3>Warning users</h3>
<p>There is a command for checking quotas and warning users called <code>warnquota</code>. It will be good to run it time to time using a crontab (will see this crontabs later).</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
                                            <br clear="both" />
                                            <h1>104.5 Manage file permissions and ownership</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to control file access through the proper use of permissions and ownerships.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Manage access permissions on regular and special files as well as directories.</li>
<li>Use access modes such as suid, sgid and the sticky bit to maintain security.</li>
<li>Know how to change the file creation mask.</li>
<li>
<p>Use the group field to grant file access to group members.</p>
</li>
<li>
<p>chmod</p>
</li>
<li>umask</li>
<li>chown</li>
<li>chgrp</li>
</ul>
<h2>Users and Groups</h2>
<p>A linux system can have many users and many groups. You can login with one user and use <code>su</code> command to change to another group. Each user belongs to one primary group and can be a member of other groups too.</p>
<p>To check your user and group use the <code>whoami</code>, <code>groups</code> and <code>id</code> commands.</p>
<div class="highlight"><pre><span></span><code>- $ whoami
jadi
- $ groups
jadi adm cdrom sudo dip plugdev netdev lpadmin sambashare debian-tor
- $ id
uid=1000(jadi) gid=1000(jadi) groups=1000(jadi),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),102(netdev),108(lpadmin),124(sambashare),125(debian-tor)
- $ su root -
Password:
- # id
uid=0(root) gid=0(root) groups=0(root)
- # exit
exit
- $ whoami
jadi
</code></pre></div>

<p>As you can see <code>id</code> shows both user and group information.</p>
<blockquote>
<p>Note the 0 UID and 0 GID belong to the root user and root group.</p>
</blockquote>
<p>These are stored in <code>/etc/passwd</code> and <code>/etc/group</code> files.</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/group | grep adm
adm:x:4:syslog,jadi
lpadmin:x:108:jadi
</code></pre></div>

<h2>File ownership &amp; permissions</h2>
<p>Linux uses three layers of access/permissions for each file or directory: User, Group &amp; Others.</p>
<p>Each file belongs to one user and one group and this user and the members of that group will have specific read/write/execute accesses on it. Have a look:</p>
<div class="highlight"><pre><span></span><code>$ ls -ltrh script.sh
-rwxr-xr-x 1 jadi adm 34 Mar  5  2023 script.sh
</code></pre></div>

<p>In above example, <code>jadi</code> is the owner of the file. The file belongs to the <code>adm</code> group and the owner (<code>jadi</code> here) has  <strong>r</strong>ead, <strong>w</strong>rite (including deletion and edit) &amp; <strong>e</strong>xecute (reading directory content) permissions on the file while the <code>adm</code> group members and <strong>others</strong> only have read &amp; execute access.</p>
<p><img alt="" src="/images/file_permissions.png"></p>
<blockquote>
<p>In many distros, when you create a user, the system creates a group with the same name and assigns that user's files to that group.</p>
</blockquote>
<p>The below table shows some more information regarding the first part of the <code>ls -l</code> command:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Position</th>
<th style="text-align: center;">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">What this entry is. Dash (-) is for ordinary files, 'l' is for links &amp; 'd' is for directory</td>
</tr>
<tr>
<td style="text-align: center;">2,3,4</td>
<td style="text-align: center;">read, write and execute access for the owner</td>
</tr>
<tr>
<td style="text-align: center;">5,6,7</td>
<td style="text-align: center;">read, write and execute access for the group members</td>
</tr>
<tr>
<td style="text-align: center;">8,9,10</td>
<td style="text-align: center;">read, write and execute access for other users</td>
</tr>
<tr>
<td style="text-align: center;">11</td>
<td style="text-align: center;">Indicated if any other access methods (such as SELinux) are applies to this file - not part of the LPIC 101 exam</td>
</tr>
</tbody>
</table>
<p>Lets check another example.</p>
<div class="highlight"><pre><span></span><code>$ ls -l /sbin/fdisk
-rwxr-xr-x 1 root root 267176 Oct 15 18:58 /sbin/fdisk
</code></pre></div>

<p>We can see that the <code>fdisk</code> can be read, be written and be executed by its owner (root). Other users (even if they belong to the group <code>root</code>) can only read and execute it.</p>
<blockquote>
<p>although non-root users can execute the fdisk, this program wont do much if it sees that a non root user is running it.</p>
</blockquote>
<p>Lets look at another example:</p>
<div class="highlight"><pre><span></span><code>$ ls -l /home/
total 12
drwxr-xr-x 160 jadi jadi 12288 Feb  7 11:44 jadi
</code></pre></div>

<p>The first character is a <code>d</code> so this is a directory. The owner (<code>jadi</code>) has read, write and execute access but other members of the <code>jadi</code> <strong>group</strong> and <strong>others</strong> only have read and execute access on this directory.</p>
<p>execute (<code>x</code> character) means that they can see the files inside it, have a look if dir has not <code>x</code>:</p>
<div class="highlight"><pre><span></span><code>(with root user)
$ tree /tmp/FOO
FOO
├── Bar1
└── Bar2

$ ls -ld /tmp/FOO/
drw-r--r--. 2 jadi jadi 80 Mar 23 19:32 FOO/

(With other user)
$ ls -l FOO/
ls: cannot access &#39;FOO/Bar2&#39;: Permission denied
ls: cannot access &#39;FOO/Bar1&#39;: Permission denied
total 0
-????????? ? ? ? ?            ? Bar1
-????????? ? ? ? ?            ? Bar2
</code></pre></div>

<h3>Changing permissions</h3>
<p>It is possible to change the permissions on files &amp; directories using the <code>chmod</code> command. There are two ways to tell this command what you want to do:</p>
<ol>
<li>using octal (base 8) codes</li>
<li>using short codes </li>
</ol>
<p>When using octal codes, you have to to create an octal number to tell chmod what you want to do. In this method, <code>0</code> means no access, <code>1</code> means execute, <code>2</code> means write and <code>4</code> means read. So if you want to give <strong><em>read</em></strong>+<strong><em>execute</em></strong>, you have to give <code>4</code>+<code>1</code> which is <code>5</code>. The below table shows every possible combination:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Symbolic</th>
<th style="text-align: center;">Octal</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">rwx</td>
<td style="text-align: center;">7</td>
</tr>
<tr>
<td style="text-align: center;">rw-</td>
<td style="text-align: center;">6</td>
</tr>
<tr>
<td style="text-align: center;">r-x</td>
<td style="text-align: center;">5</td>
</tr>
<tr>
<td style="text-align: center;">r--</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: center;">-wx</td>
<td style="text-align: center;">3</td>
</tr>
<tr>
<td style="text-align: center;">-w-</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: center;">--x</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">---</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<p>So if you want to give <code>rwx</code> to the owner, <code>rx</code> to the group and only <code>x</code> to others, you have to use <code>751</code>:</p>
<div class="highlight"><pre><span></span><code>$ ls -ltrh myfile
-rw-rw-r-- 1 jadi jadi 0 Feb  8 21:01 myfile
$ chmod 751 myfile
$ ls -ltrh myfile
-rwxr-x--x 1 jadi jadi 0 Feb  8 21:01 myfile
</code></pre></div>

<p>This might look difficult but there are some commonly used combinations like <code>755</code> for general executable files or <code>600</code> for personal files.</p>
<p>There is also an <em>easier</em> method. In this method <code>u</code> means user, <code>g</code> means group and <code>o</code> means others. You can append <code>+x</code> to give execute permission, <code>+r</code> to give read permission and <code>+w</code> to give write permission. For example <code>u+x</code> will grant execute permission to user. If you want to remove a permission, use a <code>-</code> sign. For example <code>g-r</code> to prevent <code>group</code> members from <code>read</code>ing the file.</p>
<div class="highlight"><pre><span></span><code>$ ls -ltrh myfile
-rwxr-x--x 1 jadi jadi 0 Feb  8 21:01 myfile
$ chmod u-x myfile
$ ls -ltrh myfile
-rw-r-x--x 1 jadi jadi 0 Feb  8 21:01 myfile
$ chmod +x myfile
$ chmod uo+xr myfile
$ ls -ltrh myfile
-rwxr-xr-x 1 jadi jadi 0 Feb  8 21:01 myfile
</code></pre></div>

<p>One very common switch on <code>chmod</code> is <code>-R</code> for recursive <code>chmod</code>ing on files. This will give <code>read</code> permission of all files inside /tmp/ to any user:</p>
<div class="highlight"><pre><span></span><code># chmod -R o+r /tmp
</code></pre></div>

<h3>Changing owner and groups</h3>
<p>If you need to change the ownership or group of a file or directory, use the <code>chown</code> command:</p>
<div class="highlight"><pre><span></span><code>$ ls -ltrh newfile
-rw-rw-r-- 1 jadi jadi 0 Feb  8 21:38 newfile
$ chown root:root newfile
chown: changing ownership of ‘newfile’: Operation not permitted
$ sudo chown root:root newfile
[sudo] password for jadi:
$ ls -ltrh newfile
-rw-rw-r-- 1 root root 0 Feb  8 21:38 newfile
</code></pre></div>

<p>A common switch is <code>-R</code> to <code>chown</code> recursively.</p>
<p>If need to only change the group you may use <code>chgrp</code> command:</p>
<div class="highlight"><pre><span></span><code>$ sudo chgrp postgres newfile
$ ls -ltrh newfile
-rw-rw-r-- 1 root postgres 0 Feb  8 21:38 newfile
</code></pre></div>

<p>It is possible to assign more groups to a user via <code>usermod</code> command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>sudo<span class="w"> </span>jadi<span class="w"> </span><span class="c1"># will add jadi to the sudo group</span>
</code></pre></div>

<p>Since users can be a member of many groups, they might need to change their <strong>default group</strong> when creating files. To do so, check the groups with <code>groups</code> command and set the default one with <code>newgrp</code>:</p>
<div class="highlight"><pre><span></span><code>$ touch newfile
$ ls -ltrh newfile
-rw------- 1 jadi jadi 0 Feb  8 21:53 newfile
$ groups
jadi adm cdrom sudo dip plugdev netdev lpadmin sambashare debian-tor
$ newgrp adm
$ touch newerfile
$ ls -ltrh new*
-rw------- 1 jadi jadi 0 Feb  8 21:53 newfile
-rw------- 1 jadi adm  0 Feb  8 21:54 newerfile
</code></pre></div>

<h2>Access modes</h2>
<p>A question for you: If we do not have write access to <code>/etc/passwd</code> or <code>/etc/shadow</code>, how is it possible to change our password then?</p>
<p>Normally when you run a program, it runs with <em>your</em> access level. But what happens if you need to run a program with a higher access level? say to do changes in the password files? For this Linux sets two special bits for each file; <strong>suid</strong> (set user id) and <strong>sgid</strong> (set group id). If these bits are set on a file, that file will be executed with the access of the <strong>owner</strong> (or <strong>group</strong>) of the file and not the user who is running it.</p>
<div class="highlight"><pre><span></span><code>$ ls -ltrh /usr/bin/passwd
-rwsr-xr-x 1 root root 50K Jul 18  2014 /usr/bin/passwd
</code></pre></div>

<p>Kindly note the <code>s</code> in the <em>executable bit</em> for the user permissions and also for the group? That means when any user runs this program, it will be run with the owner of the file access level (which is root) instead of that user's id.</p>
<p>It is possible to set/unset the <code>suid</code> and <code>sgid</code> using <code>chmod</code> and <code>+s</code> or <code>-s</code> instead of <code>x</code>.</p>
<p>While we are on this, let me introduce you to the last special bit. It is called <strong>sticky bit</strong> and if set, makes the file resistant to <strong><em>deletion</em></strong>. If the sticky bit is set, ONLY the owner of the file will be able to delete it, even if others do have write access to it. This is useful for places like /tmp (everybody has write access on /tmp directory but we do not want others to delete our files).</p>
<p>Sticky bit is identified by <code>t</code> and will be shown on the last bit of a <code>ls -l</code>:</p>
<div class="highlight"><pre><span></span><code>$ ls -dl /tmp
drwxrwxrwt 13 root root 77824 Feb  8 21:27 /tmp
</code></pre></div>

<p>As you can see the sticky bit is set and although all users have write access in this directory, they wont be able to delete each others files.</p>
<p>Lets review how you can set these access modes:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">access mode</th>
<th style="text-align: center;">octal</th>
<th style="text-align: center;">symbolic</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">suid</td>
<td style="text-align: center;">4000</td>
<td style="text-align: center;">u+s</td>
</tr>
<tr>
<td style="text-align: center;">sgid</td>
<td style="text-align: center;">2000</td>
<td style="text-align: center;">g+s</td>
</tr>
<tr>
<td style="text-align: center;">sticky</td>
<td style="text-align: center;">1000</td>
<td style="text-align: center;">+t</td>
</tr>
</tbody>
</table>
<blockquote>
<p>guid on a directory will force any new file in that directory to have the guid of the directory itself.</p>
</blockquote>
<h2>umask</h2>
<p>Another tricky question: what is the permissions of a newly created file? What happens if you <code>touch</code> a non-existing file? What will be its permissions? This is set by the <code>umask</code>. This command tells the system what permissions (in addition to execute) <strong>should not be given to</strong> new files. In other words, imagine that all new files will have <code>666</code> octal permission (write + read for user, group &amp; others), so a umask of 0002 (yes! 4 digits) will remove the 2 (write) for others (666-0002=664):</p>
<div class="highlight"><pre><span></span><code>$ umask
0002
</code></pre></div>

<p>If we need to change umask, it can be done with the same command:</p>
<div class="highlight"><pre><span></span><code>$ umask
0002
$ touch newfile
$ ls -ltrh newfile
-rw-rw-r-- 1 jadi jadi 0 Feb  8 21:38 newfile
$ mkdir newdir
$ ls -ltrhd newdir
drwxrwxr-x 2 jadi jadi 4.0K Feb  8 21:38 newdir
$ umask u=rw,g=,o=
$ touch newerfile
$ ls -l newerfile
-rw------- 1 jadi jadi 0 Feb  8 21:41 newerfile
$ umask
0177
</code></pre></div>

<blockquote>
<p>Note how I used <code>u=rw,g=,o=</code> to tell <code>umask</code> or <code>chmod</code> what I exactly wanted from it.</p>
</blockquote>
                                            <br clear="both" />
                                            <h1>104.6 Create and change hard and symbolic links</h1>
                                            <br clear="both" />
                                            <p><em>weight: 2</em></p>
<p>Candidates should be able to create and manage hard and symbolic links to a file.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Create links.</li>
<li>Identify hard and/or softlinks.</li>
<li>Copying versus linking files.</li>
<li>
<p>Use links to support system administration tasks.</p>
</li>
<li>
<p><code>ln</code></p>
</li>
<li><code>unlink</code></li>
</ul>
<h2>links</h2>
<p>On a storage device, a file or directory is saved on some block and a reference to it is saved in the FAT, ext, ... allocation table alongside data about its owner, permissions, when it was last accessed, its size and such. As you already know, we can check this using the <code>ls</code> command.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>-i<span class="w"> </span>script.sh
<span class="m">785379</span><span class="w"> </span>script.sh
$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>script.sh
-rwxr--r-t<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>adm<span class="w"> </span><span class="m">34</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">13</span>:38<span class="w"> </span>script.sh
$<span class="w"> </span>ls<span class="w"> </span>-R
.:
check_tr181_file.php<span class="w">  </span>etc_apparmom.tar<span class="w">  </span>index.html<span class="w">  </span>php_checker<span class="w">  </span>script.sh<span class="w">  </span>test.csv<span class="w">  </span>w

./php_checker:
check_tr181_file.php<span class="w">  </span>index.html<span class="w">  </span>test.csv

./w:
</code></pre></div>

<p>But it is also possible to create links. A link is simply an additional directory entry for a file or directory:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>-l
total<span class="w"> </span><span class="m">4</span>
-rwxr-xr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>adm<span class="w"> </span><span class="m">34</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">13</span>:38<span class="w"> </span>script.sh
$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>script.sh<span class="w"> </span>copy_of_script.sh
$<span class="w"> </span>ls<span class="w"> </span>-ltrh
total<span class="w"> </span><span class="m">4</span>.0K
-rwxr-xr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>adm<span class="w">  </span><span class="m">34</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">13</span>:38<span class="w"> </span>script.sh
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w">  </span><span class="m">9</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">11</span>:31<span class="w"> </span>copy_of_script.sh<span class="w"> </span>-&gt;<span class="w"> </span>script.sh
$<span class="w"> </span>ls<span class="w"> </span>-i
<span class="m">785349</span><span class="w"> </span>copy_of_script.sh<span class="w">  </span><span class="m">785379</span><span class="w"> </span>script.sh
</code></pre></div>

<p>A link is simply an additional directory entry for a file or directory, allowing two or more names for the same file. A <strong>hard link</strong> is a directory entry that points to an inode, while a <strong>soft link or symbolic link</strong> is a directory entry that points to an inode that provides the name of another directory entry. The exact mechanism for storing the second name may depend on both the file system and the length of the name. Symbolic links are also called symlinks.</p>
<p>Soft links, or symlinks, merely point to another file or directory by name rather than by inode. Soft links can cross file system boundaries.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>vi<span class="w"> </span>new_file
$<span class="w"> </span>ls<span class="w"> </span>-ltrh
total<span class="w"> </span><span class="m">4</span>.0K
-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w"> </span><span class="m">9</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">11</span>:37<span class="w"> </span>new_file
$<span class="w"> </span>ln<span class="w"> </span>new_file<span class="w"> </span>hard_link
$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>new_file<span class="w"> </span>soft_link
$<span class="w"> </span>ls<span class="w"> </span>-ltrh
total<span class="w"> </span><span class="m">8</span>.0K
-rw-------<span class="w"> </span><span class="m">2</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w"> </span><span class="m">9</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">11</span>:37<span class="w"> </span>new_file
-rw-------<span class="w"> </span><span class="m">2</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w"> </span><span class="m">9</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">11</span>:37<span class="w"> </span>hard_link
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w"> </span><span class="m">8</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">11</span>:37<span class="w"> </span>soft_link<span class="w"> </span>-&gt;<span class="w"> </span>new_file
$<span class="w"> </span>rm<span class="w"> </span>new_file
$<span class="w"> </span>ls<span class="w"> </span>-ltrh
total<span class="w"> </span><span class="m">4</span>.0K
-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w"> </span><span class="m">9</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">11</span>:37<span class="w"> </span>hard_link
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w"> </span><span class="m">8</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">11</span>:37<span class="w"> </span>soft_link<span class="w"> </span>-&gt;<span class="w"> </span>new_file
$<span class="w"> </span>cat<span class="w"> </span>hard_link
new<span class="w"> </span>file
$<span class="w"> </span>cat<span class="w"> </span>soft_link
cat:<span class="w"> </span>soft_link:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
</code></pre></div>

<blockquote>
<p>Note the <code>l</code> as the first character in <code>ls -l</code>'s permission list when we have a symbolic link.</p>
</blockquote>
<p>You can create hard links only for files, not for directories. The exception is the special directory entries in a directory for the directory itself and for its parent (<code>.</code> and <code>..</code>)</p>
<blockquote>
<p>You will get an error if you attempt to create hard links that cross file systems or that are for directories.</p>
</blockquote>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ln<span class="w"> </span>mydir<span class="w"> </span>link2dir<span class="w"> </span><span class="c1"># ln: mydir: hard link not allowed for director</span>
$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>mydir<span class="w"> </span>link2dir<span class="w"> </span><span class="c1"># works just fine</span>
</code></pre></div>

<p>If you are using relative names, you will usually want the current working directory to be the directory where you are creating the link; otherwise, the link you create will be relative to another point in the file system.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>myfile.txt<span class="w"> </span>mydir/<span class="w"> </span><span class="c1">#broken link</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>mydir<span class="w"> </span>
$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>../myfile.txt<span class="w"> </span>.
</code></pre></div>

<p>It's recommended to use exact path for links.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/tmp/myfile.txt<span class="w"> </span>/tmp/Foo/Bar/myfile.txt
$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>/tmp/Foo/Bar/myfile.txt<span class="w"> </span>
lrwxrwxrwx.<span class="w"> </span><span class="m">1</span><span class="w"> </span>jadi<span class="w"> </span>jadi<span class="w"> </span><span class="m">9</span><span class="w"> </span>Mar<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">12</span>:37<span class="w"> </span>/tmp/Foo/Bar/myfile.txt<span class="w"> </span>-&gt;<span class="w"> </span>/tmp/myfile.txt
</code></pre></div>

<p>we can find symbolic links using the <code>find</code> command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>find<span class="w"> </span>.<span class="w"> </span>-type<span class="w"> </span>l
</code></pre></div>

<p>They are highly used to keep one specific name pointing to a changing binary name. For example we always need to be able to run <code>python3</code> so we point it to the latest installed python on the system:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>which<span class="w"> </span>python3
/usr/bin/python3
$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>/usr/bin/python3
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">10</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">25</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/usr/bin/python3<span class="w"> </span>-&gt;<span class="w"> </span>python3.10
</code></pre></div>

<p>To remove links, you can use the <code>rm</code> or <code>unlink</code> command.</p>
                                            <br clear="both" />
                                            <h1>104.7 Find system files and place files in the correct location</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Candidates should be thoroughly familiar with the <strong>Filesystem Hierarchy Standard (FHS)</strong>, including typical file locations and directory classifications.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Understand the correct locations of files under the FHS.</li>
<li>Find files and commands on a Linux system.</li>
<li>
<p>Know the location and purpose of important file and directories as defined in the FHS.</p>
</li>
<li>
<p><code>find</code></p>
</li>
<li><code>locate</code></li>
<li><code>updatedb</code></li>
<li><code>whereis</code></li>
<li><code>which</code></li>
<li><code>type</code></li>
<li><code>/etc/updatedb.conf</code></li>
</ul>
<h2>FHS</h2>
<p>Filesystem Hierarchy Standard (FHS) is a document describing the Linux/Unix file hierarchy. It is very useful to know these because it lets you easily find what you are looking for as a system admin.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">directory</th>
<th style="text-align: left;">usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">/</td>
<td style="text-align: left;">Primary hierarchy root and root directory of the entire file system hierarchy</td>
</tr>
<tr>
<td style="text-align: center;">/bin</td>
<td style="text-align: left;">Essential command binaries</td>
</tr>
<tr>
<td style="text-align: center;">/boot</td>
<td style="text-align: left;">Static files of the boot loader</td>
</tr>
<tr>
<td style="text-align: center;">/dev</td>
<td style="text-align: left;">Device files</td>
</tr>
<tr>
<td style="text-align: center;">/etc</td>
<td style="text-align: left;">Host-specific system configuration</td>
</tr>
<tr>
<td style="text-align: center;">/lib</td>
<td style="text-align: left;">Essential shared libraries and kernel modules</td>
</tr>
<tr>
<td style="text-align: center;">/media</td>
<td style="text-align: left;">Mount point for removable media</td>
</tr>
<tr>
<td style="text-align: center;">/mnt</td>
<td style="text-align: left;">Mount point for mounting a filesystem temporarily</td>
</tr>
<tr>
<td style="text-align: center;">/opt</td>
<td style="text-align: left;">Add-on application software packages</td>
</tr>
<tr>
<td style="text-align: center;">/sbin</td>
<td style="text-align: left;">Essential system binaries</td>
</tr>
<tr>
<td style="text-align: center;">/srv</td>
<td style="text-align: left;">Data for services provided by this system</td>
</tr>
<tr>
<td style="text-align: center;">/tmp</td>
<td style="text-align: left;">Temporary files</td>
</tr>
<tr>
<td style="text-align: center;">/usr</td>
<td style="text-align: left;">Secondary hierarchy</td>
</tr>
<tr>
<td style="text-align: center;">/var</td>
<td style="text-align: left;">Variable data</td>
</tr>
<tr>
<td style="text-align: center;">/home</td>
<td style="text-align: left;">User home directories (optional)</td>
</tr>
<tr>
<td style="text-align: center;">/lib</td>
<td style="text-align: left;">Alternate format essential shared libraries (optional)</td>
</tr>
<tr>
<td style="text-align: center;">/root</td>
<td style="text-align: left;">Home directory for the root user (optional)</td>
</tr>
</tbody>
</table>
<p></br></p>
<p>The <code>/usr</code> is the second level of the hierarchy. It containins shareable, read-only data. It can be shared between systems, although present practice does not often do this.</p>
<p>The <code>/var</code> filesystem contains variable data files, including spool directories and files, administrative and logging data, and transient and temporary files. Some portions of /var are not shareable between different systems, but others, such as /var/mail, /var/cache/man, /var/cache/fonts, and /var/spool/news, may be shared.</p>
<h2>Path</h2>
<p>A general linux install has a lot of files; 741341 files in my case. So how the shell finds and runs a command? This is done by a variable called PATH:</p>
<div class="highlight"><pre><span></span><code>$ echo $PATH
/home/jadi/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games;/home/jadi/bin/
</code></pre></div>

<p>And for the root user:</p>
<div class="highlight"><pre><span></span><code># echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</code></pre></div>

<p>As you can see, this is the list of directories separated with colon. Obviously you can change your path with <code>export PATH=$PATH:/usr/new/dir</code> or put this in <code>.bashrc</code> to make it permanent.</p>
<h2>Locating files</h2>
<h3><code>which</code>, <code>type</code> and <code>whereis</code></h3>
<p>The <code>which</code> command shows the first appearance of the command given in the path. In other words the  <code>which mkfs</code> will tell you what will be run if you issue this <code>mkfs</code> command.</p>
<div class="highlight"><pre><span></span><code>$ which mkfs
/usr/bin/mkfs
jadi@ubuntuserver:~$ which ping
/usr/bin/ping
jadi@ubuntuserver:~$ which -a ping
/usr/bin/ping
/bin/ping
</code></pre></div>

<blockquote>
<p>use the <code>-a</code> switch to show all appearance in the path and not only the first one.</p>
</blockquote>
<p>But where is the <code>cd</code> command?</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@ubuntuserver</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">cd</span>
<span class="n">jadi</span><span class="nv">@ubuntuserver</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">cd</span>
<span class="n">cd</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">builtin</span>
</code></pre></div>

<p>As you can see, <code>which</code> did not find anything for <code>cd</code>, so we tried it with <code>type</code> to see what the h**l it is.</p>
<div class="highlight"><pre><span></span><code>$ type type
type is a shell builtin
$ type for
for is a shell keyword
$ type mkfs
mkfs is /sbin/mkfs
$ type chert
bash: type: chert: not found
</code></pre></div>

<p>The <code>type</code> command is more general than <code>which</code> and also understand and shows the <em>bash keywords</em>.</p>
<p>Another useful command in this category is <code>whereis</code>. Unlike <code>which</code>, <code>whereis</code> shows man pages and source codes of programs alongside their binary location.</p>
<div class="highlight"><pre><span></span><code>$ whereis mkfs
mkfs: /usr/sbin/mkfs /usr/share/man/man8/mkfs.8.gz
</code></pre></div>

<blockquote>
<p>tip: there is also a <code>whatis</code> command, try it.</p>
</blockquote>
<h3>find</h3>
<p>We have already seen this command in <a href="/1037-search-text-files-using-regular-expressions.html">chapter 103.7</a> but let's see a couple of new switches.</p>
<ul>
<li>The <code>-user</code> and <code>-group</code> specifies a specific user &amp; group</li>
<li>The <code>-maxdepth</code> tells the find how deep it should go into the directories.</li>
</ul>
<div class="highlight"><pre><span></span><code>$ find /tmp/ -maxdepth 1 -user jadi | head
/tmp/1
/tmp/2
</code></pre></div>

<p>Or even find the files not belonging to any user/group with <code>-nouser</code> and <code>-nogroup</code>.</p>
<blockquote>
<p>Like other <em>tests</em>, you can add a <code>!</code> just before any phrase to negate it. So this will find files <strong>not belonging</strong> to jadi: <code>find . ! -user jadi</code></p>
</blockquote>
<p>It is also very common to use for files with specific strings in their names:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>find<span class="w"> </span>/etc<span class="w"> </span>-iname<span class="w"> </span><span class="s2">&quot;*vmware*&quot;</span>
/etc/vmware-tools
/etc/vmware-tools/scripts/vmware
</code></pre></div>

<h3>locate &amp; updatedb</h3>
<p>You tries <code>find</code> and loved it but there is an issue with it: it does a live active search! This can slow down your system or push too much pressure on your hard or on larger file systems take too long. To solve this, there is a faster command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>locate<span class="w"> </span>networking
/etc/cloud/cloud.cfg.d/subiquity-disable-cloudinit-networking.cfg
/snap/core20/1408/usr/lib/python3/dist-packages/cloudinit/distros/networking.py
/snap/core20/1408/usr/lib/python3/dist-packages/cloudinit/distros/__pycache__/networking.cpython-38.pyc
/snap/core20/1826/usr/lib/python3/dist-packages/cloudinit/distros/networking.py
/snap/core20/1826/usr/lib/python3/dist-packages/cloudinit/distros/__pycache__/networking.cpython-38.pyc
/usr/lib/python3/dist-packages/cloudinit/distros/networking.py
/usr/lib/python3/dist-packages/cloudinit/distros/__pycache__/networking.cpython-310.pyc
/usr/lib/python3/dist-packages/sos/report/plugins/networking.py
/usr/lib/python3/dist-packages/sos/report/plugins/__pycache__/networking.cpython-310.pyc
</code></pre></div>

<p>And it is fast:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">time</span><span class="w"> </span>locate<span class="w"> </span>kernel<span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
<span class="m">16989</span>

real<span class="w">    </span>0m0.091s
user<span class="w">    </span>0m0.094s
sys<span class="w"> </span>0m0.034s
</code></pre></div>

<p>This is fast because its data comes from a database created with <code>updatedb</code> (its package is called <code>plocate</code> on debian). Usually this command runs automatically (with a cronjob) on a daily basis. Its configuration file is <code>/etc/updatedb.conf</code> or <code>/etc/sysconfig/locate</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/etc/updatedb.conf
<span class="nv">PRUNE_BIND_MOUNTS</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span>
<span class="c1"># PRUNENAMES=&quot;.git .bzr .hg .svn&quot;</span>
<span class="nv">PRUNEPATHS</span><span class="o">=</span><span class="s2">&quot;/tmp /var/spool /media /home/.ecryptfs&quot;</span>
<span class="nv">PRUNEFS</span><span class="o">=</span><span class="s2">&quot;NFS nfs nfs4 rpc_pipefs afs binfmt_misc proc smbfs autofs iso9660 ncpfs coda devpts ftpfs devfs mfs shfs sysfs cifs lustre tmpfs usbfs udf fuse.glusterfs fuse.sshfs curlftpfs ecryptfs fusesmb devtmpfs&quot;</span>
</code></pre></div>

<p>You can update the  db by running <code>updatedb</code> as root. </p>
                                            <br clear="both" />
                                            <h1>105.1 Customize and use the shell environment</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to customize shell environments to meet users’ needs. Candidates should be able to modify global and user profiles.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Set environment variables (e.g. PATH) at login or when spawning a new shell</li>
<li>Write Bash functions for frequently used sequences of commands</li>
<li>Maintain skeleton directories for new user accounts</li>
<li>Set command search path with the proper directory</li>
</ul>
<h3>Terms</h3>
<ul>
<li>.</li>
<li><code>source</code></li>
<li><code>/etc/bash.bashrc</code></li>
<li><code>/etc/profile</code></li>
<li><code>env</code></li>
<li><code>export</code></li>
<li><code>set</code></li>
<li><code>unset</code></li>
<li><code>~/.bash\_profile</code></li>
<li><code>~/.bash\_login</code></li>
<li><code>~/.profile</code></li>
<li><code>~/.bashrc</code></li>
<li><code>~/.bash\_logout</code></li>
<li><code>function</code></li>
<li><code>alias</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/dXnsNXV2Y60" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Environment variables</h2>
<p>Shell Environment Variables are special variables that contain information and configuration about the shell. System shell uses them when it needs to show you a prompt, run a command, or search what to run. Different operating system distributions have different environment variables and you can add yours if you need so; or want so!</p>
<h3>env</h3>
<p>can set, remove or display variables or even run a command in a modified environment.</p>
<div class="highlight"><pre><span></span><code>Syntax
     env [OPTION]... [NAME=VALUE]... [COMMAND [ARGS]...]

Options

  -u NAME
  --unset=NAME
       Remove variable NAME from the environment, if it was in the
       environment.

  -
  -i
  --ignore-environment
       Start with an empty environment, ignoring the inherited
       environment.
</code></pre></div>

<p>You can also use the more general <code>printenv</code> command.</p>
<h2>set</h2>
<p><code>set</code> allows you to change the values of shell options (variables) or to display the names and values of shell variables.</p>
<p>Using <code>set</code> we can configure how bash works. These are some samples:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">switch</th>
<th style="text-align: left;">result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">-b</td>
<td style="text-align: left;">Cause the status of terminated background jobs to be reported immediately, rather than before printing the next primary prompt.</td>
</tr>
<tr>
<td style="text-align: center;">-e</td>
<td style="text-align: left;">return in case a pipline, command, ... return non-zero</td>
</tr>
<tr>
<td style="text-align: center;">-n</td>
<td style="text-align: left;">Read commands but do not execute them; this may be used to check a script for syntax errors. This option is ignored by interactive shells.</td>
</tr>
<tr>
<td style="text-align: center;">-t</td>
<td style="text-align: left;">Exit after reading and executing one command.</td>
</tr>
<tr>
<td style="text-align: center;">-C</td>
<td style="text-align: left;">Prevent output redirection using ‘&gt;’, ‘&gt;&amp;’, and ‘&lt;&gt;’ from overwriting existing files.</td>
</tr>
</tbody>
</table>
<h2>setting environment variables</h2>
<p>Bash environment variables can contain only letters (a to z or A to Z), numbers ( 0 to 9) or the underscore character <code>_</code> and cannot start with numbers. Traditionally we use UPPERCASE letters in our variable names.</p>
<p>To set a new environment variable do as follow:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nv">name</span><span class="o">=</span>jadi
$<span class="w"> </span><span class="nv">desc</span><span class="o">=</span><span class="s1">&#39;A programmer who enjoys cycling and promotes freedom&#39;</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$name</span>
jadi
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$desc</span>
A<span class="w"> </span>programmer<span class="w"> </span>who<span class="w"> </span>enjoys<span class="w"> </span>cycling<span class="w"> </span>and<span class="w"> </span>promotes<span class="w"> </span>freedom
</code></pre></div>

<p><strong>Notes</strong>:</p>
<ol>
<li>There should be no spaces around <code>=</code>.</li>
<li>Use the quotes or double-quotes when your value do have spaces (or other special characters) in it.</li>
<li>Use a dollar sign only when referring to a variable, and not when defining it.</li>
</ol>
<h2>unset</h2>
<p>This command unsets a variable or a function.</p>
<div class="highlight"><pre><span></span><code>$ name=jadi
$ echo $name
jadi
$ unset name
$ echo $name
</code></pre></div>

<h2>export</h2>
<p>When setting environment variables with a simple <code>=</code>, the variable is only available in the current shell. So even if you run a new command from the current shell the variable wont be valid there (because technically the new command will be run in a sub-shell). If you want your variable to be valid in the current shell and all its sub-shells, you have to <code>export</code> it.</p>
<div class="highlight"><pre><span></span><code>$ export name=jadi
$ echo $name
jadi
$ bash
$ echo $name
jadi
</code></pre></div>

<h2><code>.</code> (and source)</h2>
<p>Yes only a dot! This is a shortcut for the bash source command. You can find it in files like <code>/etc/profile</code>. It runs the executable in front of it as part of the current environment (and not in a sub-process).</p>
<blockquote>
<p>Note: If you just execute a file (without source or dot) bash creates a child, runs the executable there and then closes it.</p>
</blockquote>
<p>The <code>source</code> command is commonly used when you want to load new/updated environment variables or functions from a script. </p>
<h2>Aliases</h2>
<p>This is a way to define... um.. and <code>alias</code>. You can find them in your <code>~/.bashrc</code>:</p>
<div class="highlight"><pre><span></span><code>alias ll=&#39;ls -alF&#39;
alias la=&#39;ls -A&#39;
alias l=&#39;ls -CF&#39;
</code></pre></div>

<p>It is a way to define a shortcut and you can add yours:</p>
<div class="highlight"><pre><span></span><code>alias testnet=&#39;ping 4.2.2.4&#39;
</code></pre></div>

<h2>functions</h2>
<p>Like larger programming languages, Bash has functions, though in a somewhat limited implementation. A function is a subroutine, a code block that implements a set of operations, a "black box" that performs a specified task. Wherever there is repetitive code, when a task repeats with only slight variations in procedure, then consider using a function.</p>
<div class="highlight"><pre><span></span><code>funnyls () {
    ls -ltrh
    echo &quot;This is a funny ls&quot;
}
</code></pre></div>

<h2>Different shell envs</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/omEV_n4U0uM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>The shell (here bash) can be started in 3 different ways:</p>
<ol>
<li>When you <em>login</em> into the shell, say after a ssh or when you site behind a terminal and login into a Linux machine. This is an interactive login session</li>
<li>When you open a new terminal (say from a GUI env). This is also interactive but not a <em>login</em> shell.</li>
<li>When a shell <em>spawns</em> when you run a command. Yes.. technically when you run a new command from a shell, a sup-shell starts, runs the commands and then returns back to your shell. This is called "non interactive" shell.</li>
</ol>
<p>We will see how different default environment variables can be set in each of these modes.</p>
<h3>login shell</h3>
<p>This is when you give your user and pass to enter a shell. In this case, these steps will define your shell environment:</p>
<p>1- <code>/etc/profile</code> is run</p>
<p>2- A line in <code>/etc/profile</code> runs whatever is in <code>/etc/profile.d/</code></p>
<p>Now the global profile is loaded and system will go for user specific profiles:</p>
<p>3.1- <code>/home/USERNAME/.bash_profile</code></p>
<p>3.2- <code>/home/USERNAME/.bash_login</code></p>
<p>3.3- <code>/home/USERNAME/.profile</code></p>
<blockquote>
<p>Note that only one of the 3, 4 &amp; 5 will run. The system will go for <code>.bash_profile</code> and IF IT IS NOT THERE will try <code>.bash_login</code> and IF IT IS NOT THERE will try to run <code>.profile</code>. If any of these exists, the system wont look any further. So if you have only 4 &amp; 5, only the 4 will be run.</p>
</blockquote>
<p>At the end, the system loads:</p>
<p>4- <code>/home/USERNAME/.bashrc</code></p>
<p>Commonly you will add whatever personal config you want into the <code>~/.bashrc</code>.</p>
<h3>Interactive (non-login) shell</h3>
<p>if you run a shell in an interactive mode (non-login) shell from a GUI or within another temrinal, only two file will handle the environment:</p>
<ol>
<li><code>/etc/bash.bashrc</code> (or <code>/etc/bashrc</code> in some systems)</li>
<li><code>/home/USERNAME/.bashrc</code></li>
</ol>
<h3>Non Interactive Shell</h3>
<p>There is no specific file to be used in this case. Instead we have the <code>BASH_ENV</code>. When a new non-interactive shell starts, it looks into this variable and if it points to a file, runs it. </p>
<blockquote>
<p>On most Linux distributions, this environment value is not set by default.</p>
</blockquote>
<h2>A few more files</h2>
<h3>/etc/skel</h3>
<p>This directory contains files which will be used as a starting template for each new user.</p>
<h3>.bash_logout</h3>
<p>This runs when you logout from a login shell. In many distros it only clears the screen so the next person will not be able to watch what you were doing before you logout.</p>
                                            <br clear="both" />
                                            <h1>105.2 Customize or write simple scripts</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<h4>Description</h4>
<p>Candidates should be able to customize existing scripts, or write simple new Bash scripts.</p>
<h4>Key Knowledge Areas:</h4>
<ul>
<li>Use standard sh syntax (loops, tests).</li>
<li>Use command substitution.</li>
<li>Test return values for success or failure or other information provided by a command.</li>
<li>Execute chained commands.</li>
<li>Perform conditional mailing to the superuser.</li>
<li>Correctly select the script interpreter through the shebang (<code>#!</code>) line.</li>
<li>Manage the location, ownership, execution and suid-rights of scripts.</li>
</ul>
<h4>Terms and Utilities</h4>
<ul>
<li><code>for</code></li>
<li><code>while</code></li>
<li><code>test</code></li>
<li><code>if</code></li>
<li><code>read</code></li>
<li><code>seq</code></li>
<li><code>exec</code></li>
<li><code>||</code></li>
<li><code>&amp;&amp;</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/0BYkWRf4Yvk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>combining commands</h2>
<p>If you want to run more than one command in oneline, separate them by a <code>;</code>. So the <code>cd /tmp; ls</code> will run the <code>cd /tmp</code> and then <code>ls</code>. But there are more advanced usages too.</p>
<p>You can use <code>&amp;&amp;</code> (as logical And) and <code>||</code> (as logical OR) chaining. In case of And, the execution will stop as soon as the first one fails to execute. In case of Or, the next command will only run if the first one fails. Just like in logic gates.</p>
<p>Confusing? Let me explain again. The system will always try to <em>evaluate</em> the outcome of your chain. So if you have <code>A &amp;&amp; B</code> then A fails, the system does not need to test B (because the overall result will be False anyway). Same logic works for <code>A || B || C</code>. If A works fine, the overall evaluation will be True so no need for testing B or C. But if A fails, system will try B and if B fails, we have to try C. </p>
<p>We use chaining to create logical flows. For example:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cp<span class="w"> </span>backup.gzip<span class="w"> </span>/backups/<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>backup.gzip
</code></pre></div>

<p>works like this: copy the backup to this location and delete the file ONLY IF the previous copy was successful. </p>
<h3>Shell Scripts</h3>
<p>We can combine shell commands or programs and or some logic or loops to write large or small scripts. Shell scripts are useful when you want to <em>automate</em> some tasks in one larger command. Say a shell script called "do_backup.sh" may compress some files into a file, rename this file based on the current date and time and then save it on a remote site and at last delete the ones older than 1 month. </p>
<h3>Shebang</h3>
<p>There is a line at the beginning of scripts which starts with <code>#!</code> and continues with an executable who needs to run this script. It is called shebang and as mentioned, tells the shell which <em>interpreter</em> must be used to run this script.</p>
<blockquote>
<p>Note: In many programming languages (including Bash &amp; Python), a <code>#</code> at the beginning of a line in script indicates <em>comments</em>. Do not confuse it with the <em>Shebang</em> (<code>#!</code>)</p>
</blockquote>
<p>Commonly we run shell scripts using <code>#!/bin/bash</code> or <code>#!/bin/sh</code></p>
<p>The rest of a shell script can use most of the commands you already know in addition with some more "programming" specific commands like loops, tests and such. Here is a primitive sample:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nb">echo</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;We are learning! Wowww...&quot;</span>
<span class="nb">echo</span>
</code></pre></div>

<blockquote>
<p>The <code>sh</code> is a more basic shell but it is compatible with most of the things we talk about. There are also other options like <code>zsh</code> and <code>csh</code> but the LPIC is based on <code>bash</code>.</p>
</blockquote>
<h3>Variables</h3>
<p>Already seen in the previous section. You can define variables like this <code>VARNAME=VALUE</code>. Here is a sample:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nv">NAME</span><span class="o">=</span>Jadi

<span class="nb">echo</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$NAME</span><span class="s2"> is learning! Wowww...&quot;</span>
<span class="nb">echo</span>
</code></pre></div>

<blockquote>
<p>Note: you can also do NAME="Jadi the geeking guy" if you need to have spaces in your values</p>
</blockquote>
<p>If you want to access the command line arguments in your shell script, use <code>$1</code>, <code>$2</code>, .... You can find the number of command line arguments via <code>$#</code> variable.</p>
<h3>Command substitution</h3>
<p>Sometimes you need to save the output of a command in a variable or use it in some way. To do so you can use <code>$(command)</code> or simply `command` (Backtick). Look at these two samples:</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="nv">FILES</span><span class="o">=</span><span class="k">$(</span>ls<span class="w"> </span>-1<span class="k">)</span><span class="w"> </span><span class="c1"># the $FILES variable contains the list of all files</span>

➜<span class="w">  </span>~<span class="w"> </span>date<span class="w"> </span>+<span class="s1">&#39;%Y%m%d-%H%m&#39;</span>
<span class="m">20230408</span>-1604
➜<span class="w">  </span>~<span class="w"> </span>touch<span class="w"> </span>backup_<span class="sb">`</span>date<span class="w"> </span>+<span class="s1">&#39;%Y%m%d-%H%m&#39;</span><span class="sb">`</span>.tar
➜<span class="w">  </span>~<span class="w"> </span>ls
backup_20230408-1604.tar
</code></pre></div>

<h3>executing scripts</h3>
<p>In the Unix/Linux world, file should be executable to be executable! :D To do so use the <code>chmod</code> command with <code>+x</code>. After this step you can run your script by giving its path to shell. Please note that Linux by default does not looks into the current directory so if you are going to run a script at the current directory, you have to run <code>./script_name.sh</code>.</p>
<p>Another way to run a script is running <code>sh</code> or <code>bash</code> with the shell scripts name as its argument. That is <code>sh my_script.sh</code>.</p>
<p>In both above methods, the scripts runs inside a child bash process and <em>returns</em> back afterwards to the same shell. If you want to override this and <em>replace</em> your current shell with the program you are going to run, use the <code>exec</code> build-in command. The <code>-c</code> switch will run the command in a clean environment.</p>
<h3>Conditions</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_4ISOx9Kxpk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>Up to now, we were just running commands one by one. That is not very <em>programmatic</em>. If we are going to have some <em>logic</em> in our programs, we need <em>conditions</em> and <em>loops</em>. First we will cover conditions, using the <code>if</code> command. Its usage is like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="o">[</span>condition<span class="o">]</span>
<span class="k">then</span>
<span class="w">   </span><span class="k">do</span><span class="w"> </span>something
<span class="w">   </span><span class="k">do</span><span class="w"> </span>another<span class="w"> </span>thing
<span class="k">else</span>
<span class="w">   </span><span class="k">do</span><span class="w"> </span>new<span class="w"> </span>things
<span class="w">   </span>even<span class="w"> </span>funnier<span class="w"> </span>things
<span class="k">fi</span>
</code></pre></div>

<blockquote>
<p>Note: else part is optional, <code>if</code>, <code>then</code>, <code>fi</code> is enough.</p>
</blockquote>
<p>Conditions can be TRUE or FALSE. A very simple conditions is <code>if [ "Linux" = "Linux" ]</code>. Silly? I know but wait; we are learning the syntax only. Please give special attention to the <em>spaces</em> and <em><code>=</code></em> for checking if two strings are equal.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nv">kernel</span><span class="o">=</span><span class="k">$(</span>uname<span class="w"> </span>-s<span class="k">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$kernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Linux&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>YES.<span class="w"> </span>You<span class="w"> </span>are<span class="w"> </span>using<span class="w"> </span>a<span class="w"> </span>Linux
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Not a linux :(&quot;</span>
<span class="k">fi</span>
</code></pre></div>

<p>The command to check conditions is the <code>test</code> command but since it is used a lot, we have a shortcut for it. Instead of <code>test condition</code> you can write <code>[ condition ]</code>. </p>
<table>
<thead>
<tr>
<th style="text-align: center;">conditions</th>
<th style="text-align: left;">what is means</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"a" = "b"</td>
<td style="text-align: left;">if two strings are equal (here it will return False)</td>
</tr>
<tr>
<td style="text-align: center;">"a" != "b"</td>
<td style="text-align: left;">string a <em>is not equal</em> to string b</td>
</tr>
<tr>
<td style="text-align: center;">4 -lt 40</td>
<td style="text-align: left;">if 4 is <em>lower   than</em> 40 (True)</td>
</tr>
<tr>
<td style="text-align: center;">5 -gt 15</td>
<td style="text-align: left;">if 5 is <em>greater than</em> 15 (False)</td>
</tr>
<tr>
<td style="text-align: center;">5 -ge 5</td>
<td style="text-align: left;">if 5 is <em>greater or equal</em> 5</td>
</tr>
<tr>
<td style="text-align: center;">5 -le 3</td>
<td style="text-align: left;">if 5 is <em>lower or equal</em> to 3</td>
</tr>
<tr>
<td style="text-align: center;">9 -ne 2</td>
<td style="text-align: left;">9 is <em>not equal</em> with 2 (True)</td>
</tr>
<tr>
<td style="text-align: center;">-f FILENAME</td>
<td style="text-align: left;">if file FILENAME exists</td>
</tr>
<tr>
<td style="text-align: center;">-s FILENAME</td>
<td style="text-align: left;">if file exists and its size is more than 0 (Zero)</td>
</tr>
<tr>
<td style="text-align: center;">-x FILENAME</td>
<td style="text-align: left;">if file exists and is executable</td>
</tr>
</tbody>
</table>
<h3>read</h3>
<p>Using <code>read</code> we can read the user input. Look at this:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;what is your name?&quot;</span>
<span class="nb">read</span><span class="w"> </span>NAME

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello </span><span class="nv">$NAME</span><span class="s2">&quot;</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Jadi&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Oh I know you!&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;I wish I knew you&quot;</span>
<span class="k">fi</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Bye&quot;</span>
</code></pre></div>

<p>You can timeout the waiting using the <code>-t</code> and show a prompt using <code>-p</code>. </p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-t<span class="w"> </span><span class="m">10</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;Server address?&quot;</span><span class="w"> </span>SERVER
<span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Connecting to the </span><span class="nv">$SERVER</span><span class="s2"> ...&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Too late!&quot;</span>
<span class="k">fi</span>
</code></pre></div>

<h3>loops</h3>
<p>In programming loops are used to repeat part of the programs. We have 2 different loops in Bash; <code>for</code> and <code>while</code>. The for loops lets us run part of a program for a specific number of iterations. The <code>while</code> loop is used when we want to repeat part of a program <em>while</em> a specific condition became true. </p>
<h4>for</h4>
<p>The syntax is like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span>VAR<span class="w"> </span><span class="k">in</span><span class="w"> </span>SOME_LIST<span class="p">;</span>
<span class="k">do</span>
<span class="w">  </span>some<span class="w"> </span>stuff<span class="w"> </span>with<span class="w"> </span><span class="nv">$VAR</span>
<span class="w">  </span>some<span class="w"> </span>other<span class="w"> </span>stuff
<span class="k">done</span>
</code></pre></div>

<blockquote>
<p>Note:  the <code>in</code>, <code>;</code>, <code>do</code> and <code>done</code>.</p>
</blockquote>
<p>On each iteration, the VAR will be equal to one of the SOME_LIST elements. SOME_LIST can be numbers, name of files, words, ...</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span>NUM<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="p">;</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$NUM</span>
<span class="k">done</span>
</code></pre></div>

<p>But what if you needed to run from 1 to 42? We have the <code>seq</code> command for that. The <code>seq 1 42</code> or its shorthand <code>{1..42}</code> will let us run a loop 42 times.</p>
<p>We can also use non-numeric variables here. This is a common use case:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span>FILE<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>ls<span class="k">)</span><span class="p">;</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$FILE</span>
<span class="w">    </span>wc<span class="w"> </span>-l<span class="w"> </span><span class="nv">$FILE</span>
<span class="k">done</span>
</code></pre></div>

<h4>while</h4>
<p>This is the syntax:</p>
<div class="highlight"><pre><span></span><code><span class="k">while</span><span class="w"> </span><span class="o">[</span>condition<span class="o">]</span>
<span class="k">do</span>
<span class="w">    </span><span class="k">do</span><span class="w"> </span>something
<span class="w">    </span><span class="k">do</span><span class="w"> </span>anohter<span class="w"> </span>thing
<span class="k">done</span>
</code></pre></div>

<blockquote>
<p>If your condition stays true all the time, the <code>while</code> loop will run <em>forever</em>. This is called an <em>infinite loop</em> and should be stopped by a <code>Ctrl+C</code>.</p>
</blockquote>
<p>This is sample:</p>
<div class="highlight"><pre><span></span><code><span class="nv">VAR</span><span class="o">=</span><span class="m">52</span>

<span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$VAR</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">42</span><span class="w"> </span><span class="o">]</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>VAR<span class="w"> </span>is<span class="w"> </span><span class="nv">$VAR</span><span class="w"> </span>and<span class="w"> </span>it<span class="w"> </span>is<span class="w"> </span>still<span class="w"> </span>greater<span class="w"> </span>than<span class="w"> </span><span class="m">42</span>
<span class="w">    </span><span class="nb">let</span><span class="w"> </span><span class="nv">VAR</span><span class="o">=</span>VAR-1
<span class="k">done</span>
</code></pre></div>

<blockquote>
<p>Note the <code>let</code> usage! If you just say <code>VAR=1</code> and then <code>VAR=$VAR+1</code>, then VAR will be equal to <code>1+1</code> as an string!.</p>
</blockquote>
<h3>mailing the root user</h3>
<p>For sending mail, you need to install <code>mailutils</code>. Then the <code>mail</code> command will send emails. You can send the mail to the root user by issuing this command:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$<span class="w"> </span>mail<span class="w"> </span>root
Cc:
Subject:<span class="w"> </span>Hi<span class="w"> </span>there<span class="w"> </span>root
hello<span class="w"> </span>there.<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>my<span class="w"> </span>mail
</code></pre></div>

<p>And root will get this email. She can read it using <code>mail</code> command.</p>
<p>If you need to send emails in a script, just do:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Body!&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>mail<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;Subject&quot;</span><span class="w"> </span>root
</code></pre></div>

<h2>returned values</h2>
<p>In the Unix world, the programs return values when they are finished. If you have programmed C, this is the <code>return 0</code> at the end. Commonly a 0 means successful execution. This return value can be read / examined using <code>$?</code> variable. </p>
<div class="highlight"><pre><span></span><code>jadi@ubuntuserver:/etc/skel$<span class="w"> </span>touch<span class="w"> </span>/chert
touch:<span class="w"> </span>cannot<span class="w"> </span>touch<span class="w"> </span><span class="s1">&#39;/chert&#39;</span>:<span class="w"> </span>Permission<span class="w"> </span>denied
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
<span class="m">1</span>
$<span class="w"> </span>touch<span class="w"> </span>/tmp/11
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
<span class="m">0</span>
$<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-e<span class="w"> </span>/
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
<span class="m">0</span>
$<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-e<span class="w"> </span>/nonexist
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
<span class="m">1</span>
$<span class="w"> </span>dummycommand
dummycommand:<span class="w"> </span><span class="nb">command</span><span class="w"> </span>not<span class="w"> </span>found
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
<span class="m">127</span>
</code></pre></div>

<p>To return values from your shell scripts, use the <code>exit</code> command; say <code>exit 0</code> for a successful exit.</p>
<h2>Bonus</h2>
<p>Just found my old <code>general_backup.sh</code> script and <a href="https://github.com/jadijadi/general_scripts/blob/main/backup_general_jadi.sh">uploaded it to github for you</a>. Nothing fancy but shows you how a general bash script can help you on your daily tasks.</p>
                                            <br clear="both" />
                                            <h1>105.3 Removed!</h1>
                                            <br clear="both" />
                                            <p>How luckY! this is removed. If you insist this used to be the old text:</p>
<h2>105.3 SQL data management</h2>
<div class="alert alert-danger" role="alert">
  This chapter is still a Work In Progress. Do not rely on it for LPIC version 500 exam. Will be updated in a few weeks.
</div>

<p><em>Weight: 2</em></p>
<p>Candidates should be able to query databases and manipulate data using basic SQL commands. This objective includes performing queries involving joining of 2 tables and/or subselects.</p>
<h4>Key Knowledge Areas</h4>
<ul>
<li>Use of basic SQL commands</li>
<li>Perform basic data manipulation</li>
</ul>
<h4>Terms and Utilities</h4>
<ul>
<li>insert</li>
<li>update</li>
<li>select</li>
<li>delete</li>
<li>from</li>
<li>where</li>
<li>group by</li>
<li>order by</li>
<li>join</li>
</ul>
<h3>Databases</h3>
<p>This module is about SQL language and MySQL is one of the many SQL databases. For this lesson, a database consists of some <strong>table</strong>s and each table has some <strong>row</strong>s and <strong>filed</strong>s. Lets have a look. In this lesson we are not going to <em>create</em> or <em>design</em> databases. You only need to have a general understanding of databases (SQL databases) and know some command to use (read query or update or add to them). The database I'm going to use in this lesson is called <code>lpic</code> and has two tables <code>contact</code> and <code>info</code>.</p>
<h3>mysql command line</h3>
<p>As I said, we are not goint to learn the <code>mysql</code> here, we only need to focus on <code>SQL</code> as a query language. You only need to know that <code>mysql</code> is a command line program to ineteractivly connect to a <code>mysql-server</code>. I use it like this:</p>
<div class="highlight"><pre><span></span><code>$ mysql -u root -p
</code></pre></div>

<p>which means I'm going to use <code>u</code>ser root and will provide a password. It was also possible to say:</p>
<div class="highlight"><pre><span></span><code>$ mysql -u root -p mypass lpic
</code></pre></div>

<p>to provide the pass on command line (not a good idea for security reasons!) and tell mysql program to connect to <code>lpic</code> database when it starts.</p>
<h4>using a database</h4>
<p>When you connect to a database, you have to use the <code>use</code> command to select which database you are going to issue commands on. Normally a database server (say mysql) can have 100s of different databases in it, each for one user or program.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 17
Server version: 5.6.25-0ubuntu0.15.04.1 (Ubuntu)

Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt; SHOW DATABASES;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| bad                |
| good               |
| lpic               |
| mysql              |
| performance_schema |
| ugly               |
+--------------------+
7 rows in set (0.00 sec)

mysql&gt; USE LPIC;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; SHOW TABLES;
+----------------+
| Tables_in_lpic |
+----------------+
| info           |
| phonebook      |
+----------------+
2 rows in set (0.00 sec)
</code></pre></div>

<p>As you can see <code>mysql</code> is friendly and shows lovely tables! I've told her to <code>use lpic</code> and then <code>show tables</code> and now I know that I have two tables: info &amp; phonebook.</p>
<blockquote>
<p>Note: it is common to type MYSQL commands in CAPITAL LETTERS and names and values and .. in lower case.</p>
</blockquote>
<h3>SELECT</h3>
<p><code>SELECt</code> is obvious! It selects from a table. When we are not sure what field we are looking for, we can select <code>*</code> to get all fields.</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM phonebook;
+--------+------------------+----------------+
| name   | email            | phone          |
+--------+------------------+----------------+
| jadi   | jadi@jadi.net    | +9890something |
| nasrin | nasrin@lpic.test | +9898989898    |
| sina   | far@from.here    | +687randomnum  |
| haale  |                  | 0935secret     |
+--------+------------------+----------------+
4 rows in set (0.00 sec)
</code></pre></div>

<p>or ask for a specific field:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT name FROM phonebook;
+--------+
| name   |
+--------+
| jadi   |
| nasrin |
| sina   |
| haale  |
+--------+
3 rows in set (0.00 sec)
</code></pre></div>

<h3>WHERE</h3>
<p>You can add <em>conditions</em> to your SQL queries using <code>WHERE</code>. Lets have a look at the other table we have:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM info;
+--------+--------+--------+-------+
| name   | height | weight | mood  |
+--------+--------+--------+-------+
| jadi   |    180 |     74 | happy |
| sina   |    175 |     81 | happy |
| nasrin |    174 |     68 | happy |
| mina   |    171 |     59 | sad   |
+--------+--------+--------+-------+
4 rows in set (0.00 sec)
</code></pre></div>

<p>What if we only wanted to see our <em>happy</em> friends?</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM info WHERE mood = &#39;happy&#39;;
+--------+--------+--------+-------+
| name   | height | weight | mood  |
+--------+--------+--------+-------+
| jadi   |    180 |     74 | happy |
| sina   |    175 |     81 | happy |
| nasrin |    174 |     68 | happy |
+--------+--------+--------+-------+
3 rows in set (0.00 sec)

mysql&gt;
</code></pre></div>

<p>Dont be afraid for <em>mina</em>, we will make her happy later but for now we need to see the friends who are happy and more than 80Kg.</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM info WHERE mood = &#39;happy&#39; AND weight &gt;= 80;
+--------+--------+--------+-------+
| name   | height | weight | mood  |
+--------+--------+--------+-------+
| sina   |    175 |     81 | happy |
+--------+--------+--------+-------+
3 rows in set (0.00 sec)
</code></pre></div>

<p>Or if I only needed the name:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT name FROM info WHERE mood = &#39;happy&#39; AND weight &gt;= 80;
+------+
| name |
+------+
| sina |
+------+
1 row in set (0.00 sec)
</code></pre></div>

<h3>ORDER BY</h3>
<p>This is used if you want to <strong>sort</strong> the data based on one field. Here I'm checking my phone book based on peoples names:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM phonebook ORDER BY name;
+--------+------------------+----------------+
| name   | email            | phone          |
+--------+------------------+----------------+
| haale  |                  | 0935secret     |
| jadi   | jadi@jadi.net    | +9890something |
| nasrin | nasrin@lpic.test | +9898989898    |
| sina   | far@from.here    | +687randomnum  |
+--------+------------------+----------------+
4 rows in set (0.00 sec)
</code></pre></div>

<p>This order can be done on any field, including numbers:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM info ORDER BY height;
+--------+--------+--------+-------+
| name   | height | weight | mood  |
+--------+--------+--------+-------+
| mina   |    171 |     59 | sad   |
| nasrin |    174 |     68 | happy |
| sina   |    175 |     81 | happy |
| jadi   |    180 |     74 | happy |
+--------+--------+--------+-------+
4 rows in set (0.00 sec)
</code></pre></div>

<h3>GROUP BY</h3>
<p>This will <em>group</em> the output. Unfortunately this is not very clear. Lets see the first example:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM info GROUP BY mood;
+------+--------+--------+-------+
| name | height | weight | mood  |
+------+--------+--------+-------+
| jadi |    180 |     74 | happy |
| mina |    171 |     59 | sad   |
+------+--------+--------+-------+
2 rows in set (0.00 sec)
</code></pre></div>

<p>We've seen that we have only two <code>mood</code>s in our table: sad &amp; happy. When <code>SELECT</code>ing all fields (that is <code>*</code>) from this table <code>GROUP BY</code> mood, SQL will check all the moods, shows us only ONE from each. This can be used like the <code>uniq</code> command you leaned from LPIC101:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT mood FROM info GROUP BY mood;
+-------+
| mood  |
+-------+
| happy |
| sad   |
+-------+
2 rows in set (0.00 sec)
</code></pre></div>

<p>Which gives you all available moods in the table. In real life this is not very useful and most of the times it is combined with <code>count</code>. Have a look:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT count(mood), mood FROM info GROUP BY mood;
+-------------+-------+
| count(mood) | mood  |
+-------------+-------+
|           3 | happy |
|           1 | sad   |
+-------------+-------+
2 rows in set (0.00 sec)
</code></pre></div>

<p>Whic counts home many rows have that specific mood. So I have 3 happy friends and one sad friend.</p>
<blockquote>
<p>Note: <code>count</code> is not part of LPIC 105.3</p>
</blockquote>
<h3>INSERT</h3>
<p>Another clear command. It adds a new row to a talbe. Say I want to add some data to phonebook:</p>
<div class="highlight"><pre><span></span><code>mysql&gt;  INSERT INTO phonebook (name, phone, email) VALUES (&#39;ghasem&#39;, &#39;+982112345678&#39;, &#39;&#39;);
Query OK, 1 row affected (0.01 sec)

mysql&gt; SELECT * FROM phonebook;
+--------+------------------+----------------+
| name   | email            | phone          |
+--------+------------------+----------------+
| jadi   | jadi@jadi.net    | +9890something |
| nasrin | nasrin@lpic.test | +9898989898    |
| sina   | far@from.here    | +687randomnum  |
| haale  |                  | 0935secret     |
| ghasem |                  | +982112345678  |
+--------+------------------+----------------+
5 rows in set (0.00 sec)
</code></pre></div>

<h3>DELETE</h3>
<p>You know it! This will DELETE from a table. But be careful of what you delete... WHERE is your fiend here:</p>
<p>mysql&gt; DELETE FROM phonebook WHERE name = 'ghasem'; Query OK, 1 row affected (0.01 sec)</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM phonebook;
+--------+------------------+----------------+
| name   | email            | phone          |
+--------+------------------+----------------+
| jadi   | jadi@jadi.net    | +9890something |
| nasrin | nasrin@lpic.test | +9898989898    |
| sina   | far@from.here    | +687randomnum  |
| haale  |                  | 0935secret     |
+--------+------------------+----------------+
4 rows in set (0.00 sec)
</code></pre></div>

<h3>UPDATE</h3>
<p>Did I tell you that SQL looks like plain English? I was right because you know what <code>UPDATE</code> does! It updates (changes) row and again <code>WHERE</code> is your friend:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM phonebook;
+--------+------------------+----------------+
| name   | email            | phone          |
+--------+------------------+----------------+
| jadi   | jadi@jadi.net    | +9890something |
| nasrin | nasrin@lpic.test | +9898989898    |
| sina   | far@from.here    | +687randomnum  |
| haale  |                  | 0935secret     |
+--------+------------------+----------------+
4 rows in set (0.00 sec)

mysql&gt; UPDATE phonebook SET  email=&#39;haale@lpic.fake&#39; WHERE name = &#39;haale&#39;;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; SELECT * FROM phonebook;
+--------+------------------+----------------+
| name   | email            | phone          |
+--------+------------------+----------------+
| jadi   | jadi@jadi.net    | +9890something |
| nasrin | nasrin@lpic.test | +9898989898    |
| sina   | far@from.here    | +687randomnum  |
| haale  | haale@lpic.fake  | 0935secret     |
+--------+------------------+----------------+
4 rows in set (0.00 sec)
</code></pre></div>

<h3>JOIN</h3>
<p>The JOIN command can be complicated but luckily we are on LPIC1-Exam 102 and we do not need to learn much ;) Join will join/mix two tables. Just check this:</p>
<div class="highlight"><pre><span></span><code>mysql&gt;  SELECT * FROM phonebook JOIN info;
+--------+------------------+----------------+--------+--------+--------+-------+
| name   | email            | phone          | name   | height | weight | mood  |
+--------+------------------+----------------+--------+--------+--------+-------+
| jadi   | jadi@jadi.net    | +9890something | jadi   |    180 |     74 | happy |
| nasrin | nasrin@lpic.test | +9898989898    | jadi   |    180 |     74 | happy |
| sina   | far@from.here    | +687randomnum  | jadi   |    180 |     74 | happy |
| haale  | haale@lpic.fake  | 0935secret     | jadi   |    180 |     74 | happy |
| jadi   | jadi@jadi.net    | +9890something | sina   |    175 |     81 | happy |
| nasrin | nasrin@lpic.test | +9898989898    | sina   |    175 |     81 | happy |
| sina   | far@from.here    | +687randomnum  | sina   |    175 |     81 | happy |
| haale  | haale@lpic.fake  | 0935secret     | sina   |    175 |     81 | happy |
| jadi   | jadi@jadi.net    | +9890something | nasrin |    174 |     68 | happy |
| nasrin | nasrin@lpic.test | +9898989898    | nasrin |    174 |     68 | happy |
| sina   | far@from.here    | +687randomnum  | nasrin |    174 |     68 | happy |
| haale  | haale@lpic.fake  | 0935secret     | nasrin |    174 |     68 | happy |
| jadi   | jadi@jadi.net    | +9890something | mina   |    171 |     59 | sad   |
| nasrin | nasrin@lpic.test | +9898989898    | mina   |    171 |     59 | sad   |
| sina   | far@from.here    | +687randomnum  | mina   |    171 |     59 | sad   |
| haale  | haale@lpic.fake  | 0935secret     | mina   |    171 |     59 | sad   |
+--------+------------------+----------------+--------+--------+--------+-------+
16 rows in set (0.00 sec)
</code></pre></div>

<p>Every single row from first table (phonebook) is copied in front of the second table (info). Not very useful <em>yet</em>. It becomes useful when you give a <em>common field</em> or tell it to JOIN tables based on a criteria; using <code>WHERE</code>. Here is the magic:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM phonebook JOIN info ON phonebook.name = info.name;
+--------+------------------+----------------+--------+--------+--------+-------+
| name   | email            | phone          | name   | height | weight | mood  |
+--------+------------------+----------------+--------+--------+--------+-------+
| jadi   | jadi@jadi.net    | +9890something | jadi   |    180 |     74 | happy |
| sina   | far@from.here    | +687randomnum  | sina   |    175 |     81 | happy |
| nasrin | nasrin@lpic.test | +9898989898    | nasrin |    174 |     68 | happy |
+--------+------------------+----------------+--------+--------+--------+-------+
3 rows in set (0.00 sec)
</code></pre></div>

<p>Great! Now I have my firneds list, their moods and their phone numbers! Say I'm bored and I need to phone a cool friend:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT phonebook.name, phone, mood FROM phonebook JOIN info ON phonebook.name = info.name WHERE mood = &#39;happy&#39;;
+--------+----------------+-------+
| name   | phone          | mood  |
+--------+----------------+-------+
| jadi   | +9890something | happy |
| sina   | +687randomnum  | happy |
| nasrin | +9898989898    | happy |
+--------+----------------+-------+
3 rows in set (0.00 sec)
</code></pre></div>

<blockquote>
<p>Note: both tables have a field called <code>name</code> so I needed to use phonebook.name to tell SQL which name I want to show.</p>
</blockquote>
<p>Obviously we can add more criteria and go out with a person shorter than 175cm:</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT phonebook.name, phone, mood FROM phonebook JOIN info ON phonebook.name = info.name AND height &lt; 175;
+--------+-------------+-------+
| name   | phone       | mood  |
+--------+-------------+-------+
| nasrin | +9898989898 | happy |
+--------+-------------+-------+
1 row in set (0.00 sec)
</code></pre></div>

<p>cool? but we are not finished yet. I do not like having sad friends and I have one, lets make her happy too!</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM info WHERE mood = &#39;sad&#39;;
+------+--------+--------+------+
| name | height | weight | mood |
+------+--------+--------+------+
| mina |    171 |     59 | sad  |
+------+--------+--------+------+
1 row in set (0.01 sec)

mysql&gt; UPDATE info SET mood = &#39;happy&#39; WHERE name = &#39;mina&#39;;
Query OK, 0 rows affected (0.02 sec)
Rows matched: 1  Changed: 0  Warnings: 0

mysql&gt; SELECT * FROM info WHERE mood = &#39;sad&#39;;                                   
Empty set (0.00 sec)

mysql&gt; SELECT * FROM info;
+--------+--------+--------+-------+
| name   | height | weight | mood  |
+--------+--------+--------+-------+
| jadi   |    180 |     74 | happy |
| sina   |    175 |     81 | happy |
| nasrin |    174 |     68 | happy |
| mina   |    171 |     59 | happy |
+--------+--------+--------+-------+
4 rows in set (0.00 sec)
</code></pre></div>

<p>Easy. The last command is even easier:</p>
<h3>quit</h3>
<div class="highlight"><pre><span></span><code>mysql&gt; quit
Bye
jadi@funlife:~$
</code></pre></div>

<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
                                            <br clear="both" />
                                            <h1>106.1 Install and configure X11</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Candidates should be able to install and configure X11.</p>
<h4>Key Knowledge Areas</h4>
<ul>
<li>Understanding of the X11 architecture.</li>
<li>Basic understanding and knowledge of the X Window configuration file.</li>
<li>Overwrite specific aspects of Xorg configuration, such as keyboard layout.</li>
<li>Understand the components of desktop environments, such as display managers and window managers.</li>
<li>Manage access to the X server and display applications on remote X servers.</li>
<li>Awareness of Wayland.</li>
</ul>
<h4>Terms and Utilities:</h4>
<ul>
<li><code>/etc/X11/xorg.conf</code></li>
<li><code>/etc/X11/xorg.conf.d/</code></li>
<li><code>~/.xsession-errors</code></li>
<li>xhost</li>
<li>xauth</li>
<li>DISPLAY</li>
<li>X</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/JqiT4rsTvUo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Intro</h2>
<p>Many people prefer to navigate and use their system via a Graphical User Interface (Or GUI in short). A GUI based operating system provides the user the Icons, mouse, windows &amp; folders, a metaphor from our daily "desktops". But how does this happen? As many other things in the Unix world, this happens via layers of applications that are doing one thing well. This is a rough representation of this stack:</p>
<p><img alt="Linux GUI stack" src="/images/gui_stack.png"></p>
<p>On the lower level we have the hardware (say your Monitor) and then the Linux kernel and its drivers. On top of that there is a software called "Display Manager" or "Display Server". This program can ask the operating system (the kernel) to perform what the desktop manager requests. In other words, the display server accepts the desires of UI (even via a network channel) and translates them to the language that Kernel (and drivers in it) understand.</p>
<p>In this section we are focusing on <strong>X</strong> which is one of the two main Display Servers and then will have a brief look at the other one; the modern <strong>Wayland</strong>. </p>
<h2>X</h2>
<p>The X Window System is a network transparent window system which runs on a wide range of computing and graphics machines; including in most GNU/Linux distributions when they need a graphical interfaces. Its history a bit long and started with <em>XFree86</em> then the X.org started its own X Server which is called X11 nowadays. </p>
<blockquote>
<p>Going down the rabbit hole, <em>X Window System</em> (or <em>X</em>), was the default windowing system for most Unix and Unix like systems during 1980s. X.Org server is the free and open-source implementation of the X Window System display server by the X.Org Foundation. These day when we say <em>X</em> we are referring to the whole family of the network protocols describing how messages are exchanged between a client (application) and the display server; X11 being the 11th version of them.</p>
</blockquote>
<h3>/etc/X11/xorg.conf</h3>
<p>This used to be main configuration file for X. In recent days X configures itself when starting and does not need a config file. But if you want to make changes in the boot-up process, you can create a new <code>xorg.conf.new</code> file by running the following command:</p>
<div class="highlight"><pre><span></span><code>Xorg -configure
</code></pre></div>

<p>and then moving it to the <code>/etc/X11/xorg.conf</code>. This file contains different sections. Lets have a look at some of them.</p>
<div class="highlight"><pre><span></span><code>Section &quot;Files&quot;
    FontPath    &quot;/usr/share/X11/fonts/misc&quot;
    FontPath    &quot;/usr/share/X11/fonts/100dpi/:unscaled&quot;
    FontPath    &quot;/usr/share/X11/fonts/75dpi/:unscaled&quot;
    FontPath    &quot;/usr/share/X11/fonts/Type1&quot;
    FontPath    &quot;/usr/share/X11/fonts/100dpi&quot;
    FontPath    &quot;/usr/share/X11/fonts/75dpi&quot;
    FontPath    &quot;/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType&quot;
EndSection
</code></pre></div>

<p>This part is about Fonts. When X-Server is running it needs these files. FontPaths tell X11 where fonts are. It also can refer to an IP running a font-server which is not common these days. Font servers used to be responsible of rendering fonts to be shown on clients but nowadays computers are fast and can render their own fonts. Font servers are going out of fashion!</p>
<div class="highlight"><pre><span></span><code>Section &quot;Module&quot;
    Load    &quot;bitmap&quot;
    Load    &quot;ddc&quot;
    Load    &quot;dri&quot;
    Load    &quot;extmod&quot;
    Load    &quot;freetype&quot;
    Load    &quot;glx&quot;
    Load    &quot;int10&quot;
    Load    &quot;type1&quot;
    Load    &quot;vbe&quot;
    Load    &quot;dbe&quot;
EndSection
</code></pre></div>

<p>These are modules. For example <code>glx</code> takes care of <em>3D graphical</em> effects and we are asking X to load it alongside others.</p>
<p>Here are the <code>InputDevice</code>s:</p>
<div class="highlight"><pre><span></span><code>Section &quot;InputDevice&quot;
    Identifier    &quot;Generic Keyboard&quot;
    Driver        &quot;kbd&quot;
    Option        &quot;CoreKeyboard&quot;
    Option        &quot;XkbRules&quot;    &quot;xorg&quot;
    Option        &quot;XkbModel&quot;    &quot;pc105&quot;
    Option        &quot;XkbLayout&quot;    &quot;us&quot;
EndSection

Section &quot;InputDevice&quot;
    Identifier    &quot;Configured Mouse&quot;
    Driver        &quot;mouse&quot;
    Option        &quot;CorePointer&quot;
    Option        &quot;Device&quot;        &quot;/dev/input/mice&quot;
    Option        &quot;Protocol&quot;        &quot;ImPS/2&quot;
    Option        &quot;Emulate3Buttons&quot;    &quot;true&quot;
    Option        &quot;ZAxisMapping&quot;        &quot;4 5&quot;
EndSection

Section &quot;InputDevice&quot;
        Identifier      &quot;Synaptics Touchpad&quot;
        Driver          &quot;synaptics&quot;
        Option          &quot;SendCoreEvents&quot;        &quot;true&quot;
        Option          &quot;Device&quot;                &quot;/dev/psaux&quot;
        Option          &quot;Protocol&quot;              &quot;auto-dev&quot;
        Option        &quot;RightEdge&quot;        &quot;5000&quot;
EndSection
</code></pre></div>

<p>As you can see each device has an <code>Identifier</code>, <code>Driver</code> and some <code>options</code>. Above we defined a mouse, a keyboard and a touchpad and gave them some names.</p>
<div class="highlight"><pre><span></span><code>Section &quot;Device&quot;
    Identifier    &quot;ATI Technologies, Inc. Radeon Mobility 7500 (M7 LW)&quot;
    Driver        &quot;radeon&quot;
    BusID        &quot;PCI:1:0:0&quot;
    Option        &quot;DynamicClocks&quot;    &quot;on&quot;
    Option        &quot;CRT2HSync&quot;    &quot;30-80&quot;
    Option        &quot;CRT2VRefresh&quot;    &quot;59-75&quot;
      Option        &quot;MetaModes&quot;    &quot;1024x768 800x600 640x480 1024x768+1280x1024&quot;
EndSection
</code></pre></div>

<p>A graphic card! Again it has its identifies (name), its drivers and some options (like support resolutions, refresh rates, ...). This device needs a screen and a monitor:</p>
<blockquote>
<p>Note: The <code>vesa</code> points to a low resolution, always working driver. It is used for troubleshooting.</p>
</blockquote>
<div class="highlight"><pre><span></span><code>Section &quot;Monitor&quot;
    Identifier    &quot;Generic Monitor&quot;
    Option        &quot;DPMS&quot;
EndSection

Section &quot;Screen&quot;
    Identifier    &quot;Screen0&quot;
    Device        &quot;Screen0 ATI Technologies, Inc. Radeon Mobility 7500 (M7 LW)&quot;
    Monitor        &quot;Generic Monitor&quot;
    DefaultDepth    24
    SubSection &quot;Display&quot;
        Depth        1
        Modes        &quot;1024x768&quot;
    EndSubSection
    SubSection &quot;Display&quot;
        Depth        4
        Modes        &quot;1024x768&quot;
    EndSubSection
    SubSection &quot;Display&quot;
        Depth        8
        Modes        &quot;1024x768&quot;
    EndSubSection
    SubSection &quot;Display&quot;
        Depth        15
        Modes        &quot;1024x768&quot;
    EndSubSection
    SubSection &quot;Display&quot;
        Depth        16
        Modes        &quot;1024x768&quot;
    EndSubSection
    SubSection &quot;Display&quot;
        Depth        24
        Modes        &quot;1024x768&quot;
    EndSubSection
EndSection
</code></pre></div>

<p>Note how the screen uses the already defined monitor (using its identifier "Generic Monitor") and an already defined graphic card. Also note the different color modes (say <code>24bit 1024x768</code>).</p>
<p>At the end we have to glue all of the above in one place as <code>ServerLayout</code>:</p>
<div class="highlight"><pre><span></span><code>Section &quot;ServerLayout&quot;
    Identifier    &quot;DefaultLayout&quot;
    Screen        &quot;Default Screen&quot;
    InputDevice    &quot;Generic Keyboard&quot;
    InputDevice    &quot;Configured Mouse&quot;
    InputDevice    &quot;Synaptics Touchpad&quot;
EndSection
</code></pre></div>

<p>We have a layout with a screen and 3 input devices :)</p>
<blockquote>
<p>Note: Do not panic. A general understanding of xorg.conf is enough</p>
</blockquote>
<h3>/etc/X11/xorg.conf.d/</h3>
<p>What happens if you edit the <code>/etc/program.conf</code> and then update the system? will the system overwrite your newly edited <code>program.conf</code> with the latest version from the vendor? or omit the changes in the vendor in favor of your local edits? Both are <em>bad</em>.</p>
<p>To solve this issue, many programs are creating a new configurations directory as <code>/etc/program/program.conf.d/</code> and asking you to add your <em>local</em> configurations there. So the main configuration file from the vendor will be <code>/etc/program/program.conf</code> and all your new configurations will go into the <code>/etc/program/program.conf.d/</code> as separated files. Much easier to manage (because smaller atomic files per configuration) and no touching the vendors config by locals. Cool? yes... this is happening in X11 too. Your own configs should go into <code>/etc/X11/xorg.conf.d/</code> and the <code>/etc/X11/xorg.conf</code> should remain untouched.</p>
<h3>~/.xsession-errors</h3>
<p>In case of any issues during the start of running of X, the errors will go here. So if you ran into an issue on your GUI startup, this is the file you should check to see what went wrong.</p>
<h3>xhost</h3>
<p>This command controls the access to the X server. If you are on a X server and run <code>xhost</code> it tells you the access status.</p>
<div class="highlight"><pre><span></span><code>$ xhost
access control enabled, only authorized clients can connect
SI:localuser:jadi
</code></pre></div>

<p>As you can see only authorized clients can connect. To open it for all:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ xhost +
access control disabled, clients can connect from any host
</code></pre></div>

<p>And for closing it again:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ xhost -
access control enabled, only authorized clients can connect
</code></pre></div>

<p>Or open it for only one specific IP:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife:~$ xhost +192.168.42.85
192.168.42.85 being added to access control list
jadi@funlife:~$ xhost
access control enabled, only authorized clients can connect
INET:192.168.42.85    (no nameserver response within 5 seconds)
SI:localuser:jadi
</code></pre></div>

<p>Now the <code>192.168.42.85</code> machine (REMOTE) can send its graphical requests to this machine. whats the usage? continue reading the next section (assuming this machine is called <code>192.168.42.80</code> (SERVER) and we opened the access from to its X11 for <code>192.168.42.85</code> (REMOTE) ).</p>
<h3>DISPLAY</h3>
<p>This variable tells graphical programs where to send their graphical output. This is the default:</p>
<div class="highlight"><pre><span></span><code>$ echo $DISPLAY
:0
</code></pre></div>

<p>So if I run any graphical program on my machine, its output will be displayed on the same machine. </p>
<p>But lets change it to the <code>192.168.42.80</code> machine (SERVER).. if you remember we just told it that this machine (REMOTE) can connect to it.</p>
<div class="highlight"><pre><span></span><code>$ export DISPLAY=192.168.42.80:0
$ xeyes # the eyes will be shown on 192.168.42.80 machine
</code></pre></div>

<p>Cool? yes. But this might not wonk on your setup. The X does not listen for remote connection in most distros because of security concerns. </p>
<blockquote>
<p>In the next chapter, we will see how you can properly run graphical programs on remote servers and receive the GUI part on your side</p>
</blockquote>
<h3>xauth</h3>
<p>The <code>xauth</code> program is used to edit and display the authorization information used in connecting to the X server. On <a href="#xhost">xhost</a> you see how you can open your X to remote IPs, using <code>xauth</code> you can do the same based on a shared "secret". </p>
<p>In this method, <code>X</code> creates an <code>.XAuthority</code> file in your home and whoever knows about the contents, can contact X. </p>
<blockquote>
<p>If your <code>X</code> is not working, one step might be <code>rm</code>ing the <code>.XAuthority</code> file and restarting the X. </p>
</blockquote>
<h2>Wayland</h2>
<p><em>X11</em> is super old and is only usable via lots of patches and hacks. Thats why one of its developers started a modern display manager called <em>Wayland</em>. In recent years many distros are switching from the default <em>X11</em> to <em>Wayland</em> and keeping X11 as a fail-safe option. Wayland is more secure and much easier to maintain and I can assure you that in a couple of years we will see more and more of it.</p>
                                            <br clear="both" />
                                            <h1>106.2 Graphical Desktops</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 1</em></p>
<p>Candidates should be aware of major Linux desktops. Furthermore, candidates should be aware of protocols used to access remote desktop sessions.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Awareness of major desktop environments</li>
<li>Awareness of protocols to access remote desktop sessions</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li>KDE</li>
<li>Gnome</li>
<li>Xfce</li>
<li>X11</li>
<li>XDMCP</li>
<li>VNC</li>
<li>Spice</li>
<li>RDP</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/YklRheL8RFQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Desktop Environments</h2>
<p>When your system boots in the graphical mode, you will see a graphical login page. This is based on the <strong>X Display Manager Control Protocol (XDMCP)</strong> which is responsible for the underlying login system. On top it different programs like GDM (for GNOME), SSDM (KDE) and a more general option XDM handle the theming and other aspects of login.</p>
<p>After the successful login, you will be in your GUI. Generally this is a <strong>large</strong> software package which manages your windows, mouse and has clickable icons and folder with drag and drop capability. There might even be a trashcan somewhere and lots of other softwares like calculators and an email client. These are called <strong>Desktop Environments</strong>. On the other hand, some people prefer to have a minimal window manager without all the bells and whistles and chose and add them based on their own preferences.</p>
<blockquote>
<p>A window manager is responsible for showing and managing windows on your GUI. Even the most minimalist GUI, needs a window manager to be function. But add more and more libraries and software to your window manager (say a calculator, calendar, email client, programming libs for that specific environment, maps, ...) and you will end up with what is called a Desktop Environment.</p>
</blockquote>
<p>In this section we will review 3 of the most famous Desktop Environments and then will talk about "remote access" to desktop envs.</p>
<h3>GNOME</h3>
<p><img alt="GNOME Desktop Environment" src="/images/gnome.png"></p>
<ul>
<li>Started at 1999</li>
<li>Focuses on productivity &amp; Accessibility</li>
<li>Used by most GNU/Linux distros</li>
</ul>
<h3>KDE [Plasma]</h3>
<p><img alt="KDE Plasma Desktop Environment" src="/images/plasma.png"></p>
<ul>
<li>Started at 1996</li>
<li>From version 5 (2016) re-branded to KDE Plasma</li>
<li>Highly customizable</li>
<li>Used during the Mars mission in NASA</li>
<li>CERN uses KDE</li>
</ul>
<h3>XFCE</h3>
<p><img alt="XFCE Desktop Environment" src="/images/xfce.png"></p>
<ul>
<li>Started at 1999</li>
<li>Lightweight but beautiful</li>
<li>Modular</li>
</ul>
<h2>Remote Connection to GUIs</h2>
<p>There are many situation where you want to connect remotely to your GUI based system. This can be remote assistance to a friend, checking the status on your computer from your phone, use a GUI based program on a much stronger remote machine or as a colleague did, hide a laptop in the LAB and connect to it remotely and work from home when you should have been to the office (don't!). </p>
<p>Here we will do a quick review on some of these methods.</p>
<h3>X Forwarding</h3>
<p>This is not mentioned in this section in LPIC1 but it is super useful to know about. If you have an SSH server, you can connect to it and run GUI softwares there and get the GUI part of the program on your own machine. This is called X-Forwarding in ssh. </p>
<p>First make sure that the <code>X11Forwarding yes</code> is configured in <code>/etc/ssh/sshd_config</code> (and [restart the service is needed]). Then do your ssh as follow:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ssh<span class="w"> </span>-X<span class="w"> </span>server_ip.address.net<span class="w"> </span>
$<span class="w"> </span>xeyes
</code></pre></div>

<p>And they eyes will appear on your own machine! You can do the same to run a browser or a cpu hungry simulation software.</p>
<h3>VNC</h3>
<p>Virtual Network Computer (VNC) started long time ago and is still active and alive. It is multi platform and uses RFB protocol. Its default port is 5900 + [display number, usually is 1 by default] so you need to use 5901 port to connect via VNC.</p>
<p>The good point about VNC is its flexibility and clients on all platform but it lacks security.</p>
<h3>Spice</h3>
<p>The <strong>Simple Protocol for Independent Computing Environment</strong> started as a closed source software but become open source when RedHat bought the company in 2008. It can be used to connect to KVM virtual machines (a very common virtual machine system) and has some advantages like fast speeds similar to local connections and low CPU usage. There is one server implementation but you can find many clients, including GNOMEs boxes program.</p>
<h3>RDP</h3>
<p>Using softwares like <code>Xrdp</code> you can start listening for Remote Desktop Protocol (RDP) connections on your machine on port 3389 by default. The traffic is encrypted by default and there are lots of free and open RDP clients available.  </p>
                                            <br clear="both" />
                                            <h1>106.3 Accessibility</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 1</em></p>
<p>Demonstrate knowledge and awareness of accessibility technologies.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Basic knowledge of visual settings and themes.</li>
<li>Basic knowledge of assistive technology.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li>High Contrast/Large Print Desktop Themes</li>
<li>Screen Reader</li>
<li>Braille Display</li>
<li>Screen Magnifier</li>
<li>On-Screen Keyboard</li>
<li>Sticky/Repeat keys</li>
<li>Slow/Bounce/Toggle keys</li>
<li>Mouse keys</li>
<li>Gestures</li>
<li>Voice recognition</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/37tZYcg_wpc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Linux is for everyone</h2>
<p>Some people have physical complications. Some can not see well, some can not see at all and some can not user their finger as most people do. Linux have 3 answers:</p>
<p>1- AccessX helps people with physical problems to use keyboard/mouse<br>
2- Visual Settings help people with vision problems by magnifying the screen and things like that<br>
3- Assistive Technologies are things like text-to-speech (tts) and reads the screen for people with visual problem  </p>
<p>These options are available in display managers (login screen) and in major desktops (like GNOME, KDE Plasma, xfce, ...). </p>
<p>In Gnome the config is located at Settings ~ Universal Access. The configurations are categorized and are as follows:</p>
<ul>
<li>High Contrast</li>
<li>Zoom</li>
<li>Large text</li>
<li>Screen Reader</li>
<li>Screen Keyboard (show a keyboard on screen)</li>
<li>Visual Alerts (instead Beeps, flash the screen )</li>
<li>Sticky Keys (Press shift, then press a -&gt; capital A)</li>
<li>Slow Keys (do not repeat keys after pressing a key for few seconds)</li>
<li>Bounce Keys (if you hit a key twice fast, it won't accept the second one)</li>
<li>Mouse Keys (Arrow keys on number path will work as a mouse)</li>
<li>Simulate Secondary Click (by holding down the click)</li>
<li>Hover click (click by waiting on a button)</li>
</ul>
<h2>TTS</h2>
<p>Applications like <strong>Orca</strong> or <strong>Emacspeak</strong> can read the dialog boxes to you so you can decide what the answer only by hearing.</p>
<p><img alt="A Braille Display" src="/images/braille.jpg"></p>
<p>Above you can see a Braille Display. This device will output text as braille for visually impaired people, although using a modern Text To Speech or screen reader might be more practical when possible.</p>
<h2>Voice recognition</h2>
<p>After the recent advancements in Voice recognition, this is one of the best methods for people with disabilities to control their OSs. </p>
                                            <br clear="both" />
                                            <h1>107.1 Manage user and group accounts and related system files</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 5</em></p>
<p>Candidates should be able to add, remove, suspend and change user accounts.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Add, modify and remove users and groups.</li>
<li>Manage user/group info in password/group databases.</li>
<li>Create and manage special purpose and limited accounts.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/passwd</code></li>
<li><code>/etc/shadow</code></li>
<li><code>/etc/group</code></li>
<li><code>/etc/skel/</code></li>
<li><code>chage</code></li>
<li><code>getent</code></li>
<li><code>groupadd</code></li>
<li><code>groupdel</code></li>
<li><code>groupmod</code></li>
<li><code>passwd</code></li>
<li><code>useradd</code></li>
<li><code>userdel</code></li>
<li><code>usermod</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xXQ1pw2sAQs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Passwords</h2>
<h3>Changing Passwords</h3>
<p>Each user can change her password using the <code>passwd</code> command:</p>
<div class="highlight"><pre><span></span><code>$ passwd
Changing password for jadi.
(current) UNIX password:
New password:
Retype new password:
passwd: password updated successfully
</code></pre></div>

<p>If the password is too short or too similar to the previous one or even a dictionary word, or equal to the username and such, the <code>passwd</code> command may refuse to change it. Also note that the <code>passwd</code> commands asks for the <em>current password</em> first to make sure that it is being changed by yourself. </p>
<blockquote>
<p>The root user can change any users password to anything (weak passwords) without providing their current password:</p>
</blockquote>
<div class="highlight"><pre><span></span><code># passwd jadi
New password:
BAD PASSWORD: it does not contain enough DIFFERENT characters
BAD PASSWORD: is too simple
Retype new password:
passwd: password updated successfully
</code></pre></div>

<h2>Users and groups</h2>
<p>Linux is a multi-user system and managing these users is part of system admin's job. As the first step, you should be able to <strong>add</strong>, <strong>remove</strong> and <strong>modify</strong> users.</p>
<p>Linux also has the concept of <strong>groups</strong>. You can define groups, give privileges to them and add users to these groups. As you've already seen in the <code>chmod</code> command, you might give access the permission to read from <code>/dev/cdrom</code> to a group called <code>cdrom</code> and then add whoever needs to read from the CD-ROM to this group.</p>
<p>Please note that each user can be a member of many groups but only one of these will be her <em>Primary</em> group. In contrast, each file can be owned only by one group.</p>
<h3>Managing Users</h3>
<h4>Adding users</h4>
<p>To add a new user to your system, use the <code>useradd</code> command. These are the main switches:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">switch</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-d</td>
<td style="text-align: left;">home directory (-d /home/user)</td>
</tr>
<tr>
<td style="text-align: left;">-m</td>
<td style="text-align: left;">create home directory</td>
</tr>
<tr>
<td style="text-align: left;">-s</td>
<td style="text-align: left;">specify shell</td>
</tr>
<tr>
<td style="text-align: left;">-G</td>
<td style="text-align: left;">add to additional groups</td>
</tr>
<tr>
<td style="text-align: left;">-c</td>
<td style="text-align: left;">comment. most of the time, users actual name. Use quotes if comments has spaces or special characters in them</td>
</tr>
</tbody>
</table>
<p>On some systems <code>useradd</code> creates the home directory and on some, you have to specify the <code>-m</code> switch yourself. It is a good practice to use it all the time.</p>
<p>When a new user directory is being created, the system will copy the contents of <code>/etc/skel</code> to their home dir. <code>/etc/skel</code> is used as a template for the home of users.</p>
<blockquote>
<p>Another command to add users is <code>adduser</code>. It will ask for the password, home directory, etc.. and will create the user.</p>
</blockquote>
<h4>Modifying users</h4>
<p>To modify a user, you should use the <code>usermod</code> command. It supports most of the <code>useradd</code> switches. For example you can change <em>jadi</em>'s login shell by issuing <code>usermod -s /bin/csh jadi</code>. But there are 3 more switches too:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">switch</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">-L</td>
<td style="text-align: left;">lock this account</td>
</tr>
<tr>
<td style="text-align: left;">-U</td>
<td style="text-align: left;">Unlock the account</td>
</tr>
<tr>
<td style="text-align: left;">-aG</td>
<td style="text-align: left;">append to more groups (say <code>usermod -aG wheel jadi</code>)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: If you do <code>usermod -G wheel,users jadi</code>, jadi will be the member of these two groups ONLY. That is why we use <code>-aG newgoup</code> to <em>append to groups</em> to add this group to jadi's groups. <code>-G</code> is like saying "jadi's groups are ..." and <code>-aG</code> is like "add jadi to these groups too".</p>
</blockquote>
<h4>Deleting users</h4>
<p>If you want to remove a user, use <code>userdel</code>. Straight forward:</p>
<div class="highlight"><pre><span></span><code>userdel jadi
</code></pre></div>

<p>If you add the <code>-r</code> switch, the home directory and mail spool will be erased too!</p>
<h3>Managing Groups</h3>
<p>It is kind of same as users, you can do <code>groupadd</code>, <code>groupdel</code> and <code>groupmod</code>. Each group has an <em>id</em> and a <em>name</em>.</p>
<div class="highlight"><pre><span></span><code># groupadd -g 1200 newgroup
</code></pre></div>

<p>adds a group called <em>newgroup</em> with id 1200. If needed, the root user can change a groups ID (to 2000) by issuing <code>groupmod -g 2000 newgroup</code> or deleting the group by <code>groupdel newgroup</code>.</p>
<p>Obviously if root deletes a group with members, people wont be deleted! They will just wont be the members of that group anymore.</p>
<blockquote>
<p>In most systems, the user id or group id's of the users and groups created by the admin will have the id of 1000, 1001, 1002, ...</p>
</blockquote>
<h3>Files related to users and groups</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/V69h5V5wdTw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h4><code>/etc/passwd</code></h4>
<p>This file contains all the user information on your system:</p>
<div class="highlight"><pre><span></span><code>tail /etc/passwd
scard:x:491:489:Smart Card Reader:/var/run/pcscd:/usr/sbin/nologin
sshd:x:493:491:SSH daemon:/var/lib/sshd:/bin/false
statd:x:488:65534:NFS statd daemon:/var/lib/nfs:/sbin/nologin
tftp:x:496:493:TFTP account:/srv/tftpboot:/bin/false
lightdm:x:10:14:Light Display Manager:/var/lib/lightdm:/bin/false
wwwrun:x:30:8:WWW daemon apache:/var/lib/wwwrun:/bin/false
jadi:x:1000:100:jadi:/home/jadi:/bin/bash
svn:x:485:482:user for Apache Subversion svnserve:/srv/svn:/sbin/nologin
privoxy:x:484:480:Daemon user for privoxy:/var/lib/privoxy:/bin/false
</code></pre></div>

<p>As you can see the format is:</p>
<div class="highlight"><pre><span></span><code>username:x:userid:primary group id:Name and comments:home dir:shell
</code></pre></div>

<p>As you can see, the 2nd field is shown as "<code>x</code>" here. In the old days the password or the hashed password of the user was shown in this file but nowadays that is moved to the <code>/etc/shadow</code> file.</p>
<blockquote>
<p>Note: /etc/passwd should be readable to all users and this makes it a very bad place to keep users password! Thats why we see a <code>x</code> instead of the password, this indicates that the main passwords should be looked up from <code>/etc/shadow</code> file.</p>
</blockquote>
<p>Note how <em>special users</em> like <code>lightdm</code> have <code>/bin/false</code> as their shell; this prevents them from logging into the system for real. In old days hackers used to try these accounts to login.</p>
<h4><code>/etc/shadow</code></h4>
<p>This file contains password (hashed passwords) of the users. See how the <code>/etc/passwd</code> is readable for all but <code>/etc/shadow</code> is only readable for root and members of the <code>shadow</code> group:</p>
<div class="highlight"><pre><span></span><code># ls -ltrh /etc/passwd /etc/shadow
-rw-r--r-- 1 root root   1.9K Oct 28 15:47 /etc/passwd
-rw-r----- 1 root shadow  851 Oct 29 19:06 /etc/shadow
</code></pre></div>

<p>But what is in it?</p>
<div class="highlight"><pre><span></span><code># tail /etc/shadow
scard:!:16369::::::
sshd:!:16369::::::
statd:!:16369::::::
tftp:!:16369::::::
uucp:*:16369::::::
lightdm:*:16369::::::
jadi:$6$enk5I3bv$uSQrRpen7m9xDapYLgwgh3P/71OLZUgj31n8AwzgIM2lA5Hc/BmRVAMC0eswdBGkseuXSvmaz0lsYFtduvuqUo:16737:0:99999:7:::
svn:!:16736::::::
privoxy:!:19473::::::
</code></pre></div>

<p>Wow! Jadi has an encrypted password there. Some numbers are following that encrypted password too: <strong><code>16737:0:99999:7:::</code></strong>. What do the mean? The following table tells you.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">filed</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">19473</td>
<td style="text-align: left;">When was the last time this password changes</td>
</tr>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">User wont be able to change the password 0 days after each change</td>
</tr>
<tr>
<td style="text-align: left;">99999</td>
<td style="text-align: left;">After this many days, the user HAVE to change his password</td>
</tr>
<tr>
<td style="text-align: left;">7</td>
<td style="text-align: left;">...and the user will be informed 7 days before the expiration to change his password</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: there numbers are "days after 1st of January 1970" or the Epoch time in days. For example 16737 means 16737 days after 1st Jan 1970. Strange but practical!</p>
</blockquote>
<p>But we do not need to change these strange number manually. If needed, we can use the <code>chage</code> tool to change these numbers. If you issue the <code>chage jadi</code> the system will prompt you for all the parameters one by one. Also it is possible to use switches to change specific parameters on command line.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">switch</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">-l</td>
<td style="text-align: left;">list information</td>
</tr>
<tr>
<td style="text-align: center;">-E</td>
<td style="text-align: left;">Set the expiration date. Date can be a number, in YYYY-MM-DD format or -1 which will mean <em>never</em></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code># chage -l jadi
Last password change                    : Apr 26, 2023
Password expires                    : never
Password inactive                    : never
Account expires                        : never
Minimum number of days between password change        : 0
Maximum number of days between password change        : 99999
Number of days of warning before password expires    : 7
</code></pre></div>

<blockquote>
<p>Note: <code>!</code> means the account is locked and the user can not login into the system using the account. On some systems (like RedHat) you may also see <code>!!</code> which means the account has never been used.</p>
</blockquote>
<h4><code>/etc/group</code></h4>
<p>This file contains the groups and their IDs.</p>
<div class="highlight"><pre><span></span><code># tail /etc/group
avahi:x:486:
kdm:!:485:
mysql:x:484:
winbind:x:483:
at:x:25:
svn:x:482:
vboxusers:x:481:
input:x:1000:jadi,joe
privoxy:x:480:
</code></pre></div>

<blockquote>
<p>Note: See that <code>x</code> there? Theoretically groups can have passwords but it is never used in any distro! The file is <code>/etc/gshadow</code></p>
</blockquote>
<h3>checking user info</h3>
<p>Previously you saw the <code>chage -l jadi</code> but there are more commands for checking user status. One is <code>id</code>:</p>
<div class="highlight"><pre><span></span><code># id jadi
uid=1000(jadi) gid=100(users) groups=1000(input),100(users)
</code></pre></div>

<p>Another solution is <code>getent</code> (for <strong>get entry</strong>). It can query important <em>databases</em> for specific entries. These databases include <code>/etc/passwd</code>, <code>/etc/hosts</code>, <code>/etc/shadow</code>, <code>/etc/group</code>, ...</p>
<div class="highlight"><pre><span></span><code>funlife:~ # getent group tor
tor:x:479:
funlife:~ # getent passwd jadi
jadi:x:1000:100:jadi:/home/jadi:/bin/bash
funlife:~ # getent shadow jadi
jadi:$6$enk5I3bv$uSQrRpen7m9xDapYLgwgh3P/71OLZUgj31n8AwzgIM2lA5Hc/BmRVAMC0eswdBGkseuXSvmaz0lsYFtduvuqUo:16737:0:99999:7:::
</code></pre></div>
                                            <br clear="both" />
                                            <h1>107.2 Automate system administration tasks by scheduling jobs</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to use cron and systemd timers to run jobs at regular intervals and to use at to run jobs at a specific time.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Manage cron and at jobs.</li>
<li>Configure user access to cron and at services.</li>
<li>Understand systemd timer units.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/cron.{d,daily,hourly,monthly,weekly}/</code></li>
<li><code>/etc/at.deny</code></li>
<li><code>/etc/at.allow</code></li>
<li><code>/etc/crontab</code></li>
<li><code>/etc/cron.allow</code></li>
<li><code>/etc/cron.deny</code></li>
<li><code>/var/spool/cron/</code></li>
<li><code>crontab</code></li>
<li><code>at</code></li>
<li><code>atq</code></li>
<li><code>atrm</code></li>
<li>systemctl</li>
<li>systemd-run</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/jIgJ-l_HMgE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>There are many cases where we need to run some commands at specific times or intervals. For example you may want to run your backup process every morning at 03:00 or refresh the list of files on your web index on hourly basis.</p>
<p>There are different methods to do so in the Linux world. The most commons are the <code>crontab</code> to run tasks on specific intervals, <code>at</code> to run a commands on specific time and also utilities provided by <code>systemd</code>.</p>
<h3>Crontab format</h3>
<p>Crontab works with a configuration file which tells it when to run a command. For example you can say "run my commands when the hour is 03 and the minute is 00" or "run my command when its Saturday and Hour is 10 and minute is 00" or "Run whenever the minute is 00". </p>
<p>Each crontab configuration line has 6 fields. The first 5 specify a specific interval and whatever after than is used as the "command".</p>
<div class="highlight"><pre><span></span><code>A    B    C    D    E    command and arguments
</code></pre></div>

<table>
<thead>
<tr>
<th style="text-align: center;">filed</th>
<th style="text-align: left;">Meaning</th>
<th style="text-align: left;">values</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">A</td>
<td style="text-align: left;">minute</td>
<td style="text-align: left;">0-59</td>
</tr>
<tr>
<td style="text-align: center;">B</td>
<td style="text-align: left;">hour</td>
<td style="text-align: left;">0-23</td>
</tr>
<tr>
<td style="text-align: center;">C</td>
<td style="text-align: left;">day of month</td>
<td style="text-align: left;">1-31</td>
</tr>
<tr>
<td style="text-align: center;">D</td>
<td style="text-align: left;">month</td>
<td style="text-align: left;">1-12 (or names, see below)</td>
</tr>
<tr>
<td style="text-align: center;">E</td>
<td style="text-align: left;">day of week</td>
<td style="text-align: left;">0-7 (0 or 7 is Sunday, or use names)</td>
</tr>
</tbody>
</table>
<p>If you replace a field with <code>*</code> it means "whatever" or "all" or "any". Also if you have <code>@reboot</code> or <code>@daily</code> instead of time fields, the command will be run once after the reboot or daily. Lets see some examples:</p>
<div class="highlight"><pre><span></span><code>5 0 * * *       $HOME/bin/daily.job &gt;&gt; $HOME/tmp/out 2&gt;&amp;1

# run at 2:15pm on the first of every month -- output mailed to paul
15 14 1 * *     $HOME/bin/monthly

# run at 10 pm on weekdays, annoy Joe
0 22 * * 1-5    mail -s &quot;It&#39;s 10pm&quot; joe%Joe,%%Where are your kids?%

23 0-23/2 * * * echo &quot;run 23 minutes after midn, 2am, 4am ..., everyday&quot;
5 4 * * sun     echo &quot;run at 5 after 4 every sunday&quot;

*/5 * * * *    echo &quot;each 5 mintues&quot;

42 8,18 * * 1-5    echo &quot;8:42 and 18:42 and only on weekdays (monday till friday)&quot;

@reboot        echo &quot;runs after the reboot&quot;
</code></pre></div>

<p>As you can see in above examples, <code>/</code> can be used to slice the time (so <code>*/5</code> in minutes means every five minutes) or use the <code>,</code> to indicate more than one number (so <code>8,18</code> means 8 and 18).</p>
<blockquote>
<p>When using <code>*</code> on the first filed, you are running your command on every minute.</p>
<p>Something like <code>42 8 1 1 0</code> runs ONLY when the 1st of Jan is a Sunday!</p>
</blockquote>
<p>When a cron runs, the output will be emailed to the owner of the cron.</p>
<h3>user specific crons</h3>
<p>Cron is a linux service. To see your crons you can use <code>crontab -l</code> (list) and for editing them you can use <code>crontab -e</code> (edit) which will open the cron files with a special editor and will validate and then load your crons after you are finished.</p>
<p>The files will be saved at <code>/var/spool/cron/tabs/</code> or <code>/var/spool/crontabs</code>:</p>
<div class="highlight"><pre><span></span><code># cat /var/spool/cron/tabs/jadi
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.khObLu installed on Thu Oct 29 22:04:43 2023)
# (Cronie version 4.2)
# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * command to be executed
* * * * * date &gt;&gt; /tmp/date.cron.txt
</code></pre></div>

<blockquote>
<p>never edit these files directly; Use <code>crontab -e</code> instead.</p>
</blockquote>
<h3>system wide cron</h3>
<p>There is file called <code>/etc/crontab</code>. This looks like a normal user file opened with <code>crontab -e</code> but has one extra filed:</p>
<div class="highlight"><pre><span></span><code>A    B    C    D    E    USER    command and arguments
</code></pre></div>

<p>This file should be edited with an editor directly and we can mention which user runs this commands.</p>
<div class="highlight"><pre><span></span><code># cat /etc/crontab
SHELL=/bin/sh
PATH=/usr/bin:/usr/sbin:/sbin:/bin:/usr/lib/news/bin
MAILTO=root
#
# check scripts in cron.hourly, cron.daily, cron.weekly, and cron.monthly
#
-*/15 * * * *   root  test -x /usr/lib/cron/run-crons &amp;&amp; /usr/lib/cron/run-crons &gt;/dev/null 2&gt;&amp;1
</code></pre></div>

<blockquote>
<p>Note: Have a look at the first three lines. It configures the shell which will run the commands and the PATH variable plus who will get the output emails.</p>
</blockquote>
<p>As you can see this default crontab runs other crons! These are hourly, daily, weekly and monthly crons. Lets have a look at them in the next section.</p>
<h3>System hourly, daliy, weekly, monthly, .. crons</h3>
<p>We have some system level crontab files in <code>/etc/cron.d/</code> too. They look like general crontab files. For example this is one that <code>munin</code> program creates:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/etc/cron.d/munin
<span class="c1">#</span>
<span class="c1"># cron-jobs for munin</span>
<span class="c1">#</span>

<span class="nv">MAILTO</span><span class="o">=</span>root

*/5<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">     </span>munin<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-x<span class="w"> </span>/usr/bin/munin-cron<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>/usr/bin/munin-cron<span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<span class="m">14</span><span class="w"> </span><span class="m">10</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">     </span>munin<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-x<span class="w"> </span>/usr/share/munin/munin-limits<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>/usr/share/munin/munin-limits<span class="w"> </span>--force<span class="w"> </span>--contact<span class="w"> </span>nagios<span class="w"> </span>--contact<span class="w"> </span>old-nagios<span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<span class="m">19</span>:12:37<span class="w"> </span>jadi@ocean:~$<span class="w"> </span>cat<span class="w"> </span>/etc/cron.weekly/man-db
</code></pre></div>

<p>But there are also directories called <code>cron.hourly</code>, <code>cron.daily</code>, <code>cron.weekly</code> &amp; <code>cron.monthly</code>. As their name indicates, whatever script / file you put in them, will be run hourly, daily, weekly &amp; monthly. This makes general cleanup, backup, ... tasks much cleaner. Its enough to copy your script in any of these directories and let them run on these intervals.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>tree<span class="w"> </span>/etc/cron*
/etc/cron.d
├──<span class="w"> </span>munin
├──<span class="w"> </span>munin-node
├──<span class="w"> </span>php5
└──<span class="w"> </span>sendmail
/etc/cron.daily
├──<span class="w"> </span>apache2
├──<span class="w"> </span>apport
├──<span class="w"> </span>apt
├──<span class="w"> </span>aptitude
├──<span class="w"> </span>bsdmainutils
├──<span class="w"> </span>dpkg
├──<span class="w"> </span>logrotate
├──<span class="w"> </span>man-db
├──<span class="w"> </span>mlocate
├──<span class="w"> </span>passwd
├──<span class="w"> </span>popularity-contest
├──<span class="w"> </span>sendmail
├──<span class="w"> </span>update-notifier-common
└──<span class="w"> </span>upstart
/etc/cron.hourly
/etc/cron.monthly
/etc/crontab<span class="w"> </span><span class="o">[</span>error<span class="w"> </span>opening<span class="w"> </span>dir<span class="o">]</span>
/etc/cron.weekly
├──<span class="w"> </span>apt-xapian-index
├──<span class="w"> </span>fstrim
├──<span class="w"> </span>man-db
└──<span class="w"> </span>update-notifier-common
</code></pre></div>

<p>Lets have a look at one of the cron.d files:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/etc/cron.daily/mlocate
<span class="c1">#! /bin/bash</span>

<span class="nb">set</span><span class="w"> </span>-e

<span class="o">[</span><span class="w"> </span>-x<span class="w"> </span>/usr/bin/updatedb.mlocate<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>

<span class="k">if</span><span class="w"> </span>which<span class="w"> </span>on_ac_power<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nv">ON_BATTERY</span><span class="o">=</span><span class="m">0</span>
<span class="w">    </span>on_ac_power<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nv">ON_BATTERY</span><span class="o">=</span><span class="nv">$?</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ON_BATTERY</span><span class="s2">&quot;</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">fi</span>

<span class="c1"># See ionice(1)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-x<span class="w"> </span>/usr/bin/ionice<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span>/usr/bin/ionice<span class="w"> </span>-c3<span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nv">IONICE</span><span class="o">=</span><span class="s2">&quot;/usr/bin/ionice -c3&quot;</span>
<span class="k">fi</span>

flock<span class="w"> </span>--nonblock<span class="w"> </span>/run/mlocate.daily.lock<span class="w"> </span><span class="nv">$IONICE</span><span class="w"> </span>/usr/bin/updatedb.mlocate
</code></pre></div>

<h3>at</h3>
<p>We say that crontab runs commands on specific intervals but what will happen if you needed to run a command only once? Here <code>at</code> is your friend.</p>
<div class="highlight"><pre><span></span><code>$ at now + 1 min
warning: commands will be executed using /bin/sh
at&gt; touch /tmp/at
at&gt; &lt;EOT&gt;
job 3 at Thu Oct 29 22:12:00 2015
</code></pre></div>

<blockquote>
<p>Note: As always, at the end of input we press Ctrl+D</p>
</blockquote>
<p>If you want to check what is in the queue you can use <code>atq</code> and then try <code>atrm 4</code> to delete job number 4;</p>
<div class="highlight"><pre><span></span><code>$ at teatime
warning: commands will be executed using /bin/sh
at&gt; echo &quot;tea time is 4pm&quot;
at&gt; &lt;EOT&gt;
job 4 at Fri Oct 30 16:00:00 2015
jadi@funlife:~$ at tomorrow
warning: commands will be executed using /bin/sh
at&gt; echo &quot;tomorrow this time&quot;
at&gt; &lt;EOT&gt;
job 5 at Fri Oct 30 22:15:00 2015
jadi@funlife:~$ at 17:30
warning: commands will be executed using /bin/sh
at&gt; echo &quot;this is the first 17:30&quot;
at&gt; &lt;EOT&gt;
job 6 at Fri Oct 30 17:30:00 2015
jadi@funlife:~$ atq
5    Fri Oct 30 22:15:00 2015 a jadi
4    Fri Oct 30 16:00:00 2015 a jadi
6    Fri Oct 30 17:30:00 2015 a jadi
jadi@funlife:~$ atrm 4
jadi@funlife:~$ atq
5    Fri Oct 30 22:15:00 2015 a jadi
6    Fri Oct 30 17:30:00 2015 a jadi
</code></pre></div>

<h3>managing cron access</h3>
<p>To control the access to the cron system, we have 4 files:</p>
<div class="highlight"><pre><span></span><code>/etc/cron.allow
/etc/cron.deny

/etc/at.allow
/etc/at.deny
</code></pre></div>

<p>In most systems none of these files exist but if you create them, they will become active as follow:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">file extension</th>
<th style="text-align: left;">functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">.allow</td>
<td style="text-align: left;">ONLY users mentioned in this file are allowed to run this service. All other users will be denied</td>
</tr>
<tr>
<td style="text-align: left;">.deny</td>
<td style="text-align: left;">Everybody can use the service except the users mentioned in this file</td>
</tr>
</tbody>
</table>
<h2>systemd &amp; systemd-run</h2>
<p>Nowadays most GNU/Linux distributions use <code>systemd</code> which has its own <strong>timers</strong> as an alternative to cron to schedule your tasks. Timer unit files use the <code>.timer</code> suffix, and for each of these there must be a corresponding unit file which describes the unit to be activated when the timer activates. By default, a timer activates a service with the same name, except for the suffix.</p>
<p>Timers have a [Timer] section that specifies when scheduled jobs should run. There are two types of timers. One is the <strong>readl-time timer</strong> which works with <code>OnCalendar=</code> option and defines kind of close to cron timers (based on calendar event expressions). This is the syntax:</p>
<div class="highlight"><pre><span></span><code>OnCalendar=DayOfWeek Year-Month-Day Hour:Minute:Second
</code></pre></div>

<blockquote>
<p>DayOfWeek is optional and you can use a 3 letter abbreviation (say Mon)</p>
</blockquote>
<p>The <code>*</code>, <code>/</code> and <code>,</code> work the same in systemd and cron configurations but in systemd you can also use <code>..</code> between two values to indicate a contiguous range. </p>
<p>For example, to run the service named <code>/etc/systemd/system/myservice.service</code> at 02:42 on the first Saturday of each month, this config line should be added to the <code>/etc/systemd/system/myservice.timer</code> unit file.</p>
<div class="highlight"><pre><span></span><code><span class="k">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">Run the blah blah service</span>

<span class="k">[Timer]</span>
<span class="na">OnCalendar</span><span class="o">=</span><span class="s">Sat *-*-1..7 02:42:00</span>
<span class="na">Persistent</span><span class="o">=</span><span class="s">true</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">timers.target</span>
</code></pre></div>

<p>It is also possible to define <strong>monotonic</strong> timers. They activate after some time has elapsed from a specific start point (say when the machine was booted up or when the timer itself is activated). You can chose between any of the following:</p>
<table>
<thead>
<tr>
<th>config</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>OnActiveSec</td>
<td>time after unit activation</td>
</tr>
<tr>
<td>OnBootSec</td>
<td>time after system boot</td>
</tr>
<tr>
<td>OnStartupSec</td>
<td>time after the service manager is started. For system services, this is almost equal to OnActiveSec. Use this for user services where the service manager is started at user login.</td>
</tr>
<tr>
<td>OnUnitActiveSec</td>
<td>time after the corresponding service was last activated</td>
</tr>
<tr>
<td>OnUnitInactiveSec</td>
<td>time after the  corresponding service was last deactivated</td>
</tr>
</tbody>
</table>
<p>And you can use any of usec, msec, seconds, minutes, hours, days, weeks, months, years in front. So for example the </p>
<div class="highlight"><pre><span></span><code><span class="k">[Timer]</span>
<span class="na">OnUnitActiveSec</span><span class="o">=</span><span class="s">5minutes 20seconds</span>
</code></pre></div>

<p>will activate the corresponding unit 5min and 20secs after the last activation of this unit service.</p>
<p>Please note that after adding any timer, you need to enable (and probably start) it:</p>
<div class="highlight"><pre><span></span><code># systemctl enable myservice.timer
# systemctl start myservice.timer
</code></pre></div>

<p>And also do not forget to do a <code>systemctl daemon-reload</code> after each change.</p>
<p>To check all the scheduled jobs, run the <code>systemctl list-timers</code> command. This will show you all the active timers. Use the <code>--all</code> switch to check all.</p>
<p>There are few shortcuts for times too. You can use these instead of the cron format to set timers:</p>
<table>
<thead>
<tr>
<th>shortcut</th>
<th>when it runs</th>
</tr>
</thead>
<tbody>
<tr>
<td>hourly</td>
<td>beginning of each hour</td>
</tr>
<tr>
<td>daily</td>
<td>One a day at midnight</td>
</tr>
<tr>
<td>weekly</td>
<td>midnight on Monday</td>
</tr>
<tr>
<td>monthly</td>
<td>midnight on the 1st of each month</td>
</tr>
<tr>
<td>yearly</td>
<td>midnight on the 1st of Jan</td>
</tr>
</tbody>
</table>
<p>This is one example from a recent Fedora installation:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="k">system</span><span class="o">/</span><span class="n">timers</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">wants</span><span class="o">/</span><span class="n">plocate</span><span class="o">-</span><span class="n">updatedb</span><span class="p">.</span><span class="n">timer</span><span class="w"> </span>
<span class="o">[</span><span class="n">Unit</span><span class="o">]</span>
<span class="n">Description</span><span class="o">=</span><span class="k">Update</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plocate</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">daily</span>

<span class="o">[</span><span class="n">Timer</span><span class="o">]</span>
<span class="n">OnCalendar</span><span class="o">=</span><span class="n">daily</span>
<span class="n">RandomizedDelaySec</span><span class="o">=</span><span class="mi">12</span><span class="n">h</span>
<span class="n">AccuracySec</span><span class="o">=</span><span class="mi">20</span><span class="nf">min</span>
<span class="n">Persistent</span><span class="o">=</span><span class="k">true</span>

<span class="o">[</span><span class="n">Install</span><span class="o">]</span>
<span class="n">WantedBy</span><span class="o">=</span><span class="n">timers</span><span class="p">.</span><span class="n">target</span>
</code></pre></div>

<p>If you want to check the output of your timers, you can use the <code>journalctl</code>.</p>
<blockquote>
<p>as any other <code>systemd</code> activity, use the <code>--user</code> switch to use it on your user level and not systemwide.</p>
</blockquote>
<p>At the end, you should know about the <code>systemd-run</code> command. It can start a transient service or scope and run specific commands in it. </p>
<p>So a command like:</p>
<div class="highlight"><pre><span></span><code>systemd-run --on-active=&quot;2hours&quot; --unit=&quot;helloworld.service&quot;
</code></pre></div>

<p>Will run the helloworld.service every 2 hours or this:</p>
<div class="highlight"><pre><span></span><code>sudo systemd-run --on-active=&quot;2hours&quot; /usr/local/bin/helloworld.sh --language=en_US
</code></pre></div>

<p>will run that specific script with shown parameters every 2 hours. </p>
<hr>
<p>Since this is new and there are not much sources about it, refer to <a href="https://documentation.suse.com/smart/systems-management/html/systemd-working-with-timers/index.html">Suse docs</a> to learn more.</p>
                                            <br clear="both" />
                                            <h1>107.3 Localisation and internationalisation</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to localise a system in a different language than English. As well, an understanding of why <code>LANG=C</code> is useful when scripting.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Configure locale settings and environment variables.</li>
<li>Configure timezone settings and environment variables.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/timezone</code></li>
<li><code>/etc/localtime</code></li>
<li><code>/usr/share/zoneinfo/</code></li>
<li><code>LC_*</code></li>
<li><code>LC_ALL</code></li>
<li><code>LANG</code></li>
<li><code>TZ</code></li>
<li><code>/usr/bin/locale</code></li>
<li><code>tzselect</code></li>
<li><code>timedatectl</code></li>
<li><code>date</code></li>
<li><code>iconv</code></li>
<li>UTF-8</li>
<li>ISO-8859</li>
<li>ASCII</li>
<li>Unicode</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kqoipsM7AMA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>timezone</h3>
<p>The earth is large and round so we have different <strong><em>timezones</em></strong> and different <strong><em>languages</em></strong>! There are even talks about a time zone for Mars and if we encounter aliens, they might also have their own languages. </p>
<p>This makes a few problems:
1. we may prefer our local language for our Linux
2. we need to tell linux about our timezone
3. programs may ask linux about our preferences on languages, keyboard configuration, and ..
4. and even if you do not case about yourself, your machines needs your timezone to be able to run tasks on needed times </p>
<p>In this section I will show you the answers Linux has to overcome these issues. But lets start simple.</p>
<p>On linux systems you can use <code>date</code> and <code>cal</code> commands to check the date and the calendar. It is possible to print a custom date using <code>+</code> formatter:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="nc">date</span>
<span class="n">Fri</span><span class="w"> </span><span class="n">Jun</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">07</span><span class="err">:</span><span class="mi">35</span><span class="w"> </span><span class="n">PM</span><span class="w"> </span><span class="n">EDT</span><span class="w"> </span><span class="mi">2023</span>
<span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="nc">date</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;%Y%m%d-%M&#39;</span>
<span class="mi">20230602</span><span class="o">-</span><span class="mi">08</span>
<span class="o">[</span><span class="n">jadi@fedora ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="nc">date</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;%Y%m%d-%H%M&#39;</span>
<span class="mi">20230602</span><span class="o">-</span><span class="mi">1408</span>
</code></pre></div>

<p>to get more info you can try <code>timedatectl</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@fedora ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">timedatectl</span>
<span class="w">               </span><span class="k">Local</span><span class="w"> </span><span class="nc">time</span><span class="err">:</span><span class="w"> </span><span class="n">Fri</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">02</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">34</span><span class="w"> </span><span class="n">EDT</span>
<span class="w">           </span><span class="n">Universal</span><span class="w"> </span><span class="nc">time</span><span class="err">:</span><span class="w"> </span><span class="n">Fri</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">02</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">34</span><span class="w"> </span><span class="n">UTC</span>
<span class="w">                 </span><span class="n">RTC</span><span class="w"> </span><span class="nc">time</span><span class="err">:</span><span class="w"> </span><span class="n">Sat</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">03</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">37</span><span class="err">:</span><span class="mi">51</span>
<span class="w">                </span><span class="nc">Time</span><span class="w"> </span><span class="k">zone</span><span class="err">:</span><span class="w"> </span><span class="n">America</span><span class="o">/</span><span class="n">New_York</span><span class="w"> </span><span class="p">(</span><span class="n">EDT</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">0400</span><span class="p">)</span>
<span class="k">System</span><span class="w"> </span><span class="n">clock</span><span class="w"> </span><span class="nl">synchronized</span><span class="p">:</span><span class="w"> </span><span class="k">no</span>
<span class="w">              </span><span class="n">NTP</span><span class="w"> </span><span class="nl">service</span><span class="p">:</span><span class="w"> </span><span class="n">active</span>
<span class="w">          </span><span class="n">RTC</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">local</span><span class="w"> </span><span class="nl">TZ</span><span class="p">:</span><span class="w"> </span><span class="k">no</span>
</code></pre></div>

<p>Timezone determines what is your time difference comparing with a reference timezone. This way you can talk about times regardless of your location. In another words, I can tell you "start the change request at 02:30 UTC" and we both know when the change will be started in our own timezone (mine will be 1 hour ahead so I'll start at 3:30 my time).</p>
<p>Most distributions will ask you about your time zone during the installation. You can change this later, either by a GUI in the system settings or using a text based user interface (TUI) like the older <code>tzconfig</code> or a newer <code>tzselect</code>.</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">jadi</span><span class="err">@</span><span class="n">fedora</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="o">$</span><span class="w"> </span><span class="n">tzselect</span>
<span class="n">Please</span><span class="w"> </span><span class="n">identify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">zone</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">correctly</span><span class="o">.</span>
<span class="n">Please</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">continent</span><span class="p">,</span><span class="w"> </span><span class="n">ocean</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;coord&quot;</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s2">&quot;TZ&quot;</span><span class="o">.</span>
<span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">Africa</span><span class="w">                                </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="n">Europe</span>
<span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">Americas</span><span class="w">                              </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="n">Indian</span><span class="w"> </span><span class="n">Ocean</span>
<span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">Antarctica</span><span class="w">                                </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="n">Pacific</span><span class="w"> </span><span class="n">Ocean</span>
<span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">Asia</span><span class="w">                                 </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="n">coord</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">geographical</span><span class="w"> </span><span class="n">coordinates</span><span class="o">.</span>
<span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">Atlantic</span><span class="w"> </span><span class="n">Ocean</span><span class="w">                           </span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">TZ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timezone</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Posix</span><span class="w"> </span><span class="n">TZ</span><span class="w"> </span><span class="n">format</span><span class="o">.</span>
<span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="n">Australia</span>
<span class="c1">#? 5</span>
<span class="n">Please</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="n">whose</span><span class="w"> </span><span class="n">clocks</span><span class="w"> </span><span class="n">agree</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">yours</span><span class="o">.</span>
<span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">Bermuda</span><span class="w">                     </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">Faroe</span><span class="w"> </span><span class="n">Islands</span><span class="w">                   </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="n">Spain</span>
<span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">Cape</span><span class="w"> </span><span class="n">Verde</span><span class="w">                      </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">Portugal</span>
<span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">Falkland</span><span class="w"> </span><span class="n">Islands</span><span class="w">                </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="n">South</span><span class="w"> </span><span class="n">Georgia</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">South</span><span class="w"> </span><span class="n">Sandwich</span><span class="w"> </span><span class="n">Islands</span>
<span class="c1">#? 1</span>

<span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">given</span><span class="p">:</span>

<span class="w">    </span><span class="n">Bermuda</span>

<span class="n">Therefore</span><span class="w"> </span><span class="n">TZ</span><span class="o">=</span><span class="s1">&#39;Atlantic/Bermuda&#39;</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="o">.</span>
<span class="n">Selected</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">now</span><span class="p">:</span><span class="w">   </span><span class="n">Fri</span><span class="w"> </span><span class="n">Jun</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="mi">15</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">06</span><span class="w"> </span><span class="n">ADT</span><span class="w"> </span><span class="mf">2023.</span>
<span class="n">Universal</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">now</span><span class="p">:</span><span class="w">  </span><span class="n">Fri</span><span class="w"> </span><span class="n">Jun</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">06</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="mf">2023.</span>
<span class="n">Is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">OK</span><span class="err">?</span>
<span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">Yes</span>
<span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">No</span>
<span class="c1">#? 1</span>

<span class="n">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">permanent</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">yourself</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">appending</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">line</span>
<span class="w">    </span><span class="n">TZ</span><span class="o">=</span><span class="s1">&#39;Atlantic/Bermuda&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">export</span><span class="w"> </span><span class="n">TZ</span>
<span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="s1">&#39;.profile&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">home</span><span class="w"> </span><span class="n">directory</span><span class="p">;</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">again</span><span class="o">.</span>

<span class="n">Here</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">TZ</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">again</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span>
<span class="n">can</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">tzselect</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">scripts</span><span class="p">:</span>
<span class="n">Atlantic</span><span class="o">/</span><span class="n">Bermuda</span>
</code></pre></div>

<p>When finished this program will suggest you to set a variable called <code>TZ</code> as follow to set <em>your own</em> time zone, but not the systems:</p>
<div class="highlight"><pre><span></span><code>TZ=&#39;Atlantic/Bermuda&#39;; export TZ
</code></pre></div>

<p>or use it once to check time in a specific city:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>env<span class="w"> </span><span class="nv">TZ</span><span class="o">=</span><span class="s1">&#39;Asia/Tokyo&#39;</span><span class="w"> </span>date
Sat<span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">03</span>:25:40<span class="w"> </span>AM<span class="w"> </span>JST<span class="w"> </span><span class="m">2023</span>
</code></pre></div>

<h3>Configuring timezone</h3>
<p>The <code>/usr/share/zoneinfo/</code> directory contains all the timezone info. These are binary files. If you need to change your system-wide timezone you need to short link the <code>/etc/localtime</code> to one of these files:</p>
<div class="highlight"><pre><span></span><code><span class="cp"># ls -ltrh /etc/localtime</span>
<span class="n">lrwxrwxrwx</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">38</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">09</span><span class="o">:</span><span class="mi">41</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">localtime</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">zoneinfo</span><span class="o">/</span><span class="n">America</span><span class="o">/</span><span class="n">New_York</span>
</code></pre></div>

<p>This file should be replaced by the correct file from <code>/usr/share/zoneinfo/</code>. It is nicer to make a symbolic link rather than copying the actual file. This will prevent the issues during next upgrades.</p>
<h3>Configuring Languages</h3>
<p>To check the status of current selected system language, use the <code>locale</code> command:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@fedora ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">locale</span>
<span class="n">LANG</span><span class="o">=</span><span class="n">en_US</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">LC_CTYPE</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_NUMERIC</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_TIME</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_COLLATE</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_MONETARY</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_MESSAGES</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_PAPER</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_NAME</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_ADDRESS</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_TELEPHONE</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_MEASUREMENT</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_IDENTIFICATION</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
<span class="n">LC_ALL</span><span class="o">=</span>
</code></pre></div>

<p>These are environment variables telling system what languages to use. Here I'm using <code>LANG=en_US.UTF-8</code> which means I'm using English with US variant and UTF-8 encoding.</p>
<blockquote>
<p>UTF-8 and other encodings will be discussed a bit later in this chapter</p>
</blockquote>
<p>Other variables you see above, tell the system how to show different things based on localisation systems. For example if we change the <code>LC_TIME</code> to <code>"en\_GB.UTF-8"</code> the time will be printed in Great Britain format.</p>
<p>Another important settings is <code>LC_ALL</code>. It can be used to change <strong>ALL</strong> settings. If you do a <code>export LC_ALL=fa_IR.UTF-8</code>, all the settings will be set to that one, with no exception. It is always possible to <code>unset LC_ALL</code>.</p>
<h4>LANG=C</h4>
<p>The <code>LANG=C</code> settings is used in many programs and scripts to make sure that the system will create coherent and predictable results in all environments. For example to make sure that the sort order will be in Binary order and all language settings will be default (en.US).</p>
<h4>changing or adding locales</h4>
<p>This is not a part of LPIC exam but it is good to know that on a debian based machine, you can change, add or set your default <em>locales</em> using <code>dpkg-reconfigure locales</code>.</p>
<p>There is also this file:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@fedora ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">locale</span><span class="p">.</span><span class="n">conf</span>
<span class="n">LANG</span><span class="o">=</span><span class="ss">&quot;en_US.UTF-8&quot;</span>
</code></pre></div>

<p>and you can also add your desired <code>LANG</code> config to your <code>~/.bash_profile</code> or <code>~/.profile</code>.</p>
<blockquote>
<p>on <code>systemd</code> use <code>localectl</code> to check locale or use <code>localectl set-locale LANG=en_US.UTF-8</code> to set it.</p>
</blockquote>
<h3>Character Encoding</h3>
<h4>ACSII</h4>
<p>Computers used to work with 7bit characters encoding. That would give us 128 characters which was enough for numbers, punctuation and digits!</p>
<h4>ISO-8859</h4>
<p>It had more characters and a lots of sets for Thai, Arabic and other languages but still had ASCII character sets.</p>
<h4>UTF-8</h4>
<p>The <code>Unicode Transformation Format</code> is the newest encoding method. It is a real universal encoding with characters not only for all written languages but also for fun characters like ¾, ♠, π and ⚤. It is backward compatible with the ASCII and uses 8 bit code units (<strong>not 8 bit coding!</strong>). In most cases it is a good idea to use UTF-8 and be sure that your system will work in practically all cases.</p>
<h3>iconv</h3>
<p>If you needed to convert coding to each other, the command is <code>iconv</code>. The <code>-l</code> switch will show you all the available codings:</p>
<div class="highlight"><pre><span></span><code>iconv -f WINDOWS-1258 -t UTF-8 /tmp/myfile.txt
</code></pre></div>

<blockquote>
<p>Note: -f is for "from" and -t is for "to". Easy to remember</p>
</blockquote>
<p>In 2023 you will seldom need this command but it is a must to know it, specially if you are living in a non US country!</p>
                                            <br clear="both" />
                                            <h1>108.1 Maintain system time</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be able to properly maintain the system time and synchronize the clock via NTP.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Set the system date and time.</li>
<li>Set the hardware clock to the correct time in UTC.</li>
<li>Configure the correct timezone.</li>
<li>Basic NTP configuration using <code>ntpd</code> and <code>chrony</code>.</li>
<li>Knowledge of using the <code>pool.ntp.org</code> service.</li>
<li>Awareness of the <code>ntpq</code> command.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/usr/share/zoneinfo/</code></li>
<li><code>/etc/timezone</code></li>
<li><code>/etc/localtime</code></li>
<li><code>/etc/ntp.conf</code></li>
<li><code>/etc/chrony.conf</code></li>
<li><code>date</code></li>
<li><code>hwclock</code></li>
<li><code>ntpd</code></li>
<li><code>ntpdate</code></li>
<li><code>chronyc</code></li>
<li><code>pool.ntp.org</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/RhH-2I1dBjA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>How a computer keeps its time</h3>
<p>There is a clock in your computer; a hardware clock on your motherboard! It has its own battery and keeps the time even when the computer is off. When the system boots, the OS reads this <strong>hardware time</strong> and it sets it's own <strong>system time</strong> based on the hardware clock and uses this clock whenever it needs to know the time.</p>
<p>Hardware clock can be the set on localtime (the time shown on your clock wherever you are) or UTC time (standard time). The <code>hwclock</code> can be used to show the time based on the hwtime. See how it works based on the hardware time even after we DO CHANGE the system time:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>date
Fri<span class="w"> </span>Jun<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">01</span>:47:22<span class="w"> </span>PM<span class="w"> </span>+0330<span class="w"> </span><span class="m">2023</span>
$<span class="w"> </span>sudo<span class="w"> </span>date<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;Jan 22 22:22:22 2022&quot;</span>
Sat<span class="w"> </span>Jan<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">10</span>:22:22<span class="w"> </span>PM<span class="w"> </span>+0330<span class="w"> </span><span class="m">2022</span>
$<span class="w"> </span>date
Sat<span class="w"> </span>Jan<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">10</span>:22:29<span class="w"> </span>PM<span class="w"> </span>+0330<span class="w"> </span><span class="m">2022</span>
$<span class="w"> </span>sudo<span class="w"> </span>hwclock<span class="w"> </span>
<span class="m">2023</span>-06-23<span class="w"> </span><span class="m">13</span>:47:41.160122+03:30
</code></pre></div>

<blockquote>
<p>Even when the hardware clock is set on UTC, <code>hwclock</code> date shows the date in the localtime (time after adding the timezone to the UTC time)</p>
</blockquote>
<p>Older OSs used to set the hardware clock on localtime zone instead of timezone. This can be achieved by:</p>
<div class="highlight"><pre><span></span><code># hwclock --localtime --set --date=&quot;01/05/2023 22:04:00&quot;
</code></pre></div>

<p>The previous commands sets the hardware clock on that specific date and tell it that this is the localtime. If you want to change back to UTC time, issue:</p>
<div class="highlight"><pre><span></span><code># hwclock -u -w
</code></pre></div>

<p>Here, <code>-w</code> tells the <code>hwclock</code> to set the hardware time based on the current system time and <code>-u</code> tells the hwclock that we are using the UTC. This also sets the HWClock using UTC int he <code>\etc\adjtime</code> file.</p>
<blockquote>
<p>If you set a time on the hardware clock without mentioning it being UTC / Local, the <code>/etc/adjtime</code> will decide this, if this file does not exists, the UTC will be used.</p>
</blockquote>
<p>You already know about the <code>timedatectl</code> and <code>date</code> from the <a href="http://linux1st.com/1073-localisation-and-internationalisation.html">Localization and globalization chapter</a> so I wont repeat them here.</p>
<h3>Time Zones</h3>
<p>We have seen time zones in previous chapters. But in short, there are two important files here.</p>
<p>The <code>/etc/timezone</code> is a text file, representing your timezone. This is used if a program wants to know about your time zone of show it. For example:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/etc/timezone<span class="w"> </span>
Asia/Tehran
</code></pre></div>

<p>But the <code>/etc/localtime</code> is a binary file describing your timezone info to the system (for example the <code>date</code> file):</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>/etc/localtime<span class="w"> </span>
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">31</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">11</span>:19<span class="w"> </span>/etc/localtime<span class="w"> </span>-&gt;<span class="w"> </span>/usr/share/zoneinfo/Asia/Tehran
$<span class="w"> </span>file<span class="w"> </span>/usr/share/zoneinfo/Asia/Tehran
/usr/share/zoneinfo/Asia/Tehran:<span class="w"> </span>timezone<span class="w"> </span>data,<span class="w"> </span>version<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>no<span class="w"> </span>gmt<span class="w"> </span><span class="nb">time</span><span class="w"> </span>flags,<span class="w"> </span>no<span class="w"> </span>std<span class="w"> </span><span class="nb">time</span><span class="w"> </span>flags,<span class="w"> </span>no<span class="w"> </span>leap<span class="w"> </span>seconds,<span class="w"> </span><span class="m">72</span><span class="w"> </span>transition<span class="w"> </span>times,<span class="w"> </span><span class="m">8</span><span class="w"> </span>abbreviation<span class="w"> </span>chars
</code></pre></div>

<p>In many cases, this is a soft link to a file located at <code>/usr/share/zoneinfo/</code> so it will be updated in case of system update.</p>
<h3>NTP</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ntyUBmG8F40" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p><strong>Network Time Protocol</strong>  is my personal favorite protocol. It is one of the coolest protocols ever if you dive into its details. But unfortunately for LPIC1 you do not need to dive into NTP depths. This protocol uses NTP servers to find out the accurate time shown by best atomic clocks on this planet. One of the most famous severs used by ntp people is <code>pool.ntp.org</code>. If you check that website you will see that it is a <strong>pool</strong> of ntp servers and by giving your NTP server the <code>pool.ntp.org</code>, it will be redirected to one of the many ntp servers available on that pool.</p>
<h4>ntpdate</h4>
<p>The most straight forward command to set the systemclock is <code>ntpdate</code> and used like this:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>ntpdate<span class="w"> </span>pool.ntp.org
<span class="m">23</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">14</span>:49:55<span class="w"> </span>ntpdate<span class="o">[</span><span class="m">160138</span><span class="o">]</span>:<span class="w"> </span>adjust<span class="w"> </span><span class="nb">time</span><span class="w"> </span>server<span class="w"> </span><span class="m">31</span>.214.170.254<span class="w"> </span>offset<span class="w"> </span>+0.020196<span class="w"> </span>sec
</code></pre></div>

<p>After this, we need to set the hwclock to the recently synced system time using <code>sudo hwclock -w</code>.</p>
<h4>ntpd</h4>
<p>Instead of manually setting the time each time, you can use a linux service called <code>ntp</code> to keep your time using some time servers (the most famous one is pool.ntp.org). Install the <code>ntp</code> and start the server:</p>
<p>In Debian/Ubuntu: </p>
<div class="highlight"><pre><span></span><code># apt install ntp
# systemctl start ntp
</code></pre></div>

<p>Fun fact? you can not use both! Look at this:</p>
<div class="highlight"><pre><span></span><code>root@funlife:~# ntpdate pool.ntp.org
23 Jun 14:49:55 ntpdate[18670]: the NTP socket is in use, exiting
</code></pre></div>

<p>As you can see, now the <code>ntp</code> is using the NTP port and <code>ntpdate</code> has problems starting up.</p>
<p>Main configuration file of <code>ntp</code> is located at <code>/etc/ntp.conf</code>:</p>
<div class="highlight"><pre><span></span><code># cat /etc/ntp.conf
# /etc/ntp.conf, configuration for ntpd; see ntp.conf(5) for help

driftfile /var/lib/ntp/ntp.drift

# Enable this if you want statistics to be logged.
#statsdir /var/log/ntpstats/

statistics loopstats peerstats clockstats
filegen loopstats file loopstats type day enable
filegen peerstats file peerstats type day enable
filegen clockstats file clockstats type day enable


# You do need to talk to an NTP server or two (or three).
#server ntp.your-provider.example

# pool.ntp.org maps to about 1000 low-stratum NTP servers.  Your server will
# pick a different set every time it starts up.  Please consider joining the
# pool: &lt;http://www.pool.ntp.org/join.html&gt;
pool 0.debian.pool.ntp.org iburst
pool 1.debian.pool.ntp.org iburst
pool 2.debian.pool.ntp.org iburst
pool 3.debian.pool.ntp.org iburst


# Access control configuration; see /usr/share/doc/ntp-doc/html/accopt.html for
# details.  The web page &lt;http://support.ntp.org/bin/view/Support/AccessRestrictions&gt;
# might also be helpful.
#
# Note that &quot;restrict&quot; applies to both servers and clients, so a configuration
# that might be intended to block requests from certain clients could also end
# up blocking replies from your own upstream servers.

# By default, exchange time with everybody, but don&#39;t allow configuration.
restrict -4 default kod notrap nomodify nopeer noquery limited
restrict -6 default kod notrap nomodify nopeer noquery limited

# Local users may interrogate the ntp server more closely.
restrict 127.0.0.1
restrict ::1

# Needed for adding pool entries
restrict source notrap nomodify noquery

# Clients from this (example!) subnet have unlimited access, but only if
# cryptographically authenticated.
#restrict 192.168.123.0 mask 255.255.255.0 notrust


# If you want to provide time to your local subnet, change the next line.
# (Again, the address is an example only.)
#broadcast 192.168.123.255

# If you want to listen to time broadcasts on your local subnet, de-comment the
# next lines.  Please do this only if you trust everybody on the network!
#disable auth
#broadcastclient
</code></pre></div>

<p>If needed, you can change the ntp servers to the ones you want to use.</p>
<p>Review the configuration and you will see cool things like providing your ntp service to other computers although you do not need these for passing LPIC.</p>
<h4>ntpq</h4>
<p>The <code>ntpq</code> queries the ntp service. One famous switch is <code>-p</code> (for Print) that shows the pool we are using to sync the clock:</p>
<div class="highlight"><pre><span></span><code> ntpq -p
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
 0.debian.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
 1.debian.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
 2.debian.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
 3.debian.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
+46.209.14.1     192.168.5.2      4 u    7   64    1   58.300  -15.546  14.519
-ntp.tums.ac.ir  195.161.115.4    4 u    4   64    1   30.636    2.485   4.025
*194.225.150.25  194.190.168.1    2 u    5   64    1   31.478   -3.870  95.635
+5.160.24.41     192.168.5.2      4 u    3   64    1   90.000  -28.328  21.643
</code></pre></div>

<p>In this output a <code>*</code> means that the ntp is using this server as the main reference, <code>+</code> means that this is a good server and <code>-</code> shows an out of range server which will be neglected.</p>
<h3>chrony</h3>
<p>Another and a newer NTP protocol implemenation is the <code>chrony</code>. Compared to <code>ntpd</code> , this tool provides better results at synchronize time difficult conditions such as intermittent network connections (such as laptops) and congested networks. Chrony is the default NTP client in RedHat 8, SUSE 15 and many other distributions. Another adavn</p>
<p>Here is a sample <code>chrony.conf</code> file:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/etc/chrony/chrony.conf<span class="w"> </span>
<span class="c1"># Welcome to the chrony configuration file. See chrony.conf(5) for more</span>
<span class="c1"># information about usable directives.</span>

<span class="c1"># Include configuration files found in /etc/chrony/conf.d.</span>
confdir<span class="w"> </span>/etc/chrony/conf.d

<span class="c1"># This will use (up to):</span>
<span class="c1"># - 4 sources from ntp.ubuntu.com which some are ipv6 enabled</span>
<span class="c1"># - 2 sources from 2.ubuntu.pool.ntp.org which is ipv6 enabled as well</span>
<span class="c1"># - 1 source from [01].ubuntu.pool.ntp.org each (ipv4 only atm)</span>
<span class="c1"># This means by default, up to 6 dual-stack and up to 2 additional IPv4-only</span>
<span class="c1"># sources will be used.</span>
<span class="c1"># At the same time it retains some protection against one of the entries being</span>
<span class="c1"># down (compare to just using one of the lines). See (LP: #1754358) for the</span>
<span class="c1"># discussion.</span>
<span class="c1">#</span>
<span class="c1"># About using servers from the NTP Pool Project in general see (LP: #104525).</span>
<span class="c1"># Approved by Ubuntu Technical Board on 2011-02-08.</span>
<span class="c1"># See http://www.pool.ntp.org/join.html for more information.</span>
pool<span class="w"> </span>ntp.ubuntu.com<span class="w">        </span>iburst<span class="w"> </span>maxsources<span class="w"> </span><span class="m">4</span>
pool<span class="w"> </span><span class="m">0</span>.ubuntu.pool.ntp.org<span class="w"> </span>iburst<span class="w"> </span>maxsources<span class="w"> </span><span class="m">1</span>
pool<span class="w"> </span><span class="m">1</span>.ubuntu.pool.ntp.org<span class="w"> </span>iburst<span class="w"> </span>maxsources<span class="w"> </span><span class="m">1</span>
pool<span class="w"> </span><span class="m">2</span>.ubuntu.pool.ntp.org<span class="w"> </span>iburst<span class="w"> </span>maxsources<span class="w"> </span><span class="m">2</span>

<span class="c1"># Use time sources from DHCP.</span>
sourcedir<span class="w"> </span>/run/chrony-dhcp

<span class="c1"># Use NTP sources found in /etc/chrony/sources.d.</span>
sourcedir<span class="w"> </span>/etc/chrony/sources.d

<span class="c1"># This directive specify the location of the file containing ID/key pairs for</span>
<span class="c1"># NTP authentication.</span>
keyfile<span class="w"> </span>/etc/chrony/chrony.keys

<span class="c1"># This directive specify the file into which chronyd will store the rate</span>
<span class="c1"># information.</span>
driftfile<span class="w"> </span>/var/lib/chrony/chrony.drift

<span class="c1"># Save NTS keys and cookies.</span>
ntsdumpdir<span class="w"> </span>/var/lib/chrony

<span class="c1"># Uncomment the following line to turn logging on.</span>
<span class="c1">#log tracking measurements statistics</span>

<span class="c1"># Log files location.</span>
logdir<span class="w"> </span>/var/log/chrony

<span class="c1"># Stop bad estimates upsetting machine clock.</span>
maxupdateskew<span class="w"> </span><span class="m">100</span>.0

<span class="c1"># This directive enables kernel synchronization (every 11 minutes) of the</span>
<span class="c1"># real-time clock. Note that it can’t be used along with the &#39;rtcfile&#39; directive.</span>
rtcsync

<span class="c1"># Step the system clock instead of slewing it if the adjustment is larger than</span>
<span class="c1"># one second, but only in the first three clock updates.</span>
makestep<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span>

<span class="c1"># Get TAI-UTC offset and leap seconds from the system tz database.</span>
<span class="c1"># This directive must be commented out when using time sources serving</span>
<span class="c1"># leap-smeared time.</span>
leapsectz<span class="w"> </span>right/UTC
</code></pre></div>

<p>To control the <code>chrony</code> service, there is a CLI (Command Line Interface) which is called <code>chronyc</code>. It it used to monitor chronyd's performance and to change various operating parameters. If a "command" is passed to the <code>chronyc</code>, the results will be shown, otherwise you will get a command to issue your commands. Have a look:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>chronyc<span class="w"> </span>tracking
Reference<span class="w"> </span>ID<span class="w">    </span>:<span class="w"> </span>0FED61D6<span class="w"> </span><span class="o">(</span>paris.time.system76.com<span class="o">)</span>
Stratum<span class="w">         </span>:<span class="w"> </span><span class="m">3</span>
Ref<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="o">(</span>UTC<span class="o">)</span><span class="w">  </span>:<span class="w"> </span>Fri<span class="w"> </span>Jun<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">12</span>:44:20<span class="w"> </span><span class="m">2023</span>
System<span class="w"> </span><span class="nb">time</span><span class="w">     </span>:<span class="w"> </span><span class="m">0</span>.001574947<span class="w"> </span>seconds<span class="w"> </span>slow<span class="w"> </span>of<span class="w"> </span>NTP<span class="w"> </span><span class="nb">time</span>
Last<span class="w"> </span>offset<span class="w">     </span>:<span class="w"> </span>+0.000513619<span class="w"> </span>seconds
RMS<span class="w"> </span>offset<span class="w">      </span>:<span class="w"> </span><span class="m">0</span>.065126784<span class="w"> </span>seconds
Frequency<span class="w">       </span>:<span class="w"> </span><span class="m">8</span>.705<span class="w"> </span>ppm<span class="w"> </span>slow
Residual<span class="w"> </span>freq<span class="w">   </span>:<span class="w"> </span>+0.278<span class="w"> </span>ppm
Skew<span class="w">            </span>:<span class="w"> </span><span class="m">14</span>.972<span class="w"> </span>ppm
Root<span class="w"> </span>delay<span class="w">      </span>:<span class="w"> </span><span class="m">0</span>.180896595<span class="w"> </span>seconds
Root<span class="w"> </span>dispersion<span class="w"> </span>:<span class="w"> </span><span class="m">0</span>.013603540<span class="w"> </span>seconds
Update<span class="w"> </span>interval<span class="w"> </span>:<span class="w"> </span><span class="m">128</span>.6<span class="w"> </span>seconds
Leap<span class="w"> </span>status<span class="w">     </span>:<span class="w"> </span>Normal
$<span class="w"> </span>chronyc
chrony<span class="w"> </span>version<span class="w"> </span><span class="m">4</span>.2
Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">1997</span>-2003,<span class="w"> </span><span class="m">2007</span>,<span class="w"> </span><span class="m">2009</span>-2021<span class="w"> </span>Richard<span class="w"> </span>P.<span class="w"> </span>Curnow<span class="w"> </span>and<span class="w"> </span>others
chrony<span class="w"> </span>comes<span class="w"> </span>with<span class="w"> </span>ABSOLUTELY<span class="w"> </span>NO<span class="w"> </span>WARRANTY.<span class="w">  </span>This<span class="w"> </span>is<span class="w"> </span>free<span class="w"> </span>software,<span class="w"> </span>and
you<span class="w"> </span>are<span class="w"> </span>welcome<span class="w"> </span>to<span class="w"> </span>redistribute<span class="w"> </span>it<span class="w"> </span>under<span class="w"> </span>certain<span class="w"> </span>conditions.<span class="w">  </span>See<span class="w"> </span>the
GNU<span class="w"> </span>General<span class="w"> </span>Public<span class="w"> </span>License<span class="w"> </span>version<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>details.

chronyc&gt;<span class="w"> </span>activity
<span class="m">200</span><span class="w"> </span>OK
<span class="m">12</span><span class="w"> </span>sources<span class="w"> </span>online
<span class="m">0</span><span class="w"> </span>sources<span class="w"> </span>offline
<span class="m">0</span><span class="w"> </span>sources<span class="w"> </span>doing<span class="w"> </span>burst<span class="w"> </span><span class="o">(</span><span class="k">return</span><span class="w"> </span>to<span class="w"> </span>online<span class="o">)</span>
<span class="m">0</span><span class="w"> </span>sources<span class="w"> </span>doing<span class="w"> </span>burst<span class="w"> </span><span class="o">(</span><span class="k">return</span><span class="w"> </span>to<span class="w"> </span>offline<span class="o">)</span>
<span class="m">3</span><span class="w"> </span>sources<span class="w"> </span>with<span class="w"> </span>unknown<span class="w"> </span>address

chronyc&gt;<span class="w"> </span>sources
MS<span class="w"> </span>Name/IP<span class="w"> </span>address<span class="w">         </span>Stratum<span class="w"> </span>Poll<span class="w"> </span>Reach<span class="w"> </span>LastRx<span class="w"> </span>Last<span class="w"> </span><span class="nv">sample</span><span class="w">               </span>
<span class="o">===============================================================================</span>
^?<span class="w"> </span>prod-ntp-4.ntp4.ps5.cano&gt;<span class="w">     </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">375</span><span class="w">    </span><span class="m">20</span><span class="w">  </span>+5039us<span class="o">[</span>+5039us<span class="o">]</span><span class="w"> </span>+/-<span class="w">   </span>85ms
^?<span class="w"> </span>prod-ntp-5.ntp4.ps5.cano&gt;<span class="w">     </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">377</span><span class="w">    </span><span class="m">83</span><span class="w">    </span>+12ms<span class="o">[</span><span class="w">  </span>+15ms<span class="o">]</span><span class="w"> </span>+/-<span class="w">   </span>87ms
^?<span class="w"> </span>prod-ntp-3.ntp4.ps5.cano&gt;<span class="w">     </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">177</span><span class="w">    </span><span class="m">22</span><span class="w">    </span>+13ms<span class="o">[</span><span class="w">  </span>+17ms<span class="o">]</span><span class="w"> </span>+/-<span class="w">   </span>91ms
^?<span class="w"> </span>alphyn.canonical.com<span class="w">          </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">277</span><span class="w">    </span><span class="m">22</span><span class="w">  </span>+3298us<span class="o">[</span>+6616us<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>185ms
^?<span class="w"> </span>mail.stumpflee.com<span class="w">            </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">373</span><span class="w">    </span><span class="m">19</span><span class="w">  </span>+6221us<span class="o">[</span>+6221us<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>117ms
^?<span class="w"> </span>meetbsd.ir<span class="w">                    </span><span class="m">2</span><span class="w">   </span><span class="m">6</span><span class="w">   </span><span class="m">377</span><span class="w">    </span><span class="m">27</span><span class="w">    </span>-23ms<span class="o">[</span><span class="w">  </span>-20ms<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>231ms
^?<span class="w"> </span><span class="m">188</span>.121.119.122<span class="w">               </span><span class="m">3</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">377</span><span class="w">    </span><span class="m">26</span><span class="w">    </span>-27ms<span class="o">[</span><span class="w">  </span>-23ms<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>131ms
^+<span class="w"> </span>brazil.time.system76.com<span class="w">      </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">377</span><span class="w">    </span><span class="m">20</span><span class="w">    </span>-13ms<span class="o">[</span><span class="w">  </span>-13ms<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>190ms
^+<span class="w"> </span>ohio.time.system76.com<span class="w">        </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">377</span><span class="w">    </span><span class="m">21</span><span class="w">    </span>+23ms<span class="o">[</span><span class="w">  </span>+23ms<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>171ms
^+<span class="w"> </span>oregon.time.system76.com<span class="w">      </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">377</span><span class="w">    </span><span class="m">23</span><span class="w">    </span>+22ms<span class="o">[</span><span class="w">  </span>+26ms<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>217ms
^*<span class="w"> </span>paris.time.system76.com<span class="w">       </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">377</span><span class="w">    </span><span class="m">24</span><span class="w">  </span>-4880us<span class="o">[</span>-1560us<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>109ms
^+<span class="w"> </span>virginia.time.system76.c&gt;<span class="w">     </span><span class="m">2</span><span class="w">   </span><span class="m">7</span><span class="w">   </span><span class="m">163</span><span class="w">    </span><span class="m">19</span><span class="w">  </span>+5465us<span class="o">[</span>+5465us<span class="o">]</span><span class="w"> </span>+/-<span class="w">  </span>148ms

chronyc&gt;<span class="w"> </span><span class="nb">exit</span>
$<span class="w"> </span>sudo<span class="w"> </span>chronyc<span class="w"> </span>makestep
<span class="m">200</span><span class="w"> </span>OK
</code></pre></div>

<p><code>chrnoyc</code> connects to the chrony service using TCP or Unix sockets. Therefore, it is possible to use a local <code>chronyc</code> to connect to remote <code>chrony</code> and issue commands, although in this case you are limited to mainly monitoring commands for security reasons.</p>
                                            <br clear="both" />
                                            <h1>108.2 System logging</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to configure rsyslog. This objective also includes configuring the logging daemon to send log output to a central log server or accept log output as a central log server. Use of the systemd journal subsystem is covered. Also, awareness of syslog and syslog-ng as alternative logging systems is included.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Basic configuration of rsyslog.</li>
<li>Understanding of standard facilities, priorities and actions.</li>
<li>Query the systemd journal.</li>
<li>Filter systemd journal data by criteria such as date, service or priority.</li>
<li>Configure persistent systemd journal storage and journal size.</li>
<li>Delete old systemd journal data.</li>
<li>Retrieve systemd journal data from a rescue system or file system copy.</li>
<li>Understand interaction of rsyslog with systemd-journald.</li>
<li>Configuration of logrotate.</li>
<li>Awareness of syslog and syslog-ng.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/rsyslog.conf</code></li>
<li><code>/var/log/</code></li>
<li><code>logger</code></li>
<li><code>logrotate</code></li>
<li><code>/etc/logrotate.conf</code></li>
<li><code>/etc/logrotate.d/</code></li>
<li><code>journalctl</code></li>
<li><code>systemd-cat</code></li>
<li><code>/etc/systemd/journald.conf</code></li>
<li><code>/var/log/journal/</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/qtHTf6q_UaI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>History</h3>
<p>Logs are an important part of Unix philosophy and design. The Kernel, services, programs and most events (let it be a crash or a login attempt) will generate logs. These logs can be examines / monitored to gain insights about the system and its status. If you watch a Linux guy on a windows machine for 1 hour, you will hear "where are the logs?". </p>
<p>If every single program tries to handle its own logs we will face 2 issues (at least!); 1. programming will be difficult because you need to invent (or import) the wheel and 2. different programmers will generate different kinds, formats and location for their logs and it will be difficult to keep them  under your control. To overcome this, Unix world had its own solution: central logging service.</p>
<p>The older utility to manage logs was called <code>syslog</code>, then we had <code>syslog-ng</code> (new-generation) and later <code>rsyslog</code> which is what most distros were using till a couple of years ago. <code>rsyslog</code> is still present and is part of the GNU/Linux universe. It can receive logs from different programs (even over network) and save them in different places (files or files in network or even run some actions on them). It's logs are saved in the text format and can be managed by the tool of your choice, let it be <code>grep</code>, <code>less</code>, <code>tail</code>, <code>zless</code> (less a compressed file without explicitly opening it), <code>zcat</code> (catting a file without explicitly opening it), <code>grep</code>, ....</p>
<p>But these days <code>systemd</code> is conquering most of the linux world and logs are not an exception. SystemDs logging service is called <code>journald</code> and we use the <code>journalctl</code>  command to read its logs; unfortunately they are not text files anymore.</p>
<p>You should also know about a couple of other tools (like <code>logrotate</code> to cleanup the older logs) and be familiar with some of more important system logs under GNU/Linux. So lets start.</p>
<blockquote>
<p>Its fun to know how the logs work in more depth. Here it is: whoever wants to log something eventually sends its messages to the <code>/dev/log</code> or  <code>/dev/kmsg</code> devices (often by using a helper tool). The logging tool (say <code>rsyslog</code>) will read from these devices and process the logs based on its configs; and now, the messages are logs!</p>
</blockquote>
<h2>dmesg</h2>
<p>As I told you, Linux loves logs and will be happy logging everything. But what about the boot process? What happens if the kernel wants to log something before the disks are ready? These logs are saved by the Kernel in the <em>Kernel Ring Buffer</em>. You can access it using the <code>dmesg</code> command. </p>
<h2>log rotation</h2>
<p>So logs are being generated and saved! Someone need to clean them up to prevent the disk from getting full. The <code>logrotate</code> utility takes care of this task.  The main configuration is at <code>/etc/logrotate.conf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@debian</span><span class="err">:#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">logrotate</span><span class="p">.</span><span class="n">conf</span>
<span class="err">#</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="ss">&quot;man logrotate&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span>

<span class="err">#</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">preceding</span><span class="w"> </span><span class="k">include</span><span class="w"> </span><span class="n">directives</span>

<span class="err">#</span><span class="w"> </span><span class="n">rotate</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">weekly</span>
<span class="n">weekly</span>

<span class="err">#</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">weeks</span><span class="w"> </span><span class="n">worth</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">backlogs</span>
<span class="n">rotate</span><span class="w"> </span><span class="mi">4</span>

<span class="err">#</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="n">empty</span><span class="p">)</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">rotating</span><span class="w"> </span><span class="k">old</span><span class="w"> </span><span class="n">ones</span>
<span class="k">create</span>

<span class="err">#</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="nc">date</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">suffix</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rotated</span><span class="w"> </span><span class="k">file</span>
<span class="n">#dateext</span>

<span class="err">#</span><span class="w"> </span><span class="n">uncomment</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">compressed</span>
<span class="n">#compress</span>

<span class="err">#</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="k">drop</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="n">rotation</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directory</span>
<span class="k">include</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">logrotate</span><span class="p">.</span><span class="n">d</span>

<span class="err">#</span><span class="w"> </span><span class="k">system</span><span class="o">-</span><span class="k">specific</span><span class="w"> </span><span class="n">logs</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">here</span><span class="p">.</span>
</code></pre></div>

<p>and specific services do create their logs in <code>/etc/logrotate.d/</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="c1"># cat /etc/logrotate.d/apt</span>
<span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">term</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">rotate</span><span class="w"> </span><span class="mi">12</span>
<span class="w">  </span><span class="n">monthly</span>
<span class="w">  </span><span class="n">compress</span>
<span class="w">  </span><span class="n">missingok</span>
<span class="w">  </span><span class="n">notifempty</span>
<span class="p">}</span>

<span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">history</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">rotate</span><span class="w"> </span><span class="mi">12</span>
<span class="w">  </span><span class="n">monthly</span>
<span class="w">  </span><span class="n">compress</span>
<span class="w">  </span><span class="n">missingok</span>
<span class="w">  </span><span class="n">notifempty</span>
<span class="p">}</span>
</code></pre></div>

<p>These are the meaning of some of these parameters:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">parameter</th>
<th style="text-align: center;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">weekly</td>
<td style="text-align: center;">rotate logs weekly</td>
</tr>
<tr>
<td style="text-align: center;">missingok</td>
<td style="text-align: center;">it is fine if there is no log for this week</td>
</tr>
<tr>
<td style="text-align: center;">rotate 52</td>
<td style="text-align: center;">keep the latest 52 logs and delete the older ones</td>
</tr>
<tr>
<td style="text-align: center;">compress</td>
<td style="text-align: center;">compress the logs</td>
</tr>
<tr>
<td style="text-align: center;">create 0640 www-data adm</td>
<td style="text-align: center;">create the files with this access and owners</td>
</tr>
<tr>
<td style="text-align: center;">pre &amp; post rotate</td>
<td style="text-align: center;">run these scripts or commands before and after the rotation</td>
</tr>
</tbody>
</table>
<p>This above configuration will create a zipped file for each week, keeping only 52 of them instead of a huge log file for this program.</p>
<p>The <code>logrotate</code> runs using crons and does its job on a daily basis based on a configuration on <code>/etc/cron.daily/logrotate</code></p>
<h2>some famous log files</h2>
<p>Generally logs are saved at <code>/var/log</code>. In case of any issue and if you do not know what to do, it is a common practice to run a <code>ls -ltrh /var/log/</code> to see if any program generated a new log or not.</p>
<p>But lets have a look at some of the famous logs:</p>
<h5><code>/var/log/auth.log</code> (in Debian Based)</h5>
<p>Authentication processes will log here. Things like <code>cron</code> jobs, failed logins, <code>sudo</code> informations, ...</p>
<h5><code>/var/log/syslog</code></h5>
<p>A centralized place most of the logs received by <code>rsyslogd</code> if a specific logfile is not provided in <code>/etc/rsyslog.conf</code></p>
<h5><code>/var/log/debug</code></h5>
<p>Debug information from programs.</p>
<h5><code>/var/log/kern.log</code></h5>
<p>Kernel messages.</p>
<h5><code>/var/log/messages</code></h5>
<p>Informative messages from services. This is also the default place for logs for remote clients.</p>
<h5><code>/var/run/utmp</code> &amp; <code>/var/log/wtmp</code></h5>
<p>Successful logins.</p>
<h5><code>/var/log/btmp</code></h5>
<p>Failed logins. You can check this to see if anyone is trying to guess your passwords!</p>
<h5><code>/var/log/faillog</code></h5>
<p>Failed authentication attempts.</p>
<h5><code>/var/log/lastlog</code></h5>
<p>Date and time of recent user logins.</p>
<h5>Service logs</h5>
<p>Service logs do create files or directories at <code>/var/log</code> and update their logs there. For example there might be a <code>/var/log/apache2/</code> (or <code>/var/log/httpd</code>) for the Apache HTTP server or a <code>/var/log/mysql</code> for the MySQL DB.</p>
<h2>rsyslog</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xliHONdwFy0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>This is the newer generation of syslogs and is used in many environments. Its main configuration is located at <code>/etc/rsyslog.conf</code> and it also reads anything in <code>/etc/rssylog.d/</code> directory. Its configuration consists of 3 main sections: </p>
<ol>
<li><code>MODULES</code>, modules used. For example to let the rsyslog use UDP connections</li>
<li><code>GLOBAL DIRECTIVES</code>, general configurations like directories accesses</li>
<li><code>RULES</code>, A combination of <em>facilities</em>, <em>priorities</em> and <em>actions</em> tells the <code>rsyslog</code> what to do with each log.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># cat /etc/rsyslog.conf</span>
<span class="c1"># /etc/rsyslog.conf configuration file for rsyslog</span>
<span class="c1">#</span>
<span class="c1"># For more information install rsyslog-doc and see</span>
<span class="c1"># /usr/share/doc/rsyslog-doc/html/configuration/index.html</span>


<span class="c1">#################</span>
<span class="c1">#### MODULES ####</span>
<span class="c1">#################</span>

<span class="n">module</span><span class="p">(</span><span class="nb">load</span><span class="o">=</span><span class="s2">&quot;imuxsock&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># provides support for local system logging</span>
<span class="n">module</span><span class="p">(</span><span class="nb">load</span><span class="o">=</span><span class="s2">&quot;imklog&quot;</span><span class="p">)</span><span class="w">   </span><span class="c1"># provides kernel logging support</span>
<span class="c1">#module(load=&quot;immark&quot;)  # provides --MARK-- message capability</span>

<span class="c1"># provides UDP syslog reception</span>
<span class="c1">#module(load=&quot;imudp&quot;)</span>
<span class="c1">#input(type=&quot;imudp&quot; port=&quot;514&quot;)</span>

<span class="c1"># provides TCP syslog reception</span>
<span class="c1">#module(load=&quot;imtcp&quot;)</span>
<span class="c1">#input(type=&quot;imtcp&quot; port=&quot;514&quot;)</span>


<span class="c1">###########################</span>
<span class="c1">#### GLOBAL DIRECTIVES ####</span>
<span class="c1">###########################</span>

<span class="c1">#</span>
<span class="c1"># Set the default permissions for all log files.</span>
<span class="c1">#</span>
<span class="o">$</span><span class="n">FileOwner</span><span class="w"> </span><span class="n">root</span>
<span class="o">$</span><span class="n">FileGroup</span><span class="w"> </span><span class="n">adm</span>
<span class="o">$</span><span class="n">FileCreateMode</span><span class="w"> </span><span class="mi">0640</span>
<span class="o">$</span><span class="n">DirCreateMode</span><span class="w"> </span><span class="mi">0755</span>
<span class="o">$</span><span class="n">Umask</span><span class="w"> </span><span class="mi">0022</span>

<span class="c1">#</span>
<span class="c1"># Where to place spool and state files</span>
<span class="c1">#</span>
<span class="o">$</span><span class="n">WorkDirectory</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">rsyslog</span>

<span class="c1">#</span>
<span class="c1"># Include all config files in /etc/rsyslog.d/</span>
<span class="c1">#</span>
<span class="o">$</span><span class="n">IncludeConfig</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rsyslog</span><span class="o">.</span><span class="n">d</span><span class="o">/*.</span><span class="n">conf</span>


<span class="c1">###############</span>
<span class="c1">#### RULES ####</span>
<span class="c1">###############</span>

<span class="c1">#</span>
<span class="c1"># Log anything besides private authentication messages to a single log file</span>
<span class="c1">#</span>
<span class="o">*.*</span><span class="p">;</span><span class="n">auth</span><span class="p">,</span><span class="n">authpriv</span><span class="o">.</span><span class="n">none</span><span class="w">      </span><span class="o">-/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">syslog</span>

<span class="c1">#</span>
<span class="c1"># Log commonly used facilities to their own log file</span>
<span class="c1">#</span>
<span class="n">auth</span><span class="p">,</span><span class="n">authpriv</span><span class="o">.*</span><span class="w">         </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">log</span>
<span class="n">cron</span><span class="o">.*</span><span class="w">              </span><span class="o">-/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">log</span>
<span class="n">kern</span><span class="o">.*</span><span class="w">              </span><span class="o">-/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">kern</span><span class="o">.</span><span class="n">log</span>
<span class="n">mail</span><span class="o">.*</span><span class="w">              </span><span class="o">-/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">mail</span><span class="o">.</span><span class="n">log</span>
<span class="n">user</span><span class="o">.*</span><span class="w">              </span><span class="o">-/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">user</span><span class="o">.</span><span class="n">log</span>

<span class="c1">#</span>
<span class="c1"># Emergencies are sent to everybody logged in.</span>
<span class="c1">#</span>
<span class="o">*.</span><span class="n">emerg</span><span class="w">             </span><span class="p">:</span><span class="n">omusrmsg</span><span class="p">:</span><span class="o">*</span>
</code></pre></div>

<p>As you can see <strong>facilities</strong> could be things like:</p>
<blockquote>
<p><code>kern</code>, <code>user</code>, <code>mail</code>, <code>daemon</code>, <code>cron</code>, <code>auth</code>, <code>ntp</code>, <code>security</code>, <code>console</code>, <code>syslog</code>, ... </p>
</blockquote>
<p>The <strong>priority</strong> could be one of the below:</p>
<blockquote>
<p><code>emerg</code>/<code>panic</code>, <code>alert</code>, <code>crit</code>, <code>err</code>/<code>error</code>, <code>warn</code>/<code>warning</code>, <code>notice</code>, <code>info</code> or <code>debug</code>. </p>
</blockquote>
<p>On the <strong>action</strong> part we can have things like these:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">action</th>
<th style="text-align: center;">sample</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">filename</td>
<td style="text-align: center;">/usr/log/logins.log</td>
<td style="text-align: left;">will write the log to this file</td>
</tr>
<tr>
<td style="text-align: center;">username</td>
<td style="text-align: center;">jadi</td>
<td style="text-align: left;">will notify that person on the screen</td>
</tr>
<tr>
<td style="text-align: center;">@ip</td>
<td style="text-align: center;">@192.168.1.100</td>
<td style="text-align: left;">will send this log to this log server and that log server will decide what to do with it based on its configs</td>
</tr>
</tbody>
</table>
<p>So a line like this will show the kernel panics to a remote log server and also will log everything on every level to a log file:</p>
<div class="highlight"><pre><span></span><code>kern.panic      @192.168.1.100
*.*             /var/log/messages
</code></pre></div>

<p>If you log some specific priority, all the <strong>more important</strong> things will be logged too! So if you write <code>cron.notice /var/log/cron/cron.log</code>, you are logging the <code>emerg/panic</code>, <code>alert</code>, <code>critical</code>, <code>error</code>, <code>warning</code> and <code>notice</code> logs of the cron category too.</p>
<p>Priority Levels (According to Syslog(3) and logger manpage):</p>
<div class="highlight"><pre><span></span><code>       This determines the importance of the message.  The levels are, in order of decreasing importance:

       emerge      system is unusable

       alert      action must be taken immediately

       crit       critical conditions

       error        error conditions

       warning    warning conditions

       notice     normal, but significant, condition

       info       informational message

       debug      debug-level message


       panic      deprecated synonym for emerg
       error      deprecated synonym for err
       warn       deprecated synonym for warning
</code></pre></div>

<blockquote>
<p>If you need to log ONLY one specific level, add an equal sign (=) before the priority like this <code>local3.=alert /var/log/user.alert.log</code>.</p>
</blockquote>
<p>It is important to know that the binary which logs the <em>*kern</em> category is a standalone daemon. This daemon is called <code>klogd</code> and uses same configuration files. Why? so even after everything is crashed, <code>klogd</code> will be able to log the kernel's crashes ;).</p>
<h3>logger</h3>
<p>If you need to send something toward the <code>rsyslog</code>, you can use the <code>logger</code> tool. </p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="c1"># logger Testing my lovely tool</span>
<span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="c1"># logger local1.emerg Nothing emergent for sure</span>
<span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="c1"># tail -3 /var/log/syslog</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span><span class="n">T06</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mf">01.325358</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">CRON</span><span class="p">[</span><span class="mi">914</span><span class="p">]:</span><span class="w"> </span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">CMD</span><span class="w"> </span><span class="p">(</span><span class="n">command</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">debian</span><span class="o">-</span><span class="n">sa1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="nb nb-Type">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">debian</span><span class="o">-</span><span class="n">sa1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span><span class="n">T06</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mf">27.671410</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">root</span><span class="p">:</span><span class="w"> </span><span class="n">Testing</span><span class="w"> </span><span class="n">my</span><span class="w"> </span><span class="n">lovely</span><span class="w"> </span><span class="k">tool</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span><span class="n">T06</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mf">45.795158</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">root</span><span class="p">:</span><span class="w"> </span><span class="n">local1</span><span class="o">.</span><span class="n">emerg</span><span class="w"> </span><span class="n">Nothing</span><span class="w"> </span><span class="n">emergent</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sure</span>
</code></pre></div>

<h2>journald</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/jXO7q_7a6-s" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>You have seen the <code>systemd</code> in various parts of this course. We have seen how it is part of the init process and how it handles the services and timers. All of these activities (and other logs reaching system journalying system) are logged in binary files, readable using <code>journalctl</code> which is part of the <code>systemd-journald</code> utility.</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># systemctl status systemd-journald</span>
<span class="err">●</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">.</span><span class="n">service</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="n">Service</span>
<span class="w">     </span><span class="n">Loaded</span><span class="p">:</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">.</span><span class="n">service</span><span class="p">;</span><span class="w"> </span><span class="k">static</span><span class="p">)</span>
<span class="w">     </span><span class="n">Active</span><span class="p">:</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="p">(</span><span class="n">running</span><span class="p">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">Fri</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">50</span><span class="w"> </span><span class="n">EDT</span><span class="p">;</span><span class="w"> </span><span class="mi">52</span><span class="nb">min</span><span class="w"> </span><span class="n">ago</span>
<span class="n">TriggeredBy</span><span class="p">:</span><span class="w"> </span><span class="err">●</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">-</span><span class="n">dev</span><span class="o">-</span><span class="nb">log</span><span class="o">.</span><span class="n">socket</span>
<span class="w">             </span><span class="err">●</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">-</span><span class="n">audit</span><span class="o">.</span><span class="n">socket</span>
<span class="w">             </span><span class="err">●</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">.</span><span class="n">socket</span>
<span class="w">       </span><span class="n">Docs</span><span class="p">:</span><span class="w"> </span><span class="n">man</span><span class="p">:</span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w">             </span><span class="n">man</span><span class="p">:</span><span class="n">journald</span><span class="o">.</span><span class="n">conf</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">   </span><span class="n">Main</span><span class="w"> </span><span class="n">PID</span><span class="p">:</span><span class="w"> </span><span class="mi">261</span><span class="w"> </span><span class="p">(</span><span class="n">systemd</span><span class="o">-</span><span class="n">journal</span><span class="p">)</span>
<span class="w">     </span><span class="n">Status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Processing requests...&quot;</span>
<span class="w">      </span><span class="n">Tasks</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">4583</span><span class="p">)</span>
<span class="w">     </span><span class="n">Memory</span><span class="p">:</span><span class="w"> </span><span class="mf">17.1</span><span class="n">M</span>
<span class="w">        </span><span class="n">CPU</span><span class="p">:</span><span class="w"> </span><span class="mi">138</span><span class="n">ms</span>
<span class="w">     </span><span class="n">CGroup</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">system</span><span class="o">.</span><span class="n">slice</span><span class="o">/</span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="o">.</span><span class="n">service</span>
<span class="w">             </span><span class="err">└─</span><span class="mi">261</span><span class="w"> </span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span>

<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">50</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="p">[</span><span class="mi">261</span><span class="p">]:</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="n">started</span>
<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">50</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="p">[</span><span class="mi">261</span><span class="p">]:</span><span class="w"> </span><span class="n">Runtime</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span><span class="n">ec22e43962c64359b9b25cfa650b025b</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mf">4.9</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="w"> </span><span class="mf">39.1</span><span class="n">M</span><span class="p">,</span><span class="o">&gt;</span>
<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">50</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="p">[</span><span class="mi">261</span><span class="p">]:</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">flushing</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span><span class="n">ec22e43962c64359b9b25cfa650b025b</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mf">23.816</span><span class="n">ms</span><span class="o">&gt;</span>
<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">50</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="p">[</span><span class="mi">261</span><span class="p">]:</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span><span class="n">ec22e43962c64359b9b25cfa650b025b</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mf">28.2</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="nb">max</span><span class="w"> </span><span class="mf">4.0</span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="o">&gt;</span>
<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">05</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">50</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">journald</span><span class="p">[</span><span class="mi">261</span><span class="p">]:</span><span class="w"> </span><span class="n">Received</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">flush</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="n">journal</span><span class="o">.</span>
<span class="n">Notice</span><span class="p">:</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">rotated</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">started</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">incomplete</span><span class="o">.</span>
</code></pre></div>

<p>and here is the configuration file:</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">journald</span><span class="p">.</span><span class="n">conf</span>
<span class="err">#</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">systemd</span><span class="p">.</span>
<span class="err">#</span>
<span class="err">#</span><span class="w">  </span><span class="n">systemd</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">free</span><span class="w"> </span><span class="n">software</span><span class="p">;</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">redistribute</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="k">modify</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">under</span><span class="w"> </span><span class="n">the</span>
<span class="err">#</span><span class="w">  </span><span class="n">terms</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GNU</span><span class="w"> </span><span class="n">Lesser</span><span class="w"> </span><span class="k">General</span><span class="w"> </span><span class="k">Public</span><span class="w"> </span><span class="n">License</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">published</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">Free</span>
<span class="err">#</span><span class="w">  </span><span class="n">Software</span><span class="w"> </span><span class="n">Foundation</span><span class="p">;</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">2.1</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">License</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="p">(</span><span class="k">at</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="k">option</span><span class="p">)</span>
<span class="err">#</span><span class="w">  </span><span class="ow">any</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">version</span><span class="p">.</span>
<span class="err">#</span>
<span class="err">#</span><span class="w"> </span><span class="n">Entries</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">defaults</span><span class="p">.</span><span class="w"> </span><span class="k">Local</span><span class="w"> </span><span class="n">configuration</span>
<span class="err">#</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">modifying</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">file</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="ss">&quot;drop-ins&quot;</span><span class="w"> </span><span class="ow">in</span>
<span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">journald</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="w"> </span><span class="n">subdirectory</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">generally</span><span class="w"> </span><span class="n">recommended</span><span class="p">.</span>
<span class="err">#</span><span class="w"> </span><span class="n">Defaults</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">restored</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simply</span><span class="w"> </span><span class="n">deleting</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="k">drop</span><span class="o">-</span><span class="n">ins</span><span class="p">.</span>
<span class="err">#</span>
<span class="err">#</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="s1">&#39;systemd-analyze cat-config systemd/journald.conf&#39;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="n">config</span><span class="p">.</span>
<span class="err">#</span>
<span class="err">#</span><span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">journald</span><span class="p">.</span><span class="n">conf</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="p">.</span>

<span class="o">[</span><span class="n">Journal</span><span class="o">]</span>
<span class="n">#Storage</span><span class="o">=</span><span class="n">auto</span>
<span class="n">#Compress</span><span class="o">=</span><span class="n">yes</span>
<span class="n">#Seal</span><span class="o">=</span><span class="n">yes</span>
<span class="n">#SplitMode</span><span class="o">=</span><span class="n">uid</span>
<span class="n">#SyncIntervalSec</span><span class="o">=</span><span class="mi">5</span><span class="n">m</span>
<span class="n">#RateLimitIntervalSec</span><span class="o">=</span><span class="mi">30</span><span class="n">s</span>
<span class="n">#RateLimitBurst</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">#SystemMaxUse</span><span class="o">=</span>
<span class="n">#SystemKeepFree</span><span class="o">=</span>
<span class="n">#SystemMaxFileSize</span><span class="o">=</span>
<span class="n">#SystemMaxFiles</span><span class="o">=</span><span class="mi">100</span>
<span class="n">#RuntimeMaxUse</span><span class="o">=</span>
<span class="n">#RuntimeKeepFree</span><span class="o">=</span>
<span class="n">#RuntimeMaxFileSize</span><span class="o">=</span>
<span class="n">#RuntimeMaxFiles</span><span class="o">=</span><span class="mi">100</span>
<span class="n">#MaxRetentionSec</span><span class="o">=</span>
<span class="n">#MaxFileSec</span><span class="o">=</span><span class="mi">1</span><span class="nf">month</span>
<span class="n">#ForwardToSyslog</span><span class="o">=</span><span class="n">yes</span>
<span class="n">#ForwardToKMsg</span><span class="o">=</span><span class="k">no</span>
<span class="n">#ForwardToConsole</span><span class="o">=</span><span class="k">no</span>
<span class="n">#ForwardToWall</span><span class="o">=</span><span class="n">yes</span>
<span class="n">#TTYPath</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">console</span>
<span class="n">#MaxLevelStore</span><span class="o">=</span><span class="n">debug</span>
<span class="n">#MaxLevelSyslog</span><span class="o">=</span><span class="n">debug</span>
<span class="n">#MaxLevelKMsg</span><span class="o">=</span><span class="n">notice</span>
<span class="n">#MaxLevelConsole</span><span class="o">=</span><span class="n">info</span>
<span class="n">#MaxLevelWall</span><span class="o">=</span><span class="n">emerg</span>
<span class="n">#LineMax</span><span class="o">=</span><span class="mi">48</span><span class="n">K</span>
<span class="n">#ReadKMsg</span><span class="o">=</span><span class="n">yes</span>
<span class="n">#Audit</span><span class="o">=</span><span class="k">no</span>
</code></pre></div>

<h3>querying journal contents</h3>
<p>If you run the <code>journalctl</code> you will get all the logs... too much. So there are some useful switches:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Switch</th>
<th style="text-align: center;">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">-r</td>
<td style="text-align: center;">show in reverse; newer on top</td>
</tr>
<tr>
<td style="text-align: center;">-f</td>
<td style="text-align: center;">keep showing the tail</td>
</tr>
<tr>
<td style="text-align: center;">-e</td>
<td style="text-align: center;">show and go to the end</td>
</tr>
<tr>
<td style="text-align: center;">-n</td>
<td style="text-align: center;">show this many lines from the end (newest ones)</td>
</tr>
<tr>
<td style="text-align: center;">-k</td>
<td style="text-align: center;">show kernel message (equal to <code>dmesg</code>)</td>
</tr>
<tr>
<td style="text-align: center;">-b</td>
<td style="text-align: center;">show from a specific boot, -1 is the previous one, 0 is the current one. You can check the list using <code>--list-boots</code></td>
</tr>
<tr>
<td style="text-align: center;">-p</td>
<td style="text-align: center;">from specific priority, say <code>-p err</code></td>
</tr>
<tr>
<td style="text-align: center;">-u</td>
<td style="text-align: center;">from a specific systemd unit</td>
</tr>
</tbody>
</table>
<p>You can also use the <code>--since</code> and <code>--until</code> to show a specific time range, It is possible to provide time as <code>YYYY-MM-DD HH:MM:SS</code> or use things like <code>yesterday</code>, <code>today</code>, <code>tomorrow</code>, <code>now</code> or even <code>--since "10 minutes ago"</code> which is equals to <code>--since "-2 minutes"</code>.</p>
<blockquote>
<p>If there are too many lines, push <code>&gt;</code> to jump to the end (or <code>&lt;</code> to go to the beginning)</p>
</blockquote>
<p>You can also add the name of the program to the command to see the logs from that specific program; say <code>journalctl /usr/bin/xrdp</code> or use some fields like <code>PRIORITY=</code>, <code>_PID=</code> and provide values.</p>
<h3>systemd-cat</h3>
<p>This tools is used when you want to manually send logs to the journaling system. It sends its input to the journal or if provided, runs the command and sends the result to the journal.</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># echo &quot;This is my first test&quot; | systemd-cat</span>
<span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># systemd-cat -p info uptime #sending priority too</span>
<span class="n">root</span><span class="err">@</span><span class="n">debian</span><span class="p">:</span><span class="o">~</span><span class="c1"># journalctl -n 3</span>
<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">06</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">01</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="w"> </span><span class="n">Finished</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">daily</span><span class="o">.</span><span class="n">service</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Daily</span><span class="w"> </span><span class="n">apt</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">activities</span><span class="o">.</span>
<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">06</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">cat</span><span class="p">[</span><span class="mi">1020</span><span class="p">]:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">my</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">test</span>
<span class="n">Jun</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">06</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">48</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">uptime</span><span class="p">[</span><span class="mi">1022</span><span class="p">]:</span><span class="w">  </span><span class="mi">06</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">48</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">1</span><span class="p">:</span><span class="mi">05</span><span class="p">,</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="n">users</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span>
</code></pre></div>

<h2>managing storage</h2>
<p>The systemd journals can keep their logs in memeory or write them to the disk or drop all the logs. This is determined by the configurations in <code>/etc/systemd/journald.conf</code>. But the default behaviour is as follow:</p>
<ol>
<li>The system checks the <code>/var/log/journal</code>. If this directory, exists logs will be saved in a directory inside this. The name of the directory will be decided by looking at <code>/etc/machine-id</code></li>
<li>If the <code>/var/log/journal</code> is not there, the logs will be saved in memory at <code>/run/log/jouranl</code> and in the directory decided by <code>/etc/machine-id</code>.</li>
</ol>
<p>But you can overcome these configs by the following sections:</p>
<div class="highlight"><pre><span></span><code><span class="nv">Storage</span><span class="o">=</span><span class="nv">volatile</span><span class="w">     </span>#<span class="w"> </span><span class="nv">keep</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">logs</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">memory</span>
<span class="nv">Storage</span><span class="o">=</span><span class="nv">persistent</span><span class="w">   </span>#<span class="w"> </span><span class="nv">keep</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">disk</span>,<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">needed</span><span class="w"> </span><span class="nv">create</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">directories</span>
<span class="nv">Storage</span><span class="o">=</span><span class="nv">auto</span><span class="w">         </span>#<span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">write</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">disk</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">directory</span><span class="w"> </span><span class="nv">exists</span>
<span class="nv">Storage</span><span class="o">=</span><span class="nv">none</span><span class="w">         </span>#<span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">keep</span><span class="w"> </span><span class="nv">logs</span>
</code></pre></div>

<p>If the logs are being written to disk, these variable will manage the disk usage:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Variable Name</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">SystemMaxUse</td>
<td>The Maximum disk usage, say 500M. The default is on <code>10%</code></td>
</tr>
<tr>
<td style="text-align: center;">SystemKeepFree</td>
<td>Keep at least this much free, say 1G. The default is 15%</td>
</tr>
<tr>
<td style="text-align: center;">SystemMaxFileSize</td>
<td>Maximum size of each individual file. The default is 1/8 of SystemMaxUse</td>
</tr>
<tr>
<td style="text-align: center;">SystemMaxFiles</td>
<td>Max number of non-currently-active files. The default is 100</td>
</tr>
</tbody>
</table>
<p>If you are keeping the logs in <strong>memory</strong>, the equivalent variables are <code>RuntimeMaxUse</code>, <code>RuntimeKeepFree</code>, <code>RuntimeMaxFileSize</code>, &amp; <code>RuntimeMaxFiles</code>.  </p>
<p>In case you need to do the clean-up manually (with the help of systemd tools for sure), you can run <code>journalctl</code> with these switches:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Switch</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">--vacuum-time</td>
<td>clean everything older than this. for example <code>--vacuum-time=3months</code> clean anything older than 3 months. You can use <code>s</code>, <code>m</code>, <code>h</code> for seconds, minutes and days and <code>d</code>/<code>days</code>, <code>months</code>, <code>weeks</code>/<code>w</code> and <code>years</code>/<code>y</code>.</td>
</tr>
<tr>
<td style="text-align: center;">--vacuum-size</td>
<td>eliminate till logs occupy a specific size; say 1G</td>
</tr>
<tr>
<td style="text-align: center;">--vacuum-files</td>
<td>Only keep this much archive files</td>
</tr>
</tbody>
</table>
<h3>checking logs from a recovered system</h3>
<p>If you have a crashed / non-booting system, you can still examine its logs; if the files are there. As you know the files are in <code>/var/log/journal/{mchine-id}</code> where machine-id is in <code>/etc/machine-id</code> of the crashed machine. </p>
<p>You can move these files to a directory after booting the crashed machine with a live linux or mount its hard on another machine or even examine them in place. The <code>-D</code> (or <code>--directory</code>) switch of <code>journalctl</code> indicates the location of the journal files. So if your crashed machine id is <code>ec22e43962c64359b9b25cfa650b025b</code> and you've mounted its <code>/var/</code> under your <code>/mnt/var/</code> directory, you can issue this command to read its logs and see what had happened:</p>
<div class="highlight"><pre><span></span><code><span class="n">journalctl</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="o">=/</span><span class="n">mnt</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">journal</span><span class="o">/</span><span class="n">ec22e43962c64359b9b25cfa650b025b</span><span class="o">/</span>
</code></pre></div>

<p>You can also use the <code>--merge</code> switch to merge these logs into your machine or use <code>--file</code> to check only one specific journal file. Lastly if the exact location of journal files are not known, you can use <code>--root /mnt</code> and tell the <code>journalctl</code> to search there for journal files.</p>
                                            <br clear="both" />
                                            <h1>108.3 Mail Transfer Agent (MTA) basics</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should be aware of the commonly available MTA programs and be able to perform basic forward and alias configuration on a client host. Other configuration files are not covered.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Create e-mail aliases.</li>
<li>Configure e-mail forwarding.</li>
<li>Knowledge of commonly available MTA programs (<code>postfix</code>, <code>sendmail</code>, <code>exim</code>) (no configuration)</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>~/.forward</code></li>
<li>sendmail emulation layer commands</li>
<li><code>newaliases</code></li>
<li><code>mail</code></li>
<li><code>mailq</code></li>
<li><code>postfix</code></li>
<li><code>sendmail</code></li>
<li><code>exim</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/0Uh7jUFQAWs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>MTAs</h3>
<p>Email is an integral part of many GNU/Linux and Unix systems. Each user do have a mail box and can send / receive email to other local users. This is done via MTAs (Mai Transfer Agents). In other words, MTAs are programs which handle emails in your operating system. They can receive and dispatch emails locally and over the network. There are different options for MTAs. In this section we will do a quick review on them and you will see how you can send emails to other uses (or over the internet) and how you can check your local mails.</p>
<h4>sendmail</h4>
<p>Is one of the oldest options available. It is huge and kind of difficult to configure and not that security oriented. Because of these, few systems use it as default their MTA.</p>
<h4>exim</h4>
<p>It aims to be a general and flexible mailer with extensive facilities for checking incoming e-mail. It is feature rich with ACLs, authentication and many other features.</p>
<h4>postfix</h4>
<p>This is a new alternative to <code>sendmail</code> and uses easy to understand configuration files. It supports multiple domains, encryption, etc. Postfix is what you see on most distros as the default MTA.</p>
<blockquote>
<p>Most desktop distros do not install MTAs by default. If you want, I suggest installing the <code>postfix</code> (and <code>mailx</code> or <code>bsd-mailx</code>) via your package manager.</p>
</blockquote>
<h3>sendmail emulation layer</h3>
<p>As you already know, <code>sendmail</code> is the oldest MTA alive and therefore, many other MTAs try to comply with it and has a <em>sendmail emulation layer</em> to keep themselves backward compatible with sendmail. Thats why you can type <code>sendmail</code> on whatever distro you are or use the <code>mailq</code> and check your mail regardless of your MTA choice.</p>
<h3>aliases</h3>
<p>There are some mail aliases on the system. Defined in <code>/etc/aliases</code>.</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/aliases
#
#  Aliases in this file will NOT be expanded in the header from
#  Mail, but WILL be visible over networks or from /bin/mail.
#
#       &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      The program &quot;newaliases&quot; must be run after
#       &gt;&gt; NOTE &gt;&gt;      this file is updated for any changes to
#       &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      show through to sendmail.
#

# Basic system aliases -- these MUST be present.
mailer-daemon:  postmaster
postmaster:     root

# General redirections for pseudo accounts.
bin:            root
daemon:         root
adm:            root
lp:             root
sync:           root
shutdown:       root
halt:           root
mail:           root
news:           root
uucp:           root
operator:       root
games:          root
www:            webmaster
webmaster:      root
[ .... ]
</code></pre></div>

<p>This tells the system if there is a message for <em>news</em>, it should be delivered to <em>root</em> and if the email is written to <em>www</em> it should be delivered to <em>webmaster</em>. </p>
<p>In case of any change in this file, you need to run the <code>newaliases</code> command.</p>
<h3>sending mail</h3>
<p>It is possible to send an email from the command line using the <code>mail</code> command:</p>
<div class="highlight"><pre><span></span><code>[jadi@funlife ~]$ mail news
Subject: Email to news user
hahah.. we know where this will go.
this will go to root and then to jadi!

Hi Jadi!

Cc:
[jadi@funlife ~]$ mail
Mail version 8.1.2 01/15/2001.  Type ? for help.
&quot;/var/mail/jadi&quot;: 12 messages 12 new
&gt;N  1 root@funlife       Sat Jan 02 08:50   39/1373  apt-listchanges: news for f
 N  2 root@funlife       Sat Jan 02 09:01  165/7438  apt-listchanges: news for f
 N  3 jadi@funlife       Sat Jan 02 19:58   18/640   *** SECURITY information fo
 N  4 jadi@funlife       Sat Jan 02 20:04   18/631   *** SECURITY information fo
 N  5 jadi@funlife       Sun Jan 03 10:15   18/664   *** SECURITY information fo
 N  6 root@funlife       Mon Jan 04 12:42   27/941   Cron &lt;jadi@funlife&gt; /home/j
 N  7 root@funlife       Mon Jan 04 17:11   26/845   apt-listchanges: news for f
 N  8 root@funlife       Tue Jan 05 18:42   27/945   Cron &lt;jadi@funlife&gt; /home/j
 N  9 root@funlife       Wed Jan 06 09:17   46/1788  apt-listchanges: news for f
 N 10 root@funlife       Thu Jan 07 12:42   27/945   Cron &lt;jadi@funlife&gt; /home/j
 N 11 root@funlife       Thu Jan 07 18:42   27/943   Cron &lt;jadi@funlife&gt; /home/j
 N 12 jadi@funlife       Thu Jan  7 19:53   17/478   Email to news user
&amp; 12
Message 12:
From jadi@funlife  Thu Jan  7 19:53:08 2016
X-Original-To: news
To: news@funlife
Subject: Email to news user
Date: Thu,  7 Jan 2016 19:53:08 +0330 (IRST)
From: jadi@funlife (jadi)

hahah.. we know where this will go.
this will go to root and then to jadi!

Hi Jadi!

&amp; d
&amp; q
Held 11 messages in /var/mail/jadi
</code></pre></div>

<h3>local forwards</h3>
<p>We saw that it is possible to forward emails using the <code>/etc/aliases</code>. That file is not writable by normal users so what a normal user like <em>jadi</em> should do?</p>
<p>Each user can create a <code>.forward</code> file in her own directory and all mail targeted to that user will be forwarded to that address.</p>
<blockquote>
<p>You can even put a complete email address like <code>jadijadi@gmail.com</code> in your <code>.forward</code> file.</p>
</blockquote>
<p>It also can send email from the command line or even within your scripts by issuing something like <code>echo -e "email content" | mail -s "email subject" "example@example.com"</code>.</p>
<h3>mailq</h3>
<p>This command lists the mail queue. Each entry shows the queue file ID, message size, arrival time, sender, and the recipients that still need to be delivered. If mail could not be delivered upon the last attempt, the reason for failure is shown. The sysadmin can use this command to check the status of emails still in the queues.</p>
<div class="highlight"><pre><span></span><code>$ mailq
-Queue ID- --Size-- ----Arrival Time---- -Sender/Recipient-------
AA52C228E6B      468 Thu Jan  7 19:59:41  jadi@funlife
(connect to alt2.gmail-smtp-in.l.google.com[2404:6800:4003:c01::1a]:25: Network is unreachable)
                                         jadijadi@gmail.com

-- 0 Kbytes in 1 Request.
</code></pre></div>
                                            <br clear="both" />
                                            <h1>108.4 Manage printers and printing</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Candidates should be able to manage print queues and user print jobs using CUPS and the LPD compatibility interface.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Basic CUPS configuration (for local and remote printers).</li>
<li>Manage user print queues.</li>
<li>Troubleshoot general printing problems.</li>
<li>Add and remove jobs from configured printer queues.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li>CUPS configuration files, tools and utilities</li>
<li><code>/etc/cups/</code></li>
<li>lpd legacy interface (lpr, lprm, lpq)</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8I9J0gsLe-U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>CUPS</h2>
<p>Most Linux distributions use the CUPS package for printing. You may need to install it via your package manager and start its service using the systemd or the init system your system use.</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">apt</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">cups</span>
<span class="o">[</span><span class="n">sudo</span><span class="o">]</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">jadi</span><span class="p">:</span>
<span class="n">Reading</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">lists</span><span class="p">...</span><span class="w"> </span><span class="n">Done</span>
<span class="n">Building</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="n">tree</span><span class="p">...</span><span class="w"> </span><span class="n">Done</span>
<span class="n">Reading</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="n">information</span><span class="p">...</span><span class="w"> </span><span class="n">Done</span>
<span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nl">installed</span><span class="p">:</span>
<span class="w">  </span><span class="n">acl</span><span class="w"> </span><span class="n">avahi</span><span class="o">-</span><span class="n">daemon</span><span class="w"> </span><span class="n">colord</span><span class="w"> </span><span class="n">colord</span><span class="o">-</span><span class="k">data</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">browsed</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">drivers</span>
<span class="w">  </span><span class="n">cups</span><span class="o">-</span><span class="n">daemon</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">filters</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">filters</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">drivers</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">ipp</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">ppdc</span>
<span class="w">  </span><span class="n">cups</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">droid</span><span class="o">-</span><span class="n">fallback</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">noto</span><span class="o">-</span><span class="n">mono</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">urw</span><span class="o">-</span><span class="n">base35</span><span class="w"> </span><span class="n">ghostscript</span>
<span class="w">  </span><span class="n">ipp</span><span class="o">-</span><span class="n">usb</span><span class="w"> </span><span class="n">libavahi</span><span class="o">-</span><span class="n">core7</span><span class="w"> </span><span class="n">libavahi</span><span class="o">-</span><span class="n">glib1</span><span class="w"> </span><span class="n">libcolorhug2</span><span class="w"> </span><span class="n">libcupsfilters1</span><span class="w"> </span><span class="n">libdaemon0</span><span class="w"> </span><span class="n">libexif12</span>
<span class="w">  </span><span class="n">libfontembed1</span><span class="w"> </span><span class="n">libgphoto2</span><span class="o">-</span><span class="mi">6</span><span class="w"> </span><span class="n">libgphoto2</span><span class="o">-</span><span class="n">l10n</span><span class="w"> </span><span class="n">libgphoto2</span><span class="o">-</span><span class="n">port12</span><span class="w"> </span><span class="n">libgs</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">libgs10</span>
<span class="w">  </span><span class="n">libgs10</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">libgusb2</span><span class="w"> </span><span class="n">libidn12</span><span class="w"> </span><span class="n">libieee1284</span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="n">libijs</span><span class="o">-</span><span class="mf">0.35</span><span class="w"> </span><span class="n">libjbig2dec0</span><span class="w"> </span><span class="n">libjson</span><span class="o">-</span><span class="n">glib</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mi">0</span>
<span class="w">  </span><span class="n">libjson</span><span class="o">-</span><span class="n">glib</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">liblouis</span><span class="o">-</span><span class="k">data</span><span class="w"> </span><span class="n">liblouis20</span><span class="w"> </span><span class="n">liblouisutdml</span><span class="o">-</span><span class="n">bin</span><span class="w"> </span><span class="n">liblouisutdml</span><span class="o">-</span><span class="k">data</span>
<span class="w">  </span><span class="n">liblouisutdml9</span><span class="w"> </span><span class="n">libltdl7</span><span class="w"> </span><span class="n">libnss</span><span class="o">-</span><span class="n">mdns</span><span class="w"> </span><span class="n">libpaper</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="n">libpaper1</span><span class="w"> </span><span class="n">libpoppler</span><span class="o">-</span><span class="n">cpp0v5</span>
<span class="w">  </span><span class="n">libpoppler</span><span class="o">-</span><span class="n">glib8</span><span class="w"> </span><span class="n">libpoppler126</span><span class="w"> </span><span class="n">libqpdf29</span><span class="w"> </span><span class="n">libsane</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">libsane1</span><span class="w"> </span><span class="n">libsnmp</span><span class="o">-</span><span class="n">base</span><span class="w"> </span><span class="n">libsnmp40</span>
<span class="w">  </span><span class="n">lynx</span><span class="w"> </span><span class="n">lynx</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">mailcap</span><span class="w"> </span><span class="n">poppler</span><span class="o">-</span><span class="k">data</span><span class="w"> </span><span class="n">poppler</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="n">sane</span><span class="o">-</span><span class="n">airscan</span><span class="w"> </span><span class="n">sane</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="k">update</span><span class="o">-</span><span class="n">inetd</span>
<span class="w">  </span><span class="n">usb</span><span class="p">.</span><span class="n">ids</span>
<span class="n">Suggested</span><span class="w"> </span><span class="nl">packages</span><span class="p">:</span>
<span class="w">  </span><span class="n">avahi</span><span class="o">-</span><span class="n">autoipd</span><span class="w"> </span><span class="n">colord</span><span class="o">-</span><span class="n">sensor</span><span class="o">-</span><span class="n">argyll</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">bsd</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">pdf</span><span class="w"> </span><span class="n">foomatic</span><span class="o">-</span><span class="n">db</span><span class="o">-</span><span class="n">compressed</span><span class="o">-</span><span class="n">ppds</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">foomatic</span><span class="o">-</span><span class="n">db</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="n">antiword</span><span class="w"> </span><span class="n">docx2txt</span><span class="w"> </span><span class="n">imagemagick</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">noto</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">freefont</span><span class="o">-</span><span class="n">otf</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">freefont</span><span class="o">-</span><span class="n">ttf</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">texgyre</span><span class="w"> </span><span class="n">gphoto2</span><span class="w"> </span><span class="n">ooo2dbk</span><span class="w"> </span><span class="n">rtf2xml</span><span class="w"> </span><span class="n">avahi</span><span class="o">-</span><span class="n">autoipd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">zeroconf</span><span class="w"> </span><span class="n">hplip</span>
<span class="w">  </span><span class="n">snmp</span><span class="o">-</span><span class="n">mibs</span><span class="o">-</span><span class="n">downloader</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">japanese</span><span class="o">-</span><span class="n">mincho</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">ipafont</span><span class="o">-</span><span class="n">mincho</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">arphic</span><span class="o">-</span><span class="n">ukai</span>
<span class="w">  </span><span class="n">fonts</span><span class="o">-</span><span class="n">arphic</span><span class="o">-</span><span class="n">uming</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">nanum</span><span class="w"> </span><span class="n">unpaper</span>
<span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="k">NEW</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nl">installed</span><span class="p">:</span>
<span class="w">  </span><span class="n">acl</span><span class="w"> </span><span class="n">avahi</span><span class="o">-</span><span class="n">daemon</span><span class="w"> </span><span class="n">colord</span><span class="w"> </span><span class="n">colord</span><span class="o">-</span><span class="k">data</span><span class="w"> </span><span class="n">cups</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">browsed</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">client</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">common</span>
<span class="w">  </span><span class="n">cups</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">drivers</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">daemon</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">filters</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">filters</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">drivers</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">ipp</span><span class="o">-</span><span class="n">utils</span>
<span class="w">  </span><span class="n">cups</span><span class="o">-</span><span class="n">ppdc</span><span class="w"> </span><span class="n">cups</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">droid</span><span class="o">-</span><span class="n">fallback</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">noto</span><span class="o">-</span><span class="n">mono</span><span class="w"> </span><span class="n">fonts</span><span class="o">-</span><span class="n">urw</span><span class="o">-</span><span class="n">base35</span>
<span class="w">  </span><span class="n">ghostscript</span><span class="w"> </span><span class="n">ipp</span><span class="o">-</span><span class="n">usb</span><span class="w"> </span><span class="n">libavahi</span><span class="o">-</span><span class="n">core7</span><span class="w"> </span><span class="n">libavahi</span><span class="o">-</span><span class="n">glib1</span><span class="w"> </span><span class="n">libcolorhug2</span><span class="w"> </span><span class="n">libcupsfilters1</span><span class="w"> </span><span class="n">libdaemon0</span>
<span class="w">  </span><span class="n">libexif12</span><span class="w"> </span><span class="n">libfontembed1</span><span class="w"> </span><span class="n">libgphoto2</span><span class="o">-</span><span class="mi">6</span><span class="w"> </span><span class="n">libgphoto2</span><span class="o">-</span><span class="n">l10n</span><span class="w"> </span><span class="n">libgphoto2</span><span class="o">-</span><span class="n">port12</span><span class="w"> </span><span class="n">libgs</span><span class="o">-</span><span class="n">common</span>
<span class="w">  </span><span class="n">libgs10</span><span class="w"> </span><span class="n">libgs10</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">libgusb2</span><span class="w"> </span><span class="n">libidn12</span><span class="w"> </span><span class="n">libieee1284</span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="n">libijs</span><span class="o">-</span><span class="mf">0.35</span><span class="w"> </span><span class="n">libjbig2dec0</span>
<span class="w">  </span><span class="n">libjson</span><span class="o">-</span><span class="n">glib</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">libjson</span><span class="o">-</span><span class="n">glib</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">liblouis</span><span class="o">-</span><span class="k">data</span><span class="w"> </span><span class="n">liblouis20</span><span class="w"> </span><span class="n">liblouisutdml</span><span class="o">-</span><span class="n">bin</span>
<span class="w">  </span><span class="n">liblouisutdml</span><span class="o">-</span><span class="k">data</span><span class="w"> </span><span class="n">liblouisutdml9</span><span class="w"> </span><span class="n">libltdl7</span><span class="w"> </span><span class="n">libnss</span><span class="o">-</span><span class="n">mdns</span><span class="w"> </span><span class="n">libpaper</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="n">libpaper1</span>
<span class="w">  </span><span class="n">libpoppler</span><span class="o">-</span><span class="n">cpp0v5</span><span class="w"> </span><span class="n">libpoppler</span><span class="o">-</span><span class="n">glib8</span><span class="w"> </span><span class="n">libpoppler126</span><span class="w"> </span><span class="n">libqpdf29</span><span class="w"> </span><span class="n">libsane</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">libsane1</span>
<span class="w">  </span><span class="n">libsnmp</span><span class="o">-</span><span class="n">base</span><span class="w"> </span><span class="n">libsnmp40</span><span class="w"> </span><span class="n">lynx</span><span class="w"> </span><span class="n">lynx</span><span class="o">-</span><span class="n">common</span><span class="w"> </span><span class="n">mailcap</span><span class="w"> </span><span class="n">poppler</span><span class="o">-</span><span class="k">data</span><span class="w"> </span><span class="n">poppler</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="n">sane</span><span class="o">-</span><span class="n">airscan</span>
<span class="w">  </span><span class="n">sane</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="k">update</span><span class="o">-</span><span class="n">inetd</span><span class="w"> </span><span class="n">usb</span><span class="p">.</span><span class="n">ids</span>
<span class="mi">0</span><span class="w"> </span><span class="n">upgraded</span><span class="p">,</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="n">newly</span><span class="w"> </span><span class="n">installed</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">upgraded</span><span class="p">.</span>
<span class="n">Need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="mf">40.7</span><span class="w"> </span><span class="n">MB</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">archives</span><span class="p">.</span>
<span class="k">After</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">operation</span><span class="p">,</span><span class="w"> </span><span class="mi">163</span><span class="w"> </span><span class="n">MB</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="k">disk</span><span class="w"> </span><span class="nf">space</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="p">.</span>
<span class="n">Do</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">continue</span><span class="vm">?</span><span class="w"> </span><span class="o">[</span><span class="n">Y/n</span><span class="o">]</span>
<span class="p">...</span>
<span class="p">...</span>
</code></pre></div>

<p>CUPS stands for Common Unix Printing System and as you can see, it installs many related packages and even suggests some more. This is because CUPS need lots of information about different printers and uses many tools to print. When installed, you need to start the service:</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">systemctl</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">cups</span><span class="o">.</span><span class="n">service</span>
<span class="o">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">systemctl</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">cups</span><span class="o">.</span><span class="n">service</span>
<span class="err">●</span><span class="w"> </span><span class="n">cups</span><span class="o">.</span><span class="n">service</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CUPS</span><span class="w"> </span><span class="n">Scheduler</span>
<span class="w">     </span><span class="n">Loaded</span><span class="p">:</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">cups</span><span class="o">.</span><span class="n">service</span><span class="p">;</span><span class="w"> </span><span class="n">enabled</span><span class="p">;</span><span class="w"> </span><span class="n">preset</span><span class="p">:</span><span class="w"> </span><span class="n">enabled</span><span class="p">)</span>
<span class="w">     </span><span class="n">Active</span><span class="p">:</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="p">(</span><span class="n">running</span><span class="p">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">Sun</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">16</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">20</span><span class="w"> </span><span class="n">EDT</span><span class="p">;</span><span class="w"> </span><span class="mi">27</span><span class="n">s</span><span class="w"> </span><span class="n">ago</span>
<span class="n">TriggeredBy</span><span class="p">:</span><span class="w"> </span><span class="err">●</span><span class="w"> </span><span class="n">cups</span><span class="o">.</span><span class="n">path</span>
<span class="w">             </span><span class="err">●</span><span class="w"> </span><span class="n">cups</span><span class="o">.</span><span class="n">socket</span>
<span class="w">       </span><span class="n">Docs</span><span class="p">:</span><span class="w"> </span><span class="n">man</span><span class="p">:</span><span class="n">cupsd</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="n">Main</span><span class="w"> </span><span class="n">PID</span><span class="p">:</span><span class="w"> </span><span class="mi">2366</span><span class="w"> </span><span class="p">(</span><span class="n">cupsd</span><span class="p">)</span>
<span class="w">     </span><span class="n">Status</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Scheduler is running...&quot;</span>
<span class="w">      </span><span class="n">Tasks</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">limit</span><span class="p">:</span><span class="w"> </span><span class="mi">4583</span><span class="p">)</span>
<span class="w">     </span><span class="n">Memory</span><span class="p">:</span><span class="w"> </span><span class="mf">2.8</span><span class="n">M</span>
<span class="w">        </span><span class="n">CPU</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="n">ms</span>
<span class="w">     </span><span class="n">CGroup</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">system</span><span class="o">.</span><span class="n">slice</span><span class="o">/</span><span class="n">cups</span><span class="o">.</span><span class="n">service</span>
<span class="w">             </span><span class="err">└─</span><span class="mi">2366</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">cupsd</span><span class="w"> </span><span class="o">-</span><span class="n">l</span>

<span class="n">Jul</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">20</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="w"> </span><span class="n">Starting</span><span class="w"> </span><span class="n">cups</span><span class="o">.</span><span class="n">service</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CUPS</span><span class="w"> </span><span class="n">Scheduler</span><span class="o">...</span>
<span class="n">Jul</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">20</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="w"> </span><span class="n">Started</span><span class="w"> </span><span class="n">cups</span><span class="o">.</span><span class="n">service</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CUPS</span><span class="w"> </span><span class="n">Scheduler</span><span class="o">.</span>
</code></pre></div>

<p>To access the CUPS services, there are different ways, including a web based interface, GUI programs on the graphical modes and even command line tools. CUPS is designed to be simple and able to use different printers from various vendors.</p>
<h3>configuration files</h3>
<p>As most other linux program, CUPS saves its configuration at <code>/etc</code> directory.</p>
<div class="highlight"><pre><span></span><code># ls /etc/cups/
cups-browsed.conf  cups-files.conf  ppd        raw.convs  snmp.conf  subscriptions.conf
cupsd.conf     interfaces       printers.conf  raw.types  ssl    subscriptions.conf.O
</code></pre></div>

<p>The main configuration file is the <code>cupsd.conf</code>. Take a look at it; it is very easy to understand. For example the <code>Listen localhost:631</code> line tells the CUPS to listen on localhost port 631. Here is a sample:</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cups</span><span class="o">/</span><span class="n">cupsd</span><span class="p">.</span><span class="n">conf</span>
<span class="cp">#</span>
<span class="cp"># Configuration file for the CUPS scheduler.  See &quot;man cupsd.conf&quot; for a</span>
<span class="cp"># complete description of this file.</span>
<span class="cp">#</span>

<span class="cp"># Log general information in error_log - change &quot;warn&quot; to &quot;debug&quot;</span>
<span class="cp"># for troubleshooting...</span>
<span class="n">LogLevel</span><span class="w"> </span><span class="n">warn</span>
<span class="n">PageLogFormat</span>

<span class="cp"># Specifies the maximum size of the log files before they are rotated.  The value &quot;0&quot; disables log rotation.</span>
<span class="n">MaxLogSize</span><span class="w"> </span><span class="mi">0</span>

<span class="cp"># Default error policy for printers</span>
<span class="n">ErrorPolicy</span><span class="w"> </span><span class="n">retry</span><span class="o">-</span><span class="n">job</span>

<span class="cp"># Only listen for connections from the local machine.</span>
<span class="n">Listen</span><span class="w"> </span><span class="n">localhost</span><span class="o">:</span><span class="mi">631</span>
<span class="n">Listen</span><span class="w"> </span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">cups</span><span class="o">/</span><span class="n">cups</span><span class="p">.</span><span class="n">sock</span>

<span class="cp"># Show shared printers on the local network.</span>
<span class="n">Browsing</span><span class="w"> </span><span class="n">Yes</span>
<span class="n">BrowseLocalProtocols</span><span class="w"> </span><span class="n">dnssd</span>

<span class="cp"># Default authentication type, when authentication is required...</span>
<span class="n">DefaultAuthType</span><span class="w"> </span><span class="n">Basic</span>

<span class="cp"># Web interface setting...</span>
<span class="n">WebInterface</span><span class="w"> </span><span class="n">Yes</span>

<span class="cp"># Timeout after cupsd exits if idle (applied only if cupsd runs on-demand - with -l)</span>
<span class="n">IdleExitTimeout</span><span class="w"> </span><span class="mi">60</span>

<span class="cp"># Restrict access to the server...</span>
<span class="o">&lt;</span><span class="n">Location</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">  </span><span class="n">Order</span><span class="w"> </span><span class="n">allow</span><span class="p">,</span><span class="n">deny</span>
<span class="o">&lt;/</span><span class="n">Location</span><span class="o">&gt;</span>

<span class="cp"># Restrict access to the admin pages...</span>
<span class="o">&lt;</span><span class="n">Location</span><span class="w"> </span><span class="o">/</span><span class="n">admin</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">Order</span><span class="w"> </span><span class="n">allow</span><span class="p">,</span><span class="n">deny</span>
<span class="o">&lt;/</span><span class="n">Location</span><span class="o">&gt;</span>

<span class="cp"># Restrict access to configuration files...</span>
<span class="o">&lt;</span><span class="n">Location</span><span class="w"> </span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">conf</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">  </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">  </span><span class="n">Order</span><span class="w"> </span><span class="n">allow</span><span class="p">,</span><span class="n">deny</span>
<span class="o">&lt;/</span><span class="n">Location</span><span class="o">&gt;</span>

<span class="cp"># Restrict access to log files...</span>
<span class="o">&lt;</span><span class="n">Location</span><span class="w"> </span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">log</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">  </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">  </span><span class="n">Order</span><span class="w"> </span><span class="n">allow</span><span class="p">,</span><span class="n">deny</span>
<span class="o">&lt;/</span><span class="n">Location</span><span class="o">&gt;</span>

<span class="cp"># Set the default printer/job policies...</span>
<span class="o">&lt;</span><span class="n">Policy</span><span class="w"> </span><span class="k">default</span><span class="o">&gt;</span>
<span class="w">  </span><span class="cp"># Job/subscription privacy...</span>
<span class="w">  </span><span class="n">JobPrivateAccess</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">JobPrivateValues</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">SubscriptionPrivateAccess</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">SubscriptionPrivateValues</span><span class="w"> </span><span class="k">default</span>

<span class="w">  </span><span class="cp"># Job-related operations must be done by the owner or an administrator...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Create</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Print</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Print</span><span class="o">-</span><span class="n">URI</span><span class="w"> </span><span class="n">Validate</span><span class="o">-</span><span class="n">Job</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Send</span><span class="o">-</span><span class="n">Document</span><span class="w"> </span><span class="n">Send</span><span class="o">-</span><span class="n">URI</span><span class="w"> </span><span class="n">Hold</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Release</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Restart</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Purge</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Set</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">Attributes</span><span class="w"> </span><span class="n">Create</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Renew</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Get</span><span class="o">-</span><span class="n">Notifications</span><span class="w"> </span><span class="n">Reprocess</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Suspend</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Resume</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">My</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Close</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Move</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Get</span><span class="o">-</span><span class="n">Document</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">OWNER</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># All administration operations require an administrator to authenticate...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Add</span><span class="o">-</span><span class="n">Modify</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Delete</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Add</span><span class="o">-</span><span class="n">Modify</span><span class="o">-</span><span class="kt">Class</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Delete</span><span class="o">-</span><span class="kt">Class</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Set</span><span class="o">-</span><span class="n">Default</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Get</span><span class="o">-</span><span class="n">Devices</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># All printer operations require a printer operator to authenticate...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Pause</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Resume</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Enable</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Disable</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Pause</span><span class="o">-</span><span class="n">Printer</span><span class="o">-</span><span class="n">After</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Hold</span><span class="o">-</span><span class="n">New</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Release</span><span class="o">-</span><span class="n">Held</span><span class="o">-</span><span class="n">New</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Deactivate</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Activate</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Restart</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Shutdown</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Startup</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Promote</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Schedule</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">After</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Accept</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Reject</span><span class="o">-</span><span class="n">Jobs</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># Only the owner or an administrator can cancel or authenticate a job...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Authenticate</span><span class="o">-</span><span class="n">Job</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">OWNER</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">All</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Policy</span><span class="o">&gt;</span>

<span class="cp"># Set the authenticated printer/job policies...</span>
<span class="o">&lt;</span><span class="n">Policy</span><span class="w"> </span><span class="n">authenticated</span><span class="o">&gt;</span>
<span class="w">  </span><span class="cp"># Job/subscription privacy...</span>
<span class="w">  </span><span class="n">JobPrivateAccess</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">JobPrivateValues</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">SubscriptionPrivateAccess</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">SubscriptionPrivateValues</span><span class="w"> </span><span class="k">default</span>

<span class="w">  </span><span class="cp"># Job-related operations must be done by the owner or an administrator...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Create</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Print</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Print</span><span class="o">-</span><span class="n">URI</span><span class="w"> </span><span class="n">Validate</span><span class="o">-</span><span class="n">Job</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Send</span><span class="o">-</span><span class="n">Document</span><span class="w"> </span><span class="n">Send</span><span class="o">-</span><span class="n">URI</span><span class="w"> </span><span class="n">Hold</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Release</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Restart</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Purge</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Set</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">Attributes</span><span class="w"> </span><span class="n">Create</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Renew</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Get</span><span class="o">-</span><span class="n">Notifications</span><span class="w"> </span><span class="n">Reprocess</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Suspend</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Resume</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">My</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Close</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Move</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Get</span><span class="o">-</span><span class="n">Document</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">OWNER</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># All administration operations require an administrator to authenticate...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Add</span><span class="o">-</span><span class="n">Modify</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Delete</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Add</span><span class="o">-</span><span class="n">Modify</span><span class="o">-</span><span class="kt">Class</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Delete</span><span class="o">-</span><span class="kt">Class</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Set</span><span class="o">-</span><span class="n">Default</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># All printer operations require a printer operator to authenticate...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Pause</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Resume</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Enable</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Disable</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Pause</span><span class="o">-</span><span class="n">Printer</span><span class="o">-</span><span class="n">After</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Hold</span><span class="o">-</span><span class="n">New</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Release</span><span class="o">-</span><span class="n">Held</span><span class="o">-</span><span class="n">New</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Deactivate</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Activate</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Restart</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Shutdown</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Startup</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Promote</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Schedule</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">After</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Accept</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Reject</span><span class="o">-</span><span class="n">Jobs</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># Only the owner or an administrator can cancel or authenticate a job...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Authenticate</span><span class="o">-</span><span class="n">Job</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">OWNER</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">All</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Policy</span><span class="o">&gt;</span>

<span class="cp"># Set the kerberized printer/job policies...</span>
<span class="o">&lt;</span><span class="n">Policy</span><span class="w"> </span><span class="n">kerberos</span><span class="o">&gt;</span>
<span class="w">  </span><span class="cp"># Job/subscription privacy...</span>
<span class="w">  </span><span class="n">JobPrivateAccess</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">JobPrivateValues</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">SubscriptionPrivateAccess</span><span class="w"> </span><span class="k">default</span>
<span class="w">  </span><span class="n">SubscriptionPrivateValues</span><span class="w"> </span><span class="k">default</span>

<span class="w">  </span><span class="cp"># Job-related operations must be done by the owner or an administrator...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Create</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Print</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Print</span><span class="o">-</span><span class="n">URI</span><span class="w"> </span><span class="n">Validate</span><span class="o">-</span><span class="n">Job</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Negotiate</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Send</span><span class="o">-</span><span class="n">Document</span><span class="w"> </span><span class="n">Send</span><span class="o">-</span><span class="n">URI</span><span class="w"> </span><span class="n">Hold</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Release</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Restart</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Purge</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Set</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">Attributes</span><span class="w"> </span><span class="n">Create</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Renew</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Subscription</span><span class="w"> </span><span class="n">Get</span><span class="o">-</span><span class="n">Notifications</span><span class="w"> </span><span class="n">Reprocess</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Suspend</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Resume</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">My</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Close</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Move</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Get</span><span class="o">-</span><span class="n">Document</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Negotiate</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">OWNER</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># All administration operations require an administrator to authenticate...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Add</span><span class="o">-</span><span class="n">Modify</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Delete</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Add</span><span class="o">-</span><span class="n">Modify</span><span class="o">-</span><span class="kt">Class</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Delete</span><span class="o">-</span><span class="kt">Class</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Set</span><span class="o">-</span><span class="n">Default</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># All printer operations require a printer operator to authenticate...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Pause</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Resume</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Enable</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Disable</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Pause</span><span class="o">-</span><span class="n">Printer</span><span class="o">-</span><span class="n">After</span><span class="o">-</span><span class="n">Current</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Hold</span><span class="o">-</span><span class="n">New</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Release</span><span class="o">-</span><span class="n">Held</span><span class="o">-</span><span class="n">New</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">Deactivate</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Activate</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Restart</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Shutdown</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Startup</span><span class="o">-</span><span class="n">Printer</span><span class="w"> </span><span class="n">Promote</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">Schedule</span><span class="o">-</span><span class="n">Job</span><span class="o">-</span><span class="n">After</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Accept</span><span class="o">-</span><span class="n">Jobs</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Reject</span><span class="o">-</span><span class="n">Jobs</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Default</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="cp"># Only the owner or an administrator can cancel or authenticate a job...</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">Cancel</span><span class="o">-</span><span class="n">Job</span><span class="w"> </span><span class="n">CUPS</span><span class="o">-</span><span class="n">Authenticate</span><span class="o">-</span><span class="n">Job</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">AuthType</span><span class="w"> </span><span class="n">Negotiate</span>
<span class="w">    </span><span class="n">Require</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p">@</span><span class="n">OWNER</span><span class="w"> </span><span class="p">@</span><span class="n">SYSTEM</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>

<span class="w">  </span><span class="o">&lt;</span><span class="n">Limit</span><span class="w"> </span><span class="n">All</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">Order</span><span class="w"> </span><span class="n">deny</span><span class="p">,</span><span class="n">allow</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">Limit</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Policy</span><span class="o">&gt;</span>
<span class="n">jadi</span><span class="p">@</span><span class="n">debian</span><span class="o">:~</span><span class="n">$</span>
<span class="n">Broadcast</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">root</span><span class="p">@</span><span class="n">debian</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">3</span><span class="w"> </span><span class="p">(</span><span class="n">Sun</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-07</span><span class="mi">-16</span><span class="w"> </span><span class="mi">20</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mo">04</span><span class="w"> </span><span class="n">EDT</span><span class="p">)</span><span class="o">:</span>

<span class="n">The</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="n">now</span><span class="o">!</span>

<span class="n">Connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">192.168.64.7</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="p">.</span>
<span class="n">Connection</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">192.168.64.7</span><span class="w"> </span><span class="n">closed</span><span class="p">.</span>
<span class="err">➜</span><span class="w">  </span><span class="n">lpic1book</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">jadi</span><span class="mf">@192.168.64.7</span>
<span class="n">jadi</span><span class="mf">@192.168.64.7</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">password</span><span class="o">:</span>
<span class="n">Linux</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="mf">6.1.0</span><span class="mi">-9</span><span class="o">-</span><span class="n">arm64</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span><span class="w"> </span><span class="n">SMP</span><span class="w"> </span><span class="n">Debian</span><span class="w"> </span><span class="mf">6.1.27</span><span class="mi">-1</span><span class="w"> </span><span class="p">(</span><span class="mi">2023</span><span class="mo">-05</span><span class="mi">-08</span><span class="p">)</span><span class="w"> </span><span class="n">aarch64</span>

<span class="n">The</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Debian</span><span class="w"> </span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">software</span><span class="p">;</span>
<span class="n">the</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span>
<span class="n">individual</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="cm">/*/copyright.</span>

<span class="cm">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span>
<span class="cm">permitted by applicable law.</span>
<span class="cm">You have no mail.</span>
<span class="cm">Last login: Mon Jul 17 08:13:13 2023</span>
<span class="cm">jadi@debian:~$ sudo su -</span>
<span class="cm">[sudo] password for jadi:</span>
<span class="cm">root@debian:~# cd /etc/cups/</span>
<span class="cm">root@debian:/etc/cups# ls</span>
<span class="cm">cups-browsed.conf  cups-files.conf  ppd        raw.convs  snmp.conf  subscriptions.conf</span>
<span class="cm">cupsd.conf     interfaces       printers.conf  raw.types  ssl    subscriptions.conf.O</span>
<span class="cm">root@debian:/etc/cups# cd</span>
<span class="cm">root@debian:~# ls /etc/cups/</span>
<span class="cm">cups-browsed.conf  cups-files.conf  ppd        raw.convs  snmp.conf  subscriptions.conf</span>
<span class="cm">cupsd.conf     interfaces       printers.conf  raw.types  ssl    subscriptions.conf.O</span>
<span class="cm">root@debian:~# cat /etc/cups/cupsd.conf</span>
<span class="cm">#</span>
<span class="cm"># Configuration file for the CUPS scheduler.  See &quot;man cupsd.conf&quot; for a</span>
<span class="cm"># complete description of this file.</span>
<span class="cm">#</span>

<span class="cm"># Log general information in error_log - change &quot;warn&quot; to &quot;debug&quot;</span>
<span class="cm"># for troubleshooting...</span>
<span class="cm">LogLevel warn</span>
<span class="cm">PageLogFormat</span>

<span class="cm"># Specifies the maximum size of the log files before they are rotated.  The value &quot;0&quot; disables log rotation.</span>
<span class="cm">MaxLogSize 0</span>

<span class="cm"># Default error policy for printers</span>
<span class="cm">ErrorPolicy retry-job</span>

<span class="cm"># Only listen for connections from the local machine.</span>
<span class="cm">Listen localhost:631</span>
<span class="cm">Listen /run/cups/cups.sock</span>

<span class="cm"># Show shared printers on the local network.</span>
<span class="cm">Browsing Yes</span>
<span class="cm">BrowseLocalProtocols dnssd</span>

<span class="cm"># Default authentication type, when authentication is required...</span>
<span class="cm">DefaultAuthType Basic</span>

<span class="cm"># Web interface setting...</span>
<span class="cm">WebInterface Yes</span>

<span class="cm"># Timeout after cupsd exits if idle (applied only if cupsd runs on-demand - with -l)</span>
<span class="cm">IdleExitTimeout 60</span>

<span class="cm"># Restrict access to the server...</span>
<span class="cm">&lt;Location /&gt;</span>
<span class="cm">  Order allow,deny</span>
<span class="cm">&lt;/Location&gt;</span>

<span class="cm"># Restrict access to the admin pages...</span>
<span class="cm">&lt;Location /admin&gt;</span>
<span class="cm">  Order allow,deny</span>
<span class="cm">&lt;/Location&gt;</span>

<span class="cm"># Restrict access to configuration files...</span>
<span class="cm">&lt;Location /admin/conf&gt;</span>
<span class="cm">  AuthType Default</span>
<span class="cm">  Require user @SYSTEM</span>
<span class="cm">  Order allow,deny</span>
<span class="cm">&lt;/Location&gt;</span>

<span class="cm"># Restrict access to log files...</span>
<span class="cm">&lt;Location /admin/log&gt;</span>
<span class="cm">  AuthType Default</span>
<span class="cm">  Require user @SYSTEM</span>
<span class="cm">  Order allow,deny</span>
<span class="cm">&lt;/Location&gt;</span>

<span class="cm"># Set the default printer/job policies...</span>
<span class="cm">&lt;Policy default&gt;</span>
<span class="cm">  # Job/subscription privacy...</span>
<span class="cm">  JobPrivateAccess default</span>
<span class="cm">  JobPrivateValues default</span>
<span class="cm">  SubscriptionPrivateAccess default</span>
<span class="cm">  SubscriptionPrivateValues default</span>

<span class="cm">  # Job-related operations must be done by the owner or an administrator...</span>
<span class="cm">  &lt;Limit Create-Job Print-Job Print-URI Validate-Job&gt;</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  &lt;Limit Send-Document Send-URI Hold-Job Release-Job Restart-Job Purge-Jobs Set-Job-Attributes Create-Job-Subscription Renew-Subscription Cancel-Subscription Get-Notifications Reprocess-Job Cancel-Current-Job Suspend-Current-Job Resume-Job Cancel-My-Jobs Close-Job CUPS-Move-Job CUPS-Get-Document&gt;</span>
<span class="cm">    Require user @OWNER @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # All administration operations require an administrator to authenticate...</span>
<span class="cm">  &lt;Limit CUPS-Add-Modify-Printer CUPS-Delete-Printer CUPS-Add-Modify-Class CUPS-Delete-Class CUPS-Set-Default CUPS-Get-Devices&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # All printer operations require a printer operator to authenticate...</span>
<span class="cm">  &lt;Limit Pause-Printer Resume-Printer Enable-Printer Disable-Printer Pause-Printer-After-Current-Job Hold-New-Jobs Release-Held-New-Jobs Deactivate-Printer Activate-Printer Restart-Printer Shutdown-Printer Startup-Printer Promote-Job Schedule-Job-After Cancel-Jobs CUPS-Accept-Jobs CUPS-Reject-Jobs&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # Only the owner or an administrator can cancel or authenticate a job...</span>
<span class="cm">  &lt;Limit Cancel-Job CUPS-Authenticate-Job&gt;</span>
<span class="cm">    Require user @OWNER @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  &lt;Limit All&gt;</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>
<span class="cm">&lt;/Policy&gt;</span>

<span class="cm"># Set the authenticated printer/job policies...</span>
<span class="cm">&lt;Policy authenticated&gt;</span>
<span class="cm">  # Job/subscription privacy...</span>
<span class="cm">  JobPrivateAccess default</span>
<span class="cm">  JobPrivateValues default</span>
<span class="cm">  SubscriptionPrivateAccess default</span>
<span class="cm">  SubscriptionPrivateValues default</span>

<span class="cm">  # Job-related operations must be done by the owner or an administrator...</span>
<span class="cm">  &lt;Limit Create-Job Print-Job Print-URI Validate-Job&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  &lt;Limit Send-Document Send-URI Hold-Job Release-Job Restart-Job Purge-Jobs Set-Job-Attributes Create-Job-Subscription Renew-Subscription Cancel-Subscription Get-Notifications Reprocess-Job Cancel-Current-Job Suspend-Current-Job Resume-Job Cancel-My-Jobs Close-Job CUPS-Move-Job CUPS-Get-Document&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @OWNER @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # All administration operations require an administrator to authenticate...</span>
<span class="cm">  &lt;Limit CUPS-Add-Modify-Printer CUPS-Delete-Printer CUPS-Add-Modify-Class CUPS-Delete-Class CUPS-Set-Default&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # All printer operations require a printer operator to authenticate...</span>
<span class="cm">  &lt;Limit Pause-Printer Resume-Printer Enable-Printer Disable-Printer Pause-Printer-After-Current-Job Hold-New-Jobs Release-Held-New-Jobs Deactivate-Printer Activate-Printer Restart-Printer Shutdown-Printer Startup-Printer Promote-Job Schedule-Job-After Cancel-Jobs CUPS-Accept-Jobs CUPS-Reject-Jobs&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # Only the owner or an administrator can cancel or authenticate a job...</span>
<span class="cm">  &lt;Limit Cancel-Job CUPS-Authenticate-Job&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @OWNER @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  &lt;Limit All&gt;</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>
<span class="cm">&lt;/Policy&gt;</span>

<span class="cm"># Set the kerberized printer/job policies...</span>
<span class="cm">&lt;Policy kerberos&gt;</span>
<span class="cm">  # Job/subscription privacy...</span>
<span class="cm">  JobPrivateAccess default</span>
<span class="cm">  JobPrivateValues default</span>
<span class="cm">  SubscriptionPrivateAccess default</span>
<span class="cm">  SubscriptionPrivateValues default</span>

<span class="cm">  # Job-related operations must be done by the owner or an administrator...</span>
<span class="cm">  &lt;Limit Create-Job Print-Job Print-URI Validate-Job&gt;</span>
<span class="cm">    AuthType Negotiate</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  &lt;Limit Send-Document Send-URI Hold-Job Release-Job Restart-Job Purge-Jobs Set-Job-Attributes Create-Job-Subscription Renew-Subscription Cancel-Subscription Get-Notifications Reprocess-Job Cancel-Current-Job Suspend-Current-Job Resume-Job Cancel-My-Jobs Close-Job CUPS-Move-Job CUPS-Get-Document&gt;</span>
<span class="cm">    AuthType Negotiate</span>
<span class="cm">    Require user @OWNER @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # All administration operations require an administrator to authenticate...</span>
<span class="cm">  &lt;Limit CUPS-Add-Modify-Printer CUPS-Delete-Printer CUPS-Add-Modify-Class CUPS-Delete-Class CUPS-Set-Default&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # All printer operations require a printer operator to authenticate...</span>
<span class="cm">  &lt;Limit Pause-Printer Resume-Printer Enable-Printer Disable-Printer Pause-Printer-After-Current-Job Hold-New-Jobs Release-Held-New-Jobs Deactivate-Printer Activate-Printer Restart-Printer Shutdown-Printer Startup-Printer Promote-Job Schedule-Job-After Cancel-Jobs CUPS-Accept-Jobs CUPS-Reject-Jobs&gt;</span>
<span class="cm">    AuthType Default</span>
<span class="cm">    Require user @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  # Only the owner or an administrator can cancel or authenticate a job...</span>
<span class="cm">  &lt;Limit Cancel-Job CUPS-Authenticate-Job&gt;</span>
<span class="cm">    AuthType Negotiate</span>
<span class="cm">    Require user @OWNER @SYSTEM</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>

<span class="cm">  &lt;Limit All&gt;</span>
<span class="cm">    Order deny,allow</span>
<span class="cm">  &lt;/Limit&gt;</span>
<span class="cm">&lt;/Policy&gt;</span>
</code></pre></div>

<p>All the printer data is saved at <code>/etc/cups/printers.conf</code>. The web interface or any other GUI is actually editing this file.</p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span>cat<span class="w"> </span>/etc/cups/printers.conf
#<span class="w"> </span>Printer<span class="w"> </span>configuration<span class="w"> </span>file<span class="w"> </span>for<span class="w"> </span>CUPS<span class="w"> </span>v2.4.2
#<span class="w"> </span>Written<span class="w"> </span>by<span class="w"> </span>cupsd
#<span class="w"> </span>DO<span class="w"> </span>NOT<span class="w"> </span>EDIT<span class="w"> </span>THIS<span class="w"> </span>FILE<span class="w"> </span>WHEN<span class="w"> </span>CUPSD<span class="w"> </span>IS<span class="w"> </span>RUNNING
NextPrinterId<span class="w"> </span>2
<span class="nt">&lt;Printer</span><span class="w"> </span><span class="err">MyPrinter</span><span class="nt">&gt;</span>
PrinterId<span class="w"> </span>1
UUID<span class="w"> </span>urn:uuid:cea56d60-93a0-31bf-443b-5a7288e2cd51
Info<span class="w"> </span>My<span class="w"> </span>Printer
Location<span class="w"> </span>other<span class="w"> </span>room
MakeModel<span class="w"> </span>HP<span class="w"> </span>DesignJet<span class="w"> </span>600<span class="w"> </span>pcl,<span class="w"> </span>1.0
DeviceURI<span class="w"> </span>http://thatprinter:631/ipp/
State<span class="w"> </span>Idle
StateTime<span class="w"> </span>1689596391
ConfigTime<span class="w"> </span>1689596367
Type<span class="w"> </span>8450116
Accepting<span class="w"> </span>Yes
Shared<span class="w"> </span>Yes
JobSheets<span class="w"> </span>none<span class="w"> </span>none
QuotaPeriod<span class="w"> </span>0
PageLimit<span class="w"> </span>0
KLimit<span class="w"> </span>0
OpPolicy<span class="w"> </span>default
ErrorPolicy<span class="w"> </span>retry-job
<span class="nt">&lt;/Printer&gt;</span>
</code></pre></div>

<p>Another important configuration directory is located at <code>/etc/cups/ppd/</code>. This directory contains the PostScript printer Description (PPD) files. These let printers which use them to function properly. </p>
<p>To find the CUPS logs, check the <code>/var/log</code> directory:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ls /var/log/cups/</span>
<span class="n">access_log</span><span class="w">  </span><span class="n">error_log</span>
</code></pre></div>

<h3>CUPS web interface</h3>
<p>To enable CUPS's web interface, you have to enable the following configuration in the <code>/etc/cups/cupsd.conf</code>:</p>
<div class="highlight"><pre><span></span><code>WebInterface Yes
</code></pre></div>

<p>Then you will have access to the GUI via port <strong>631</strong>. So it will be enough to access the <strong>localhost:631</strong> or <strong>127.0.0.1:631</strong> (or the server's <strong>IP</strong> address on port <strong>631</strong>) from your browser.</p>
<p><img alt="CUPS web interface on port 631" src="/images/cups_we_interface.png"></p>
<p>There are some of the important sections on the above page:</p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>Administration</td>
<td>Adding printers, managing jobs and configuring the CUPS server</td>
</tr>
<tr>
<td>Jobs</td>
<td>Checking the active, pending &amp; completed jobs</td>
</tr>
<tr>
<td>Printers</td>
<td>List or search in the installed printers</td>
</tr>
</tbody>
</table>
<p>By default, system users can view printers and queued jobs ,but changes (like adding printers) will need more access. This is configured at the bottom part of <code>cupsd.conf</code> file. For example, the below configuration provides <code>CUPS-Add-Modify-Printer CUPS-Delete-Printer CUPS-Set-Defaul</code> access to anyone in <code>@printer_admin</code> group.</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">&lt;Limit</span><span class="w"> </span><span class="err">CUPS-Add-Modify-Printer</span><span class="w"> </span><span class="err">CUPS-Delete-Printer</span><span class="w"> </span><span class="err">CUPS-Set-Default</span><span class="nt">&gt;</span>
<span class="w">    </span>AuthType<span class="w"> </span>Default
<span class="w">    </span>Require<span class="w"> </span>user<span class="w"> </span>@printer_admin
<span class="w">    </span>Order<span class="w"> </span>deny,allow
<span class="w">  </span><span class="nt">&lt;/Limit&gt;</span>
</code></pre></div>

<blockquote>
<p>CUPS has most of the common printer drivers installed. You just need to choose the printer from the dropdown menu to add it.</p>
</blockquote>
<h3>legacy tools</h3>
<p>Just like the <a href="//1083-mail-transfer-agent-mta-basics.html">MTA</a> programs, CUPS support all the legacy command line programs too. These used to be printing commands in the BSD world so you may need to install the <code>cups-bsd</code> package to let them work under your CUPS environment. The table below lists the BSD printing compatibility commands:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">command</th>
<th style="text-align: left;">usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">lpr</td>
<td style="text-align: left;">print a file</td>
</tr>
<tr>
<td style="text-align: left;">lpq</td>
<td style="text-align: left;">show print queue/jobs</td>
</tr>
<tr>
<td style="text-align: left;">lprm</td>
<td style="text-align: left;">rm/remove a file from priner queue</td>
</tr>
<tr>
<td style="text-align: left;">lpc</td>
<td style="text-align: left;">printer control / troubleshooting program</td>
</tr>
</tbody>
</table>
<h4><code>lpq</code></h4>
<p>The <strong>q</strong> stands for <strong>queue</strong>. Therefor <code>lpq</code> shows the printer queue and is used when you want to see the printing jobs. If you use the <code>-a</code> switch, <code>lpq</code> will list the jobs from <strong>all</strong> printers. Alternatively you can use the <code>-P</code> switch to show the jobs of a specific printer. So the following command will show the jobs of a printer called Apple-Dot-Matrix:</p>
<div class="highlight"><pre><span></span><code># lpq -PApple-Dot-Matrix
Apple-Dot-Matrix is ready and printing
Rank    Owner   Job     File(s)                         Total Size
active  unknown 1       unknown                         7168 bytes
1st     unknown 2       unknown                         2048 bytes
</code></pre></div>

<blockquote>
<p>There should be no spaces between the <code>-P</code> and the printer's name; strange? yes :D</p>
</blockquote>
<h4><code>lpr</code></h4>
<p>This command sends a job to a printer. The printer is specified via the <code>-P</code> switch.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>lpr<span class="w"> </span>-PApple-Dot-Matrix<span class="w"> </span>for_print.txt
$<span class="w"> </span>lpq
Apple-Dot-Matrix<span class="w"> </span>is<span class="w"> </span>ready<span class="w"> </span>and<span class="w"> </span>printing
Rank<span class="w">    </span>Owner<span class="w">   </span>Job<span class="w">     </span>File<span class="o">(</span>s<span class="o">)</span><span class="w">                         </span>Total<span class="w"> </span>Size
active<span class="w">  </span>jadi<span class="w">    </span><span class="m">1</span><span class="w">       </span>Untitled<span class="w"> </span>Document<span class="w"> </span><span class="m">1</span><span class="w">             </span><span class="m">7168</span><span class="w"> </span>bytes
1st<span class="w">     </span>jadi<span class="w">    </span><span class="m">2</span><span class="w">       </span>Untitled1<span class="w">                       </span><span class="m">2048</span><span class="w"> </span>bytes
2nd<span class="w">     </span>jadi<span class="w">    </span><span class="m">3</span><span class="w">       </span>for_print.txt<span class="w">                   </span><span class="m">1024</span><span class="w"> </span>bytes
</code></pre></div>

<blockquote>
<p>If no printer is specified, the default printer will be used</p>
</blockquote>
<h4><code>lprm</code></h4>
<p>The <strong>rm</strong> stands for <strong>remove</strong>. Therefor the <code>lprm</code> command removes jobs from the queue. Obviously, you have to provide the <strong>Job ID</strong>.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>lpq
Apple-Dot-Matrix<span class="w"> </span>is<span class="w"> </span>ready<span class="w"> </span>and<span class="w"> </span>printing
Rank<span class="w">    </span>Owner<span class="w">   </span>Job<span class="w">     </span>File<span class="o">(</span>s<span class="o">)</span><span class="w">                         </span>Total<span class="w"> </span>Size
active<span class="w">  </span>jadi<span class="w">    </span><span class="m">1</span><span class="w">       </span>Untitled<span class="w"> </span>Document<span class="w"> </span><span class="m">1</span><span class="w">             </span><span class="m">7168</span><span class="w"> </span>bytes
1st<span class="w">     </span>jadi<span class="w">    </span><span class="m">2</span><span class="w">       </span>Untitled1<span class="w">                       </span><span class="m">2048</span><span class="w"> </span>bytes
2nd<span class="w">     </span>jadi<span class="w">    </span><span class="m">3</span><span class="w">       </span>for_print.txt<span class="w">                   </span><span class="m">1024</span><span class="w"> </span>bytes
jadi@funlife:/tmp$<span class="w"> </span>lprm<span class="w"> </span><span class="m">2</span>
jadi@funlife:/tmp$<span class="w"> </span>lpq
Apple-Dot-Matrix<span class="w"> </span>is<span class="w"> </span>ready<span class="w"> </span>and<span class="w"> </span>printing
Rank<span class="w">    </span>Owner<span class="w">   </span>Job<span class="w">     </span>File<span class="o">(</span>s<span class="o">)</span><span class="w">                         </span>Total<span class="w"> </span>Size
active<span class="w">  </span>jadi<span class="w">    </span><span class="m">1</span><span class="w">       </span>Untitled<span class="w"> </span>Document<span class="w"> </span><span class="m">1</span><span class="w">             </span><span class="m">7168</span><span class="w"> </span>bytes
1st<span class="w">     </span>jadi<span class="w">    </span><span class="m">3</span><span class="w">       </span>for_print.txt<span class="w">                   </span><span class="m">1024</span><span class="w"> </span>bytes
</code></pre></div>

<blockquote>
<p>Only root can remove other peoples print jobs</p>
</blockquote>
<p>If you need to remove ALL the jobs of a specific printer, you can go with <code>-Pprinter_name -</code>. Yes! That is only one dash (<code>-</code>) after the printer name; that's why this is called a legacy command.</p>
<blockquote>
<p>the <code>lprm -</code> will remove all the print jobs</p>
</blockquote>
<h4><code>lpc</code></h4>
<p>The <strong>c</strong> stands for <strong>control</strong>. Therefor <code>lpc</code> lets you control, check the status (via <code>lpc status</code>) and troubleshoot your printers.</p>
<div class="highlight"><pre><span></span><code>$ lpc status
Apple-Dot-Matrix:
    printer is on device &#39;ipp&#39; speed -1
    queuing is enabled
    printing is enabled
    2 entries
    daemon present
</code></pre></div>

<p>In the above response,</p>
<ul>
<li><strong>queuing is enabled</strong> tell us that the queue can accept new print jobs. If the queue is disabled, you can not even send new jobs to the printer.</li>
<li><strong>printing is enabled</strong> means that the printer is actually can print on the paper. This will be on the disable state if the printer is out of ink or paper or experiencing a paper jam.</li>
</ul>
<p>If you are having problems with your printer or need to prevent it from accepting new jobs or let it accept jobs but not do the actual printing, these four commands can help:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">command</th>
<th style="text-align: left;">usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">cupsaccept</td>
<td style="text-align: left;">tells the printer queue to accept new jobs</td>
</tr>
<tr>
<td style="text-align: left;">cupsreject</td>
<td style="text-align: left;">tells the printer to reject any new job</td>
</tr>
<tr>
<td style="text-align: left;">cupsenable</td>
<td style="text-align: left;">enables the actual/physical printing of the jobs</td>
</tr>
<tr>
<td style="text-align: left;">cupsdisable</td>
<td style="text-align: left;">disables the physical printing of the jobs</td>
</tr>
</tbody>
</table>
<blockquote>
<p>In all cases, you have to provide the printer name of the printer. It is also possible to provide a reason using <code>-r</code> switch.</p>
</blockquote>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cupsdisable<span class="w"> </span>Apple-Dot-Matrix<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;need more paper&quot;</span>
$<span class="w"> </span>lpc<span class="w"> </span>status
Apple-Dot-Matrix:
<span class="w">    </span>printer<span class="w"> </span>is<span class="w"> </span>on<span class="w"> </span>device<span class="w"> </span><span class="s1">&#39;ipp&#39;</span><span class="w"> </span>speed<span class="w"> </span>-1
<span class="w">    </span>queuing<span class="w"> </span>is<span class="w"> </span>enabled
<span class="w">    </span>printing<span class="w"> </span>is<span class="w"> </span>disabled
<span class="w">    </span><span class="m">2</span><span class="w"> </span>entries
<span class="w">    </span>daemon<span class="w"> </span>present
</code></pre></div>
                                            <br clear="both" />
                                            <h1>109.1 Fundamentals of internet protocols</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should demonstrate a proper understanding of TCP/IP network fundamentals.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Demonstrate an understanding of network masks and CIDR notation.</li>
<li>Knowledge of the differences between private and public "dotted quad" IP addresses.</li>
<li>Knowledge about common TCP and UDP ports and services (20, 21, 22, 23, 25, 53, 80, 110, 123, 139, 143, 161, 162, 389, 443, 465, 514, 636, 993, 995).</li>
<li>Knowledge about the differences and major features of UDP, TCP and ICMP.</li>
<li>Knowledge of the major differences between IPv4 and IPv6.</li>
<li>Knowledge of the basic features of IPv6.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li>/etc/services</li>
<li>IPv4, IPv6</li>
<li>Subnetting</li>
<li>TCP, UDP, ICMP</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_QD4413ezWs" title="LPIC1 - 068 - 109.1 (1/3) - Networking Fundamentals; A look at IP Networking and its Basics" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>TCP/IP</h3>
<p>The <em>Transmission Control Protocol/Internet Protocol</em> (or TCP/IP in short) is stack or protocols which powers the most of communications on the Internet (and many other networks). Although it is generally called TCP, it also includes UDP, ICMP, DNS and many others. </p>
<h3>IP</h3>
<p>Internet Protocol or IP is a way to logically pointing to a host on the Internet. When a device has an IP Address, it is possible to send data toward it. The IP addresses should be unique so the network will know where each packet is intended to go. There are 2 active versions of the IP protocol; 4 &amp; 6.</p>
<p>An IPv4 is in the form of A.B.C.D where A, B, C &amp; D are between 0-255. The followings are all valid IP addresses:</p>
<div class="highlight"><pre><span></span><code><span class="mf">1.2.3.4</span>
<span class="mf">1.1.1.1</span>
<span class="mf">100.0.0.100</span>
<span class="mf">192.168.1.4</span>
</code></pre></div>

<blockquote>
<p>each part of an IP address is called an Octet since it is constructed of an 8 bit number (0..255) and can be shown in binary or hex or any notation, but Decimal format is more common.</p>
</blockquote>
<p>Having in mind that each octet can be between 0 to 255, in total we can have 256 * 256 * 256 * 256 = 4294967296 IPv4 addresses; That is around 4.3 billion - only! Thats why we are switching to IPv6.</p>
<h4>Private IPs</h4>
<p>IP addresses should be uniq on a network so people should get their IP addresses from a central authority called Internet Assigned Numbers Authority (IANA). The available IP addresses are grouped in 3 classes:</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>First Octet</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>1-126</td>
<td><code>1.0.0.0</code> to <code>126.255.255.255</code></td>
</tr>
<tr>
<td>B</td>
<td>128-191</td>
<td><code>128.0.0.0</code> to <code>191.255.255.255</code></td>
</tr>
<tr>
<td>C</td>
<td>192-223</td>
<td><code>192.0.0.0</code> to <code>223.255.255.255</code></td>
</tr>
</tbody>
</table>
<p>Normally if you are creating a server on your service provider, that service provider will give you an IP address purchased from IANA (via smaller regional registries). But what happens if you want to assign an IP to your laptop or mobile phone of tablet <em>inside</em> your home? These devices are not visible directly on the Internet and you are not going to purchase IPs for them.</p>
<p>Here the <em>Private IP Address</em> ranges come to play. The below ranges are called "private" addresses and anyone can assign them to any device they want, as long as they are not visible on the open internet.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">range</th>
<th style="text-align: left;">Number of IPs in this range</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">192.168.0-255.0-255</td>
<td style="text-align: left;">65K IPs</td>
</tr>
<tr>
<td style="text-align: left;">172.16-31.0-255.0-255</td>
<td style="text-align: left;">1M IPs</td>
</tr>
<tr>
<td style="text-align: left;">10.0-255.0-255.0-255</td>
<td style="text-align: left;">16M IPs</td>
</tr>
</tbody>
</table>
<p>Any one can use any of these IPs on her devices as long as it is not connected directly to the internet. Have a look at this example:</p>
<div class="highlight"><pre><span></span><code>                                                                                              XXXXXX
                                                                          XXXXXX   XXXXX    XXX    XX
                 +--------+                                              X     XXXXX   XXXXXX       XX
        +--------+172.16. |                                             XX                           X
        |        |1.1     |                                             X                            X
   +--------+    |        |                                             X                           XX
   |192.168.|    +--------+                                           XXX  Internet, Only         XX
   |2.100   |         |           +-----------------+              XXXXX   uses Public          XXXX
   |        |         |           |                 |           XXX        IP Addresses        XX
   +--------+    Private Network  | NAT, Translates |Public IP XX                              X
        |             +-----------+ between Public  +---------+X      Devices with Private IPs  XX
        |             |           | and Private IPs | 87.3.91.4 XX     reach the Internet via     X
   +--------+     +--------+      |                 |           XX    the Public IP configured   XX
   |192.168.|     |        |      |                 |            XXX    on their NAT device.     X
   |2.200   |     |172.16. |      +-----------------+               XX                          XX
   |        |     |1.2     |                                      XXX                           X
   +--------+     |        |                                     XX                             XX
                  +--------+                                     X                               XX
                                                                 X                              XXX
                                                                 XX                           XXX
                                                                   XX    XXXXXXX     XXXXXXXXXX
                                                                    XXXXXX     XXXXXXX
</code></pre></div>

<p>In the middle you can see a <code>Network Address Translation</code> or <code>NAT</code> device. It is connected to the Internet using only one public IP (It might be 87.3.91.4). On the left side of the NAT box, there are 4 devices with Private IPs. Each time any of these devices targets an address on the Internet (a public IP), the NAT device will use its own public IP to request that IP and when the answer is ready, will provide it to the <em>Natted</em> device - the device behind the NAT. This way we can create huge networks behind a NAT device. In this scenario, all the devices can reach the Internet but no-one from the Internet can directly reach any of them, directly; Unless we've configured an DMZ. </p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/A3SIx41ivBk" title="LPIC1 - 069 - 109.1 (2/3) - Networking Fundamentals; IP Subnetting. Netmasks &amp; CIDR notation" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h4>Subnetting (and Netmask)</h4>
<p>OK! We have around 4B addresses in IPv4. But what happens if I send a packet to another IP? Say I try to print a document on the <em>local</em> printer using its private IP as you learned in previous section? Who should listen for this packet? Does the whole Internet passes it hand to hand? Obviously not! Only my <em>local</em> network should be able to receive that packet and in this specific case, only they printer should receive it on its local IP.</p>
<p>This is achieved by subnetting. The purpose of subnetting is to create <em>sub</em>-<em>networks</em> in your IP address range. You have already seen this times and times when talking about your Netmask (the 255.255.255.0 is a famous one) or its CIDR notation which is <code>/24</code>. Lets have a deeper look.</p>
<blockquote>
<p>CIDR stands for Classless Inter-Domain Routing</p>
</blockquote>
<p>When speaking about networks, you have to decide on </p>
<ol>
<li>How many bits of my IP address is going to be shared between all my devices (network)</li>
<li>How many bits of my IP address is going to differentiate my devices in this network (hosts)</li>
</ol>
<p>For example if you assign the <code>192.168.1.1</code> to your router and set the Netmask on <code>/24</code>, you are claiming 24 (left hand bits) of <code>192.168.1.1</code> as your Network (so <code>192.168.1.</code> because 245 = 8 * 3) and 8 bits as your Host (last octet). In this network you can assign these IPs to your devices:  <code>192.168.1.10</code>,  <code>192.168.1.2</code>,  <code>192.168.1.200</code> and they will see each other correctly. </p>
<p>There are 2 methods to talk about Netmask bits. The CIDR <code>/24</code> method and Decimal Netmask (255.255.255.0) method. In CIDR we are saying how many bits are 1 (the network section of an IP address) and in Decimal method, we are representing these 1 bits in an IP address format. Have a look at the following table:</p>
<table>
<thead>
<tr>
<th>Decimal</th>
<th>CIDR</th>
<th>Binary</th>
</tr>
</thead>
<tbody>
<tr>
<td>255.0.0.0</td>
<td>/8</td>
<td>11111111.00000000.00000000.00000000</td>
</tr>
<tr>
<td>255.255.0.0</td>
<td>/16</td>
<td>11111111.11111111.00000000.00000000</td>
</tr>
<tr>
<td>255.255.255.0</td>
<td>/24</td>
<td>11111111.11111111.11111111.00000000</td>
</tr>
</tbody>
</table>
<blockquote>
<p>In above table I'm just showing the easy ones ;) If you are taking an CCNA exam, you should be able to calculate the Network/Host section for something like /13; which is not difficult now that you know the concept.</p>
</blockquote>
<p>Any time any packets tries to reach any IP in my <strong>subnet</strong> (that is 192.168.1.0-255), my router routes the packets correctly to the destination. But If any devices tries to reach anything out of my subnet (say a public IP), my router will use its NAT functionality (or other methods) to send the packets over the Internet (or the correct network based on the routing table).</p>
<blockquote>
<p>for a better understanding of subnetting, have a look at <a href="http://www.cisco.com/c/en/us/support/docs/ip/routing-information-protocol-rip/13788-3.html">Cisco document</a></p>
</blockquote>
<h3>Network and Broadcast Address</h3>
<p>When having the IP address and the Network Mask, we can calculate the network address and the broadcast address. </p>
<p>The network address is a Logical AND between the IP address and the networkmask. The broadcast address is the network address with a Logical OR when all the host bits are changed to 1. </p>
<p>Confusing... yes. Because talking about maths is difficult. Say we have the <code>192.168.4.12</code> as our IP Address and our CIDR is /24 (that is 255.255.255.0). Lets calculate the network and broadcast addresses. <code>ipcalc</code> a useful utility you can use.</p>
<div class="highlight"><pre><span></span><code><span class="n">IP</span><span class="o">:</span><span class="w">        </span><span class="mf">11000000.10101000</span><span class="o">.</span><span class="mf">00000100.00001100</span><span class="w"> </span><span class="o">(</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">4.12</span><span class="o">)</span>
<span class="n">Netmask</span><span class="o">:</span><span class="w">   </span><span class="mf">11111111.11111111</span><span class="o">.</span><span class="mf">11111111.00000000</span><span class="w"> </span><span class="o">(</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="o">)</span>
<span class="n">Network</span><span class="o">:</span><span class="w">   </span><span class="mf">11000000.10101000</span><span class="o">.</span><span class="mf">00000100.00000000</span><span class="w"> </span><span class="o">(</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">4.0</span><span class="o">)</span>
<span class="n">Broadcast</span><span class="o">:</span><span class="w"> </span><span class="mf">11000000.10101000</span><span class="o">.</span><span class="mf">00000100.11111111</span><span class="w"> </span><span class="o">(</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">4.255</span><span class="o">)</span>
</code></pre></div>

<h3>Binary to Decimal Conversion</h3>
<p>You are probably familiar with binary base - it is the basis of anything related to computers. If not I highly recommend you to do a google search and study it from another source since this book assumes you already know it. In short when writing numbers on binary format (base 2), the only used digits are 0 and 1. An easy way for conversion is using the following table to convert 0 and 1s to our <em>normal</em> decimal format. Its enough to know the value of each bit and add up the ones having 1 in them.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">128</th>
<th style="text-align: left;">64</th>
<th style="text-align: left;">32</th>
<th style="text-align: left;">16</th>
<th style="text-align: left;">8</th>
<th style="text-align: left;">4</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">Decimal</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">128</td>
</tr>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">129</td>
</tr>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">32</td>
</tr>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">132</td>
</tr>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">6</td>
</tr>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">179</td>
</tr>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">255</td>
</tr>
</tbody>
</table>
<p>So <code>11000000.10101000.00000001.00001111</code> equals to <code>192.168.1.15</code>.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/rUQe5ezhmRE" title="LPIC1 - 070 - 109.1 (3/3) - Networking Fundamentals; TCP/IP Protocols, Ports and TCP vs UDP vs ICMP" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>Communication Protocols</h3>
<p>When computers communicate, they use Protocols. This protocols are designed to let computers speak in different ways for fulfilling different needs. Here we will have a look at three of the most popular protocols on the Internet: TCP / UDP / ICMP.</p>
<h4>TCP</h4>
<p>Transmission Control Protocol or TCP is designed to make sure that both parties are <em>speaking</em> with each other without loosing any information. In this protocol the receiver will get anything the sender sends, exactly as it is sent. When you are downloading a program from the Internet, TCP is the best option because you need the file to be downloaded <strong>exactly</strong> as it is stored on the server. The TCP communication is kind of like this:</p>
<div class="highlight"><pre><span></span><code>A- Are you ready?
B- Yes
A- Please share with me the file XYZ
B- Ok. Are you ready?
A- Yes. Start sending
B- OK. This is the part 1 of XYZ
A- OK I got it based on these criteria?
B- Good. Now is it correct?
A- Yes. Please send the second part
B- OK. Are you ready for the second part?
A- Yes.
B- Here comes the second part
A- ...
B- ...
</code></pre></div>

<p><img alt="tcp flow diagram" src="/images/tcpflow.gif"></p>
<p>As you can see, TCP needs a lot of communications and spends time (or even retransmits data) to make sure that the receiver is getting the exact correct data available on the server. Strangely in some cases this is not what we are looking for. If you are watching a movie or having a phone call or enjoying a game stream, you prefer to continue watching live in case of a 1s issue in your network. Thats why we also have the UDP. </p>
<h4>UDP</h4>
<p>You are video-chatting with a friend and network fluctuates. What is a better choice? </br>
A) retransmitting the missing packets and/or reestablishing the connection and continue the whole conversation with a 2s delay or ... </br> 
B) just show the newer packets we got and continue the live vide-conference and just forget about that 2 second fluctuation (missed data)? If your choice is B, it is better if you use UDP (User Datagram Protocol) for your chat program. UDP is less reliable: the sender sends packets without communicating much and hearing back from the receiver and receiver listens for packets without negotiating the exact details with the sender. It is much faster than TCP but you can not be sure that 100% of packets will be received by the B party.</p>
<h4>ICMP</h4>
<p>Internet Control Messaging Protocol or ICMP is a specific purpose protocol used to check the connectivity of the servers by the <code>ping</code> command. The first computer just tells "are you there?" and the second will answer "yes I'm here". Have a look at this practical example:</p>
<div class="highlight"><pre><span></span><code>[jadi@funlife ~]$ ping google.com
PING google.com (173.194.32.135) 56(84) bytes of data.
64 bytes from 173.194.32.135: icmp_seq=1 ttl=48 time=239 ms
64 bytes from 173.194.32.135: icmp_seq=2 ttl=48 time=236 ms
^C
--- google.com ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 236.707/238.174/239.642/1.546 ms
</code></pre></div>

<p>As you can see, we are pinging (send ICMP packets) to a server and it answers are back (replying to our ICMP packets).</p>
<blockquote>
<p>ICMP is used for network troubleshooting and DOES NOT transfers user data</p>
</blockquote>
<h3>Port</h3>
<p>Any computer has an address but there are many programs running on that computer. By using an IP address you can tell the Internet the destination of your packets but how can you decide which program on that computer should answer to your packet? We know that a computer with the address of 5.1.23.1 has a webserver and a ftp server on it but how can we reach it and tell it "i want the index.html of your webserver" or "deliver me the XYZ file from your FTP server"? This is done using PORTs. Ports are numbers where a program LISTENS to. For example port 80 is reserved for webservers so if I connect to 5.1.23.1:80 I'm sure that I'm talking with the webserver. In the same way, when the file transport protocol (FTP) starts, it starts listening on port 20 &amp; 21 and if I use a FTP client to reach that computer, I will automatically connect to port 21 which is reserved for FTP.</p>
<p>Different ports can use different transmission protocols (UDP or TCP). The default port of some protocols are as follow. These are very important and most admins know them.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">port</th>
<th style="text-align: center;">usage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">20, 21</td>
<td style="text-align: center;">FTP (one data, one control)</td>
</tr>
<tr>
<td style="text-align: center;">22</td>
<td style="text-align: center;">SSH</td>
</tr>
<tr>
<td style="text-align: center;">23</td>
<td style="text-align: center;">Telnet</td>
</tr>
<tr>
<td style="text-align: center;">25</td>
<td style="text-align: center;">SMTP</td>
</tr>
<tr>
<td style="text-align: center;">53</td>
<td style="text-align: center;">DNS</td>
</tr>
<tr>
<td style="text-align: center;">80</td>
<td style="text-align: center;">HTTP</td>
</tr>
<tr>
<td style="text-align: center;">110</td>
<td style="text-align: center;">POP3</td>
</tr>
<tr>
<td style="text-align: center;">123</td>
<td style="text-align: center;">NTP</td>
</tr>
<tr>
<td style="text-align: center;">139</td>
<td style="text-align: center;">NetBIOS</td>
</tr>
<tr>
<td style="text-align: center;">143</td>
<td style="text-align: center;">IMAP</td>
</tr>
<tr>
<td style="text-align: center;">161, 162</td>
<td style="text-align: center;">SNMP</td>
</tr>
<tr>
<td style="text-align: center;">389</td>
<td style="text-align: center;">LDAP</td>
</tr>
<tr>
<td style="text-align: center;">443</td>
<td style="text-align: center;">HTTPS</td>
</tr>
<tr>
<td style="text-align: center;">465</td>
<td style="text-align: center;">SMTPS</td>
</tr>
<tr>
<td style="text-align: center;">636</td>
<td style="text-align: center;">LDAPS</td>
</tr>
<tr>
<td style="text-align: center;">993</td>
<td style="text-align: center;">IMAPS</td>
</tr>
<tr>
<td style="text-align: center;">995</td>
<td style="text-align: center;">POP3S</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note that in this table all ports above 400 ends with S, which stands for <strong>S</strong>ecure</p>
</blockquote>
<p>You can find all of the above ports and many many others in <code>/etc/services</code></p>
<h3>IPv6</h3>
<p>We saw that there are only around 4B IPv4s available. Just consider that we are around 7B people on the planet earth so there is not even enough IP for every person on IPv4 range. Add to this the latest demands from all the mobile phones, cars, fridges, clocks, TVs, camera, ...! They all want to be on the Internet; this is called Internet Of Things. What should be done? We saw one solution called NAT but the permanent solution is a new version of the IP; IP version 6. In version 6 IPs are not limited to 4 octets anymore.</p>
<p>Each IPv6 has 128 bits. They are grouped in 8, 16 bit groups and are normally written in Hex (base 16) format. A sample IPv6 address looks like <code>2001:0db8:0a0b:12f0:0000:0000:0000:0001</code> and it can be shortened to <code>2001:db8:a0b:12f0::1</code>. Here we have decimal numbers from <strong>0000</strong> to <strong>FFFF</strong> and <strong>8</strong> fields which are separated by <strong>:</strong>. </p>
<p>IPv6 provides us around 3.4*(10^38) IPs which is enough for whatever we can imagine at the moment. Just imagine that it can allocate 2^52 addresses for every observable star in the known universe.</p>
                                            <br clear="both" />
                                            <h1>109.2 Persistent network configuration</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to view, change and verify configuration settings on client hosts.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Understand basic TCP/IP host configuration</li>
<li>Configure ethernet and wi-fi network configuration using NetworkManager</li>
<li>Awareness of systemd-networkd</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/hostname</code></li>
<li><code>/etc/hosts</code></li>
<li><code>/etc/nsswitch.conf</code></li>
<li><code>/etc/resolv.conf</code></li>
<li><code>nmcli</code></li>
<li><code>hostnamectl</code></li>
<li><code>ifup</code></li>
<li><code>ifdown</code></li>
</ul>
<h3>Intro</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/YN8sJuy9df8?si=BEs4RmfvW1zdSUA4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>As we saw in the previous section, every PC, server, laptop, phone, .. should have an IP configuration (IP, Netmask, Default gateway, DNS, ..) to work properly in the network. This can be done in various ways. Some devices like laptops are changing their network all the time and should be able to keep up with the changes. Some servers remain in the same location (physical and network wise) all their life and should persist this configuration after restarts, outages, upgrade and HW changes.</p>
<p>In this section we will see how this can be achieved in modern GNU/Linux systems.</p>
<h3>Network Interface</h3>
<p>The NIC (or Network Interface Card) is the physical network hardware in your computer. This can be the chip+antenna in your mobile phone or an Ethernet Card connected to a network cable on your PC.</p>
<p>In older systems, these were called things like <code>eth0</code>, <code>eth1</code>, <code>eth2</code>, ... where 0, 1 &amp; 2 were decided by the kernel - mostly based on the order of loading the drivers. In recent Linux machines the NICs are called by <code>wlan0</code>, <code>eno1</code>, <code>ens1</code>, <code>enp3s2</code> and such. This is based on some more concrete data like being an <code>wireless</code> or <code>ethernet</code>, PCI (<code>ens</code>) or bus like (<code>enp</code>). </p>
<p>The <code>ip</code> command can show these:</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="nv">ip</span><span class="w"> </span><span class="nv">link</span><span class="w"> </span><span class="k">show</span>
<span class="mi">1</span>:<span class="w"> </span><span class="nv">lo</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">LOOPBACK</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">mtu</span><span class="w"> </span><span class="mi">65536</span><span class="w"> </span><span class="nv">qdisc</span><span class="w"> </span><span class="nv">noqueue</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">UNKNOWN</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nv">DEFAULT</span><span class="w"> </span><span class="nv">group</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">qlen</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="nv">link</span><span class="o">/</span><span class="nv">loopback</span><span class="w"> </span><span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span><span class="w"> </span><span class="nv">brd</span><span class="w"> </span><span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>
<span class="mi">2</span>:<span class="w"> </span><span class="nv">wlp108s0</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">BROADCAST</span>,<span class="nv">MULTICAST</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="nv">qdisc</span><span class="w"> </span><span class="nv">noqueue</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">UP</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nv">DORMANT</span><span class="w"> </span><span class="nv">group</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">qlen</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="nv">link</span><span class="o">/</span><span class="nv">ether</span><span class="w"> </span><span class="mi">00</span>:<span class="nv">bb</span>:<span class="mi">60</span>:<span class="mi">97</span>:<span class="mi">6</span><span class="nv">b</span>:<span class="mi">07</span><span class="w"> </span><span class="nv">brd</span><span class="w"> </span><span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>
<span class="mi">3</span>:<span class="w"> </span><span class="nv">docker0</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">NO</span><span class="o">-</span><span class="nv">CARRIER</span>,<span class="nv">BROADCAST</span>,<span class="nv">MULTICAST</span>,<span class="nv">UP</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="nv">qdisc</span><span class="w"> </span><span class="nv">noqueue</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">DOWN</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nv">DEFAULT</span><span class="w"> </span><span class="nv">group</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span>
<span class="w">    </span><span class="nv">link</span><span class="o">/</span><span class="nv">ether</span><span class="w"> </span><span class="mi">02</span>:<span class="mi">42</span>:<span class="mi">75</span>:<span class="nv">d3</span>:<span class="nv">e6</span>:<span class="nv">ff</span><span class="w"> </span><span class="nv">brd</span><span class="w"> </span><span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>
</code></pre></div>

<blockquote>
<p>The <code>lo</code> is a virtual network adapter called the <em>loopback</em> device. It is always there and points to "this device or 127.0.0.1 as IPv4 calls it".</p>
</blockquote>
<h3>Configuring NICs</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/KKL-r4eAZHI?si=Av2ehqBv7eoRHuGw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>In older distributions, the <code>ifconfig</code> was used to check / configure the IP settings on NICs. Have a look:</p>
<div class="highlight"><pre><span></span><code>$ ifconfig
enp0s25: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        ether f0:de:f1:62:c5:73  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 20  memory 0xd1500000-d1520000  

lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1  (Local Loopback)
        RX packets 560719  bytes 339937974 (324.1 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 560719  bytes 339937974 (324.1 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlp3s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.35  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::8ea9:82ff:fe7b:8906  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 8c:a9:82:7b:89:06  txqueuelen 1000  (Ethernet)
        RX packets 2325385  bytes 2629859900 (2.4 GiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2023796  bytes 510997240 (487.3 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre></div>

<p>It is also possible to use <code>ifconfig</code> to change the network configurations, but you should have root access:</p>
<div class="highlight"><pre><span></span><code>$  sudo ifconfig enp0s25 192.168.42.42
password for jadi:
$ ifconfig enp0s25
enp0s25: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        inet 192.168.42.42  netmask 255.255.255.0  broadcast 192.168.42.255
        ether f0:de:f1:62:c5:73  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 20  memory 0xd1500000-d1520000  

$
</code></pre></div>

<p>In case you want to change the netmask of an interface, do <code>ifconfig eth0 netmask 255.255.0.0</code> or as most of us used to do, issue both in one command:</p>
<div class="highlight"><pre><span></span><code># ifconfig eth0 192.168.42.42 netmask 255.255.255.0
</code></pre></div>

<p>It is also possible to turn the interfaces <em>up</em> and <em>down</em> (on and off) using predefined configurations by:</p>
<div class="highlight"><pre><span></span><code>$ sudo ifconfig enp0s25 down
[sudo] password for jadi:
$ ifconfig
lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1  (Local Loopback)
        RX packets 562273  bytes 340257228 (324.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 562273  bytes 340257228 (324.4 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlp3s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.35  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::8ea9:82ff:fe7b:8906  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 8c:a9:82:7b:89:06  txqueuelen 1000  (Ethernet)
        RX packets 2330388  bytes 2634026235 (2.4 GiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2027352  bytes 511549072 (487.8 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre></div>

<p>As you can see, downing the interface removed it from the list of active interfaces, using switch <code>-a</code> will tell the <code>ifconfig</code> to show ALL interfaces, even if they are down.</p>
<p>In many systems there are <code>ifup</code> and <code>ifdown</code> commands directly to up and down interfaces easily. They work just like <code>ifup eth0</code>.</p>
<p>These predefined configs are located at <code>/etc/network/interfaces</code> on Debian based machines and at <code>/etc/sysconfig/network-scripts/</code> in RPM based distro. </p>
<p>This is a sample of such file on a RedHat based distro:</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/sysconfig/network-scripts/ifcfg-eth0
DEVICE=eth0
ONBOOT=yes
TYPE=Ethernet
IPADDR=192.168.1.10
NETMASK=255.255.255.0
DNS1=4.2.2.4
</code></pre></div>

<p>On RPM systems, the default gateway is configured via the below file:</p>
<div class="highlight"><pre><span></span><code>cat /etc/sysconfig/network
NETWORKING=yes
HOSTNAME=lpictest
GATEWAY=192.168.1.1
</code></pre></div>

<p>On Debian based systems (including Ubuntu) the main configuration file for network interfaces is <code>/etc/network/interfaces</code>. This one file has the configuration for all the interfaces. Have a look:</p>
<div class="highlight"><pre><span></span><code>auto lo
iface lo inte loopback

auto eth0
#ifconfig eth0 inet dhcp
iface eth0 inet static
address 192.168.1.10
netmask 255.255.255.0
gateway 192.168.1.1
dns-nameservers 4.2.2.4
</code></pre></div>

<h3><code>ip</code></h3>
<p>Recent distributions are mostly using the <code>ip</code> command. This command can do lots of things including and not limited to showing and configuring the IP addresses, netmasks, default gateways &amp; routing rules.</p>
<div class="highlight"><pre><span></span><code><span class="nv">ip</span><span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="mi">172</span>.<span class="mi">19</span>.<span class="mi">1</span>.<span class="mi">10</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nv">dev</span><span class="w"> </span><span class="nv">eth2</span><span class="w"> </span>#<span class="w"> </span><span class="nv">temporary</span><span class="w"> </span><span class="nv">adding</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">IP</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="nv">eth2</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="nv">del</span><span class="w"> </span><span class="mi">172</span>.<span class="mi">19</span>.<span class="mi">1</span>.<span class="mi">10</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nv">dev</span><span class="w"> </span><span class="nv">eth2</span><span class="w"> </span>#<span class="w"> </span><span class="nv">deleting</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">IP</span><span class="w"> </span><span class="nv">address</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">link</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">eth2</span><span class="w"> </span><span class="nv">up</span><span class="w"> </span>#<span class="w"> </span><span class="nv">brining</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">NIC</span><span class="w"> </span><span class="nv">up</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">route</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">route</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">via</span><span class="w"> </span><span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">1</span><span class="w"> </span>#<span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">gateway</span>
</code></pre></div>

<p>Please note that above commands do temporary changes which will be lost after restarting the <code>NetworkManager</code> service. If you need permanent changes, it should be done using the configuration files or Network Manager interfaces. </p>
<h3>NetworkManager &amp; <code>nmcli</code></h3>
<p>In recent years, <code>NetworkManager</code> services has gained a lot of popularity. This service can "watch" the status of network and various configuration and configure the network cards (specially the wifi ones) accordingly. This is what makes our laptop connected whenever we open it in an area with a known WiFi or ask about the password if we want to connect to a new network or assign IP addresses as soon as we connect the cable to our Ethernet card. This IP assignment might happen via the "permanent IP configuration" on your device or a protocol called DHCP. When using DHCP (Dynamic Host Configuration Protocol), your computer asks a DHCP server (say your home's wifi router) about the IP, Netmask, Default gateway, DNS and other stuff and sets them. </p>
<p>By default, NetworkManager  daemon controls the networks which are not mentioned in <code>/etc/network/interfaces</code>. This service is running in the background and controls the NICs which are not configured there. Various frontend GUI (graphical user interface) or TUI (textual user interface. try <code>nmtui</code> ) or CLI (command line interfaces) programs exists to control or configure the NetworkManager daemon. If you are using a Desktop Linux, you've probably already used / know one (say the network manager applet). Here I will show you how to use the <code>nmcli</code> from the command line.</p>
<p>We always call the <code>nmcli</code> with one of it various commands, here is a list:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>general</td>
<td>NetworkManager’s general status and operations.</td>
</tr>
<tr>
<td>networking</td>
<td>Overall networking control.</td>
</tr>
<tr>
<td>radio</td>
<td>NetworkManager radio switches.</td>
</tr>
<tr>
<td>connection</td>
<td>Controlling the connection</td>
</tr>
<tr>
<td>device</td>
<td>Devices controlled by NetworkManager</td>
</tr>
<tr>
<td>agent</td>
<td>secret or polkit agent</td>
</tr>
<tr>
<td>monitor</td>
<td>Montor the changes</td>
</tr>
</tbody>
</table>
<p>For example, we can check the current status with the <code>general</code> command:</p>
<div class="highlight"><pre><span></span><code>➜  ~ nmcli general
STATE      CONNECTIVITY  WIFI-HW  WIFI     WWAN-HW  WWAN    
connected  full          enabled  enabled  missing  enabled
</code></pre></div>

<p>Or if you want to check the devices or list of Wi-Fi connections:</p>
<div class="highlight"><pre><span></span><code>➜  ~ nmcli device          
DEVICE            TYPE      STATE                   CONNECTION          
wlp108s0          wifi      connected               Sharm Bar Sansoor 5 
docker0           bridge    connected (externally)  docker0             
lo                loopback  connected (externally)  lo                  
p2p-dev-wlp108s0  wifi-p2p  disconnected            --                  
➜  ~ nmcli device wifi     
IN-USE  BSSID              SSID                 MODE   CHAN  RATE        SIGNAL  BARS  SECURITY  
        6C:AD:EF:38:13:38  AxLTE                Infra  3     270 Mbit/s  84      ▂▄▆█  WPA2      
        00:E0:4C:93:1D:B8  Lanat Be Sansoorchi  Infra  6     130 Mbit/s  59      ▂▄▆_  WPA2      
*       24:F5:A2:42:DE:CE  Sharm Bar Sansoor 5  Infra  36    540 Mbit/s  47      ▂▄__  WPA2      
        30:A2:20:DD:8B:54  AvinaAmin            Infra  7     270 Mbit/s  29      ▂___  WPA1 WPA2 
        30:85:A9:8C:71:2C  bahram               Infra  11    65 Mbit/s   29      ▂___  WPA2
</code></pre></div>

<p>To connect to a Wi-Fi network, you're a do:</p>
<div class="highlight"><pre><span></span><code><span class="nv">nmcli</span><span class="w"> </span><span class="nv">device</span><span class="w"> </span><span class="nv">wifi</span><span class="w"> </span><span class="k">connect</span><span class="w"> </span><span class="nv">AxLTE</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="nv">AFunkyPassword</span><span class="w"> </span>
</code></pre></div>

<h3>Fancy Names for Computers</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/yR07UaiNeME?si=UcsRifk-HXLH-L4U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h4>hostname</h4>
<p>Remembering IP addresses are easy for robots but not for humans. Thats why we have "hostname"s. A hostname is a like a contact list where you just tell "call Jadi" and the system known my phone number. If you check your <code>/etc/hostname</code>, you will see your machines name there. Although you can change it temporarily (or permanently). The command is <code>hostnamectl</code>. </p>
<div class="highlight"><pre><span></span><code>[funlap ~]# hostnamectl set-hostname mycoolmachine
[funlap ~]# hostname
mycoolmachine
[funlap ~]# cat /etc/hostname 
mycoolmachine
[funlap ~]# bash
[mycoolmachine ~]# 
</code></pre></div>

<p>Or you can change it as <em>transient</em>, which is a temporary change using the <code>--transient</code> switch.</p>
<p>It is also possible to define a "pretty" name for your computer so other systems might show it in their interfaces more nicely:</p>
<div class="highlight"><pre><span></span><code>[mycoolmachine ~]# hostnamectl --pretty set-hostname &quot;LAN Shared Storage&quot;
[mycoolmachine ~]# hostnamectl status
 Static hostname: mycoolmachine
 Pretty hostname: LAN Shared Storage
       Icon name: computer-convertible
         Chassis: convertible
      Machine ID: 0b126c4b6f4347168140eaa6202ce8be
         Boot ID: 675eff37f42648c6bdea31177596557f
Operating System: Manjaro Linux                   
          Kernel: Linux 6.1.38-1-MANJARO
    Architecture: x86-64
 Hardware Vendor: Dell Inc.
  Hardware Model: Latitude 7390 2-in-1
Firmware Version: 1.30.0
</code></pre></div>

<h4><code>/etc/hosts</code></h4>
<p>This file contains a list of IPs and their corresponding names, including your own computers. </p>
<div class="highlight"><pre><span></span><code>[<span class="nv">mycoolmachine</span><span class="w"> </span><span class="o">~</span>]#<span class="w"> </span><span class="nv">head</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="o">/</span><span class="nv">etc</span><span class="o">/</span><span class="nv">hosts</span>
##
#<span class="w"> </span><span class="nv">Host</span><span class="w"> </span><span class="nv">Database</span>
#
#<span class="w"> </span><span class="nv">localhost</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">configure</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">loopback</span><span class="w"> </span><span class="nv">interface</span>
#<span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">booting</span>.<span class="w">  </span><span class="k">Do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">change</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">entry</span>.
##
<span class="mi">127</span>.<span class="mi">0</span>.<span class="mi">0</span>.<span class="mi">1</span><span class="w">   </span><span class="nv">localhost</span><span class="w"> </span><span class="nv">funlife</span><span class="w"> </span><span class="nv">db</span>
<span class="mi">255</span>.<span class="mi">255</span>.<span class="mi">255</span>.<span class="mi">255</span><span class="w"> </span><span class="nv">broadcasthost</span>
::<span class="mi">1</span><span class="w">             </span><span class="nv">localhost</span>
##
#<span class="w"> </span><span class="nv">Host</span><span class="w"> </span><span class="nv">Database</span>
#
#<span class="w"> </span><span class="nv">localhost</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">configure</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">loopback</span><span class="w"> </span><span class="nv">interface</span>
#<span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">booting</span>.<span class="w">  </span><span class="k">Do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">change</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">entry</span>.
##

<span class="mi">198</span>.<span class="mi">74</span>.<span class="mi">56</span>.<span class="mi">50</span><span class="w"> </span><span class="nv">jobs</span>.<span class="nv">jadi</span>.<span class="nv">net</span>
<span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">22</span><span class="w"> </span><span class="nv">amoledtesting</span><span class="w"> </span>

<span class="mi">67</span>.<span class="mi">217</span>.<span class="mi">170</span>.<span class="mi">72</span><span class="w"> </span><span class="nv">vps</span>
</code></pre></div>

<p>So when you need to reach a machine by its name, your OS will now which IP to reach. </p>
<h4>DNS configuration</h4>
<p>DNS (which stands for Domain Name System) is a server which translates human-readable domain names (or more technically, text based domain names) to the corresponding IP addresses. You have to configure your computer to use a DNS so it will know which IP to contacted if you wanted to reach <code>linux1st.com</code> (and <a href="https://linux1st.com/support">donate</a> maybe).</p>
<p>This configuration can be found in <code>/etc/resolve.conf</code>.</p>
<div class="highlight"><pre><span></span><code>nameserver 192.168.1.1
nameserver 4.2.2.4
domain jadi.net
search jadi.net company.com
</code></pre></div>

<p>Here I'm telling my computer to contact the DNS on my home network (192.168.1.1) or a DNS located at 4.2.2.4 if it needed to translate an address to an IP. </p>
<p>The <code>domain</code> configuration sets a local domain name so the machines in this domain will be able to use a short name (tv, instead of tv.jadi.net) and the <code>search</code> config does kind the same and tells the resolver to search for <code>tv.jadi.net</code> and <code>tv.company.com</code> if it was trying to resolve <code>tv</code>.</p>
<h4>nsswitch</h4>
<p>The <code>/etc/nsswitch.conf</code> file is used to configure which services are to be used to determine information such as hostnames, password files, and group files. Mine is</p>
<div class="highlight"><pre><span></span><code># cat /etc/nsswitch.conf
# Begin /etc/nsswitch.conf

passwd: files
group: files
shadow: files

publickey: files

hosts: files dns myhostname
networks: files

protocols: files
services: files
ethers: files
rpc: files

netgroup: files

# End /etc/nsswitch.conf
</code></pre></div>

<p>So if someone wants to check a password, the system will try the password <em>file</em> on the system. Or if they want to check an ip address of a hostname, my config says <code>hosts: files dns myhostname</code> so the computer first tries the files (/etc/hosts) and then goes for DNS. If I reverse these and change the line to</p>
<div class="highlight"><pre><span></span><code>hosts:      dns files
</code></pre></div>

<p>Any resolve request will be sent to a DNS server first and the /etc/hosts will be used only if the DNS servers answers "I don't know!"</p>
                                            <br clear="both" />
                                            <h1>109.3 Basic network troubleshooting</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>Candidates should be able to troubleshoot networking issues on client hosts.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Manually configure network interfaces, including viewing and changing the configuration of network interfaces using iproute2.</li>
<li>Manually configure routing, including viewing and changing routing tables and setting the default route using iproute2.</li>
<li>Debug problems associated with the network configuration.</li>
<li>Awareness of legacy <code>net-tools</code> commands.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>ip</code></li>
<li><code>hostname</code></li>
<li><code>ss</code></li>
<li><code>ping</code></li>
<li><code>ping6</code></li>
<li><code>traceroute</code></li>
<li><code>traceroute6</code></li>
<li><code>tracepath</code></li>
<li><code>tracepath6</code></li>
<li><code>netcat</code></li>
<li><code>ifconifg</code></li>
<li><code>netstat</code></li>
<li><code>route</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/sAzkN5P2-0E?si=P1r5KgfEvit_BMFW" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>Troubleshooting network problems</h3>
<p>When a network related problem is reported to you, you have to take a lot of steps to find out where the root cause of the problem is. For example, if the report says "I can not open webpages", you have to start from checking if the network interface has an ip, if it is up, its the routing is OK and if the DNS works fine and if everything is OK, you have to try reaching a server on the Internet via <code>ping</code> command and if you see any problems, you have to use <code>traceroute</code> to see where your traffic is going wrong. In this lesson, we will review these basic steps.</p>
<h4>ifconfig &amp; ip</h4>
<p>As you already know, <code>ifconfig</code> and <code>ip</code> commands can be used to check the IP address of your interfaces. If a network card is going to work, it needs a correct IP address and netmask. Let me check my own computer to see it has an IP address:</p>
<div class="highlight"><pre><span></span><code>[jadi@debian ~]$ ip addr show
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: wlp3s0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast state DOWN group default qlen 1000
    link/ether f0:de:f1:62:c5:73 brd ff:ff:ff:ff:ff:ff
3: enp0s25: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000
    link/ether 8c:a9:82:7b:89:06 brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.35/24 brd 192.168.1.255 scope global dynamic wlp3s0
       valid_lft 254836sec preferred_lft 254836sec
    inet6 fe80::8ea9:82ff:fe7b:8906/64 scope link
       valid_lft forever preferred_lft forever
[jadi@debian ~]$ 
[jadi@debian ~]$ 
[jadi@debian ~]$ 
[jadi@debian ~]$ ifconfig
enp0s25   Link encap:Ethernet  HWaddr f0:de:f1:62:c5:73  
          inet addr:192.168.1.35  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::8ea9:82ff:fe7b:8906/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:231586 errors:0 dropped:0 overruns:0 frame:0
          TX packets:200220 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:198053888 (198.0 MB)  TX bytes:51583154 (51.5 MB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:221752 errors:0 dropped:0 overruns:0 frame:0
          TX packets:221752 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:150859909 (150.8 MB)  TX bytes:150859909 (150.8 MB)
</code></pre></div>

<p>Both commands show that my IP address is OK. This is assigned to may be the Wi-Fi modem and 192.168.1.35 as IP and 255.255.255.0 looks reasonable.</p>
<blockquote>
<p>Please note that you can get a full help on <code>ip</code> using the <code>man ip</code> or get manual of a specific section using the <code>man ip-address</code> (or any other subcommand)</p>
</blockquote>
<h4>ping &amp; ping6</h4>
<p>This is the most common tool when troubleshooting a network problem. It sends an ICMP packet to a destination and if it gets back an answer, will inform you about not only it, but all the stats. Below, I will check my default route and will try to ping it. You should always be able to ping your default router, although sometimes paranoid sysadmins block the ICMP on the network and although you are connected, you won't get back answers.</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ ip route show
default via 192.168.70.1 dev enp0s1
172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown
192.168.70.0/24 dev enp0s1 proto kernel scope link src 192.168.70.2
jadi@debian:~$ ping 192.168.70.1
PING 192.168.70.1 (192.168.70.1) 56(84) bytes of data.
64 bytes from 192.168.70.1: icmp_seq=1 ttl=64 time=1.11 ms
64 bytes from 192.168.70.1: icmp_seq=2 ttl=64 time=0.855 ms
^C
--- 192.168.70.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 0.855/0.984/1.113/0.129 msec
</code></pre></div>

<p>I can ping my gateway, but is it possible to reach a server on the Internet using its IP address. To find the answer, let's ping 4.2.2.4; it is very well known server on the Internet and many people use it to check their IP connectivity.</p>
<div class="highlight"><pre><span></span><code>[jadi@debian ~]$ ping 4.2.2.4
PING 4.2.2.4 (4.2.2.4) 56(84) bytes of data.
64 bytes from 4.2.2.4: icmp_seq=1 ttl=50 time=108 ms
64 bytes from 4.2.2.4: icmp_seq=2 ttl=50 time=111 ms
64 bytes from 4.2.2.4: icmp_seq=3 ttl=50 time=113 ms
^C
--- 4.2.2.4 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 108.160/111.233/113.717/2.338 ms
</code></pre></div>

<p>This is also working fine. But can I ping google.com too?</p>
<div class="highlight"><pre><span></span><code>[jadi@debian ~]$ ping google.com
ping: unknown host google.com
</code></pre></div>

<p>Aha! We found the problem. In this case I have a correct IP address on my machine, I can ping my default gateway and I can ping 4.2.2.4, but I can not ping google.com. The error message is "unknown host". This means my computer can not translate google.com to its IP address; this is a DNS issue:</p>
<div class="highlight"><pre><span></span><code>[jadi@debian ~]$ cat /etc/resolv.conf
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
</code></pre></div>

<p>No wonder, we had problems with surfing the WWW. There is no active DNS in my computer so no one will be able to reach sites by their domain names! This should be fixed by adding a DNS to my configuration file.</p>
<h4>routing problems</h4>
<p>In some situations you can not reach the Internet (say 4.2.2.4 or 8.8.8.8) but you can ping your gateway. Have a look:</p>
<div class="highlight"><pre><span></span><code>[jadi@debian ~]$ ping 8.8.8.8
connect: Network is unreachable
[jadi@debian ~]$ ping 192.168.1.1
PING 192.168.1.1 (192.168.1.1) 56(84) bytes of data.
64 bytes from 192.168.1.1: icmp_seq=1 ttl=254 time=3.03 ms
64 bytes from 192.168.1.1: icmp_seq=2 ttl=254 time=3.31 ms
^C
--- 192.168.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 3.039/3.174/3.310/0.146 ms
</code></pre></div>

<p>What is going on here? Let's see, what clues do I have:
1) I can reach the gateway.
2) when asking for the Internet, my computer does not know what to do.
In this case the <strong>default gateway</strong> is missing: the computer does not know what to do if a packet is outside its network mask. You know that we can set the default gateway using the <code>/etc/network/interfaces</code> config file, but there is also a <code>route</code> (or the newer <code>ip route</code> subcommand) to show and change the routing configurations on the fly.</p>
<blockquote>
<p>Routes added or changed via <code>ip route</code> (or <code>route</code>) will be lost after a reboot! Permanent configurations should come from configuration files.</p>
</blockquote>
<p>Lets check our current routing state using <code>route</code> command as root.</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ ip route show
default via 192.168.70.1 dev enp0s1
172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown
192.168.70.0/24 dev enp0s1 proto kernel scope link src 192.168.70.2

jadi@debian:~$ sudo ip route del default
[sudo] password for jadi:

jadi@debian:~$ ip route show
172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown
192.168.70.0/24 dev enp0s1 proto kernel scope link src 192.168.70.2

jadi@debian:~$ ping 4.2.2.4
ping: connect: Network is unreachable

jadi@debian:~$ ip route add default via 192.168.70.1
RTNETLINK answers: Operation not permitted

jadi@debian:~$ sudo ip route add default via 192.168.70.1

jadi@debian:~$ ping 4.2.2.4
PING 4.2.2.4 (4.2.2.4) 56(84) bytes of data.
64 bytes from 4.2.2.4: icmp_seq=1 ttl=55 time=316 ms
64 bytes from 4.2.2.4: icmp_seq=2 ttl=55 time=434 ms
^C
--- 4.2.2.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 316.253/375.282/434.311/59.029 ms
</code></pre></div>

<p>We were able to ping the Internet after adding a default gateway using <code>ip route</code> command. It is important to know that we can define even more routes and control exactly where our packets should go based on their destinations.</p>
<h4>tracepath &amp; traceroute</h4>
<p>This is a more advanced troubleshooting tool. It is like pinging all the servers between you and your destination one by one and see where our packets go wrong. Lets check how I reach google.com.</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ traceroute 4.2.2.4
traceroute to 4.2.2.4 (4.2.2.4), 30 hops max, 60 byte packets
 1  192.168.70.1 (192.168.70.1)  0.619 ms *  0.673 ms
 2  10.192.0.1 (10.192.0.1)  421.898 ms  728.657 ms  728.617 ms
 3  162.221.202.253 (162.221.202.253)  728.597 ms  728.564 ms  728.552 ms
 4  * * *
 5  207.35.48.241 (207.35.48.241)  728.289 ms  728.265 ms  728.251 ms
 6  agg2-vancouverbg_5-2-0.net.bell.ca (64.230.122.250)  728.344 ms agg1-vancouverbg_5-2-0.net.bell.ca (64.230.122.248)  612.097 ms  922.055 ms
 7  * * *
 8  bx6-seattle_et-0/0/13_ae1.net.bell.ca (64.230.76.157)  921.662 ms  921.635 ms  921.566 ms
 9  ae96.edge6.Seattle1.Level3.net (4.16.2.13)  921.511 ms  921.372 ms  921.317 ms
10  * * ae6.4.edge2.SanJose1.level3.net (4.69.220.185)  920.786 ms
11  d.resolvers.level3.net (4.2.2.4)  601.295 ms  921.003 ms  920.970 ms
</code></pre></div>

<p>On the first step (1) I reach my own router. On the 2nd step, I'm at my ISPs local network and then will reach 162.blah.blah.blah. You can see in some cases the traceroute were able to do a <strong>reverse DNS lookup</strong> and find the hostname of the IPs and show them. After 11 hops, I reached my destination. The traceroute is a very useful tool in troubleshooting network and routing issues or checking the status of your network and paths. </p>
<blockquote>
<p>In some routers, the ping traffic is blocked, and you will see <code>* * *</code> at some steps because those servers are blocking ICMP traffic.</p>
</blockquote>
<p>There is another command called <code>tracepath</code> which is very similar to <code>traceroute</code>. For the LPIC1 level, they are essentially the same!</p>
<h4>ss &amp; netstat</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/AvVOHQdbZDA?si=WZzCqGbaEdUDFp88" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>These commands can show a wide range of information about our network. The <code>ss</code> is the newer one and <code>netstat</code> is the older one. The two commands are replaceable in most cases and does the same things and even have similar option in most use cases. You can use the <code>netstat</code> to check your routing table:</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ netstat -nr
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         192.168.70.1    0.0.0.0         UG        0 0          0 enp0s1
172.17.0.0      0.0.0.0         255.255.0.0     U         0 0          0 docker0
192.168.70.0    0.0.0.0         255.255.255.0   U         0 0          0 enp0s1
</code></pre></div>

<p>Or use the <code>ss</code> to see which port is in the LISTENING mode:</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ ss -na | grep LISTEN | grep tcp
tcp   LISTEN 0      128                                       127.0.0.1:631              0.0.0.0:*
tcp   LISTEN 0      100                                         0.0.0.0:25               0.0.0.0:*
tcp   LISTEN 0      128                                         0.0.0.0:22               0.0.0.0:*
tcp   LISTEN 0      100                                            [::]:25                  [::]:*
tcp   LISTEN 0      128                                            [::]:22                  [::]:*
tcp   LISTEN 0      128                                           [::1]:631                 [::]:*
</code></pre></div>

<p>The <code>-na</code> switch will show all the open ports (including sockets) and here I'm checking only for the tcp ones in the LISTEN status.</p>
<blockquote>
<p>In these switches, <code>-n</code> stands for <em>numeric</em>, <code>-a</code> stands for <em>all ports</em> and <code>-r</code> stands for <em>routes</em>.</p>
</blockquote>
<p>A super common combination is the <code>-tulpn</code> option set:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ss</span><span class="w"> </span><span class="o">-</span><span class="n">tulpn</span>
<span class="n">Netid</span><span class="w">             </span><span class="k">State</span><span class="w">              </span><span class="n">Recv</span><span class="o">-</span><span class="n">Q</span><span class="w">             </span><span class="n">Send</span><span class="o">-</span><span class="n">Q</span><span class="w">                         </span><span class="k">Local</span><span class="w"> </span><span class="nl">Address</span><span class="p">:</span><span class="n">Port</span><span class="w">                          </span><span class="n">Peer</span><span class="w"> </span><span class="nl">Address</span><span class="p">:</span><span class="n">Port</span><span class="w">            </span><span class="n">Process</span>
<span class="n">udp</span><span class="w">               </span><span class="n">UNCONN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">0</span><span class="w">                                    </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">68</span><span class="w">                                 </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span>
<span class="n">udp</span><span class="w">               </span><span class="n">UNCONN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">0</span><span class="w">                                    </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">631</span><span class="w">                                </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span>
<span class="n">udp</span><span class="w">               </span><span class="n">UNCONN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">0</span><span class="w">                                    </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">58120</span><span class="w">                              </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span>
<span class="n">udp</span><span class="w">               </span><span class="n">UNCONN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">0</span><span class="w">                                    </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">5353</span><span class="w">                               </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span>
<span class="n">udp</span><span class="w">               </span><span class="n">UNCONN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">0</span><span class="w">                                       </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="mi">39822</span><span class="w">                                 </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="o">*</span>
<span class="n">udp</span><span class="w">               </span><span class="n">UNCONN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">0</span><span class="w">                                       </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="mi">5353</span><span class="w">                                  </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="o">*</span>
<span class="n">tcp</span><span class="w">               </span><span class="n">LISTEN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">128</span><span class="w">                                </span><span class="mf">127.0.0.1</span><span class="err">:</span><span class="mi">631</span><span class="w">                                </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span>
<span class="n">tcp</span><span class="w">               </span><span class="n">LISTEN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">100</span><span class="w">                                  </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">25</span><span class="w">                                 </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span>
<span class="n">tcp</span><span class="w">               </span><span class="n">LISTEN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">128</span><span class="w">                                  </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">22</span><span class="w">                                 </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span>
<span class="n">tcp</span><span class="w">               </span><span class="n">LISTEN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">100</span><span class="w">                                     </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="mi">25</span><span class="w">                                    </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="o">*</span>
<span class="n">tcp</span><span class="w">               </span><span class="n">LISTEN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">128</span><span class="w">                                     </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="mi">22</span><span class="w">                                    </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="o">*</span>
<span class="n">tcp</span><span class="w">               </span><span class="n">LISTEN</span><span class="w">             </span><span class="mi">0</span><span class="w">                  </span><span class="mi">128</span><span class="w">                                    </span><span class="o">[</span><span class="n">::1</span><span class="o">]</span><span class="err">:</span><span class="mi">631</span><span class="w">                                   </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="o">*</span>
</code></pre></div>

<h4>netcat</h4>
<p>The <code>nc</code> (or netcat) utility is used for just about anything under the sun involving TCP, UDP, or UNIX-domain sockets. It can open TCP connections, send UDP packets, listen on arbitrary TCP and UDP ports, do port scanning, and deal with both IPv4 and IPv6. Unlike <code>telnet</code>, <code>nc</code> can be used easily in the scripts and separates error messages onto standard error instead of sending them to standard output, as telnet does with some. This is a very capable command, and it is enough for you to be familiar with its general concept.</p>
<p>Here I'm creating a tcp listener on port 1337:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="mi">1337</span>
</code></pre></div>

<p>And here I'm opening a connection to that port and sending some data:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="n">localhost</span><span class="w"> </span><span class="mi">1337</span>
<span class="k">Are</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">enjoying</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">LPIC</span><span class="vm">?</span>
</code></pre></div>

<p>And the message should be visible on the listening <code>nc</code>. </p>
<h4>dig</h4>
<p>The <code>dig</code> command is a DNS lookup tool. If you are having a problem with a domain name, you can check how it is being resolved to IPs; and by whom.</p>
<div class="highlight"><pre><span></span><code>[jadi@debian ~]$ dig google.com

; &lt;&lt;&gt;&gt; DiG 9.9.5-11ubuntu1.3-Ubuntu &lt;&lt;&gt;&gt; google.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 50032
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;google.com.            IN    A

;; ANSWER SECTION:
google.com.        293    IN    A    216.58.214.46

;; Query time: 120 msec
;; SERVER: 4.2.2.4#53(4.2.2.4)
;; WHEN: Fri Apr 01 22:00:05 IRDT 2016
;; MSG SIZE  rcvd: 44
</code></pre></div>

<p>You can see that SERVER 4.2.2.4 is resolving google.com to 216.58.214.46.</p>
                                            <br clear="both" />
                                            <h1>109.4 Configure client side DNS</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 2</em></p>
<p>Candidates should be able to configure DNS on a client host.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Query remote DNS servers.</li>
<li>Configure local name resolution and use remote DNS servers.</li>
<li>Modify the order in which name resolution is done.</li>
<li>Debug errors related to name resolution</li>
<li>Awareness of systemd-resolved</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/hosts</code></li>
<li><code>/etc/resolv.conf</code></li>
<li><code>/etc/nsswitch.conf</code></li>
<li><code>host</code></li>
<li><code>dig</code></li>
<li><code>getent</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/wUDhmSpr3lg?si=O1LCyXq_L4LmLn39" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>DNS</h3>
<p>We already know a lot about Domain Name System; A service which translates domain names (say yahoo.com) to IP addresses (say 206.190.36.45). A DNS server is used when you ping a server using its domain name. You have seen the config files for DNS and should know that the actual DNS server which is being used by the computer can be checked / changed (temporarily) from <code>/etc/resolv.conf</code>:</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 192.168.1.1
nameserver 4.2.2.4

$ ping x.org
PING x.org (131.252.210.176) 56(84) bytes of data.
64 bytes from annarchy.freedesktop.org (131.252.210.176): icmp_seq=1 ttl=45 time=338 ms
64 bytes from  annarchy.freedesktop.org (131.252.210.176): icmp_seq=2 ttl=45 time=333 ms
^C
--- x.org ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1000ms
rtt min/avg/max/mdev = 333.088/335.612/338.136/2.524 ms
</code></pre></div>

<h3><code>host</code></h3>
<p>This is a simple program to lookup DNS queries. This is a sample with no arguments:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>host<span class="w"> </span>kernel.org
kernel.org<span class="w"> </span>has<span class="w"> </span>address<span class="w"> </span><span class="m">139</span>.178.84.217
kernel.org<span class="w"> </span>has<span class="w"> </span>IPv6<span class="w"> </span>address<span class="w"> </span><span class="m">2604</span>:1380:4641:c500::1
kernel.org<span class="w"> </span>mail<span class="w"> </span>is<span class="w"> </span>handled<span class="w"> </span>by<span class="w"> </span><span class="m">10</span><span class="w"> </span>smtp1.kernel.org.
kernel.org<span class="w"> </span>mail<span class="w"> </span>is<span class="w"> </span>handled<span class="w"> </span>by<span class="w"> </span><span class="m">10</span><span class="w"> </span>smtp2.kernel.org.
kernel.org<span class="w"> </span>mail<span class="w"> </span>is<span class="w"> </span>handled<span class="w"> </span>by<span class="w"> </span><span class="m">10</span><span class="w"> </span>smtp3.kernel.org.
</code></pre></div>

<p>As you can see, the <code>host</code> command returns all the records it can find for a specific domain. In this case it returns IPv4 (A), IPv6 (AAAA) and two Mail (MX) records.</p>
<blockquote>
<p>if you want to check only a specific record, you can provide it via <code>-t</code> swtich. So the <code>-t A</code> will only return back the IPv4 records.</p>
</blockquote>
<h3>dig</h3>
<p>The <code>dig</code> tool is specifically build to query DNS servers. If you want to find out where x.org points to, you can do:</p>
<div class="highlight"><pre><span></span><code>$ dig x.org

; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-RedHat-9.10.3-12.P4.fc23 &lt;&lt;&gt;&gt; x.org
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 7483
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;x.org.                IN    A

;; ANSWER SECTION:
x.org.            1625    IN    A    131.252.210.176

;; Query time: 35 msec
;; SERVER: 192.168.1.1#53(192.168.1.1)
;; WHEN: Sun Apr 17 12:45:02 IRDT 2016
;; MSG SIZE  rcvd: 50
</code></pre></div>

<p>As you can see, <code>dig</code> did an <strong>ip lookup</strong> for <code>x.org</code> and told me that its IP is 131.252.210.176. The <code>1625</code> is called the <strong>TTL</strong> or <em>Time To Live</em> and show how many seconds this answer will be considered valid in cache. This command also tells us which server is used to query the answer (last 4 lines) and when and how long it took.</p>
<p>There is also a way to tell <code>dig</code> command what server it should use as the DNS vi <code>@&lt;DNS-SERVER&gt;</code>:</p>
<div class="highlight"><pre><span></span><code>$ dig @8.8.8.8 google.com

; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-RedHat-9.10.3-12.P4.fc23 &lt;&lt;&gt;&gt; @8.8.8.8 google.com
; (1 server found)
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 24313
;; flags: qr rd ra; QUERY: 1, ANSWER: 11, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;google.com.            IN    A

;; ANSWER SECTION:
google.com.        112    IN    A    173.194.32.133
google.com.        112    IN    A    173.194.32.136
google.com.        112    IN    A    173.194.32.132
google.com.        112    IN    A    173.194.32.129
google.com.        112    IN    A    173.194.32.137
google.com.        112    IN    A    173.194.32.130
google.com.        112    IN    A    173.194.32.134
google.com.        112    IN    A    173.194.32.135
google.com.        112    IN    A    173.194.32.128
google.com.        112    IN    A    173.194.32.131
google.com.        112    IN    A    173.194.32.142

;; Query time: 238 msec
;; SERVER: 8.8.8.8#53(8.8.8.8)
;; WHEN: Sun Apr 17 13:03:38 IRDT 2016
;; MSG SIZE  rcvd: 215
</code></pre></div>

<p>Here I have asked dig to use <code>8.8.8.8</code> as its DNS and query <code>google.com</code>. You can see that I've got more than one answer (actually much more than one answer). My computer can randomly contact any of those IPs to reach the <code>google.com</code>. In other words, google.com is using more than one server/IP and <code>8.8.8.8</code> provides all of them when queried for that domain.</p>
<h3><code>/etc/hosts</code></h3>
<p>This file contains IP addresses and their correspondive names. This is kind of an static name resolution on your computer. Let's have a look:</p>
<div class="highlight"><pre><span></span><code>$ head /etc/hosts
127.0.0.1    funlife localhost.localdomain    localhost clickadu.com
::1    funlife localhost6.localdomain6    localhost6

10.159.32.155 nsproxy
172.16.12.134 linuxclass wonderland
193.40.12.135 salma

87.106.233.90 gratis.vps

192.168.59.231 mass1
</code></pre></div>

<p>This file can be changed by root and will map some domain names (localhost, mass1, gratis.vps, ...) to some IP addresses. If I ping <em>mass1</em> on this computer.. lets see:</p>
<div class="highlight"><pre><span></span><code>$ dig mass1

; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-RedHat-9.10.3-12.P4.fc23 &lt;&lt;&gt;&gt; mass1
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 39464
;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;mass1.                IN    A

;; AUTHORITY SECTION:
.            600    IN    SOA    a.root-servers.net. nstld.verisign-grs.com. 2016041700 1800 900 604800 86400

;; Query time: 516 msec
;; SERVER: 192.168.1.1#53(192.168.1.1)
;; WHEN: Sun Apr 17 13:15:07 IRDT 2016
;; MSG SIZE  rcvd: 109

$ ping mass1
PING mass1 (192.168.59.231) 56(84) bytes of data.
From 85-15-16-103.shatel.ir (85.15.16.103) icmp_seq=1 Packet filtered
From 85-15-16-103.shatel.ir (85.15.16.103) icmp_seq=2 Packet filtered
</code></pre></div>

<p>My computer pings 192.168.59.231 when I go for mass1 even when the DNS can not find this name because that is defined in <code>/etc/hosts</code>.</p>
<h3>nsswitch</h3>
<p>The <code>/etc/nsswitch.conf</code> file tells the system about the priority of lookups, password checks, .... Lets have a look to make it clear:</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/nsswitch.conf
#
# /etc/nsswitch.conf
#
# An example Name Service Switch config file. This file should be
# sorted with the most-used services at the beginning.
#
# The entry &#39;[NOTFOUND=return]&#39; means that the search for an
# entry should stop if the search in the previous entry turned
# up nothing. Note that if the search failed due to some other reason
# (like no NIS server responding) then the search continues with the
# next entry.
#
# Valid entries include:
#
#    nisplus            Use NIS+ (NIS version 3)
#    nis            Use NIS (NIS version 2), also called YP
#    dns            Use DNS (Domain Name Service)
#    files            Use the local files
#    db            Use the local database (.db) files
#    compat            Use NIS on compat mode
#    hesiod            Use Hesiod for user lookups
#    [NOTFOUND=return]    Stop searching if not found so far
#

# To use db, put the &quot;db&quot; in front of &quot;files&quot; for entries you want to be
# looked up first in the databases
#
# Example:
#passwd:    db files nisplus nis
#shadow:    db files nisplus nis
#group:     db files nisplus nis

passwd:     files sss
shadow:     files sss
group:      files sss

#hosts:     db files nisplus nis dns
hosts:      files mdns4_minimal [NOTFOUND=return] dns myhostname mymachines

# Example - obey only what nisplus tells us...
#services:   nisplus [NOTFOUND=return] files
#networks:   nisplus [NOTFOUND=return] files
#protocols:  nisplus [NOTFOUND=return] files
#rpc:        nisplus [NOTFOUND=return] files
#ethers:     nisplus [NOTFOUND=return] files
#netmasks:   nisplus [NOTFOUND=return] files

bootparams: nisplus [NOTFOUND=return] files

ethers:     files
netmasks:   files
networks:   files
protocols:  files
rpc:        files
services:   files sss

netgroup:   files sss

publickey:  nisplus

automount:  files sss
aliases:    files nisplus
</code></pre></div>

<p>On the DNS line I have <code>hosts: files mdns4_minimal [NOTFOUND=return] dns myhostname mymachines</code>. This means when the system wants to find the IP address of a name, it first go for the <code>files</code> (/etc/hosts) and then for m<strong>dns</strong>4_minimal and then <strong>dns</strong> and so on. In this case if I add the <code>facebook.com</code> to my <code>/etc/hosts</code> like this:</p>
<div class="highlight"><pre><span></span><code>127.0.0.1 facebook.com
</code></pre></div>

<p>And then point my browser to facebook.com, my computer will try to connect to the webserver on 127.0.0.1 instead of the real IP of Facebook.</p>
<h3>getent</h3>
<p>The <code>getent</code> command is a utility to get entries from Name Service Switch libraries (read /etc/nsswitch.conf). If you want to check what is the config of your hosts, you can do as follow.</p>
<div class="highlight"><pre><span></span><code>$ getent hosts
127.0.0.1       funlife localhost.localdomain localhost clickadu.com
127.0.0.1       funlife localhost6.localdomain6 localhost6
10.159.32.155   nsnproxy
172.16.12.134   linuxclass wonderland
193.40.12.135   salma
87.106.233.90   gratisvps
192.168.59.231  mass1
192.168.59.232  mass2
192.168.59.233  mass3
192.168.59.234  mass4
192.168.59.235  mass5
192.168.59.236  mass6
192.168.59.237  mass7
192.168.59.238  mass8
192.168.59.239  mass9
127.0.0.1       frctlstartupfailure localtodoer localdeliv
127.0.0.1       frctlmeth
</code></pre></div>

<h3><code>systemd-resolved</code></h3>
<p>It should be noted that the <code>systemd</code> provides a DNS called <code>systemd-resolved</code>. It listens for DNS requests on <code>127.0.0.53</code> and answers back after consulgint the <code>/etc/systemd/resolv.conf</code> or <code>/etc/resolv.conf</code>.</p>
<p>Read more <a href="https://wiki.archlinux.org/title/Systemd-resolved">Here</a> about <code>systemd-resolved</code>.</p>
                                            <br clear="both" />
                                            <h1>110.1 Perform security administration tasks</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should know how to review system configuration to ensure host security in accordance with local security policies.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Audit a system to find files with the suid/sgid bit set.</li>
<li>Set or change user passwords and password aging information.</li>
<li>Being able to use nmap and netstat to discover open ports on a system.</li>
<li>Set up limits on user logins, processes and memory usage.</li>
<li>Determine which users have logged in to the system or are currently logged in.</li>
<li>Basic sudo configuration and usage.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>find</code></li>
<li><code>passwd</code></li>
<li><code>fuser</code></li>
<li><code>lsof</code></li>
<li><code>nmap</code></li>
<li><code>chage</code></li>
<li><code>netstat</code></li>
<li><code>sudo</code></li>
<li><code>/etc/sudoers</code></li>
<li><code>su</code></li>
<li><code>usermod</code></li>
<li><code>ulimit</code></li>
<li><code>who, w, last</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/rNxitwVtRvo" title="LPIC 1 - 77  - 110.1 (1/3) - Perform Security Admin Tasks;su,sudo,online users &amp;password management" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Users</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/rNxitwVtRvo?si=V6a_wAv84xjOIbjx" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3><code>sudo</code> vs <code>su</code></h3>
<p>We've used <code>sudo</code> and <code>su</code> in practically all the chapters and now is the time to have a closer look! <code>su</code> switches you to some other account; a "substitute user identity". You get a new prompt with the new user account after successfully <code>su</code>ing to that account:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife ~$ whoami
jadi
jadi@funlife ~$ su -
Password:
root@funlife:~# whoami
root
root@funlife:~# su jadi -
jadi@funlife /root$ whoami
jadi
jadi@funlife /root$ exit
exit
root@funlife:~# whoami
root
root@funlife:~# exit
logout
jadi@funlife ~$ whoami
jadi
jadi@funlife ~$
</code></pre></div>

<p>Note that when running <code>su</code> you have to <strong>provide the root password</strong> to become root; or any other users password to become that user!</p>
<p>On the other hand, sudo asks for your own password and runs the command you gave it, with the root privileges. So <code>sudo ls</code> runs the ls command with the root privileges after asking for <strong>your password</strong>. Obviously you should have the <em>sudo right</em> to issue sudo. This is defined in <code>/etc/sudoers</code> file:</p>
<div class="highlight"><pre><span></span><code>$ sudo cat /etc/sudoers
#
# This file MUST be edited with the &#39;visudo&#39; command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults    env_reset
Defaults    mail_badpass
Defaults    secure_path=&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root    ALL=(ALL:ALL) ALL

# Members of the admin group may gain root privileges
%admin ALL=(ALL) ALL

# Allow members of group sudo to execute any command
%sudo    ALL=(ALL:ALL) ALL

# See sudoers(5) for more information on &quot;#include&quot; directives:

#includedir /etc/sudoers.d
</code></pre></div>

<p>Note the 2 important lines: 
- How root gets the right to run all the commands:
  <code>txt
  root    ALL=(ALL:ALL) ALL</code>
- And how the sudo and admin groups get rights to run commands as root: 
  ```txt
  # Members of the admin group may gain root privileges
  %admin ALL=(ALL) ALL</p>
<p># Allow members of group sudo to execute any command
  %sudo    ALL=(ALL:ALL) ALL
  ```</p>
<p>The <code>ALL:ALL</code> means these users can run as any user and any group. The last ALL tells the sudo that these users/groups can run ALL commands. It is possible to put <code>/bin/ping</code> in the last part to tell sudo that this user can run only ping as root, Like below:</p>
<p><code>txt
  username ALL=(ALL) /bin/ping</code></p>
<blockquote>
<p>The /etc/sudoers file is very important and breaking it will make major problems. to prevent you from adding un-interpretable lines in that file, the <code>visudo</code> command should be used instead of <code>vi /etc/sudoers</code>. This tool will check your edits to make sure that sudo command can understand them.</p>
</blockquote>
<p>Now we know what <code>sudo su -</code> means. The sudo tells the system to run the <code>su -</code> command with the root access. It asks your password and runs the <code>su -</code> as the root if you have sudo access. The <code>su</code> commands changes your user to root and <code>-</code> switch load the root environment variables. This way you can become root using your own password via running <code>su</code> with <code>sudo</code>.</p>
<h3>checking the users in the system</h3>
<p>If you need to check who is in your system (and to some extend what they are doing) you can use these commands:</p>
<div class="highlight"><pre><span></span><code>$  w
 22:03:37 up 3 days,  5:33, 13 users,  load average: 1.48, 1.12, 1.19
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
jadi     tty7     :0               Wed16    3days  2:30m  1.96s /sbin/upstart --user
jadi     pts/18   :0               Wed16    3:04m  1:02   1:02  /usr/bin/python manage.py runserver 0.0.0.0:8000
jadi     pts/19   :0               Wed16    1:11m  0.35s  0.35s /bin/bash
root     tty2                      Wed16    3days  0.07s  0.03s -bash
jadi     pts/21   :0               08:41   45:37   0.06s  0.06s /bin/bash
jadi     pts/23   :0               Thu11   46:49   0.25s  0.23s ssh startups
jadi     pts/21   funlife          Fri22   45:37   0.06s  0.06s /bin/bash
jadi     pts/25   :0               10:17   31:37   0.07s  5.81s /usr/bin/python /usr/bin/x-terminal-emulator
jadi     pts/26   :0               21:39    0.00s  0.07s  0.00s w
jadi     pts/27   :0               21:55    8:09   0.01s  0.01s /bin/bash
</code></pre></div>

<p>You have a line for each logged in users (every single shell window is a separated login).</p>
<p>Another useful command is <code>who</code>. Lets check it:</p>
<div class="highlight"><pre><span></span><code>$ who
jadi     tty7         2016-06-01 16:30 (:0)
jadi     pts/17       2016-06-01 16:30 (funlife)
jadi     pts/2        2016-06-01 16:32 (:0)
jadi     pts/18       2016-06-01 16:32 (:0)
jadi     pts/19       2016-06-01 16:33 (:0)
root     tty2         2016-06-01 16:36
jadi     pts/21       2016-06-04 08:41 (:0)
jadi     pts/22       2016-06-01 18:37 (funlife)
jadi     pts/23       2016-06-02 11:41 (:0)
jadi     pts/21       2016-06-03 22:22 (funlife)
jadi     pts/25       2016-06-04 10:17 (:0)
jadi     pts/26       2016-06-04 21:39 (:0)
jadi     pts/27       2016-06-04 21:55 (:0)
</code></pre></div>

<p>As you can see both these commands tell you when was the time that the user logged into the system but does not show the logged out people (because they are not on the system anymore!). If you need that data use the <code>last</code> command:</p>
<div class="highlight"><pre><span></span><code>~$ last | head
jadi     pts/27       :0               Sat Jun  4 21:55    gone - no logout
jadi     pts/26       :0               Sat Jun  4 21:39    gone - no logout
jadi     pts/26       :0               Sat Jun  4 18:55 - 19:42  (00:46)
jadi     pts/25       :0               Sat Jun  4 10:17    gone - no logout
jadi     pts/26       :0               Sat Jun  4 09:25 - 09:26  (00:00)
jadi     pts/26       :0               Sat Jun  4 09:25 - 09:25  (00:00)
jadi     pts/25       :0               Sat Jun  4 08:52 - 09:27  (00:35)
jadi     pts/21       :0               Sat Jun  4 08:41    gone - no logout
jadi     pts/21       funlife          Fri Jun  3 22:22 - 08:41  (10:18)
jadi     pts/21       :0               Fri Jun  3 18:44 - 19:47  (01:03)
</code></pre></div>

<blockquote>
<p>there is a way to check the failed logins too: <code>last -f /var/log/btmp</code></p>
</blockquote>
<h3>Password Management</h3>
<p>The <code>passwd</code> command is used to update / change the password of the users. </p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="nv">passwd</span><span class="w">     </span>
<span class="nv">Changing</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">jadi</span>.
<span class="nv">Current</span><span class="w"> </span><span class="nv">password</span>:<span class="w"> </span>
<span class="nv">New</span><span class="w"> </span><span class="nv">password</span>:<span class="w"> </span>
<span class="nv">Retype</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">password</span>:<span class="w"> </span>
<span class="nv">passwd</span>:<span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="nv">updated</span><span class="w"> </span><span class="nv">successfully</span>
➜<span class="w">  </span><span class="nv">sudo</span><span class="w"> </span><span class="nv">passwd</span><span class="w"> </span><span class="nv">jadi</span>
<span class="nv">New</span><span class="w"> </span><span class="nv">password</span>:<span class="w"> </span>
<span class="nv">BAD</span><span class="w"> </span><span class="nv">PASSWORD</span>:<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">shorter</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nv">characters</span>
<span class="nv">Retype</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">password</span>:<span class="w"> </span>
<span class="nv">passwd</span>:<span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="nv">updated</span><span class="w"> </span><span class="nv">successfully</span>
</code></pre></div>

<p>You can also use this command to check the status of a user:</p>
<div class="highlight"><pre><span></span><code>➜  ~ passwd -S
jadi P 2023-09-14 0 99999 7 -1
</code></pre></div>

<p>It says my user is jadi, I have a valid <em>P</em>assword (could have been <em>L</em>ocked or <em>NP</em> for no password), my last password change time, minimum and maximum age of my password, warning period before password expiry &amp; allowed password inactivity in days. The <code>passwd</code> command can also be used to <code>--lock</code> (or <code>-l</code>) a user, <code>--expire</code> (or <code>-e</code>) a user or <code>--unlock</code> (or <code>-u</code>) a user.</p>
<blockquote>
<p>As you've already see in the user management section, to change the user shell, home, ... you should use the <code>usermod</code> command</p>
</blockquote>
<p>But to properly check/change the password age and configurations of users, the <code>chage</code> utility should be used. Run it with <code>-l</code> for <code>list</code>:</p>
<div class="highlight"><pre><span></span><code>➜  ~ chage -l jadi
Last password change                    : Sep 14, 2023
Password expires                    : never
Password inactive                   : never
Account expires                     : never
Minimum number of days between password change      : 0
Maximum number of days between password change      : 99999
Number of days of warning before password expires   : 7
</code></pre></div>

<p>or without any switches for interactive mode:</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="nv">chage</span><span class="w"> </span><span class="nv">jadi</span>
<span class="nv">chage</span>:<span class="w"> </span><span class="nv">Permission</span><span class="w"> </span><span class="nv">denied</span>.
➜<span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="nv">sudo</span><span class="w"> </span><span class="nv">chage</span><span class="w"> </span><span class="nv">jadi</span>
<span class="nv">Changing</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">aging</span><span class="w"> </span><span class="nv">information</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">jadi</span>
<span class="nv">Enter</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">value</span>,<span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">press</span><span class="w"> </span><span class="nv">ENTER</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">default</span>

<span class="w">    </span><span class="nv">Minimum</span><span class="w"> </span><span class="nv">Password</span><span class="w"> </span><span class="nv">Age</span><span class="w"> </span>[<span class="mi">0</span>]:<span class="w"> </span>
<span class="w">    </span><span class="nv">Maximum</span><span class="w"> </span><span class="nv">Password</span><span class="w"> </span><span class="nv">Age</span><span class="w"> </span>[<span class="mi">99999</span>]:<span class="w"> </span>
<span class="w">    </span><span class="nv">Last</span><span class="w"> </span><span class="nv">Password</span><span class="w"> </span><span class="nv">Change</span><span class="w"> </span><span class="ss">(</span><span class="nv">YYYY</span><span class="o">-</span><span class="nv">MM</span><span class="o">-</span><span class="nv">DD</span><span class="ss">)</span><span class="w"> </span>[<span class="mi">2023</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">14</span>]:<span class="w"> </span>
<span class="w">    </span><span class="nv">Password</span><span class="w"> </span><span class="nv">Expiration</span><span class="w"> </span><span class="nv">Warning</span><span class="w"> </span>[<span class="mi">7</span>]:<span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="nv">Password</span><span class="w"> </span><span class="nv">Inactive</span><span class="w"> </span>[<span class="o">-</span><span class="mi">1</span>]:<span class="w"> </span>
<span class="w">    </span><span class="nv">Account</span><span class="w"> </span><span class="nv">Expiration</span><span class="w"> </span><span class="nv">Date</span><span class="w"> </span><span class="ss">(</span><span class="nv">YYYY</span><span class="o">-</span><span class="nv">MM</span><span class="o">-</span><span class="nv">DD</span><span class="ss">)</span><span class="w"> </span>[<span class="o">-</span><span class="mi">1</span>]:<span class="w"> </span>
</code></pre></div>

<p>You can also use switches to directly change values. Say <code>-m</code> for --mindays or <code>-M</code> for --maxdays. </p>
<h3>suid and guid</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/1wyPXxrnI7g" title="LPIC 1 - 78  - 110.1 (2/3) - Perform Security Admin Tasks; suid, guid &amp; ulimits" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>We've already covered <code>suid</code>; In short, when the suid bit is set on an executable file, the user will run with the access level of the owner of the file (and not the runner). Have a look at the <code>ping</code> command:</p>
<div class="highlight"><pre><span></span><code>➜  ~ type passwd
passwd is /usr/bin/passwd
➜  ~ ls -ltrh /usr/bin/passwd 
-rwsr-xr-x 1 root root 63K Nov 23  2022 /usr/bin/passwd
</code></pre></div>

<p>The <code>s</code> on the access rights part, will run the file using the owners (here its root) access; regardless of whom is running it. This is needed because the <code>passwd</code> commands needs to be able to change the passwords in the <em>shadow</em> file even if a normal user runs it. But what happens if someone changes the suid of the vi command? let's see who owns the <code>vi</code>:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife ~$ type vi
vi is /usr/bin/vi
jadi@funlife ~$ ls -ltrh /usr/bin/vi
lrwxrwxrwx 1 root root 20 Jun  1 12:52 /usr/bin/vi -&gt; /etc/alternatives/vi
</code></pre></div>

<p>The <code>vi</code> is owned by root, so if the suid bit is set, vi will always be run as root! In that case, anybody will be able to edit any file! So if you are a hacker and get a temporary root, its enough to copy vi somewhere (with a different unsuspicious name) and give it the <code>suid</code> access. Now you will be able to run it with normal users and modify system files when needed! That's why a system admin should be able to check her systems executable files with <code>suid</code> bit if needed:</p>
<div class="highlight"><pre><span></span><code>$sudo find / -perm -u+s
</code></pre></div>

<p>Here, the <code>-perm -u+s</code> tells <code>find</code> to search for file which has <code>suid</code> on <code>user</code>. For more info, check the <code>man find</code> and search for <code>perm</code>. </p>
<blockquote>
<p>same applies for guid. if the guid is set, the file will be run with access of its group</p>
</blockquote>
<h3>user limits</h3>
<p>The resources on a Linux machine can be managed for users by the <code>ulimit</code> command. It is part of the PAM system. If you want to check the limits on the system run:</p>
<div class="highlight"><pre><span></span><code>~$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 47457
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 47457
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
</code></pre></div>

<p>and you can change them like this:</p>
<div class="highlight"><pre><span></span><code>$ ulimit -t 1
</code></pre></div>

<p>This will limit the CPU TIME of any process to 1 second. If you use more than that, the process will be killed automatically (by PAM module). Please note that your walls clock time is different than CPU time. To see how much CPU time a process uses run it like this:</p>
<div class="highlight"><pre><span></span><code>$ time firefox
</code></pre></div>

<p>Changing the ulimit as we did is a temporary thing. It only persists in that specific shell.</p>
<p>To change the ulimits system-wide:</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/security/limits.conf
# /etc/security/limits.conf
#
#Each line describes a limit for a user in the form:
#
#&lt;domain&gt;        &lt;type&gt;  &lt;item&gt;  &lt;value&gt;
#
#Where:
#&lt;domain&gt; can be:
#        - a user name
#        - a group name, with @group syntax
#        - the wildcard *, for default entry
#        - the wildcard %, can be also used with %group syntax,
#                 for maxlogin limit
#        - NOTE: group and wildcard limits are not applied to root.
#          To apply a limit to the root user, &lt;domain&gt; must be
#          the literal username root.
#
#&lt;type&gt; can have the two values:
#        - &quot;soft&quot; for enforcing the soft limits
#        - &quot;hard&quot; for enforcing hard limits
#
#&lt;item&gt; can be one of the following:
#        - core - limits the core file size (KB)
#        - data - max data size (KB)
#        - fsize - maximum filesize (KB)
#        - memlock - max locked-in-memory address space (KB)
#        - nofile - max number of open files
#        - rss - max resident set size (KB)
#        - stack - max stack size (KB)
#        - cpu - max CPU time (MIN)
#        - nproc - max number of processes
#        - as - address space limit (KB)
#        - maxlogins - max number of logins for this user
#        - maxsyslogins - max number of logins on the system
#        - priority - the priority to run user process with
#        - locks - max number of file locks the user can hold
#        - sigpending - max number of pending signals
#        - msgqueue - max memory used by POSIX message queues (bytes)
#        - nice - max nice priority allowed to raise to values: [-20, 19]
#        - rtprio - max realtime priority
#        - chroot - change root to directory (Debian-specific)
#
#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;
#

#*               soft    core            0
#root            hard    core            100000
#*               hard    rss             10000
#@student        hard    nproc           20
#@faculty        soft    nproc           20
#@faculty        hard    nproc           50
#ftp             hard    nproc           0
#ftp             -       chroot          /ftp
#@student        -       maxlogins       4

# End of file
</code></pre></div>

<blockquote>
<p>soft limits can be changed by the user but hard limits are the real stop points.</p>
</blockquote>
<h2>Open Ports</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/9yycyd7ShyM" title="LPIC 1 - 79  - 110.1 (3/3) - Perform Security Admin Tasks; checking for open ports &amp; scan with nmap" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h3>netstat, fuser and lsof</h3>
<p>On module 109.1 we talked about ports. Ports are like wholes in our systems used by programs to listen to the outside world. If I'm running a web server on my computer I should have a port open so people can ask that server "please show me your index.html". Many malwares open ports to let the attacker to communicate with them. It is important to check your computer for open ports time to time. The older command for this is the <code>netstat</code>; using the <code>-na</code> or <code>-ap</code> or <code>-tuna</code> switch.. I'm sure <strong>tuna</strong> is easy to remember if you have every enjoyed a tuna sandwich.</p>
<div class="highlight"><pre><span></span><code>jadi@funlife ~$ netstat -tuna
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN     
tcp        0      0 127.0.1.1:53            0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:9050          0.0.0.0:*               LISTEN     
tcp       25      0 192.168.59.9:49934      192.168.59.192:139      CLOSE_WAIT
tcp        0      0 127.0.0.1:60228         127.0.0.1:1080          ESTABLISHED
tcp        0      0 192.168.1.35:55324      159.203.148.169:8385    ESTABLISHED
tcp        0      0 127.0.0.1:59590         127.0.0.1:1080          ESTABLISHED
tcp        0      0 127.0.0.1:60212         127.0.0.1:1080          ESTABLISHED
tcp        0      0 192.168.1.35:54220      159.203.148.169:8385    ESTABLISHED
tcp        0      0 127.0.0.1:57186         127.0.0.1:1080          ESTABLISHED
tcp        0      0 192.168.1.35:49574      173.194.122.231:443     ESTABLISHED
tcp        0      0 127.0.0.1:59002         127.0.0.1:1080          ESTABLISHED
udp        0      0 0.0.0.0:54502           0.0.0.0:*                          
udp        0      0 0.0.0.0:5353            0.0.0.0:*                          
udp        0      0 0.0.0.0:5353            0.0.0.0:*
</code></pre></div>

<p>All the <code>LISTEN</code> ports are servers; they are LISTENING for new incoming connections. The <code>ESTABLISHED</code> connections are the active connections between your computer and another computer. In these tables <code>0.0.0.0</code> dictates <em>any address</em> or <em>any interface</em>.</p>
<p>Other useful tools are <code>ss</code> for the same purpose as you saw on chapter 109 and <code>lsof</code> and <code>fuser</code>. The <code>lsof</code> is already discussed in previous sections. It shows the open files on the system and having in mind that <em>everything in Linux is a file or a process</em> you can conclude that this command should be able to display open connections too; and you are right:</p>
<div class="highlight"><pre><span></span><code># lsof -i
COMMAND     PID       USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
privoxy     806    privoxy    4u  IPv4   16130      0t0  TCP funlife:8118 (LISTEN)
cups-brow   903       root    8u  IPv4   17477      0t0  UDP *:ipp
mysqld      971      mysql   19u  IPv4   20875      0t0  TCP funlife:mysql (LISTEN)
tor        1038 debian-tor    6u  IPv4   19155      0t0  TCP funlife:9050 (LISTEN)
dnsmasq    1260     nobody   11u  IPv4 1910037      0t0  UDP *:18666
adb        1278       jadi    5u  IPv4  579541      0t0  TCP funlife:5037 (LISTEN)
chromium-  2891       jadi   88u  IPv4  813611      0t0  TCP 192.168.1.35:45702-&gt;do-13.lastpass.com:https (ESTABLISHED)
chromium-  2891       jadi  126u  IPv4 1907389      0t0  TCP 192.168.1.35:50642-&gt;ntt-2.lastpass.com:https (ESTABLISHED)
chromium-  2891       jadi  133u  IPv4 1909733      0t0  TCP 192.168.1.35:50644-&gt;ntt-2.lastpass.com:https (ESTABLISHED)
chromium-  2891       jadi  268u  IPv4  785289      0t0  TCP 192.168.1.35:60736-&gt;lf-in-f188.1e100.net:5228 (ESTABLISHED)
python     4925       jadi    4u  IPv4  658287      0t0  TCP funlife:8000 (LISTEN)
Telegram   4943       jadi   39u  IPv4  773463      0t0  TCP 192.168.1.35:44732-&gt;149.154.175.50:https (ESTABLISHED)
dhclient   9984       root    6u  IPv4  787885      0t0  UDP *:bootpc
nginx     11095       root    6u  IPv4   17998      0t0  TCP *:http (LISTEN)
nginx     11099   www-data    7u  IPv6   17999      0t0  TCP *:http (LISTEN)
chrome    14264       jadi  114u  IPv4  788089      0t0  UDP *:mdns
chrome    14264       jadi  126u  IPv4 1872872      0t0  TCP funlife:60370-&gt;funlife:socks (ESTABLISHED)
chrome    14264       jadi  138u  IPv4 1908382      0t0  TCP funlife:60408-&gt;funlife:socks (ESTABLISHED)
</code></pre></div>

<p>Wow! This command shows the command, PID, user running it and source and destination IP and tells of if this is a LISTENING or STABLISHED connection.</p>
<p>If you want to check which process is using port 80, you can grep the output of any above commands or simply use the <code>fuser</code> (file user; who uses this file) command to find all the PIDs related to that specific port. A common switch is <code>-v</code> which goes verbose. </p>
<div class="highlight"><pre><span></span><code>➜  bin sudo fuser 22/tcp -v      
                     USER        PID ACCESS COMMAND
22/tcp:              root          1 F.... systemd
</code></pre></div>

<h3>nmap</h3>
<p><code>nmap</code> is the one of the hackers beloved tools! You can nmap a server to find out about a lot of data about that server:</p>
<div class="highlight"><pre><span></span><code># nmap localhost

Starting Nmap 7.01 ( https://nmap.org ) at 2016-06-04 21:32 IRDT
Nmap scan report for localhost (127.0.0.1)
Host is up (0.0000070s latency).
rDNS record for 127.0.0.1: funlife
Not shown: 995 closed ports
PORT     STATE SERVICE
80/tcp   open  http
1080/tcp open  socks
3306/tcp open  mysql
8000/tcp open  http-alt
9050/tcp open  tor-socks

Nmap done: 1 IP address (1 host up) scanned in 1.66 seconds
root@funlife:~#
</code></pre></div>

<p>In the most basic form, nmap checks all the open ports from 1 to 1000 and prints the results. There are a lot of switches to find other information about the hosts and they are used by every single hacker who wants to examine a servers status.</p>
<p>Do a quick search for <a href="https://duckduckgo.com/?t=h_&amp;q=nmap+oneliners&amp;ia=web">nmap oneliners</a> and you will find dozens of cool commands and tricks for it. Its so cool that its website <a href="https://nmap.org/movies/">has a section about nmap in movies</a>!</p>
                                            <br clear="both" />
                                            <h1>110.2 Setup host security</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 3</em></p>
<p>Candidates should know how to set up a basic level of host security.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Awareness of shadow passwords and how they work.</li>
<li>Turn off network services not in use.</li>
<li>Understand the role of TCP wrappers.</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/nologin</code></li>
<li><code>/etc/passwd</code></li>
<li><code>/etc/shadow</code></li>
<li><code>/etc/xinetd.d/</code></li>
<li><code>/etc/xinetd.conf</code></li>
<li><code>systemd.socket</code></li>
<li><code>/etc/inittab</code></li>
<li><code>/etc/init.d/</code></li>
<li><code>/etc/hosts.allow</code></li>
<li><code>/etc/hosts.deny</code></li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/HoQtVkcSqz8" title="LPIC 1 - 80  - 110.2 - Setup Host Security; controlling server logins and using super services" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<iframe width="560" height="315" src="https://www.youtube.com/embed/HoQtVkcSqz8?si=Q5zWktbxB7qaTplh" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h4>shadow passwords</h4>
<p>The <code>/etc/passwd</code> is already discussed. It contains the passwords of the users but there is a logical problem: if a user should be able to change her own password, he should have access to this file and if this is the case, he can see other people's passwords. This is not interesting even when the passwords are hashed (shown as a more complex form using a one way function).</p>
<div class="highlight"><pre><span></span><code>$ ls -ltrh /etc/passwd
-rw-r--r-- 1 root root 2.5K Jun  5 19:14 /etc/passwd
</code></pre></div>

<p>To prevent this the <code>/etc/shadow</code> file is introduced. In modern systems, we only show a <code>*</code> at the location of the password in <code>/etc/passwd</code> and store the real password in <code>/etc/shadow</code> which has a very limited file access:</p>
<div class="highlight"><pre><span></span><code>jadi@funlife ~$ grep jadi /etc/passwd
jadi:x:1000:1000:jadi,,,:/home/jadi:/bin/bash
jadi@funlife ~$ grep jadi /etc/shadow
grep: /etc/shadow: Permission denied
jadi@funlife ~$ sudo grep jadi /etc/shadow
[sudo] password for jadi:
jadi:$6$bp01DBX.$I6dt4pz8GeXJl6asgPeKhSdepf40bgepTz8zwB3HFmN56SdcsxjTETdZAmRt17biwMYOI7SoGFOXssHqeNFgw/:16963:0:99999:7:::
jadi@funlife ~$ sudo ls -ltrh /etc/shadow
-rw-r----- 1 root shadow 1.5K Jun 11 17:36 /etc/shadow
</code></pre></div>

<h4><code>/etc/nologin</code></h4>
<p>The <code>/etc/nologin</code> is a cool file! If you create and write something in it, the content will be shown to any person who tries to login into the system and with that file the login attempt will fail. It is useful for maintenance time. Delete this file and the users will be able to login again.</p>
<blockquote>
<p>the root user will be able to login even in the presence of /etc/nologin</p>
</blockquote>
<p>Please also note that there is a dummy shell called <code>nologin</code> and you can set it as shell for any user you want to prevent from being able to login into the system via a shell. Note that such a user still has an active account and will be able to use other services (say email or ftp) but wont be able to enter the shell.</p>
<div class="highlight"><pre><span></span><code>sudo usermod -s /sbin/nologin baduser
</code></pre></div>

<h3>super-servers</h3>
<p>A super-server or sometimes called a service dispatcher is a type of daemon running mostly on Unix-like systems for security and resource management reasons. It listens for requests its configured for and starts the target services when needed to answer the requests. This adds a layer of security to your communications and also lets some of the services to be inactive when we do not need them. You can see a super server or superdaemon as a TCP (and UDP or even ICMP) wrapper around other services.</p>
<p><img alt="Super Server" src="/images/super-server.png"></p>
<p>Few GNU/Linuxes use TCP wrappers like <code>xinetd</code> these days but you might see it in some installations or traces of it in your <code>/etc/xinet.d</code>. If needed it is also possible to configure the <code>systemd.socket</code> as a TCP wrapper for other services.</p>
<p>Here is a sample <code>xinetd</code> configuration file:</p>
<div class="highlight"><pre><span></span><code>service telnet
{
        disable         = no
        flags           = REUSE
        socket_type     = stream
        wait            = no
        user            = root
        server          = /usr/sbin/in.telnetd
        log_on_failure  += USERID
        no_access       = 10.0.1.0/24
        log_on_success  += PID HOST EXIT
        access_times    = 09:45-16:15
}
</code></pre></div>

<p>If we change the <code>disable</code> to <code>yes</code> and restart the xinetd, the telnet daemon will start running. There are a few files to control xinetd related files.</p>
<p>As mentioned, <code>xinetd</code> is replaced by the <code>systemd.socket</code> units. Some services like <code>ssh</code> and <code>cups</code> might have a socket unit alongside the service unit in your distribution. In this case its enough to stop &amp; disable the <code>ssh.service</code> and start the <code>ssh.docekt</code> instead. Now the <code>systemd.socekt</code> is acting as a wrapper around the port 22 and IF someones needs the service, starts the ssh server to answer.</p>
<h4><code>/etc/hosts.allow</code> &amp; <code>/etc/hosts.deny</code></h4>
<p>These two files will allow or deny access from specific hosts. Its logic is like cron.deny and cron.allow. If something is allowed, everything else is denied but if you add something to the <code>/etc/hosts.deny</code>, only that specific thing is denied (and every other thing is allowed).</p>
<div class="highlight"><pre><span></span><code>jadi@funlife ~$ cat /etc/hosts.allow
# /etc/hosts.allow: list of hosts that are allowed to access the system.
#                   See the manual pages hosts_access(5) and hosts_options(5).
#
# Example:    ALL: LOCAL @some_netgroup
#             ALL: .foobar.edu EXCEPT terminalserver.foobar.edu
#
# If you&#39;re going to protect the portmapper use the name &quot;rpcbind&quot; for the
# daemon name. See rpcbind(8) and rpc.mountd(8) for further information.
#

vsftpd: 10.10.100.
</code></pre></div>

<p>How the <code>vsftpd</code> knows about this file? Because it uses the <code>libwrap</code> library in its source and the libwrap understands the wrapper tools. You can check this claim by searching for <code>libwrap</code> in the list of libraries <code>vsftpd</code> uses:</p>
<div class="highlight"><pre><span></span><code>➜  ~ ldd /usr/sbin/vsftpd | grep libwrap
    libwrap.so.0 =&gt; /lib/x86_64-linux-gnu/libwrap.so.0 (0x00007fb293921000)
</code></pre></div>

<p>Here the <code>vsftpd</code> service is only allowed from 10.10.100.* . It is possible to use <code>ALL</code> as the service name to allow or deny ALL services.</p>
<blockquote>
<p>after changing this file, xinetd should be restarted</p>
</blockquote>
<p>As mentioned, super servers are not being used anymore and most distributions use standalone services.</p>
<h3>Removing unused services</h3>
<p>Based on your distribution, you can check the running services using the <code>service</code> or <code>systemctl</code> command. If you are using the SysV init system (older distros mainly) or you have the compatibility tools installed, do as follow:</p>
<div class="highlight"><pre><span></span><code>~ sudo service --status-all
 [ - ]  alsa-utils
 ....
 [ + ]  ufw
 [ + ]  unattended-upgrades
 [ + ]  uuidd
 [ + ]  vpn-unlimited-daemon
 [ + ]  vsftpd
 [ - ]  whoopsie
 [ - ]  x11-common
</code></pre></div>

<p>On a RedHat based machine, you can stop a service via:</p>
<div class="highlight"><pre><span></span><code>sudo chkconfig vsfptd off
</code></pre></div>

<p>and On debian machines:</p>
<div class="highlight"><pre><span></span><code>sudo update-rc.d vsftpd remove
</code></pre></div>

<p>If you are using the systemd, do as follow to check and stop / disable a service:</p>
<div class="highlight"><pre><span></span><code>systemctl list-units --state active --type service
systemctl status
systemctl disable vsftpd.service --now
</code></pre></div>

<p>Please also remember that on older systems, we used to have all the Init scripts in <code>/etc/init.d</code> and <code>/etc/rcX.d</code> folders. There were also a <code>/etc/inittab</code> file which was a configuration file for initializing a Linux system using SysV . It contains lines in this format:</p>
<p>This would tell the init system to do <code>actions</code> on the <code>process</code> on a specific <code>runlevel</code>. For example:</p>
<div class="highlight"><pre><span></span><code><span class="n">id</span><span class="o">:</span><span class="n">runlevel</span><span class="o">:</span><span class="n">action</span><span class="o">:</span><span class="n">process</span>
</code></pre></div>

<p>It tells the init to start (and respawn if killed), the <code>mingetty tty1</code> command on runlevels <code>2</code>, <code>3</code>, <code>4</code>, &amp; <code>5</code>.</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span><span class="o">:</span><span class="mi">2345</span><span class="o">:</span><span class="n">respawn</span><span class="o">:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">mingetty</span><span class="w"> </span><span class="n">tty1</span>
</code></pre></div>

<p>As the final note, this was the most important line in the <code>inittab</code> file because it tells the init to start in run level 3.</p>
<div class="highlight"><pre><span></span><code><span class="n">id</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="n">initdefault</span><span class="o">:</span>
</code></pre></div>

<p>For more information about <code>runlevels</code> , please refer to <a href="1013-change-runlevels-boot-targets-and-shutdown-or-reboot-the-system.html">Chapter 101.3</a>.</p>
                                            <br clear="both" />
                                            <h1>110.3 Securing data with encryption</h1>
                                            <br clear="both" />
                                            <p><em>Weight: 4</em></p>
<p>The candidate should be able to use public key techniques to secure data and communication.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Perform basic OpenSSH 2 client configuration and usage.</li>
<li>Understand the role of OpenSSH 2 server host keys.</li>
<li>Perform basic GnuPG configuration, usage and revocation.</li>
<li>Use GPG to encrypt, decrypt, sign and verify files.</li>
<li>Understand SSH port tunnels (including X11 tunnels).</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li>ssh</li>
<li>ssh-keygen</li>
<li>ssh-agent</li>
<li>ssh-add</li>
<li>~/.ssh/id_rsa and id_rsa.pub</li>
<li>~/.ssh/id_dsa and id_dsa.pub</li>
<li>~/.ssh/id_ecdsa and id_ecdsa.pub</li>
<li>~/.ssh/id_ed25519 and id_ed25519.pub</li>
<li>/etc/ssh/ssh_host_rsa_key and ssh_host_rsa_key.pub</li>
<li>/etc/ssh/ssh_host_dsa_key and ssh_host_dsa_key.pub</li>
<li>/etc/ssh/ssh_host_ecdsa_key and ssh_host_ecdsa_key.pub</li>
<li>/etc/ssh/ssh_host_ed25519_key and ssh_host_ed25519_key.pub</li>
<li>~/.ssh/authorized_keys</li>
<li>ssh_known_hosts</li>
<li>gpg</li>
<li>gpg-agent</li>
<li>~/.gnupg/</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ElbC0EtZc4c?si=PemOqHr6s7V53wwS" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h2>Key Pairs</h2>
<p>In traditional cryptography, the symmetric keys were used: both parties had a shared password. The data were encrypted with that password and then decrypted using the same password. But in 1976, a new idea came into the view: what if we create 2 keys (lets call them the Private Key and the Public Key) in a way that only people who has the Public Key, be able to open whatever which is encrypted with the Private key? The scientists made this a reality and nowawayds, most of our encryptions are being done via these <strong>Key Pair</strong>s. When generating a key pair, we generate two keys using a computer algorithm in the way that any message which is encrypted using one, can be opened only using the other. These are called Public &amp; Private key. You publish the public key to your friends or even publicly on the net and if someone wants to send you an encrypted message, she encrypts it using your public key and send it to you with any means (or published the encoded message on the intneret) and only and only you will be able to open it, because you are the one who has the Private key!</p>
<blockquote>
<p>great point about Public / Private key is that the data can be transmitted over the internet with no fear of hackers or governments. You are publishing your key to the world, some one picks it and uses it to encrypt some data and sent the result to you. People can see that you are receiving "some data" but they can not encrypt it because they do not have the private key needed to decrypt it.</p>
</blockquote>
<h3>ssh keys</h3>
<p>The same technology (Public key cryptography or asymetric cryptography) can be used in most of the network communications too. In fact the very <code>ssh</code> works based on this concept. It is used to authenticate hosts and secure the traffic. </p>
<div class="highlight"><pre><span></span><code><span class="err">➜</span><span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="mf">192.168.70.2</span>
<span class="n">The</span><span class="w"> </span><span class="n">authenticity</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="err">&#39;</span><span class="mf">192.168.70.2</span><span class="w"> </span><span class="p">(</span><span class="mf">192.168.70.2</span><span class="p">)</span><span class="err">&#39;</span><span class="w"> </span><span class="n">can</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">established</span><span class="p">.</span>
<span class="n">ED25519</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">fingerprint</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">SHA256</span><span class="o">:</span><span class="mi">4</span><span class="n">Wp2zz6sgPAhnbqhkNjOd6QDpNQ4jvjX7qAzslPX09U</span><span class="p">.</span>
<span class="n">This</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">names</span>
<span class="n">Are</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="n">connecting</span><span class="w"> </span><span class="p">(</span><span class="n">yes</span><span class="o">/</span><span class="n">no</span><span class="o">/</span><span class="p">[</span><span class="n">fingerprint</span><span class="p">])</span><span class="o">?</span><span class="w"> </span><span class="n">y</span>
<span class="n">Please</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="err">&#39;</span><span class="n">yes</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">no</span><span class="err">&#39;</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fingerprint</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span>
<span class="nl">Warning</span><span class="p">:</span><span class="w"> </span><span class="n">Permanently</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="err">&#39;</span><span class="mf">192.168.70.2</span><span class="err">&#39;</span><span class="w"> </span><span class="p">(</span><span class="n">ED25519</span><span class="p">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">hosts</span><span class="p">.</span>
<span class="n">jadi</span><span class="mf">@192.168.70.2</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">password</span><span class="o">:</span>
<span class="n">Linux</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="mf">6.4.0</span><span class="mi">-2</span><span class="o">-</span><span class="n">arm64</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span><span class="w"> </span><span class="n">SMP</span><span class="w"> </span><span class="n">Debian</span><span class="w"> </span><span class="mf">6.4.4</span><span class="mi">-3</span><span class="w"> </span><span class="p">(</span><span class="mi">2023-08-08</span><span class="p">)</span><span class="w"> </span><span class="n">aarch64</span>

<span class="n">The</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Debian</span><span class="w"> </span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">software</span><span class="p">;</span>
<span class="n">the</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="n">terms</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span>
<span class="n">individual</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="cm">/*/copyright.</span>

<span class="cm">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span>
<span class="cm">permitted by applicable law.</span>
<span class="cm">You have no mail.</span>
<span class="cm">Last login: Sun Sep 17 04:43:18 2023 from 192.168.70.1</span>
<span class="cm">jadi@debian:~$</span>
</code></pre></div>

<p>Above the server is showing us the fingerprint of its ED25519 key and asking us to approve it. From now on, our system wont warn us for the same key with the same server. BUT if the fingerprint (so the key) of the same server is changed, that will be considered a serious case:</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="nv">ssh</span><span class="w"> </span><span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">70</span>.<span class="mi">2</span>
<span class="nv">Host</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">verification</span><span class="w"> </span><span class="nv">failed</span>.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@<span class="w">    </span><span class="nv">WARNING</span>:<span class="w"> </span><span class="nv">REMOTE</span><span class="w"> </span><span class="nv">HOST</span><span class="w"> </span><span class="nv">IDENTIFICATION</span><span class="w"> </span><span class="nv">HAS</span><span class="w"> </span><span class="nv">CHANGED</span><span class="o">!</span><span class="w">     </span>@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
<span class="nv">IT</span><span class="w"> </span><span class="nv">IS</span><span class="w"> </span><span class="nv">POSSIBLE</span><span class="w"> </span><span class="nv">THAT</span><span class="w"> </span><span class="nv">SOMEONE</span><span class="w"> </span><span class="nv">IS</span><span class="w"> </span><span class="nv">DOING</span><span class="w"> </span><span class="nv">SOMETHING</span><span class="w"> </span><span class="nv">NASTY</span><span class="o">!</span>
<span class="nv">Someone</span><span class="w"> </span><span class="nv">could</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">eavesdropping</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">right</span><span class="w"> </span><span class="nv">now</span><span class="w"> </span><span class="ss">(</span><span class="nv">man</span><span class="o">-</span><span class="nv">in</span><span class="o">-</span><span class="nv">the</span><span class="o">-</span><span class="nv">middle</span><span class="w"> </span><span class="nv">attack</span><span class="ss">)</span><span class="o">!</span>
<span class="nv">It</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">also</span><span class="w"> </span><span class="nv">possible</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">host</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">just</span><span class="w"> </span><span class="nv">been</span><span class="w"> </span><span class="nv">changed</span>.
<span class="nv">The</span><span class="w"> </span><span class="nv">fingerprint</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">ED25519</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">sent</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">remote</span><span class="w"> </span><span class="nv">host</span><span class="w"> </span><span class="nv">is</span>
<span class="nv">SHA256</span>:<span class="mi">4</span><span class="nv">Wp2zz6sgPAhnbqhkNjOd6QDpNQ4jvjX7qAzslPX09U</span>.
<span class="nv">Please</span><span class="w"> </span><span class="nv">contact</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="nv">administrator</span>.
<span class="nv">Add</span><span class="w"> </span><span class="nv">correct</span><span class="w"> </span><span class="nv">host</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="o">/</span><span class="nv">Users</span><span class="o">/</span><span class="nv">jadi</span><span class="o">/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">known_hosts</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span><span class="nv">rid</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">message</span>.
<span class="nv">Offending</span><span class="w"> </span><span class="nv">RSA</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="o">/</span><span class="nv">Users</span><span class="o">/</span><span class="nv">jadi</span><span class="o">/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">known_hosts</span>:<span class="mi">548</span>
<span class="nv">Host</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">70</span>.<span class="mi">2</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">changed</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">have</span><span class="w"> </span><span class="nv">requested</span><span class="w"> </span><span class="nv">strict</span><span class="w"> </span><span class="nv">checking</span>.
</code></pre></div>

<p>If you want to solve this - after making sure that this is not an attack - you have to remove the data of 192.168.70.2 from the <code>.ssh/known_hosts</code> file. Fortunately you do not need to directly edit the file. Its enough to use the <code>ssh-keygen</code> command:</p>
<div class="highlight"><pre><span></span><code>➜  ~ ssh-keygen -R 192.168.70.2
# Host 192.168.70.2 found: line 547
# Host 192.168.70.2 found: line 548
# Host 192.168.70.2 found: line 549
/Users/jadi/.ssh/known_hosts updated.
Original contents retained as /Users/jadi/.ssh/known_hosts.old
</code></pre></div>

<h4>creating your own key pairs</h4>
<p>You can easily create as many key pairs want; Even with different algorithms (defined by <code>-t</code> switch and including dsa, ecdsa, ecdsa-sk, ed25519, ed25519-sk, rsa). Common choices are <em>rsa</em> which is the default and <em>ecdsa</em> which is used by bitcoin!</p>
<p>Lets create an ecdsa key pair on our machine. We can use this to login into the servers without providing a password or sign/encrypt messages.</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">ecdsa</span>
<span class="n">Generating</span><span class="w"> </span><span class="k">public</span><span class="o">/</span><span class="n">private</span><span class="w"> </span><span class="n">ecdsa</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">pair</span><span class="p">.</span>
<span class="n">Enter</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">save</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_ecdsa</span><span class="p">)</span><span class="err">:</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_ecdsa</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="ow">exists</span><span class="p">.</span>
<span class="n">Overwrite</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="vm">?</span><span class="w"> </span><span class="n">y</span>
<span class="n">Enter</span><span class="w"> </span><span class="n">passphrase</span><span class="w"> </span><span class="p">(</span><span class="n">empty</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">passphrase</span><span class="p">)</span><span class="err">:</span>
<span class="n">Enter</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">passphrase</span><span class="w"> </span><span class="nl">again</span><span class="p">:</span>
<span class="n">Your</span><span class="w"> </span><span class="n">identification</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_ecdsa</span>
<span class="n">Your</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_ecdsa</span><span class="p">.</span><span class="n">pub</span>
<span class="n">The</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">fingerprint</span><span class="w"> </span><span class="k">is</span><span class="err">:</span>
<span class="nl">SHA256</span><span class="p">:</span><span class="n">WvJu5D7ns0a2z0sB6l8ZrCXnAgxSmb2kSwgo</span><span class="o">/</span><span class="n">lK0QYA</span><span class="w"> </span><span class="n">jadi</span><span class="nv">@debian</span>
<span class="n">The</span><span class="w"> </span><span class="k">key</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">randomart</span><span class="w"> </span><span class="nc">image</span><span class="w"> </span><span class="k">is</span><span class="err">:</span>
<span class="o">+---[</span><span class="n">ECDSA 256</span><span class="o">]---+</span>
<span class="o">|</span><span class="p">.</span><span class="n">oo</span><span class="p">.</span><span class="w">  </span><span class="p">.</span><span class="o">+</span><span class="w">         </span><span class="o">|</span>
<span class="o">|</span><span class="n">E</span><span class="w"> </span><span class="p">.</span><span class="n">o</span><span class="w"> </span><span class="p">.</span><span class="n">o</span><span class="w"> </span><span class="n">o</span><span class="w">        </span><span class="o">|</span>
<span class="o">|</span><span class="n">o</span><span class="w"> </span><span class="p">..</span><span class="o">+</span><span class="p">..</span><span class="n">o</span><span class="w"> </span><span class="p">..</span><span class="w">      </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">o</span><span class="p">..</span><span class="n">oo</span><span class="p">..</span><span class="w"> </span><span class="n">o</span><span class="w">     </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">o</span><span class="w">  </span><span class="p">...</span><span class="n">S</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">*</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="w">  </span><span class="p">.</span><span class="o">*</span><span class="p">..</span><span class="n">o</span><span class="o">*</span><span class="w"> </span><span class="o">+</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="p">.</span><span class="w">   </span><span class="p">.</span><span class="n">oooo</span><span class="p">.</span><span class="o">=</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w">       </span><span class="p">.</span><span class="o">+</span><span class="p">.</span><span class="o">==</span><span class="w">     </span><span class="o">|</span>
<span class="o">|</span><span class="w">       </span><span class="n">oo</span><span class="o">=+++</span><span class="p">.</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----[SHA256]-----+</span>
</code></pre></div>

<p>and since its free, lets create an rsa key too:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span>
<span class="n">Generating</span><span class="w"> </span><span class="k">public</span><span class="o">/</span><span class="n">private</span><span class="w"> </span><span class="n">rsa</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">pair</span><span class="p">.</span>
<span class="n">Enter</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">save</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">)</span><span class="err">:</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="ow">exists</span><span class="p">.</span>
<span class="n">Overwrite</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="vm">?</span><span class="w"> </span><span class="n">y</span>
<span class="n">Enter</span><span class="w"> </span><span class="n">passphrase</span><span class="w"> </span><span class="p">(</span><span class="n">empty</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">passphrase</span><span class="p">)</span><span class="err">:</span>
<span class="n">Enter</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">passphrase</span><span class="w"> </span><span class="nl">again</span><span class="p">:</span>
<span class="n">Your</span><span class="w"> </span><span class="n">identification</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span>
<span class="n">Your</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="p">.</span><span class="n">pub</span>
<span class="n">The</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">fingerprint</span><span class="w"> </span><span class="k">is</span><span class="err">:</span>
<span class="nl">SHA256</span><span class="p">:</span><span class="n">Q67Ob1DOfmF3gG449OfNLHXxE5QEH4B</span><span class="o">/</span><span class="n">UzHR8ycAHao</span><span class="w"> </span><span class="n">jadi</span><span class="nv">@debian</span>
<span class="n">The</span><span class="w"> </span><span class="k">key</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">randomart</span><span class="w"> </span><span class="nc">image</span><span class="w"> </span><span class="k">is</span><span class="err">:</span>
<span class="o">+---[</span><span class="n">RSA 3072</span><span class="o">]----+</span>
<span class="o">|</span><span class="w">          </span><span class="p">.</span><span class="n">oo</span><span class="o">++*=|</span>
<span class="o">|</span><span class="w">           </span><span class="n">oo</span><span class="w"> </span><span class="p">.</span><span class="o">+=|</span>
<span class="o">|</span><span class="w">        </span><span class="p">.</span><span class="w"> </span><span class="p">......</span><span class="o">+|</span>
<span class="o">|</span><span class="w">       </span><span class="n">oo</span><span class="p">..</span><span class="w"> </span><span class="p">...</span><span class="o">=</span><span class="n">o</span><span class="o">|</span>
<span class="o">|</span><span class="w">       </span><span class="o">=</span><span class="n">E</span><span class="o">+</span><span class="w">   </span><span class="p">...</span><span class="o">*|</span>
<span class="o">|</span><span class="w">      </span><span class="p">..</span><span class="o">=</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">o</span><span class="o">|</span>
<span class="o">|</span><span class="w">      </span><span class="p">.</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">..</span><span class="o">|</span>
<span class="o">|</span><span class="w">     </span><span class="n">o</span><span class="w">  </span><span class="n">o</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="w">      </span><span class="n">oo</span><span class="p">..</span><span class="w">   </span><span class="p">.</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----[SHA256]-----+</span>
</code></pre></div>

<p>That fun <em>Image</em> is what you can show your friends so they can make sure that they are using the correct key. </p>
<blockquote>
<p>Above, I did not set a password for the keys. If I did, I had to provide that password everytime I wanted to use that key</p>
</blockquote>
<p>These keys are saved in users <code>~/.ssh</code> directory. As you can guess, the system wide keys used for ssh server are located at <code>/etc/ssh</code>.</p>
<h3>Key based / Password less login</h3>
<p>The ssh server can be configured to check your identity using your keys. Its enough to save your public-key on the server's user account and tell the server to check for key-based logins too. In this case, your ssh client will provide your private key to the ssh server as a proof of identity and you will be able to enter the user without providing passwords.</p>
<p>First copy your <em>public</em> key and login into the server. Open the <code>~/.ssh/authorized_keys</code> file and add yours. Also make sure that the <code>/etc/ssh/sshd_config</code> contains the <code>PubkeyAuthentication yes</code>. Now log out and on the next login you should be able to login without password! This is super userful when you are managing many servers or want to automate <code>scp</code> copies and other stuff. Its also more secure from the sysadmin point of view because if I need to let a new user to login into my system, I do not need to share the password or communicate the password on any channel. Its enough to ask the person for his <strong>public key</strong> and add it to the users <code>.ssh/authorized_keys</code> file.</p>
<p>Oh! and you do not need to do the <em>key copying</em> manually; just use the <code>ssh-copy-id</code> command:</p>
<div class="highlight"><pre><span></span><code><span class="err">➜</span><span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="k">copy</span><span class="o">-</span><span class="kt">id</span><span class="w"> </span><span class="mf">192.168.70.2</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="k">copy</span><span class="o">-</span><span class="kt">id</span><span class="o">:</span><span class="w"> </span><span class="n">INFO</span><span class="o">:</span><span class="w"> </span><span class="n">Source</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">installed</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;/Users/jadi/.ssh/id_dsa.pub&quot;</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="k">copy</span><span class="o">-</span><span class="kt">id</span><span class="o">:</span><span class="w"> </span><span class="n">INFO</span><span class="o">:</span><span class="w"> </span><span class="n">attempting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">installed</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="k">copy</span><span class="o">-</span><span class="kt">id</span><span class="o">:</span><span class="w"> </span><span class="n">INFO</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">prompted</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">keys</span>
<span class="n">jadi</span><span class="mf">@192.168.70.2</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">password</span><span class="o">:</span>

<span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">added</span><span class="o">:</span><span class="w">        </span><span class="mi">1</span>

<span class="n">Now</span><span class="w"> </span><span class="n">try</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">machine</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="o">:</span><span class="w">   </span><span class="s">&quot;ssh &#39;192.168.70.2&#39;&quot;</span>
<span class="n">and</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">wanted</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="p">.</span>
</code></pre></div>

<h4>ssh-agent</h4>
<p>The <code>ssh-agent</code> works like a key manager for your ssh keys. It keeps your private keys in memory and provides them when needed. For example if you have set a password on your key, you have to type the password every single time you are going to use that key. To make this easier using ssh-agent, you have to rush a shell with ssh-agent and add all your key to the agent:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">agent</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="k">add</span>
<span class="k">Identity</span><span class="w"> </span><span class="nl">added</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="w"> </span><span class="p">(</span><span class="n">jadi</span><span class="nv">@debian</span><span class="p">)</span>
<span class="k">Identity</span><span class="w"> </span><span class="nl">added</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_ecdsa</span><span class="w"> </span><span class="p">(</span><span class="n">jadi</span><span class="nv">@debian</span><span class="p">)</span>
<span class="k">Identity</span><span class="w"> </span><span class="nl">added</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_dsa</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jadi</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_dsa</span><span class="p">)</span>
</code></pre></div>

<p>Now, the agent knows about your keys and wont ask for the passwords anymore.</p>
<p><code>ssh-agent</code> can also <em>transfer</em> your keys safely in memory to other servers. Say you need to ssh to server A and while on server A, use your key to ssh to server B (or do a git pull using your private keys). The keys are on server A and its not safe to actually and physically copy them to server B. In this case you cal run <code>ssh-agent</code> and have your keys even when you are on server B. </p>
<h4>ssh tunnels</h4>
<iframe width="560" height="315" src="https://www.youtube.com/embed/bjvOJNmWgYI?si=UFKx2TDaF9l5GCjw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>The ssh can also be used for <em>tunnelling</em>. Its a very fun concept and a super userful tool in the hands of a network Ninja! Honestly we use it all the time to solve complicated problems. </p>
<p>As the name sggests, ssh tunelling <em>tunnels</em> the data between machines. Look at this example:</p>
<div class="highlight"><pre><span></span><code><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="mi">9000</span><span class="o">:</span><span class="n">hckrnews</span><span class="p">.</span><span class="n">com</span><span class="o">:</span><span class="mi">80</span><span class="w"> </span><span class="n">root</span><span class="mf">@5.161.197.79</span>
</code></pre></div>

<p>Here I'm telling my computer to ssh using user <code>root</code> (which is not a great idea) to the <code>5.161.197.79</code> server; AND create a <strong>local tunnel</strong> (<code>-L</code>) from on my machine toward the <code>hckrnews.com</code> port <code>80</code> through that machine. Now if I connect to <code>localhost:9000</code> <strong>on my machine</strong>, the request will be tunnels through <code>5.161.197.79</code> toward hckrnews.com port 80. You can try it with <code>curl localhost:9000</code>. </p>
<p>Why this is useful? Say you have a program on your server which only answers back to the local requests (and not the internet). Using local forwarding you can forward a port on your computer to port which programs works on and use the program on your own machine!</p>
<p>There is also the concept of <strong>Remote Forwarding</strong>. In this case, you connect a port from a remote server to another server (mostly your own computer). Using this, you can expose a webserver from your own computer on the Internet:</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">R</span><span class="w"> </span><span class="mi">8000</span><span class="o">:</span><span class="n">localhost</span><span class="o">:</span><span class="mi">80</span><span class="w"> </span><span class="n">root</span><span class="mf">@5.161.197.79</span>
</code></pre></div>

<p>In the above example, I'm telling the ssh to create a <strong>Remote</strong> tunnel. After this any request on port 8000 from the 5.161.197.79 computer will reach to localhost (my machine) port 80!</p>
<p>You can even ask the remote machine to start listening on a specific port on all of its interfaces (open up to the network and not only localhost):</p>
<div class="highlight"><pre><span></span><code>ssh -R 0.0.0.0:8000:localhost:7777 192.168.70.2
</code></pre></div>

<p>Above, I'm telling the 192.168.70.2 machine to open port 8000 to ALL interfaces and forward whatever it got to my machiens 7777 port.</p>
<blockquote>
<p>to let clients to <em>bind</em> listening ports to anything other than localhost, the <code>GatewayPorts clientspecified</code> configu should be set in the ssh server's config file.</p>
</blockquote>
<p>There are even more use caases. For example you use the -D switch for a <code>dynamic</code> application level port forarding. It works like a proxy / anti censorship. If I do </p>
<div class="highlight"><pre><span></span><code>ssh -D 1080 192.168.70.2
</code></pre></div>

<p>The 1080 port will work ask a <em>socks</em> proxy on my machine and forward whatever request reaches it to the 192.168.70.2 machine and returns back the answers. Now I can configure my applications to use the localhost:1080 as their socks proxy and the 192.168.70.2 will work as a proxy here. This is useful when you do not have internet on your localhost, but 192.168.70.2 has it.</p>
<h5>X Forwarding</h5>
<p>The last concept I want to talk about in forwarding section, is the X forwarding. As you already know from <a href="1061-install-and-configure-x11.html">Module 106</a>, linux graphical applications use X as their graphical host. This X can also be forwarded on the network as any other network based communication. Its even has its own switch on the ssh program. To forward the X, its enough to add a <code>-X</code> to your ssh. Please note that the <code>X11Forwarding yes</code> configuration should be present in your sshd_config file.</p>
<p>To activate the X11 forwarding in a ssh session, simply add <code>-X</code> to your ssh:</p>
<div class="highlight"><pre><span></span><code>ssh -X 192.168.70.2
</code></pre></div>

<p>and then you can run graphical programs (say <code>xeyes</code> for fun) on the remote machine and see the graphical part on your own X server!</p>
<blockquote>
<p>If you are not on a GNU/Linux machine with an X11 server, you need to install it (for example XQuartz on Mac)</p>
</blockquote>
<p>This is very useful when you want to run a program on a resourceful server or work from home whiel your graphical applications are at the office ;)</p>
<h2>ecnrypt and sign using gpg</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/BX6BB8bqy24?si=iIWhRQnFmADr93n6" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>As described in previous section, a public and private key pair can be used to encrypt or sign messages. There is an implementation of this method called <code>gpg</code> which can be used on Linux (and other machiens) to perform these tasks. First you need to generate a key:</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ gpg --gen-key
gpg (GnuPG) 2.2.40; Copyright (C) 2022 g10 Code GmbH
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

gpg: directory &#39;/home/jadi/.gnupg&#39; created
gpg: keybox &#39;/home/jadi/.gnupg/pubring.kbx&#39; created
Note: Use &quot;gpg --full-generate-key&quot; for a full featured key generation dialog.

GnuPG needs to construct a user ID to identify your key.

Real name: Jadi
Name must be at least 5 characters long
Real name: Jadi M
Email address: jadijadi@gmail.com
You selected this USER-ID:
    &quot;Jadi M &lt;jadijadi@gmail.com&gt;&quot;

Change (N)ame, (E)mail, or (O)kay/(Q)uit?
Change (N)ame, (E)mail, or (O)kay/(Q)uit? O
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: /home/jadi/.gnupg/trustdb.gpg: trustdb created
gpg: directory &#39;/home/jadi/.gnupg/openpgp-revocs.d&#39; created


gpg: revocation certificate stored as &#39;/home/jadi/.gnupg/openpgp-revocs.d/E279681DC09318AB5B23D359C9063DD26365986A.rev&#39;
public and secret key created and signed.

pub   rsa3072 2023-09-17 [SC] [expires: 2025-09-16]
      E279681DC09318AB5B23D359C9063DD26365986A
uid                      Jadi M &lt;jadijadi@gmail.com&gt;
sub   rsa3072 2023-09-17 [E] [expires: 2025-09-16]
</code></pre></div>

<p>Now the key is created in the <code>~/.gnupg</code> directory and we can share our public key with others:</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ gpg --list-keys
/home/jadi/.gnupg/pubring.kbx
-----------------------------
pub   rsa3072 2023-09-17 [SC] [expires: 2025-09-16]
      E279681DC09318AB5B23D359C9063DD26365986A
uid           [ultimate] Jadi M &lt;jadijadi@gmail.com&gt;
sub   rsa3072 2023-09-17 [E] [expires: 2025-09-16]

jadi@debian:~$ gpg --export jadi &gt; jadi.pub.key
jadi@debian:~$ file jadi.pub.key
jadi.pub.key: OpenPGP Public Key Version 4, Created Sun Sep 17 12:39:19 2023, RSA (Encrypt or Sign, 3072 bits); User ID; Signature; OpenPGP Certificate
</code></pre></div>

<blockquote>
<p>the exported key is in binary format, add <code>-a</code> to armor it in ascii</p>
</blockquote>
<p>Now you have to distribute this key to others. You can upload it somewhere, email it, put it on your website or use some of the public key stores to share it with other. If anyone recives it, she can import it into her key store using the following command:</p>
<div class="highlight"><pre><span></span><code>gpg --import jadi.pub.key
</code></pre></div>

<p>Oh! and what happens if you feel that your key is compromised!? In this case you have to create a <strong>revoke</strong> file and share it with other to tell them that your key is not valid anymore:</p>
<div class="highlight"><pre><span></span><code>gpg --output jadi.revoke.asc --gen-revoke jadijadi@gmail.com
</code></pre></div>

<p>This tells gpg to create a revoke file called jadi.revoke.asc for the identity jadijadi@gmail.com. If jadijadi@gmail.com needs to invalidate his public key, he has to publish this file to the Internet or key servers and others will know that the previous public key is not valid anymore.</p>
<h3>Encrypt / Decrypt files</h3>
<p>At this stage, I have a key and my friends do have my public key imported in their machine. If any of them wants to send my an encrypted message, they can do the following: </p>
<div class="highlight"><pre><span></span><code><span class="n">echo</span><span class="w"> </span><span class="ss">&quot;I Loved your course! I&#39;ll tell all my friends about it.&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">file</span><span class="p">.</span><span class="n">txt</span>
<span class="n">gpg</span><span class="w"> </span><span class="c1">--out file.txt.encrypted --recipient jadijdai@gmail.com --encrypt file.txt</span>
</code></pre></div>

<p>Now its enough for them to send me this file. Even using unsecure channels because its encrypted by the top notch tools. Every one can download this file but ONLY I will be able to decypt it; because only I have the <strong>Private key</strong> of jadijadi@gmail.com.</p>
<div class="highlight"><pre><span></span><code>gpg --out out.txt --decrypt file.txt.encrypted
</code></pre></div>

<blockquote>
<p>If you liked this course, no need to encrypt the message, just share the <a href="https://linux1st.com">linux1st.com</a> on the internet! </p>
</blockquote>
<h4>Signing and verifying files</h4>
<p>In the previous section, we used gpg to encrypt the data. We used someone's Public key to encrypt and then used our own Private Key to decrypt the data. But what happens if I use my Private key on my side and let other use my Public key to <em>open</em> the data? That is called *<em>signing</em>. </p>
<p>Please remember that only I have access to my private key. So if I apply it to a file, every one:</p>
<ol>
<li>will be able to open the file using my Public Key</li>
<li>Will be sure that <strong>I</strong> have signed this because only <strong>I</strong> has access to the private key of the public key they used to open the file.</li>
</ol>
<p>Lets sign a message:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;I&#39;m Jadi and I&#39;m glad that you reached to the end of your LPIC study&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>message-jadi.txt
$<span class="w"> </span>gpg<span class="w"> </span>--output<span class="w"> </span>message-jadi.sig<span class="w"> </span>--sign<span class="w"> </span>message-jadi.txt
</code></pre></div>

<p>Now its enough for me to publish the <code>message-jadi.sig</code> to the Internet or send it to someone. If they want to make sure that it is truely comming from me, its enough for them to check my signature (obviously after importing my public key):</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">gpg</span><span class="w"> </span><span class="o">--</span><span class="n">verify</span><span class="w"> </span><span class="n">message</span><span class="o">-</span><span class="n">jadi</span><span class="p">.</span><span class="n">sig</span>
<span class="nl">gpg</span><span class="p">:</span><span class="w"> </span><span class="n">Signature</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="n">Sun</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2023</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">26</span><span class="err">:</span><span class="mi">15</span><span class="w"> </span><span class="n">AM</span><span class="w"> </span><span class="n">EDT</span>
<span class="nl">gpg</span><span class="p">:</span><span class="w">                </span><span class="k">using</span><span class="w"> </span><span class="n">RSA</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">E279681DC09318AB5B23D359C9063DD26365986A</span>
<span class="nl">gpg</span><span class="p">:</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="n">signature</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="ss">&quot;Jadi M &lt;jadijadi@gmail.com&gt;&quot;</span><span class="w"> </span><span class="o">[</span><span class="n">ultimate</span><span class="o">]</span>
</code></pre></div>

<p>This only checked the signature, if they also needed to decrypt the message they had to as follow:</p>
<div class="highlight"><pre><span></span><code><span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">gpg</span><span class="w"> </span><span class="o">--</span><span class="k">output</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">jadi</span><span class="w"> </span><span class="o">--</span><span class="n">decrypt</span><span class="w"> </span><span class="n">message</span><span class="o">-</span><span class="n">jadi</span><span class="p">.</span><span class="n">sig</span>
<span class="nl">gpg</span><span class="p">:</span><span class="w"> </span><span class="n">Signature</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="n">Sun</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2023</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">26</span><span class="err">:</span><span class="mi">15</span><span class="w"> </span><span class="n">AM</span><span class="w"> </span><span class="n">EDT</span>
<span class="nl">gpg</span><span class="p">:</span><span class="w">                </span><span class="k">using</span><span class="w"> </span><span class="n">RSA</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">E279681DC09318AB5B23D359C9063DD26365986A</span>
<span class="nl">gpg</span><span class="p">:</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="n">signature</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="ss">&quot;Jadi M &lt;jadijadi@gmail.com&gt;&quot;</span><span class="w"> </span><span class="o">[</span><span class="n">ultimate</span><span class="o">]</span>
<span class="n">jadi</span><span class="nv">@debian</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">jadi</span>
<span class="n">I</span><span class="s1">&#39;m Jadi and I&#39;</span><span class="n">m</span><span class="w"> </span><span class="n">glad</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">reached</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">LPIC</span><span class="w"> </span><span class="n">study</span>
</code></pre></div>

<p>Please also note the <code>--clearsign</code> option. This option will create a file ending in <code>.asc</code> which containt the original un-encrypted (clear text) message alongside the signature. This way non-tech-savy people will be able to read the message too and only if someone wants, she can <code>--verify</code> the signature.</p>
<div class="highlight"><pre><span></span><code>jadi@debian:~$ cat message-jadi.txt
I&#39;m Jadi and I&#39;m glad that you reached to the end of your LPIC study
jadi@debian:~$ gpg --clearsign message-jadi.txt
jadi@debian:~$ ls -ltrh
total 16M
drwxr-xr-x 27 jadi jadi 4.0K Jun 15 09:00 rust-for-linux
drwxr-xr-x  2 jadi jadi 4.0K Jun 15 09:09 Downloads
drwx------  2 jadi jadi 4.0K Jul 17 10:53 BRF
-rw-r--r--  1 jadi jadi    6 Jul 17 10:57 myfile
drwxr-xr-x  5 jadi jadi 4.0K Jul 25 13:34 nltk_data
drwxr-xr-x  4 jadi jadi 4.0K Aug 13 07:29 w
-rw-r--r--  1 jadi jadi  16M Aug 24 01:15 nvim-linux64.tar.gz
drwxr-xr-x  6 jadi jadi 4.0K Aug 24 05:38 nvim-linux64
-rw-r--r--  1 jadi jadi 3.8K Aug 27 15:49 report.xml
-rw-r--r--  1 jadi jadi 1.8K Sep 17 08:50 jadi.pub.key
-rw-r--r--  1 jadi jadi   69 Sep 17 09:26 message-jadi.txt
-rw-r--r--  1 jadi jadi  549 Sep 17 09:26 message-jadi.sig
-rw-r--r--  1 jadi jadi   69 Sep 17 09:27 message.jadi
-rw-r--r--  1 jadi jadi  777 Sep 17 09:28 message-jadi.txt.asc
jadi@debian:~$ cat message-jadi.txt.asc
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

I&#39;m Jadi and I&#39;m glad that you reached to the end of your LPIC study
-----BEGIN PGP SIGNATURE-----

iQGzBAEBCgAdFiEE4nloHcCTGKtbI9NZyQY90mNlmGoFAmUG/xYACgkQyQY90mNl
mGqpXQv/QNv0NlCR+S7HJhxiOZcKXE3RB1sx4jRVrOtMd6ZoXYLb28Zz4xN/Lzh2
sipohDbNttr1ovNZvMMu83bbuSeViY9L7nvjNjKsY50u5V1KnrMJPHRaGV8g/0p2
t5zFJuzSFWXQczIjjXMpoLVH8jK3mJuBOmVFwLuBqUoW8827tCLIdr1DNyHXBW47
fcLK5/bO/ljdwGnAX46d+Prg0TIfMLjPpb7uFXVkRBo+zMtCEVDGObaVHQ3J8t6w
8i2YgMrmA3h9h4Gy/yM9Agb2kPeKl6iToeCfQ0EwTcnPF1TN0KZ1PS8Pr3Jp3LcS
A+p32zj7YTzTeE1uBAb7/BorBqaArX8HtLe15yFkNKhPluXya9GG4/Nsxk33Qpd3
c1KiLK9YhTFy7u+Q6tbTKG+uuGj71wANhkqRP30iMjLcBQ7aAO3ehVSYZFyZ7dbL
SJollwyG1sf4zH0g5SQZOxpjyz874IrlFc7GldDCr5jXZw6H+4NuY2yiVWKAcOcU
Qv23xWL2
=q81y
-----END PGP SIGNATURE-----
jadi@debian:~$ gpg --verify message-jadi.txt.asc
gpg: Signature made Sun 17 Sep 2023 09:28:54 AM EDT
gpg:                using RSA key E279681DC09318AB5B23D359C9063DD26365986A
gpg: Good signature from &quot;Jadi M &lt;jadijadi@gmail.com&gt;&quot; [ultimate]
gpg: WARNING: not a detached signature; file &#39;message-jadi.txt&#39; was NOT verified!
</code></pre></div>

<blockquote>
<p>here the --clearsign tells the gpg to include the clear text message in the output file too. The output file will be originalfile.asc</p>
</blockquote>
<p>and another one to verify that a document is singed correctly:</p>
<div class="highlight"><pre><span></span><code>gpg --verify recievedfile
</code></pre></div>

<h4>gpg-agent</h4>
<p>Just like the <code>ssh-agent</code>, <code>gpg-agent</code> is a tool which acts like a password manager for you gpg keys. It keeps the keys in the memory so you wont need to provide password on every single use. </p>
                                            <br clear="both" />
                                </div>
                            </div>
                        </div>
                        


                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>        <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>
    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>
