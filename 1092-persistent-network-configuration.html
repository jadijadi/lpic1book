<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Jadi" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="LPIC1, 102, LPIC1-102-500, LPIC1, " />

<meta property="og:title" content="109.2 Persistent network configuration "/>
<meta property="og:url" content="./1092-persistent-network-configuration.html" />
<meta property="og:description" content="" />
<meta property="og:site_name" content="lpic1book" />
<meta property="og:article:author" content="Jadi" />
<meta property="og:article:published_time" content="2010-12-03T10:20:00+01:00" />
<meta name="twitter:title" content="109.2 Persistent network configuration ">
<meta name="twitter:description" content="">

        <title>109.2 Persistent network configuration  · lpic1book
</title>



        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4CZV14VZXW"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-4CZV14VZXW');
        </script>
        
    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>lpic1book</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                </li>
                                <li ><a href="./">Home</a></li>
                                <li ><a href="./support">Support/Donate</a></li>
                                <li ><a href="./archives.html">Chapters</a></li>
                                <li ><a href="./tags.html">Tags</a></li>
                                <li><form action="https://www.google.com/search" method="get" target="_blank" class="navbar-search"> <input type="hidden" name="sitesearch" value="https://linux1st.com/"/><input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./1092-persistent-network-configuration.html">
                109.2 Persistent network configuration
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p><em>Weight: 4</em></p>
<p>Candidates should be able to view, change and verify configuration settings on client hosts.</p>
<h3>Key Knowledge Areas</h3>
<ul>
<li>Understand basic TCP/IP host configuration</li>
<li>Configure ethernet and wi-fi network configuration using NetworkManager</li>
<li>Awareness of systemd-networkd</li>
</ul>
<h3>Terms and Utilities</h3>
<ul>
<li><code>/etc/hostname</code></li>
<li><code>/etc/hosts</code></li>
<li><code>/etc/nsswitch.conf</code></li>
<li><code>/etc/resolv.conf</code></li>
<li><code>nmcli</code></li>
<li><code>hostnamectl</code></li>
<li><code>ifup</code></li>
<li><code>ifdown</code></li>
</ul>
<h3>Intro</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/YN8sJuy9df8?si=BEs4RmfvW1zdSUA4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>As we saw in the previous section, every PC, server, laptop, phone, .. should have an IP configuration (IP, Netmask, Default gateway, DNS, ..) to work properly in the network. This can be done in various ways. Some devices like laptops are changing their network all the time and should be able to keep up with the changes. Some servers remain in the same location (physical and network wise) all their life and should persist this configuration after restarts, outages, upgrade and HW changes.</p>
<p>In this section we will see how this can be achieved in modern GNU/Linux systems.</p>
<h3>Network Interface</h3>
<p>The NIC (or Network Interface Card) is the physical network hardware in your computer. This can be the chip+antenna in your mobile phone or an Ethernet Card connected to a network cable on your PC.</p>
<p>In older systems, these were called things like <code>eth0</code>, <code>eth1</code>, <code>eth2</code>, ... where 0, 1 &amp; 2 were decided by the kernel - mostly based on the order of loading the drivers. In recent Linux machines the NICs are called by <code>wlan0</code>, <code>eno1</code>, <code>ens1</code>, <code>enp3s2</code> and such. This is based on some more concrete data like being an <code>wireless</code> or <code>ethernet</code>, PCI (<code>ens</code>) or bus like (<code>enp</code>). </p>
<p>The <code>ip</code> command can show these:</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="nv">ip</span><span class="w"> </span><span class="nv">link</span><span class="w"> </span><span class="k">show</span>
<span class="mi">1</span>:<span class="w"> </span><span class="nv">lo</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">LOOPBACK</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">mtu</span><span class="w"> </span><span class="mi">65536</span><span class="w"> </span><span class="nv">qdisc</span><span class="w"> </span><span class="nv">noqueue</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">UNKNOWN</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nv">DEFAULT</span><span class="w"> </span><span class="nv">group</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">qlen</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="nv">link</span><span class="o">/</span><span class="nv">loopback</span><span class="w"> </span><span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span><span class="w"> </span><span class="nv">brd</span><span class="w"> </span><span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>
<span class="mi">2</span>:<span class="w"> </span><span class="nv">wlp108s0</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">BROADCAST</span>,<span class="nv">MULTICAST</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="nv">qdisc</span><span class="w"> </span><span class="nv">noqueue</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">UP</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nv">DORMANT</span><span class="w"> </span><span class="nv">group</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">qlen</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="nv">link</span><span class="o">/</span><span class="nv">ether</span><span class="w"> </span><span class="mi">00</span>:<span class="nv">bb</span>:<span class="mi">60</span>:<span class="mi">97</span>:<span class="mi">6</span><span class="nv">b</span>:<span class="mi">07</span><span class="w"> </span><span class="nv">brd</span><span class="w"> </span><span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>
<span class="mi">3</span>:<span class="w"> </span><span class="nv">docker0</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">NO</span><span class="o">-</span><span class="nv">CARRIER</span>,<span class="nv">BROADCAST</span>,<span class="nv">MULTICAST</span>,<span class="nv">UP</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="nv">qdisc</span><span class="w"> </span><span class="nv">noqueue</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">DOWN</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nv">DEFAULT</span><span class="w"> </span><span class="nv">group</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span>
<span class="w">    </span><span class="nv">link</span><span class="o">/</span><span class="nv">ether</span><span class="w"> </span><span class="mi">02</span>:<span class="mi">42</span>:<span class="mi">75</span>:<span class="nv">d3</span>:<span class="nv">e6</span>:<span class="nv">ff</span><span class="w"> </span><span class="nv">brd</span><span class="w"> </span><span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>
</code></pre></div>

<blockquote>
<p>The <code>lo</code> is a virtual network adapter called the <em>loopback</em> device. It is always there and points to "this device or 127.0.0.1 as IPv4 calls it".</p>
</blockquote>
<h3>Configuring NICs</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/KKL-r4eAZHI?si=Av2ehqBv7eoRHuGw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>In older distributions, the <code>ifconfig</code> was used to check / configure the IP settings on NICs. Have a look:</p>
<div class="highlight"><pre><span></span><code>$ ifconfig
enp0s25: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        ether f0:de:f1:62:c5:73  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 20  memory 0xd1500000-d1520000  

lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1  (Local Loopback)
        RX packets 560719  bytes 339937974 (324.1 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 560719  bytes 339937974 (324.1 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlp3s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.35  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::8ea9:82ff:fe7b:8906  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 8c:a9:82:7b:89:06  txqueuelen 1000  (Ethernet)
        RX packets 2325385  bytes 2629859900 (2.4 GiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2023796  bytes 510997240 (487.3 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre></div>

<p>It is also possible to use <code>ifconfig</code> to change the network configurations, but you should have root access:</p>
<div class="highlight"><pre><span></span><code>$  sudo ifconfig enp0s25 192.168.42.42
password for jadi:
$ ifconfig enp0s25
enp0s25: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        inet 192.168.42.42  netmask 255.255.255.0  broadcast 192.168.42.255
        ether f0:de:f1:62:c5:73  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 20  memory 0xd1500000-d1520000  

$
</code></pre></div>

<p>In case you want to change the netmask of an interface, do <code>ifconfig eth0 netmask 255.255.0.0</code> or as most of us used to do, issue both in one command:</p>
<div class="highlight"><pre><span></span><code># ifconfig eth0 192.168.42.42 netmask 255.255.255.0
</code></pre></div>

<p>It is also possible to turn the interfaces <em>up</em> and <em>down</em> (on and off) using predefined configurations by:</p>
<div class="highlight"><pre><span></span><code>$ sudo ifconfig enp0s25 down
[sudo] password for jadi:
$ ifconfig
lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1  (Local Loopback)
        RX packets 562273  bytes 340257228 (324.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 562273  bytes 340257228 (324.4 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

wlp3s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.35  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::8ea9:82ff:fe7b:8906  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 8c:a9:82:7b:89:06  txqueuelen 1000  (Ethernet)
        RX packets 2330388  bytes 2634026235 (2.4 GiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2027352  bytes 511549072 (487.8 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre></div>

<p>As you can see, downing the interface removed it from the list of active interfaces, using switch <code>-a</code> will tell the <code>ifconfig</code> to show ALL interfaces, even if they are down.</p>
<p>In many systems there are <code>ifup</code> and <code>ifdown</code> commands directly to up and down interfaces easily. They work just like <code>ifup eth0</code>.</p>
<p>These predefined configs are located at <code>/etc/network/interfaces</code> on Debian based machines and at <code>/etc/sysconfig/network-scripts/</code> in RPM based distro. </p>
<p>This is a sample of such file on a RedHat based distro:</p>
<div class="highlight"><pre><span></span><code>$ cat /etc/sysconfig/network-scripts/ifcfg-eth0
DEVICE=eth0
ONBOOT=yes
TYPE=Ethernet
IPADDR=192.168.1.10
NETMASK=255.255.255.0
DNS1=4.2.2.4
</code></pre></div>

<p>On RPM systems, the default gateway is configured via the below file:</p>
<div class="highlight"><pre><span></span><code>cat /etc/sysconfig/network
NETWORKING=yes
HOSTNAME=lpictest
GATEWAY=192.168.1.1
</code></pre></div>

<p>On Debian based systems (including Ubuntu) the main configuration file for network interfaces is <code>/etc/network/interfaces</code>. This one file has the configuration for all the interfaces. Have a look:</p>
<div class="highlight"><pre><span></span><code>auto lo
iface lo inte loopback

auto eth0
#ifconfig eth0 inet dhcp
iface eth0 inet static
address 192.168.1.10
netmask 255.255.255.0
gateway 192.168.1.1
dns-nameservers 4.2.2.4
</code></pre></div>

<h3><code>ip</code></h3>
<p>Recent distributions are mostly using the <code>ip</code> command. This command can do lots of things including and not limited to showing and configuring the IP addresses, netmasks, default gateways &amp; routing rules.</p>
<div class="highlight"><pre><span></span><code><span class="nv">ip</span><span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="mi">172</span>.<span class="mi">19</span>.<span class="mi">1</span>.<span class="mi">10</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nv">dev</span><span class="w"> </span><span class="nv">eth2</span><span class="w"> </span>#<span class="w"> </span><span class="nv">temporary</span><span class="w"> </span><span class="nv">adding</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">IP</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="nv">eth2</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="nv">del</span><span class="w"> </span><span class="mi">172</span>.<span class="mi">19</span>.<span class="mi">1</span>.<span class="mi">10</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nv">dev</span><span class="w"> </span><span class="nv">eth2</span><span class="w"> </span>#<span class="w"> </span><span class="nv">deleting</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">IP</span><span class="w"> </span><span class="nv">address</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">link</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">eth2</span><span class="w"> </span><span class="nv">up</span><span class="w"> </span>#<span class="w"> </span><span class="nv">brining</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">NIC</span><span class="w"> </span><span class="nv">up</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">route</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">route</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">via</span><span class="w"> </span><span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">1</span><span class="w"> </span>#<span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">gateway</span>
</code></pre></div>

<p>Please note that above commands do temporary changes which will be lost after restarting the <code>NetworkManager</code> service. If you need permanent changes, it should be done using the configuration files or Network Manager interfaces. </p>
<h3>NetworkManager &amp; <code>nmcli</code></h3>
<p>In recent years, <code>NetworkManager</code> services has gained a lot of popularity. This service can "watch" the status of network and various configuration and configure the network cards (specially the wifi ones) accordingly. This is what makes our laptop connected whenever we open it in an area with a known WiFi or ask about the password if we want to connect to a new network or assign IP addresses as soon as we connect the cable to our Ethernet card. This IP assignment might happen via the "permanent IP configuration" on your device or a protocol called DHCP. When using DHCP (Dynamic Host Configuration Protocol), your computer asks a DHCP server (say your home's wifi router) about the IP, Netmask, Default gateway, DNS and other stuff and sets them. </p>
<p>By default, NetworkManager  daemon controls the networks which are not mentioned in <code>/etc/network/interfaces</code>. This service is running in the background and controls the NICs which are not configured there. Various frontend GUI (graphical user interface) or TUI (textual user interface. try <code>nmtui</code> ) or CLI (command line interfaces) programs exists to control or configure the NetworkManager daemon. If you are using a Desktop Linux, you've probably already used / know one (say the network manager applet). Here I will show you how to use the <code>nmcli</code> from the command line.</p>
<p>We always call the <code>nmcli</code> with one of it various commands, here is a list:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>general</td>
<td>NetworkManager’s general status and operations.</td>
</tr>
<tr>
<td>networking</td>
<td>Overall networking control.</td>
</tr>
<tr>
<td>radio</td>
<td>NetworkManager radio switches.</td>
</tr>
<tr>
<td>connection</td>
<td>Controlling the connection</td>
</tr>
<tr>
<td>device</td>
<td>Devices controlled by NetworkManager</td>
</tr>
<tr>
<td>agent</td>
<td>secret or polkit agent</td>
</tr>
<tr>
<td>monitor</td>
<td>Montor the changes</td>
</tr>
</tbody>
</table>
<p>For example, we can check the current status with the <code>general</code> command:</p>
<div class="highlight"><pre><span></span><code>➜  ~ nmcli general
STATE      CONNECTIVITY  WIFI-HW  WIFI     WWAN-HW  WWAN    
connected  full          enabled  enabled  missing  enabled
</code></pre></div>

<p>Or if you want to check the devices or list of Wi-Fi connections:</p>
<div class="highlight"><pre><span></span><code>➜  ~ nmcli device          
DEVICE            TYPE      STATE                   CONNECTION          
wlp108s0          wifi      connected               Sharm Bar Sansoor 5 
docker0           bridge    connected (externally)  docker0             
lo                loopback  connected (externally)  lo                  
p2p-dev-wlp108s0  wifi-p2p  disconnected            --                  
➜  ~ nmcli device wifi     
IN-USE  BSSID              SSID                 MODE   CHAN  RATE        SIGNAL  BARS  SECURITY  
        6C:AD:EF:38:13:38  AxLTE                Infra  3     270 Mbit/s  84      ▂▄▆█  WPA2      
        00:E0:4C:93:1D:B8  Lanat Be Sansoorchi  Infra  6     130 Mbit/s  59      ▂▄▆_  WPA2      
*       24:F5:A2:42:DE:CE  Sharm Bar Sansoor 5  Infra  36    540 Mbit/s  47      ▂▄__  WPA2      
        30:A2:20:DD:8B:54  AvinaAmin            Infra  7     270 Mbit/s  29      ▂___  WPA1 WPA2 
        30:85:A9:8C:71:2C  bahram               Infra  11    65 Mbit/s   29      ▂___  WPA2
</code></pre></div>

<p>To connect to a Wi-Fi network, you're a do:</p>
<div class="highlight"><pre><span></span><code><span class="nv">nmcli</span><span class="w"> </span><span class="nv">device</span><span class="w"> </span><span class="nv">wifi</span><span class="w"> </span><span class="k">connect</span><span class="w"> </span><span class="nv">AxLTE</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="nv">AFunkyPassword</span><span class="w"> </span>
</code></pre></div>

<h3>Fancy Names for Computers</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/yR07UaiNeME?si=UcsRifk-HXLH-L4U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<h4>hostname</h4>
<p>Remembering IP addresses are easy for robots but not for humans. Thats why we have "hostname"s. A hostname is a like a contact list where you just tell "call Jadi" and the system known my phone number. If you check your <code>/etc/hostname</code>, you will see your machines name there. Although you can change it temporarily (or permanently). The command is <code>hostnamectl</code>. </p>
<div class="highlight"><pre><span></span><code>[funlap ~]# hostnamectl set-hostname mycoolmachine
[funlap ~]# hostname
mycoolmachine
[funlap ~]# cat /etc/hostname 
mycoolmachine
[funlap ~]# bash
[mycoolmachine ~]# 
</code></pre></div>

<p>Or you can change it as <em>transient</em>, which is a temporary change using the <code>--transient</code> switch.</p>
<p>It is also possible to define a "pretty" name for your computer so other systems might show it in their interfaces more nicely:</p>
<div class="highlight"><pre><span></span><code>[mycoolmachine ~]# hostnamectl --pretty set-hostname &quot;LAN Shared Storage&quot;
[mycoolmachine ~]# hostnamectl status
 Static hostname: mycoolmachine
 Pretty hostname: LAN Shared Storage
       Icon name: computer-convertible
         Chassis: convertible
      Machine ID: 0b126c4b6f4347168140eaa6202ce8be
         Boot ID: 675eff37f42648c6bdea31177596557f
Operating System: Manjaro Linux                   
          Kernel: Linux 6.1.38-1-MANJARO
    Architecture: x86-64
 Hardware Vendor: Dell Inc.
  Hardware Model: Latitude 7390 2-in-1
Firmware Version: 1.30.0
</code></pre></div>

<h4><code>/etc/hosts</code></h4>
<p>This file contains a list of IPs and their corresponding names, including your own computers. </p>
<div class="highlight"><pre><span></span><code>[<span class="nv">mycoolmachine</span><span class="w"> </span><span class="o">~</span>]#<span class="w"> </span><span class="nv">head</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="o">/</span><span class="nv">etc</span><span class="o">/</span><span class="nv">hosts</span>
##
#<span class="w"> </span><span class="nv">Host</span><span class="w"> </span><span class="nv">Database</span>
#
#<span class="w"> </span><span class="nv">localhost</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">configure</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">loopback</span><span class="w"> </span><span class="nv">interface</span>
#<span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">booting</span>.<span class="w">  </span><span class="k">Do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">change</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">entry</span>.
##
<span class="mi">127</span>.<span class="mi">0</span>.<span class="mi">0</span>.<span class="mi">1</span><span class="w">   </span><span class="nv">localhost</span><span class="w"> </span><span class="nv">funlife</span><span class="w"> </span><span class="nv">db</span>
<span class="mi">255</span>.<span class="mi">255</span>.<span class="mi">255</span>.<span class="mi">255</span><span class="w"> </span><span class="nv">broadcasthost</span>
::<span class="mi">1</span><span class="w">             </span><span class="nv">localhost</span>
##
#<span class="w"> </span><span class="nv">Host</span><span class="w"> </span><span class="nv">Database</span>
#
#<span class="w"> </span><span class="nv">localhost</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">configure</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">loopback</span><span class="w"> </span><span class="nv">interface</span>
#<span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">system</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">booting</span>.<span class="w">  </span><span class="k">Do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">change</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">entry</span>.
##

<span class="mi">198</span>.<span class="mi">74</span>.<span class="mi">56</span>.<span class="mi">50</span><span class="w"> </span><span class="nv">jobs</span>.<span class="nv">jadi</span>.<span class="nv">net</span>
<span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">22</span><span class="w"> </span><span class="nv">amoledtesting</span><span class="w"> </span>

<span class="mi">67</span>.<span class="mi">217</span>.<span class="mi">170</span>.<span class="mi">72</span><span class="w"> </span><span class="nv">vps</span>
</code></pre></div>

<p>So when you need to reach a machine by its name, your OS will now which IP to reach. </p>
<h4>DNS configuration</h4>
<p>DNS (which stands for Domain Name System) is a server which translates human-readable domain names (or more technically, text based domain names) to the corresponding IP addresses. You have to configure your computer to use a DNS so it will know which IP to contacted if you wanted to reach <code>linux1st.com</code> (and <a href="https://linux1st.com/support">donate</a> maybe).</p>
<p>This configuration can be found in <code>/etc/resolve.conf</code>.</p>
<div class="highlight"><pre><span></span><code>nameserver 192.168.1.1
nameserver 4.2.2.4
domain jadi.net
search jadi.net company.com
</code></pre></div>

<p>Here I'm telling my computer to contact the DNS on my home network (192.168.1.1) or a DNS located at 4.2.2.4 if it needed to translate an address to an IP. </p>
<p>The <code>domain</code> configuration sets a local domain name so the machines in this domain will be able to use a short name (tv, instead of tv.jadi.net) and the <code>search</code> config does kind the same and tells the resolver to search for <code>tv.jadi.net</code> and <code>tv.company.com</code> if it was trying to resolve <code>tv</code>.</p>
<h4>nsswitch</h4>
<p>The <code>/etc/nsswitch.conf</code> file is used to configure which services are to be used to determine information such as hostnames, password files, and group files. Mine is</p>
<div class="highlight"><pre><span></span><code># cat /etc/nsswitch.conf
# Begin /etc/nsswitch.conf

passwd: files
group: files
shadow: files

publickey: files

hosts: files dns myhostname
networks: files

protocols: files
services: files
ethers: files
rpc: files

netgroup: files

# End /etc/nsswitch.conf
</code></pre></div>

<p>So if someone wants to check a password, the system will try the password <em>file</em> on the system. Or if they want to check an ip address of a hostname, my config says <code>hosts: files dns myhostname</code> so the computer first tries the files (/etc/hosts) and then goes for DNS. If I reverse these and change the line to</p>
<div class="highlight"><pre><span></span><code>hosts:      dns files
</code></pre></div>

<p>Any resolve request will be sent to a DNS server first and the /etc/hosts will be used only if the DNS servers answers "I don't know!"</p>


             
 
            
            
            







            <hr/>

            <!-- show next and previous links -->
            <table style="background: white; border: 0; font-size: 0.8em;"><tr>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <td style="background: white; border: 0;">
                            <a href="./1091-fundamentals-of-internet-protocols.html">← 109.1 Fundamentals of internet protocols</a>
                </td>
                <td style="background: white; border: 0;"><center ><a href="/archives.html">Chapter List</a></center></td>
                <td style="background: white; border: 0; text-align: right;">
                            <a href="./1093-basic-network-troubleshooting.html">109.3 Basic network troubleshooting →</a>
                </td>
                
                
                
                
                
            </tr></table>
            
            <hr />


	<div class=comment>

<div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://linux1st.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


	</div>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#lpic1-ref">LPIC1</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="./tags.html#102-ref">102
                    <span class="superscript">20</span>
</a></li>
                <li><a href="./tags.html#lpic1-ref">LPIC1
                    <span class="superscript">42</span>
</a></li>
                <li><a href="./tags.html#lpic1-102-500-ref">LPIC1-102-500
                    <span class="superscript">20</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="./theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>